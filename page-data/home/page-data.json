{"componentChunkName":"component---gatsby-ghost-theme-src-templates-home-js","path":"/home/","webpackCompilationHash":"283f27f644fa2f206251","result":{"data":{"page":{"html":"<p>The most useful feature of the ACF Wordpress plugin is its PHP API. Unfortunately, it is not fully documented on the official <a href=\"https://www.advancedcustomfields.com/resources/register-fields-via-php/\">page</a>.</p>\n<p>Here are the missing fields:</p>\n<h2>ACF Repeater field</h2>\n<p>Code example.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n  <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_reference_section'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Some label'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'reference_section'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'repeater'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'layout'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'table'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// also 'block' and 'row' are available</span>\n  <span class=\"token single-quoted-string string\">'required'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'min'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'button_label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Add another attachment'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'sub_fields'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n      <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_reference_name'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Name'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'reference_name'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'text'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n      <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_reference_value'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Value'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'reference_value'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'text'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>ACF Date Picker field</h2>\n<p>Code example:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">  <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_578f5d95e81fa'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'test'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'datatest'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'date_picker'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'instructions'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'required'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'conditional_logic'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'wrapper'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token single-quoted-string string\">'width'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'class'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'display_format'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'d/m/Y'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'return_format'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'d/m/Y'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'first_day'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 1 - monday</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>ACF Google Maps field</h2>\n<p>Code example:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_position'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Position on the map'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'position'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'google_map'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'required'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'center_lat'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">50.3091691</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'center_lng'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">19.2547187</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'zoom'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'height'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">400</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>// TODO: add some comments and improve this documentation</strong></p>\n<h2>hide_on_screen</h2>\n<p>Hide on screen is an ACF field group option which allows hiding selected admin page elements when the group is active (current page matches group <code class=\"language-text\">location</code> parameter). Here is the list of available <code class=\"language-text\">hide_on_screen</code> values. You may provide one or more value as an array.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token function\">acf_add_local_field_group</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token comment\">//... (other options)</span>\n  <span class=\"token single-quoted-string string\">'hide_on_screen'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'permalink'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'the_content'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'excerpt'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'custom_fields'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'discussion'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'comments'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'revisions'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'slug'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'author'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'format'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'page_attributes'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'featured_image'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'categories'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'tags'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'send-trackbacks'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","timeToRead":1,"rawMarkdownBody":"The most useful feature of the ACF Wordpress plugin is its PHP API. Unfortunately, it is not fully documented on the official [page](https://www.advancedcustomfields.com/resources/register-fields-via-php/).\n\nHere are the missing fields:\n\n## ACF Repeater field\n\nCode example.\n\n```php\narray(\n  'key' => 'field_reference_section',\n  'label' => 'Some label',\n  'name' => 'reference_section',\n  'type' => 'repeater',\n  'layout' => 'table', // also 'block' and 'row' are available\n  'required' => 1,\n  'min' => 1,\n  'button_label' => 'Add another attachment',\n  'sub_fields' => array(\n    array(\n      'key' => 'field_reference_name',\n      'label' => 'Name',\n      'name' => 'reference_name',\n      'type' => 'text',\n    ),\n    array(\n      'key' => 'field_reference_value',\n      'label' => 'Value',\n      'name' => 'reference_value',\n      'type' => 'text',\n    )\n  )\n)\n```\n\n## ACF Date Picker field\n\nCode example:\n\n```php\n  array (\n    'key' => 'field_578f5d95e81fa',\n    'label' => 'test',\n    'name' => 'datatest',\n    'type' => 'date_picker',\n    'instructions' => '',\n    'required' => 0,\n    'conditional_logic' => 0,\n    'wrapper' => array (\n      'width' => '',\n      'class' => '',\n      'id' => '',\n    ),\n    'display_format' => 'd/m/Y',\n    'return_format' => 'd/m/Y',\n    'first_day' => 1, // 1 - monday\n  ),\n```\n\n## ACF Google Maps field\n\nCode example:\n\n```php\narray (\n  'key' => 'field_position',\n  'label' => 'Position on the map',\n  'name' => 'position',\n  'type' => 'google_map',\n  'required' => 1,\n  'center_lat' => 50.3091691,\n  'center_lng' => 19.2547187,\n  'zoom' => 11,\n  'height' => 400\n),\n```\n**// TODO: add some comments and improve this documentation**\n\n## hide\\_on\\_screen\n\nHide on screen is an ACF field group option which allows hiding selected admin page elements when the group is active (current page matches group `location` parameter). Here is the list of available `hide_on_screen` values. You may provide one or more value as an array.\n\n```php\nacf_add_local_field_group(array (\n  //... (other options)\n  'hide_on_screen' => array (\n    'permalink',\n    'the_content',\n    'excerpt',\n    'custom_fields',\n    'discussion',\n    'comments',\n    'revisions',\n    'slug',\n    'author',\n    'format',\n    'page_attributes',\n    'featured_image',\n    'categories',\n    'tags',\n    'send-trackbacks',\n  ),\n));\n```\n","frontmatter":{"author":"jan","feature_image":null,"title":"ACF PHP API the missing docs","excerpt":null,"slug":"acf-php-api-the-missing-docs","date":"2017-05-08T13:28:50.000Z","tags":["wordpress","acf"],"date_created":"2017-04-27T12:05:05.000Z","date_updated":"2017-08-18T13:09:10.000Z","featured":false}},"posts":{"edges":[{"node":{"id":"72f86f5f-0345-5054-98a9-b2af241a4cc4","html":"<p>How to bind handlers in React to multiple similar elements e.g. buttons on list?\nIs it any better to use one handler and identify clicked elements (like it was in jQuery days) than binding them to each element?\nIs it an \"expensive\" operation to bind an event handler in React?</p>\n<p>TLDR; There is nearly no benefit from using only one handler bound to the parent container, but it is fairly important to avoid handler creation during rendering if you use Pure components as a children.</p>\n<h2>Overview</h2>\n<p>If you have a list of elements you may either set <code class=\"language-text\">onClick</code> property to each of rendered elements or create <code class=\"language-text\">onClick</code> handler in the parent container.\nI will try to show the difference between those two approaches.</p>\n<h2>Example</h2>\n<p>Each component is a button which shows its ID in the browser console in response to click event.</p>\n<iframe src=\"https://codesandbox.io/embed/6lo82zrlzw?fontsize=14&view=preview\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<p>In order to measure perfomance go to <a href=\"https://6lo82zrlzw.codesandbox.io/\">https://6lo82zrlzw.codesandbox.io/</a> and open Chrome DevTool Performance tab.</p>\n<h2>Description</h2>\n<p>In each case there were 1000 fairly simple React components rendered and measured.</p>\n<p>There are two types of components in this example:</p>\n<ul>\n<li>Regular - standard React.Component</li>\n<li>Pure - React.PureComponent</li>\n</ul>\n<p>And four ways of providing element context/information to event handler:</p>\n<ul>\n<li>Arrow - wrapping event handler in arrow function, data as an argument</li>\n<li>WithId - passing data through <code class=\"language-text\">data-id</code> and getting it through (<code class=\"language-text\">event.currentTarget</code>)</li>\n<li>SingleHandler - passing data through <code class=\"language-text\">data-id</code> and having one shared handler (<code class=\"language-text\">event.target</code>)</li>\n<li>MethodList - wrapping handler inside class method</li>\n</ul>\n<p>Here are the results from Google DevTools Performance tab.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 778px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b88373e4c76781a81c83f5acb465097f/e5651/react-handlers-performance.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.311053984575835%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAn0lEQVQI1x3Huw7BAABA0f4vQmIwGAxMHrsfoCltF7qgXkk3r6HaWCqqUpR2EJKW5BLbOULo++zHKsGyxW0hEq5Eoo3EfS3xNGU+O5XYkkkshbetktjK78r/sdUl3nZ+7pKYbWLXQPg8HjiDJk6/zEmrEhg1fL2EO0pxnma5zjMEkyJer8hRS+NpOcJRnkgvcJnUuU5rhOMG91mF12HIF/LWhQBS4p4tAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"react-handlers-performance\"\n        title=\"react-handlers-performance\"\n        src=\"/static/b88373e4c76781a81c83f5acb465097f/e5651/react-handlers-performance.png\"\n        srcset=\"/static/b88373e4c76781a81c83f5acb465097f/a1986/react-handlers-performance.png 210w,\n/static/b88373e4c76781a81c83f5acb465097f/ad7fb/react-handlers-performance.png 420w,\n/static/b88373e4c76781a81c83f5acb465097f/e5651/react-handlers-performance.png 778w\"\n        sizes=\"(max-width: 778px) 100vw, 778px\"\n      />\n  </a>\n    </span></p>\n<p>I've calculated average rendering time from 17 full page re-renders. Non of this re-renders was an initial render.\nNumbers from perfomance tab looks as follows (lower number is better).</p>\n<ul>\n<li>17 ms RegularArrow</li>\n<li>17 ms RegularSingleHandler</li>\n<li>18 ms RegularWithId</li>\n<li>20 ms PureSingleHandler</li>\n<li>21 ms PureWithId</li>\n<li>21 ms PureMethodList</li>\n<li><strong>64 ms</strong> RegularMethodList</li>\n<li><strong>73 ms</strong> PureArrow</li>\n</ul>\n<p>Avarage render time of each components list as a bar chart.</p>\n<p><img src=\"/bcb293b88e25de0d32ec12a704eb78b0/react-multiple-handlers.svg\" alt=\"react-multiple-handlers\">\n<small><sup>Chart rendered with <a href=\"https://www.amcharts.com/\">amCharts 4</a> library</sup></small></p>\n<p>It is not a big suprise that <strong>PureArrow</strong> component was the slowest one, as for each re-render shallow equality comparison has to be executed and in each case component has to be re-rendered due to the fact that arrow function creates new handler function during rendering.</p>\n<p>Surprising is the fact that <strong>RegularMethodList</strong> is second slowest way of event handling. I guess that that is due to the large overhead required for new component initialization, and on each re-render new component has to be created.</p>\n<p>What surprises me about this test is the fact that there is no benefit from having a single handler attached to parent component as it will be beneficial in the jQuery times.</p>\n<h2>Links</h2>\n<ul>\n<li><a href=\"https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/edit#\">https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/edit#</a> - official Google docs about data export from DevTools Performance tab</li>\n<li><a href=\"https://www.amcharts.com/\">https://www.amcharts.com/</a> - charting library used to render bar chart with rendering times</li>\n<li><a href=\"https://ymm959qlxv.codesandbox.io/\">https://ymm959qlxv.codesandbox.io/</a> - Google Chrome Performance tab visualizer app (source code: <a href=\"https://codesandbox.io/s/ymm959qlxv\">https://codesandbox.io/s/ymm959qlxv</a>)</li>\n</ul>","timeToRead":3,"rawMarkdownBody":"\nHow to bind handlers in React to multiple similar elements e.g. buttons on list?\nIs it any better to use one handler and identify clicked elements (like it was in jQuery days) than binding them to each element?\nIs it an \"expensive\" operation to bind an event handler in React?\n\nTLDR; There is nearly no benefit from using only one handler bound to the parent container, but it is fairly important to avoid handler creation during rendering if you use Pure components as a children.\n\n## Overview\n\nIf you have a list of elements you may either set `onClick` property to each of rendered elements or create `onClick` handler in the parent container.\nI will try to show the difference between those two approaches.\n\n## Example\n\nEach component is a button which shows its ID in the browser console in response to click event.\n\n<iframe src=\"https://codesandbox.io/embed/6lo82zrlzw?fontsize=14&view=preview\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n\nIn order to measure perfomance go to https://6lo82zrlzw.codesandbox.io/ and open Chrome DevTool Performance tab.\n\n## Description\n\nIn each case there were 1000 fairly simple React components rendered and measured.\n\nThere are two types of components in this example:\n\n- Regular - standard React.Component\n- Pure - React.PureComponent\n\nAnd four ways of providing element context/information to event handler:\n\n- Arrow - wrapping event handler in arrow function, data as an argument\n- WithId - passing data through `data-id` and getting it through (`event.currentTarget`)\n- SingleHandler - passing data through `data-id` and having one shared handler (`event.target`)\n- MethodList - wrapping handler inside class method\n\nHere are the results from Google DevTools Performance tab.\n\n![react-handlers-performance](img/react-handlers-performance.png)\n\nI've calculated average rendering time from 17 full page re-renders. Non of this re-renders was an initial render.\nNumbers from perfomance tab looks as follows (lower number is better).\n\n- 17 ms RegularArrow\n- 17 ms RegularSingleHandler\n- 18 ms RegularWithId\n- 20 ms PureSingleHandler\n- 21 ms PureWithId\n- 21 ms PureMethodList\n- **64 ms** RegularMethodList\n- **73 ms** PureArrow\n\nAvarage render time of each components list as a bar chart.\n\n![react-multiple-handlers](img/react-multiple-handlers.svg)\n<small><sup>Chart rendered with <a href=\"https://www.amcharts.com/\">amCharts 4</a> library</sup></small>\n\nIt is not a big suprise that **PureArrow** component was the slowest one, as for each re-render shallow equality comparison has to be executed and in each case component has to be re-rendered due to the fact that arrow function creates new handler function during rendering.\n\nSurprising is the fact that **RegularMethodList** is second slowest way of event handling. I guess that that is due to the large overhead required for new component initialization, and on each re-render new component has to be created.\n\nWhat surprises me about this test is the fact that there is no benefit from having a single handler attached to parent component as it will be beneficial in the jQuery times.\n\n## Links\n\n- https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/edit# - official Google docs about data export from DevTools Performance tab\n- https://www.amcharts.com/ - charting library used to render bar chart with rendering times\n- https://ymm959qlxv.codesandbox.io/ - Google Chrome Performance tab visualizer app (source code: https://codesandbox.io/s/ymm959qlxv)\n","excerpt":"How to bind handlers in React to multiple similar elements e.g. buttons on list?\nIs it any better to use one handler and identify clickedâ€¦","frontmatter":{"title":"React multiple event handlers performance","slug":"react-multiple-event-handlers","date":"2019-03-13T08:38:18.000Z","tags":["react","javascript","frontend"],"date_created":"2019-03-09T19:49:23.000Z","date_updated":"2019-07-13T22:58:17.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1514388479888-50b7cef280ed.jpg","relativePath":"posts/img/photo-1514388479888-50b7cef280ed.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHiyWMg/8QAFxABAQEBAAAAAAAAAAAAAAAAABIBEf/aAAgBAQABBQKEuK1euv/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABUQAQEAAAAAAAAAAAAAAAAAABAx/9oACAEBAAY/Amv/xAAZEAEBAQADAAAAAAAAAAAAAAABABEhUWH/2gAIAQEAAT8hHbnEHOz2Xxil/9oADAMBAAIAAwAAABAIP//EABcRAQEBAQAAAAAAAAAAAAAAAAEAURH/2gAIAQMBAT8QDW4bf//EABcRAQADAAAAAAAAAAAAAAAAAAABESH/2gAIAQIBAT8QuWv/xAAfEAEAAgICAgMAAAAAAAAAAAABABEhMUFRgZGh0fD/2gAIAQEAAT8QSGd4KNxK7cfvs9y1SwarJ055ti7o5XlK+OJR0DNO3uf/2Q==","aspectRatio":2,"src":"/static/aad908a40e560a85f4e88a73b25c43dc/0defe/photo-1514388479888-50b7cef280ed.jpg","srcSet":"/static/aad908a40e560a85f4e88a73b25c43dc/38b6a/photo-1514388479888-50b7cef280ed.jpg 150w,\n/static/aad908a40e560a85f4e88a73b25c43dc/e201c/photo-1514388479888-50b7cef280ed.jpg 300w,\n/static/aad908a40e560a85f4e88a73b25c43dc/0defe/photo-1514388479888-50b7cef280ed.jpg 600w,\n/static/aad908a40e560a85f4e88a73b25c43dc/a71f1/photo-1514388479888-50b7cef280ed.jpg 900w,\n/static/aad908a40e560a85f4e88a73b25c43dc/8d595/photo-1514388479888-50b7cef280ed.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"7f41791b-b92c-55b9-8630-29f818f7652e","html":"<p>There are many ways to define event handlers in React. Are there any differences between them?</p>\n<p>TLDR; You should probably avoid the inline arrow functions and handlers defined in the <code class=\"language-text\">render()</code> method.</p>\n<h2>Overview</h2>\n<p>Writing React handlers is easy, just take care of \"it\" and you're good to go.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'it works'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Click me<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Are you sure?</p>\n<h2>Example</h2>\n<p>A brief example of the various handler defining methods and their impact on the re-rendering of React.PureComponent based elements.</p>\n<iframe src=\"https://codesandbox.io/embed/wom604pn85?fontsize=14\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<br/>\n<p>NOTE: You may open console in above example to see a value of <code class=\"language-text\">this</code> for each handler.</p>\n<h2>Description</h2>\n<p>In the above example, you can see five ways to write click handlers.</p>\n<h3>Handler defined outside of a component</h3>\n<p>Easy to write, but you won't be able to access <code class=\"language-text\">this</code> from within the handler, that's why most of the time it is not so useful.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleClickOutsideClass</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h3>Handler as a class method</h3>\n<p>This is probably the most \"classic\" way of handling events in React components.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token function\">handleClickMethodBound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>In most cases, you should remember to bind handler methods in the class constructor or remember that <code class=\"language-text\">this</code> will be <code class=\"language-text\">undefined</code> inside the handler.\nHere is a binding implementation example:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClickMethodBound <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClickMethodBound</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>While it might be important for your code to bind the handler method, it's also worth knowing that binding will slow down your code, <a href=\"https://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1#e821\">a little bit, but still</a>.</p>\n<h3>Handler as a class property</h3>\n<p>The most elegant way to define event handler is through the Babel class properties.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token function-variable function\">handleClickClassProp</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>In this method you can avoid binding inside the class constructor and still keep expected <code class=\"language-text\">this</code> assignment.\nOf course you will have to use <a href=\"https://babeljs.io/docs/en/babel-plugin-proposal-class-properties\">@babel/plugin-proposal-class-properties</a> in order to make this work.\nOne more drawback of this method is a Babel transpilation result.\nClass properties are transpiled to arrow functions in the class constructor.\nIt means that you won't be able to access them from outside the class e.g. to mock/spy them in tests, or use with super in subclasses.</p>\n<h3>Handler inside render() method</h3>\n<p>In this method, a new handler function will be created on each re-render, which is probably not the desired behavior.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleClickInRender</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ... Remaining implementation</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>Handler as an inline arrow function</h3>\n<p>Arrow functions may quickly solve <code class=\"language-text\">this</code> related issues.\nThis method has similar disadvantages to the handlers defined inside <code class=\"language-text\">render()</code> method.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Click me<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>You can use the inline arrow functions to avoid binding class methods in the class constructor, but drawbacks are still the same.\nOn each render, a new handler method will be created.</p>\n<h2>Summary</h2>\n<p>As you can see it is easy to create handler function on each render, which is not necessarly something you want to do.\nIt seems that class methods with optional binding (if necessary) are still the best option to define event handlers.</p>\n<h2>Sources</h2>\n<p>Official React guide on event handling is something worth checking <a href=\"https://reactjs.org/docs/handling-events.html\">https://reactjs.org/docs/handling-events.html</a>\nDetailed analysis of class properties solution\n<a href=\"https://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1\">https://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1</a>\nComparison of transpiled class properties vs class methods\nStack Overflow question: <a href=\"https://stackoverflow.com/questions/49065425/should-class-methods-be-created-with-arrow-functions\">https://stackoverflow.com/questions/49065425/should-class-methods-be-created-with-arrow-functions</a>\nDirect Babel REPL <a href=\"https://babeljs.io/repl/#?babili=false&#x26;browsers=&#x26;build=&#x26;builtIns=false&#x26;spec=false&#x26;loose=false&#x26;code_lz=MYGwhgzhAEBiD29oFMAeAXZA7AJjASsmMOgHQDC8AtgA7xbbrQDeAUNNMPROgE4CuJeLwAUNXvBoQAlC3YdoEfjWSjxkmfI7oAFgEsIpHWFwhkAIXDQAvNF0GjJnGcthSAIz24R9zRwC-rPLGphbgIrJs8oGBrKCQMAjwAEwoGNh40ITEZJS09IxywU4uVrYRNgB8RQGs_kA&#x26;debug=false&#x26;forceAllTransforms=false&#x26;shippedProposals=false&#x26;circleciRepo=&#x26;evaluate=true&#x26;fileSize=false&#x26;timeTravel=false&#x26;sourceType=module&#x26;lineWrap=false&#x26;presets=es2015%2Creact%2Cstage-0&#x26;prettier=false&#x26;targets=&#x26;version=7.3.3\">link</a></p>","timeToRead":4,"rawMarkdownBody":"There are many ways to define event handlers in React. Are there any differences between them?\n\nTLDR; You should probably avoid the inline arrow functions and handlers defined in the `render()` method.\n\n## Overview\n\nWriting React handlers is easy, just take care of \"it\" and you're good to go.\n\n```javascript\n<button onClick={() => console.log('it works', this)}>Click me</button>\n```\n\nAre you sure?\n\n## Example\n\nA brief example of the various handler defining methods and their impact on the re-rendering of React.PureComponent based elements.\n\n<iframe src=\"https://codesandbox.io/embed/wom604pn85?fontsize=14\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<br/>\n\nNOTE: You may open console in above example to see a value of `this` for each handler.\n\n## Description\n\nIn the above example, you can see five ways to write click handlers.\n\n### Handler defined outside of a component\n\nEasy to write, but you won't be able to access `this` from within the handler, that's why most of the time it is not so useful.\n\n```javascript\nconst handleClickOutsideClass = () => {\n  console.log(\"click\", this);\n};\n```\n\n### Handler as a class method\n\nThis is probably the most \"classic\" way of handling events in React components.\n\n```javascript\n  handleClickMethodBound() {\n    console.log(\"click\", this);\n  }\n```\n\nIn most cases, you should remember to bind handler methods in the class constructor or remember that `this` will be `undefined` inside the handler.\nHere is a binding implementation example:\n\n```javascript\n  constructor(props) {\n    super(props);\n    this.handleClickMethodBound = this.handleClickMethodBound.bind(this);\n  }\n```\n\nWhile it might be important for your code to bind the handler method, it's also worth knowing that binding will slow down your code, [a little bit, but still](https://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1#e821).\n\n### Handler as a class property\n\nThe most elegant way to define event handler is through the Babel class properties.\n\n```javascript\n  handleClickClassProp = () => {\n    console.log(\"click\", this);\n  };\n```\n\nIn this method you can avoid binding inside the class constructor and still keep expected `this` assignment.\nOf course you will have to use [@babel/plugin-proposal-class-properties](https://babeljs.io/docs/en/babel-plugin-proposal-class-properties) in order to make this work.\nOne more drawback of this method is a Babel transpilation result.\nClass properties are transpiled to arrow functions in the class constructor.\nIt means that you won't be able to access them from outside the class e.g. to mock/spy them in tests, or use with super in subclasses.\n\n### Handler inside render() method\n\nIn this method, a new handler function will be created on each re-render, which is probably not the desired behavior.\n\n```javascript\n  render() {\n    const handleClickInRender = () => {\n      console.log(\"click\", this);\n    };\n    // ... Remaining implementation\n ```\n\n### Handler as an inline arrow function\n\nArrow functions may quickly solve `this` related issues.\nThis method has similar disadvantages to the handlers defined inside `render()` method.\n\n```javascript\n  return (\n    <button onClick={() => console.log('click', this)}>Click me</button>\n  );\n```\n\nYou can use the inline arrow functions to avoid binding class methods in the class constructor, but drawbacks are still the same.\nOn each render, a new handler method will be created.\n\n## Summary\n\nAs you can see it is easy to create handler function on each render, which is not necessarly something you want to do.\nIt seems that class methods with optional binding (if necessary) are still the best option to define event handlers.\n\n## Sources\n\nOfficial React guide on event handling is something worth checking https://reactjs.org/docs/handling-events.html\nDetailed analysis of class properties solution\nhttps://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1\nComparison of transpiled class properties vs class methods\nStack Overflow question: https://stackoverflow.com/questions/49065425/should-class-methods-be-created-with-arrow-functions\nDirect Babel REPL [link](https://babeljs.io/repl/#?babili=false&browsers=&build=&builtIns=false&spec=false&loose=false&code_lz=MYGwhgzhAEBiD29oFMAeAXZA7AJjASsmMOgHQDC8AtgA7xbbrQDeAUNNMPROgE4CuJeLwAUNXvBoQAlC3YdoEfjWSjxkmfI7oAFgEsIpHWFwhkAIXDQAvNF0GjJnGcthSAIz24R9zRwC-rPLGphbgIrJs8oGBrKCQMAjwAEwoGNh40ITEZJS09IxywU4uVrYRNgB8RQGs_kA&debug=false&forceAllTransforms=false&shippedProposals=false&circleciRepo=&evaluate=true&fileSize=false&timeTravel=false&sourceType=module&lineWrap=false&presets=es2015%2Creact%2Cstage-0&prettier=false&targets=&version=7.3.3)\n","excerpt":"There are many ways to define event handlers in React. Are there any differences between them? TLDR; You should probably avoid the inlineâ€¦","frontmatter":{"title":"React.PureComponent - different ways of writing event handlers","slug":"react-different-ways-of-passing-handlers-through-the-props","date":"2019-02-19T22:55:00.000Z","tags":["react","javascript","frontend"],"date_created":"2019-03-03T23:56:03.000Z","date_updated":"2019-02-24T10:36:11.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1501281668745-f7f57925c3b4.jpg","relativePath":"posts/img/photo-1501281668745-f7f57925c3b4.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAgP/2gAMAwEAAhADEAAAARaijRsOL//EABgQAQEBAQEAAAAAAAAAAAAAAAIBAwAT/9oACAEBAAEFAs8ZeOQR8zOmikLR66K9/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQACE//aAAgBAwEBPwE0F0L/xAAWEQEBAQAAAAAAAAAAAAAAAAABABL/2gAIAQIBAT8BSy3/xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhAhD/2gAIAQEABj8Cb6ciMdZGZ7//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhQf/aAAgBAQABPyEmER3dEa3gZTTuZClI6JHh5lKy7//aAAwDAQACAAMAAAAQQC//xAAXEQEAAwAAAAAAAAAAAAAAAAAAESFh/9oACAEDAQE/EIqmL//EABcRAAMBAAAAAAAAAAAAAAAAAAABMWH/2gAIAQIBAT8Qc4aH/8QAGRABAQADAQAAAAAAAAAAAAAAAREAITFB/9oACAEBAAE/EHHzENs5lhCE1jzb3jjRMdmbFqb2OTCoILYe5ZKiLO5//9k=","aspectRatio":2,"src":"/static/b8caf1eb71d198c481e25e4bcf14457d/0defe/photo-1501281668745-f7f57925c3b4.jpg","srcSet":"/static/b8caf1eb71d198c481e25e4bcf14457d/38b6a/photo-1501281668745-f7f57925c3b4.jpg 150w,\n/static/b8caf1eb71d198c481e25e4bcf14457d/e201c/photo-1501281668745-f7f57925c3b4.jpg 300w,\n/static/b8caf1eb71d198c481e25e4bcf14457d/0defe/photo-1501281668745-f7f57925c3b4.jpg 600w,\n/static/b8caf1eb71d198c481e25e4bcf14457d/a71f1/photo-1501281668745-f7f57925c3b4.jpg 900w,\n/static/b8caf1eb71d198c481e25e4bcf14457d/8d595/photo-1501281668745-f7f57925c3b4.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"aa89b796-9cc6-5097-88ec-76d1a6312fa6","html":"<p>Can I use the <code class=\"language-text\">children</code> property with React.PureComponent, or do I have to use only custom properties?</p>\n<p>TLDR; You can use <code class=\"language-text\">children</code> with React.PureComponent as long as you use your component carefully. It is much easier to make a \"mistake\" with <code class=\"language-text\">children</code>.</p>\n<h2>Overview</h2>\n<p>Pure Components were introduced to facilitate limiting the re-rendering after component properties/state update.\nThey do this by using a shallow equality comparison inside <code class=\"language-text\">shouldComponentUpdate()</code>, <a href=\"https://reactjs.org/docs/react-api.html#reactpurecomponent\">see the official React documentation</a>\nThis comparison is used for every property, including <code class=\"language-text\">children</code> property as well as component internal state.</p>\n<h2>Example</h2>\n<p>Here's an example with different implementations that use React.Component or React.PureComponent as a base class.</p>\n<iframe src=\"https://codesandbox.io/embed/r0k3oywn44?fontsize=14&view=preview\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<br/>\n<p>Components used in this example:</p>\n<ul>\n<li>PureWithChildren - React PureComponent, which uses the <code class=\"language-text\">children</code> property</li>\n<li>PureWithLabel - React PureComponent, which uses the <code class=\"language-text\">label</code> property</li>\n<li>RegularWithChildren - React Component, which uses the <code class=\"language-text\">children</code> property</li>\n<li>RegularWithLabel - React Component, which uses the <code class=\"language-text\">label</code> property</li>\n</ul>\n<p>Regular React.Component is re-rendered each time it receives new properties, even if they are equal to old.\nOn the other, hand React.PureComponent is re-rendered only if new properties are different from the old ones.</p>\n<h2>Description</h2>\n<p>The above example shows that using PureComponents is much easier when they have custom properties such as <code class=\"language-text\">label</code> instead of the generic <code class=\"language-text\">children</code> property.\nThis is especially important if we look at interpolated strings.\nFor the <code class=\"language-text\">label</code> property it works expected, but in the case of <code class=\"language-text\">children</code> additional renders may surprise the developer.\nThe reason for this behavior is that <code class=\"language-text\">children</code> are passed as an array while <code class=\"language-text\">label</code> is simply a string (interpolated but still a string).\nArrays are not shallow equal to each other and therefore <code class=\"language-text\">children</code> are always re-rendered despite the lack of changes.</p>\n<p>React.PureComponent can be used with the <code class=\"language-text\">children</code> property, but with caution (probably along with some type checking using Flow/Typescript/PropTypes).\nThe above example can be refactored to prevent problematic array values for <code class=\"language-text\">children</code> by adding:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">PureWithChildren<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  children<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>string\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Then the correct component usage would be:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>PureWithChildren<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">string </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>data<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>PureWithChildren<span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>Sources</h2>\n<p>Official documentation for React.PureComponent:\n<a href=\"https://reactjs.org/docs/react-api.html#reactpurecomponent\">https://reactjs.org/docs/react-api.html#reactpurecomponent</a></p>\n<p>Other interesting posts on this topic:\n<a href=\"https://blog.cloudboost.io/react-purecomponents-children-979e3da15ba8\">https://blog.cloudboost.io/react-purecomponents-children-979e3da15ba8</a>\n<a href=\"https://medium.com/@antonkorzunov/2-things-about-purecomponent-you-probable-should-know-b04844a90d4\">https://medium.com/@antonkorzunov/2-things-about-purecomponent-you-probable-should-know-b04844a90d4</a>\n<a href=\"https://blog.shakacode.com/react-purecomponent-pitfalls-d057882f4b6e\">https://blog.shakacode.com/react-purecomponent-pitfalls-d057882f4b6e</a></p>","timeToRead":2,"rawMarkdownBody":"Can I use the `children` property with React.PureComponent, or do I have to use only custom properties?\n\nTLDR; You can use `children` with React.PureComponent as long as you use your component carefully. It is much easier to make a \"mistake\" with `children`.\n\n## Overview\n\nPure Components were introduced to facilitate limiting the re-rendering after component properties/state update.\nThey do this by using a shallow equality comparison inside `shouldComponentUpdate()`, [see the official React documentation](https://reactjs.org/docs/react-api.html#reactpurecomponent)\nThis comparison is used for every property, including `children` property as well as component internal state.\n\n## Example\n\nHere's an example with different implementations that use React.Component or React.PureComponent as a base class.\n\n<iframe src=\"https://codesandbox.io/embed/r0k3oywn44?fontsize=14&view=preview\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n\n<br/>\n\nComponents used in this example:\n\n- PureWithChildren - React PureComponent, which uses the `children` property\n- PureWithLabel - React PureComponent, which uses the `label` property\n- RegularWithChildren - React Component, which uses the `children` property\n- RegularWithLabel - React Component, which uses the `label` property\n\nRegular React.Component is re-rendered each time it receives new properties, even if they are equal to old.\nOn the other, hand React.PureComponent is re-rendered only if new properties are different from the old ones.\n\n## Description\n\nThe above example shows that using PureComponents is much easier when they have custom properties such as `label` instead of the generic `children` property.\nThis is especially important if we look at interpolated strings.\nFor the `label` property it works expected, but in the case of `children` additional renders may surprise the developer.\nThe reason for this behavior is that `children` are passed as an array while `label` is simply a string (interpolated but still a string).\nArrays are not shallow equal to each other and therefore `children` are always re-rendered despite the lack of changes.\n\nReact.PureComponent can be used with the `children` property, but with caution (probably along with some type checking using Flow/Typescript/PropTypes).\nThe above example can be refactored to prevent problematic array values for `children` by adding:\n\n```js\nPureWithChildren.propTypes = {\n  children: PropTypes.string\n};\n```\n\nThen the correct component usage would be:\n\n```js\n<PureWithChildren>{`string ${data}`}</PureWithChildren>\n```\n\n## Sources\n\nOfficial documentation for React.PureComponent:\nhttps://reactjs.org/docs/react-api.html#reactpurecomponent\n\nOther interesting posts on this topic:\nhttps://blog.cloudboost.io/react-purecomponents-children-979e3da15ba8\nhttps://medium.com/@antonkorzunov/2-things-about-purecomponent-you-probable-should-know-b04844a90d4\nhttps://blog.shakacode.com/react-purecomponent-pitfalls-d057882f4b6e\n","excerpt":"Can I use the  property with React.PureComponent, or do I have to use only custom properties? TLDR; You can use  with React.PureComponent asâ€¦","frontmatter":{"title":"React.PureComponent - children vs custom properties","slug":"react-purecomponent-children-vs-custom-properties","date":"2019-02-16T16:00:00.000Z","tags":["react","javascript","frontend"],"date_created":"2019-02-27T14:11:00.000Z","date_updated":"2019-02-23T13:04:06.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1503847752244-32e931070a43.jpg","relativePath":"posts/img/photo-1503847752244-32e931070a43.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQID/9oADAMBAAIQAxAAAAGi3NgaOEDj/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxEQEv/aAAgBAQABBQJa9hrCguJ7abvP/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEB/9oACAEDAQE/Abiv/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEB/9oACAECAQE/Abqv/8QAGBAAAgMAAAAAAAAAAAAAAAAAADEBECH/2gAIAQEABj8CNkQ7/8QAGxAAAwACAwAAAAAAAAAAAAAAAAERECExQWH/2gAIAQEAAT8h7BYISlpTpj2Dbk28f//aAAwDAQACAAMAAAAQKw//xAAXEQADAQAAAAAAAAAAAAAAAAAAARFB/9oACAEDAQE/EHmij//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EBT/xAAcEAEAAgMAAwAAAAAAAAAAAAABESEAMVEQYXH/2gAIAQEAAT8QdFQ1eNSF8Ph11XvNlTrWRiBSzTkVWdZ8f//Z","aspectRatio":2,"src":"/static/b1dc252aafcc5edeb969febda63fd7b3/0defe/photo-1503847752244-32e931070a43.jpg","srcSet":"/static/b1dc252aafcc5edeb969febda63fd7b3/38b6a/photo-1503847752244-32e931070a43.jpg 150w,\n/static/b1dc252aafcc5edeb969febda63fd7b3/e201c/photo-1503847752244-32e931070a43.jpg 300w,\n/static/b1dc252aafcc5edeb969febda63fd7b3/0defe/photo-1503847752244-32e931070a43.jpg 600w,\n/static/b1dc252aafcc5edeb969febda63fd7b3/a71f1/photo-1503847752244-32e931070a43.jpg 900w,\n/static/b1dc252aafcc5edeb969febda63fd7b3/8d595/photo-1503847752244-32e931070a43.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"dbec8e89-2961-5b54-9686-d63c2dccf023","html":"<p>You want to check how (or if) your application works with SSL encryption without exposing it to the Internet? Use a self-signed SSL certificate with the Traefik proxy server inside the intranet (or other LAN with restricted access).</p>\n<p><strong>TLDR;</strong> Clone this repo and adjust content of <strong>traefik.toml</strong> file <a href=\"https://github.com/jmarceli/traefik-self-signed-ssl-proxy\">https://github.com/jmarceli/traefik-self-signed-ssl-proxy</a></p>\n<h2>Start</h2>\n<p><a href=\"https://docs.traefik.io/\">Traefik</a> is becoming more and more popular thanks to its configuration simplicity and rich features available out of the box. Here is how it can be used to ensure self-signed SSL certificate for selected application server.</p>\n<h3>Overview</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 751px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.05326231691078%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACKUlEQVQoz4WSaU8aURSG/fFNmvSzTZqYJq02cYnthyogRoNWizALi6AWFxRmZVERGZRtnp5hEGnSph/enDt37n3Oe+45c5ABtKl8/yXqDEcZRn6GeiNBo5mgP1BlT2cw1Mcx+PcqXe7kmAtB6li+HypYX93eUnR7nNWfOL8bcHE/RLtusK0USOQvyZptirVnCu7TWHmnR8OrzAJDdyFQkwNdYhcQPR+ycfrM5ll/HDd+Ddi+8FFMplJFR1Ww2u7fgOG3YnksKLD4s8f7aI35qMuH7SZLKfiSkxOWjzajtAF22/63w2SlxUYajk9GHOr37KcbJHNtsgVxnPVJmSFINWeBDnMvkBd3/gT+9SDLcvyO7MMdm4ZG9CZLxNBRbxsC5H/AGQWOJcHWcYW1hEfWfWDPuiZxUx5HzWrxfQLUJ+Xqs8Cw3NRE6WnJiiONkGXy2iZ2VWTr/JTYZZHDsjN1GDQjJaAAlqxOgN1+EbdjUvNMafvNeJ6CJEdGh015w0y9zlYlR7ycJ17Nodg1ItIUxYb1os+CNuKjNuCzJDEeBOg+muxfQaLURTUG9IbHAlQ4Mjusien9yxaRkkmsZMsImeyWWnwTYDzv8HZV503E5t1Ok/lk/xX4Q4B7pac/gKr1zFIeVuXyWv5Vy+Jk/QR2Th75dFBnMeOzUoSVQuBQ5tDrn8pA2jiPDrVOdVpy0yvjjPdNkTGJoQITbseh3nVlbeG2TXk/C69f4jcQOWhaTI9rdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Traefik-SSL-proxy\"\n        title=\"Traefik-SSL-proxy\"\n        src=\"/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png\"\n        srcset=\"/static/75e4f14247faf096e98b3044469792ad/a1986/traefik-ssl-proxy.png 210w,\n/static/75e4f14247faf096e98b3044469792ad/ad7fb/traefik-ssl-proxy.png 420w,\n/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png 751w\"\n        sizes=\"(max-width: 751px) 100vw, 751px\"\n      />\n  </a>\n    </span></p>\n<p>Things to check before starting:</p>\n<ul>\n<li><strong>Your device</strong> - should have access to <strong>Development server</strong> using a custom domain name e.g. <strong>my.test</strong>, you can set it using the <strong>/etc/hosts</strong> file (on Unix systems), <strong>dnsmasq</strong> or directly in the network router, if you have access to its configuration (if you can't do that please read <a href=\"#tips\">#Tips</a> section to adjust your <strong>traefik.toml</strong> TLS configuration)</li>\n<li><strong>Development server</strong> - if necessary, adjust system firewall configuration and open the required ports (ports <strong>4000</strong> and <strong>8080</strong> should be available for Intranet/LAN connections)</li>\n<li><strong>Application server</strong> - make sure it works and is available from <strong>Development server</strong> on port <strong>5000</strong></li>\n</ul>\n<p>Request to <strong>my.test:4000</strong> made from <strong>Your device</strong> is supposed to go through the following path:</p>\n<ul>\n<li>access <strong>Development server</strong> (via some domain resolution mechanism e.g. <strong>/etc/hosts</strong> on <strong>Your device</strong>)</li>\n<li>go through opened <strong>4000</strong> port</li>\n<li><strong>Traefik</strong> Docker container should handle that request thanks to the exposed <strong>4000</strong> port</li>\n<li>Traefik <strong>httpSSL</strong> entryPoint should be set to <strong>4000</strong> port and handle the request</li>\n<li>Traefik <strong>frontend1</strong> should \"redirect\" request to <strong>backend1</strong></li>\n<li>Traefik <strong>backend1</strong> should respond with a content from <strong>Application server</strong></li>\n</ul>\n<h3>File structure</h3>\n<p>Here is the final files structure you should generate by following the next steps.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">./\n./certs/cert.crt\n./crets/cert.key\n./traefik.toml\n./docker-compose.yml</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>Self-signed certificate files</h3>\n<p>You will need a <strong>.key</strong> and <strong>.crt</strong> files. They can be generated for self-signed certificates using the <code class=\"language-text\">openssl</code>. If you don't have it already, please check on Google (<code class=\"language-text\">brew install openssl</code> for Mac OS X with Homebrew packages manager). With the <code class=\"language-text\">openssl</code> ready to use execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">openssl req -x509 -nodes -days <span class=\"token number\">365</span> -newkey rsa:2048 -keyout cert.key -out cert.crt</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>The only important question while running the <code class=\"language-text\">openssl</code> command is <strong>Common Name (e.g. server FQDN or YOUR name):</strong>. It should match the domain name of your server e.g. <code class=\"language-text\">*.test</code> or <code class=\"language-text\">my.test</code> (or any other that you can point to your server), wildcards (<code class=\"language-text\">*</code>) are allowed.</p>\n<p>After preparing the certificate files, you must change their access rights.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">chmod</span> <span class=\"token number\">644</span> cert.crt\n<span class=\"token function\">chmod</span> <span class=\"token number\">600</span> cert.key</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>It's done, now you may proceed to the next step.</p>\n<h3>Traefik configuration traefik.toml</h3>\n<p>Most Traefik configurations will be placed inside the <strong>traefik.toml</strong> file. Here is the final result.</p>\n<div class=\"gatsby-highlight\" data-language=\"toml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-toml line-numbers\"><code class=\"language-toml\"><span class=\"token key property\">debug</span> <span class=\"token punctuation\">=</span> <span class=\"token boolean\">true</span>\n<span class=\"token key property\">logLevel</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"DEBUG\"</span>\n<span class=\"token key property\">defaultEntryPoints</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"httpSSL\"</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">web</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">address</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\":8080\"</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.httpSSL</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">address</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\":4000\"</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.httpSSL.tls</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">file</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">backends</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">backends.backend1</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">backends.backend1.servers</span><span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">[</span><span class=\"token table class-name\">backends.backend1.servers.server0</span><span class=\"token punctuation\">]</span>\n        <span class=\"token key property\">url</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"http://192.168.0.16:5000\"</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">frontends</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">frontends.frontend1</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">entryPoints</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"httpSSL\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">backend</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"backend1\"</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token table class-name\">tls</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">entryPoints</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"httpSSL\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">tls.certificate</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key property\">certFile</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"/certs/cert.crt\"</span>\n    <span class=\"token key property\">keyFile</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"/certs/cert.key\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Useful information:</p>\n<ul>\n<li><strong>debug</strong> and <strong>logLevel</strong> - It should be self-explanatory</li>\n<li><strong>defaultEntryPoints</strong> - Specifies that by default Traefik server will expose extrypoint named <strong>httpSSL</strong> (it can be <strong>any</strong> string, just be consistent if you want to change it)</li>\n<li><strong>[web]</strong> - This section might be omitted, it will provide administrative/diagnostic panel on the selected <strong>8080</strong> port</li>\n<li><strong>[entryPoints]</strong> - Defines default entrypoint <strong>httpSSL</strong> and assings port <strong>4000</strong> to it. It also ensures <strong>tls</strong> encryption (<a href=\"https://tools.ietf.org/html/rfc7568\">TLS is \"safer\" SSL</a>)</li>\n<li><strong>[file]</strong> - This one is tricky, because it does not look as important as it is, thanks to that section Traefik uses <strong>traefik.toml</strong> <a href=\"https://docs.traefik.io/v1.5/configuration/backends/file/\">file as a backend definitions provider</a></li>\n<li><strong>[backends]</strong> - All available backends names (which is only one <strong>backend1</strong> in this example) with <strong><a href=\"http://192.168.0.16:5000\">http://192.168.0.16:5000</a></strong> as a proxy target (<strong><a href=\"http://192.168.0.16:5000\">http://192.168.0.16:5000</a></strong> is an IP address of a running Application server)</li>\n<li><strong>[frontends]</strong> - Frontends configuration, where <strong>frontend1</strong> is the name (which can be changed at any time), <strong>entryPoints</strong> and <strong>backend</strong> keys link entry point with a backend for given frontend, <strong>rule</strong> tells Traefik which domains it should handle with that frontend</li>\n<li><strong>[[tls]]</strong> - Assign generated cert and key files to the selected <strong>entryPoint</strong> (which is <strong>httpSSL</strong> in this case)</li>\n</ul>\n<h3>It's Docker time</h3>\n<p>With <strong>traefik.toml</strong> in place it's time to go to the Docker configuration. The simplest (at least for me) solution is to write the <strong>docker-compose.yml</strong> file. Here's how it can look.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3'</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">traefik</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> traefik<span class=\"token punctuation\">:</span>1.7.0\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> public\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> 4000<span class=\"token punctuation\">:</span><span class=\"token number\">4000</span>\n      <span class=\"token punctuation\">-</span> 8080<span class=\"token punctuation\">:</span><span class=\"token number\">8080</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./traefik.toml<span class=\"token punctuation\">:</span>/traefik.toml\n      <span class=\"token punctuation\">-</span> ./certs/<span class=\"token punctuation\">:</span>/certs/\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock\n\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">public</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> bridge</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Let's start from the beginning:</p>\n<ul>\n<li><strong>version</strong> - Specifies the syntax of the Docker configuration used</li>\n<li><strong>services</strong> - A list of Docker containers to create</li>\n<li><strong>traefik</strong> - The only service to create</li>\n<li><strong>image</strong> - Image for <strong>traefik</strong> service creation (<strong>1.7.0</strong> is the current stable version at the time of writing)</li>\n<li><strong>network</strong> - The name of the network which will be used does not matter, as long as it uses the <strong>bridge</strong> driver defined at the end of configuration in <strong>networks</strong> section</li>\n<li><strong>ports</strong> - Exposes <strong>4000</strong> port which will be proxied with SSL and <strong>8080</strong> for debugging and diagnostic</li>\n<li><strong>volumes</strong> - Files and folders mounted to the created container, you should be familiar with all of them except <strong>/var/run/docker.sock</strong> which allows <strong>traefik</strong> container to <a href=\"https://stackoverflow.com/questions/35110146/can-anyone-explain-docker-sock/35110344\">use Docker API</a></li>\n</ul>\n<h3>Show time</h3>\n<p>When everything is in place, it's easy to shine :)\nExecute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">docker-compose up</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Visit <a href=\"http://192.168.0.16:8080\">http://192.168.0.16:8080</a> to check the configuration. Here is how it may look like.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 751px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.05326231691078%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACKUlEQVQoz4WSaU8aURSG/fFNmvSzTZqYJq02cYnthyogRoNWizALi6AWFxRmZVERGZRtnp5hEGnSph/enDt37n3Oe+45c5ABtKl8/yXqDEcZRn6GeiNBo5mgP1BlT2cw1Mcx+PcqXe7kmAtB6li+HypYX93eUnR7nNWfOL8bcHE/RLtusK0USOQvyZptirVnCu7TWHmnR8OrzAJDdyFQkwNdYhcQPR+ycfrM5ll/HDd+Ddi+8FFMplJFR1Ww2u7fgOG3YnksKLD4s8f7aI35qMuH7SZLKfiSkxOWjzajtAF22/63w2SlxUYajk9GHOr37KcbJHNtsgVxnPVJmSFINWeBDnMvkBd3/gT+9SDLcvyO7MMdm4ZG9CZLxNBRbxsC5H/AGQWOJcHWcYW1hEfWfWDPuiZxUx5HzWrxfQLUJ+Xqs8Cw3NRE6WnJiiONkGXy2iZ2VWTr/JTYZZHDsjN1GDQjJaAAlqxOgN1+EbdjUvNMafvNeJ6CJEdGh015w0y9zlYlR7ycJ17Nodg1ItIUxYb1os+CNuKjNuCzJDEeBOg+muxfQaLURTUG9IbHAlQ4Mjusien9yxaRkkmsZMsImeyWWnwTYDzv8HZV503E5t1Ok/lk/xX4Q4B7pac/gKr1zFIeVuXyWv5Vy+Jk/QR2Th75dFBnMeOzUoSVQuBQ5tDrn8pA2jiPDrVOdVpy0yvjjPdNkTGJoQITbseh3nVlbeG2TXk/C69f4jcQOWhaTI9rdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"traefik-ssl-proxy\"\n        title=\"traefik-ssl-proxy\"\n        src=\"/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png\"\n        srcset=\"/static/75e4f14247faf096e98b3044469792ad/a1986/traefik-ssl-proxy.png 210w,\n/static/75e4f14247faf096e98b3044469792ad/ad7fb/traefik-ssl-proxy.png 420w,\n/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png 751w\"\n        sizes=\"(max-width: 751px) 100vw, 751px\"\n      />\n  </a>\n    </span></p>\n<p>Then open <a href=\"https://my.test:4000\">https://my.test:4000</a> to admire the results of your hard work.</p>\n<p>You can verify if certificate works by clicking on \"Not Secure\" info in Google Chrome address bar. Details should match those provided during cert generation.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 468px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/17ae3e393b262eea69a3cee49459ab0d/3f263/self-signed-my-test-certificate.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.2905982905983%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAACs0lEQVQ4y61US4vTUBTuLxZduNONbgZ0IwjiLARx5QNkdNRZDDMrFQTn0Xb6SpsmaZomuXk2bd7t57m3dqad1oEBL3yccJJ85zuvW3l9UMXzAxXPvql4sq/cGk+/KNj5rODloQZlYKDyau8MO18ZHu07uPvexr3b4oONO+9sPNwz0ZBUVPCfTprlqLV6qGjWGJoVQjEJo4CsT9aHPHQhG66wXZ1dPq/Zv1BGHtqqjfNGG5XYPYFnniHx6wgcA/2+Atu2bq1wGseockIm/YSuqmCDYxhKE622hF5PhtzvE7kKWVbAmIMoihCEIcbjMXzfRxCECMMxkiRZJ3S6v2BKP6DX34ANB+h1ZWgUoCt1ocp9qKTYYQwRkQVENA45obcgJKwRNjuozOZAHCcoZuSlDwtdQ2noKJmFUutjNhoCngs49gL/TDlZEOZ5huFwCNMcIU0zFGUpsDw8zmw+v8JstoErhdL62KRpCs/z4DiUItUqTZMNJXMivY4NQu7jZK7rUodtMILjOFCplryePEhJqvOiuCRYDXCV8orCosgxMgwYBMs0icRHp9MRYzTQNFiWKYJleb6hdCshVxhSmpNoIkaEN8qyLGRZduP8bSVcOnOKHlMtOJbFFo0RxS+3NuSfTSmoPnym+MyZlDKvp+M6SMm3Sr6tMVubkmWpIDIpTd4U1/VoS/qQJAm6rosNCWm4eeCtNZxeU1jSh4zU8cK7NDacQO71xNqFQUCbEQjfdbXLEyfZgjDgq0Qr5JAim7nCModbnxRb8IgooujRZCoQhBF88c8YcRQgm/jIphTMZwvCk2oDCzRxWmvipLZi6y2yDfzm74WvtfDV26g1mnj7nW76QxMvjkzsHg9x2iDC84s2bgTdINVGR+wpV8BxTj+2aEZ3jwzc/+jjwScfj/cZTi8k/AGyadN+97XliAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"self-signed-my-test-certificate\"\n        title=\"self-signed-my-test-certificate\"\n        src=\"/static/17ae3e393b262eea69a3cee49459ab0d/3f263/self-signed-my-test-certificate.png\"\n        srcset=\"/static/17ae3e393b262eea69a3cee49459ab0d/a1986/self-signed-my-test-certificate.png 210w,\n/static/17ae3e393b262eea69a3cee49459ab0d/ad7fb/self-signed-my-test-certificate.png 420w,\n/static/17ae3e393b262eea69a3cee49459ab0d/3f263/self-signed-my-test-certificate.png 468w\"\n        sizes=\"(max-width: 468px) 100vw, 468px\"\n      />\n  </a>\n    </span></p>\n<h2>Tips</h2>\n<h3>You can't set a custom domain name for your development server and you need to use it's IP address</h3>\n<p>Use following <strong>entryPoints</strong> configuration:</p>\n<div class=\"gatsby-highlight\" data-language=\"toml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-toml line-numbers\"><code class=\"language-toml\"><span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.httpSSL</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">address</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\":4000\"</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.httpSSL.tls</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.httpSSL.tls.defaultCertificate</span><span class=\"token punctuation\">]</span>\n      <span class=\"token key property\">certFile</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"/certs/cert.crt\"</span>\n      <span class=\"token key property\">keyFile</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"/certs/cert.key\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Thanks to that step you will use your own certificate (generated in <a href=\"#self-signed-certificate-files\">#Self-signed certificate files</a> step) as a default one.</p>\n<h3>Application server address 192.168.0.16</h3>\n<p>It doesn't have to be your Development server IP visible on LAN. It can be also an internal IP visible from Docker which is usally something like <strong>172.17.0.1</strong>. You should be able to check that using <strong>ifconfig</strong> (look for <strong>docker0</strong> interface), in case you are using <strong>Docker for Mac</strong> you may also use <strong>host.docker.internal</strong> <a href=\"https://docs.docker.com/docker-for-mac/networking/#use-cases-and-workarounds\">see the docs</a>.</p>\n<h2>Troubleshooting</h2>\n<p>Check the output after executing the <code class=\"language-text\">docker-compose up</code> command.</p>\n<p>If you want to restart the created container with the new/changed configuration inside <strong>traefik.toml</strong> file, press <code class=\"language-text\">Ctrl-c</code>, and then execute <code class=\"language-text\">docker-compose down &amp;&amp; docker-compose up</code> to make sure that old container has been properly destroyed.</p>\n<p><code class=\"language-text\">502 Bad gateway</code> instead of your requested/proxied content probably means that you have made a simple error in the <strong>traefik.toml</strong> configuration. Watch out for typos and renaming (if you choose to change some names).</p>\n<p>Start with minimal modifications. Just copy and paste the example content to files and adjust only the URLs. Start it. You will be renaming everything (frontends, backends, entryPoints, containers, networks etc.) later, after the first successful start.</p>\n<p>Some explanations regarding the Traefik log messages:</p>\n<ul>\n<li><code class=\"language-text\">Serving default cert for request: ...</code> - you probably give an incorrect FQDN when generating a self-signed certificate using <code class=\"language-text\">openssl</code></li>\n<li><code class=\"language-text\">Error loading new configuration, aborted unable to generate TLS certificate : tls: failed to find any PEM data in certificate input</code> - check the path to your certificate files specified in the <strong>traefik.toml</strong> file, it is probably icorrect</li>\n</ul>\n<p>Be patient and read this guide again... (if necessary)</p>\n<h2>Why</h2>\n<p>Because I did not find such an example when I needed it.</p>\n<p>After some adjustment, you can use this configuration in production with Let's Encrypt SSL certificate instead of self-signed. I'm going to write something about it later and link it here.</p>\n<h2>Sources</h2>\n<p><a href=\"https://tools.ietf.org/html/rfc7568\">https://tools.ietf.org/html/rfc7568</a> - SSLv3 deprecation in favour of TLS 1.2\n<a href=\"https://stackoverflow.com/questions/35110146/can-anyone-explain-docker-sock/35110344\">https://stackoverflow.com/questions/35110146/can-anyone-explain-docker-sock/35110344</a> - info about docker.sock\n<a href=\"https://hub.docker.com/_/traefik/\">https://hub.docker.com/_/traefik/</a> - Traefik Docker image\n<a href=\"https://docs.traefik.io/\">https://docs.traefik.io/</a> - Traefik Documenation, which should be the most up-to-date source of knowledge\n<a href=\"https://docs.docker.com/docker-for-mac/networking/#use-cases-and-workarounds\">https://docs.docker.com/docker-for-mac/networking/#use-cases-and-workarounds</a> - Docker docs</p>","timeToRead":8,"rawMarkdownBody":"You want to check how (or if) your application works with SSL encryption without exposing it to the Internet? Use a self-signed SSL certificate with the Traefik proxy server inside the intranet (or other LAN with restricted access).\n\n**TLDR;** Clone this repo and adjust content of **traefik.toml** file https://github.com/jmarceli/traefik-self-signed-ssl-proxy\n\n## Start\n\n[Traefik](https://docs.traefik.io/) is becoming more and more popular thanks to its configuration simplicity and rich features available out of the box. Here is how it can be used to ensure self-signed SSL certificate for selected application server.\n\n### Overview\n\n![Traefik-SSL-proxy](img/traefik-ssl-proxy.png)\n\nThings to check before starting:\n\n- **Your device** - should have access to **Development server** using a custom domain name e.g. **my.test**, you can set it using the **/etc/hosts** file (on Unix systems), **dnsmasq** or directly in the network router, if you have access to its configuration (if you can't do that please read [#Tips](#tips) section to adjust your **traefik.toml** TLS configuration)\n- **Development server** - if necessary, adjust system firewall configuration and open the required ports (ports **4000** and **8080** should be available for Intranet/LAN connections)\n- **Application server** - make sure it works and is available from **Development server** on port **5000**\n\nRequest to **my.test:4000** made from **Your device** is supposed to go through the following path:\n\n- access **Development server** (via some domain resolution mechanism e.g. **/etc/hosts** on **Your device**)\n- go through opened **4000** port\n- **Traefik** Docker container should handle that request thanks to the exposed **4000** port\n- Traefik **httpSSL** entryPoint should be set to **4000** port and handle the request\n- Traefik **frontend1** should \"redirect\" request to **backend1**\n- Traefik **backend1** should respond with a content from **Application server**\n\n### File structure\n\nHere is the final files structure you should generate by following the next steps.\n\n```bash\n./\n./certs/cert.crt\n./crets/cert.key\n./traefik.toml\n./docker-compose.yml\n```\n\n### Self-signed certificate files\n\nYou will need a **.key** and **.crt** files. They can be generated for self-signed certificates using the `openssl`. If you don't have it already, please check on Google (`brew install openssl` for Mac OS X with Homebrew packages manager). With the `openssl` ready to use execute:\n\n```bash\nopenssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout cert.key -out cert.crt\n```\n\nThe only important question while running the `openssl` command is **Common Name (e.g. server FQDN or YOUR name):**. It should match the domain name of your server e.g. `*.test` or `my.test` (or any other that you can point to your server), wildcards (`*`) are allowed.\n\nAfter preparing the certificate files, you must change their access rights.\n\n```bash\nchmod 644 cert.crt\nchmod 600 cert.key\n```\n\nIt's done, now you may proceed to the next step.\n\n### Traefik configuration traefik.toml\n\nMost Traefik configurations will be placed inside the **traefik.toml** file. Here is the final result.\n\n```toml\ndebug = true\nlogLevel = \"DEBUG\"\ndefaultEntryPoints = [\"httpSSL\"]\n\n[web]\naddress = \":8080\"\n\n[entryPoints]\n  [entryPoints.httpSSL]\n  address = \":4000\"\n    [entryPoints.httpSSL.tls]\n\n[file]\n\n[backends]\n  [backends.backend1]\n    [backends.backend1.servers]\n      [backends.backend1.servers.server0]\n        url = \"http://192.168.0.16:5000\"\n\n[frontends]\n  [frontends.frontend1]\n  entryPoints = [\"httpSSL\"]\n  backend = \"backend1\"\n\n[[tls]]\n  entryPoints = [\"httpSSL\"]\n  [tls.certificate]\n    certFile = \"/certs/cert.crt\"\n    keyFile = \"/certs/cert.key\"\n```\n\nUseful information:\n\n- **debug** and **logLevel** - It should be self-explanatory\n- **defaultEntryPoints** - Specifies that by default Traefik server will expose extrypoint named **httpSSL** (it can be **any** string, just be consistent if you want to change it)\n- **[web]** - This section might be omitted, it will provide administrative/diagnostic panel on the selected **8080** port\n- **[entryPoints]** - Defines default entrypoint **httpSSL** and assings port **4000** to it. It also ensures **tls** encryption ([TLS is \"safer\" SSL](https://tools.ietf.org/html/rfc7568))\n- **[file]** - This one is tricky, because it does not look as important as it is, thanks to that section Traefik uses **traefik.toml** [file as a backend definitions provider](https://docs.traefik.io/v1.5/configuration/backends/file/)\n- **[backends]** - All available backends names (which is only one **backend1** in this example) with **http://192.168.0.16:5000** as a proxy target (**http://192.168.0.16:5000** is an IP address of a running Application server)\n- **[frontends]** - Frontends configuration, where **frontend1** is the name (which can be changed at any time), **entryPoints** and **backend** keys link entry point with a backend for given frontend, **rule** tells Traefik which domains it should handle with that frontend\n- **[[tls]]** - Assign generated cert and key files to the selected **entryPoint** (which is **httpSSL** in this case)\n\n### It's Docker time\n\nWith **traefik.toml** in place it's time to go to the Docker configuration. The simplest (at least for me) solution is to write the **docker-compose.yml** file. Here's how it can look.\n\n```yaml\nversion: '3'\n\nservices:\n  traefik:\n    image: traefik:1.7.0\n    networks:\n      - public\n    ports:\n      - 4000:4000\n      - 8080:8080\n    volumes:\n      - ./traefik.toml:/traefik.toml\n      - ./certs/:/certs/\n      - /var/run/docker.sock:/var/run/docker.sock\n\nnetworks:\n  public:\n    driver: bridge\n```\n\nLet's start from the beginning:\n\n- **version** - Specifies the syntax of the Docker configuration used\n- **services** - A list of Docker containers to create\n- **traefik** - The only service to create\n- **image** - Image for **traefik** service creation (**1.7.0** is the current stable version at the time of writing)\n- **network** - The name of the network which will be used does not matter, as long as it uses the **bridge** driver defined at the end of configuration in **networks** section\n- **ports** - Exposes **4000** port which will be proxied with SSL and **8080** for debugging and diagnostic\n- **volumes** - Files and folders mounted to the created container, you should be familiar with all of them except **/var/run/docker.sock** which allows **traefik** container to [use Docker API](https://stackoverflow.com/questions/35110146/can-anyone-explain-docker-sock/35110344)\n\n### Show time\n\nWhen everything is in place, it's easy to shine :)\nExecute:\n\n```bash\ndocker-compose up\n```\n\nVisit http://192.168.0.16:8080 to check the configuration. Here is how it may look like.\n\n![traefik-ssl-proxy](img/traefik-ssl-proxy.png)\n\nThen open https://my.test:4000 to admire the results of your hard work.\n\nYou can verify if certificate works by clicking on \"Not Secure\" info in Google Chrome address bar. Details should match those provided during cert generation.\n\n![self-signed-my-test-certificate](img/self-signed-my-test-certificate.png)\n\n## Tips\n\n### You can't set a custom domain name for your development server and you need to use it's IP address\n\nUse following **entryPoints** configuration:\n\n```toml\n[entryPoints]\n  [entryPoints.httpSSL]\n  address = \":4000\"\n    [entryPoints.httpSSL.tls]\n    [entryPoints.httpSSL.tls.defaultCertificate]\n      certFile = \"/certs/cert.crt\"\n      keyFile = \"/certs/cert.key\"\n```\n\nThanks to that step you will use your own certificate (generated in [#Self-signed certificate files](#self-signed-certificate-files) step) as a default one.\n\n### Application server address 192.168.0.16\n\nIt doesn't have to be your Development server IP visible on LAN. It can be also an internal IP visible from Docker which is usally something like **172.17.0.1**. You should be able to check that using **ifconfig** (look for **docker0** interface), in case you are using **Docker for Mac** you may also use **host.docker.internal** [see the docs](https://docs.docker.com/docker-for-mac/networking/#use-cases-and-workarounds).\n\n## Troubleshooting\n\nCheck the output after executing the `docker-compose up` command.\n\nIf you want to restart the created container with the new/changed configuration inside **traefik.toml** file, press `Ctrl-c`, and then execute `docker-compose down && docker-compose up` to make sure that old container has been properly destroyed.\n\n`502 Bad gateway` instead of your requested/proxied content probably means that you have made a simple error in the **traefik.toml** configuration. Watch out for typos and renaming (if you choose to change some names).\n\nStart with minimal modifications. Just copy and paste the example content to files and adjust only the URLs. Start it. You will be renaming everything (frontends, backends, entryPoints, containers, networks etc.) later, after the first successful start.\n\nSome explanations regarding the Traefik log messages:\n\n- `Serving default cert for request: ...` - you probably give an incorrect FQDN when generating a self-signed certificate using `openssl`\n- `Error loading new configuration, aborted unable to generate TLS certificate : tls: failed to find any PEM data in certificate input` - check the path to your certificate files specified in the **traefik.toml** file, it is probably icorrect\n\nBe patient and read this guide again... (if necessary)\n\n## Why\n\nBecause I did not find such an example when I needed it.\n\nAfter some adjustment, you can use this configuration in production with Let's Encrypt SSL certificate instead of self-signed. I'm going to write something about it later and link it here.\n\n## Sources\nhttps://tools.ietf.org/html/rfc7568 - SSLv3 deprecation in favour of TLS 1.2\nhttps://stackoverflow.com/questions/35110146/can-anyone-explain-docker-sock/35110344 - info about docker.sock\nhttps://hub.docker.com/_/traefik/ - Traefik Docker image\nhttps://docs.traefik.io/ - Traefik Documenation, which should be the most up-to-date source of knowledge\nhttps://docs.docker.com/docker-for-mac/networking/#use-cases-and-workarounds - Docker docs\n","excerpt":"You want to check how (or if) your application works with SSL encryption without exposing it to the Internet? Use a self-signed SSLâ€¦","frontmatter":{"title":"Traefik - proxy development server with self-signed SSL certificate","slug":"traefik-proxy-development-server-self-signed-ssl","date":"2018-11-07T05:25:00.000Z","tags":["backend","tools"],"date_created":"2018-11-29T04:08:02.000Z","date_updated":"2018-11-08T00:16:57.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1512168203104-3910bc2bcd54.jpg","relativePath":"posts/img/photo-1512168203104-3910bc2bcd54.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAeABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAECAwQF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAe0nkjUMDNfAtIB//8QAGRAAAwEBAQAAAAAAAAAAAAAAAAECEBEx/9oACAEBAAEFAtfkNuhkzyh7/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFxAAAwEAAAAAAAAAAAAAAAAAAREgMP/aAAgBAQAGPwKA8P/EABoQAAIDAQEAAAAAAAAAAAAAAAARARBBITH/2gAIAQEAAT8hm/YxonXgndldR0S0cn//2gAMAwEAAgADAAAAEL//AMP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAbEAADAQADAQAAAAAAAAAAAAAAARExECFRQf/aAAgBAQABPxCh3wQuWkmR4R7843S0Q/CbnCqXZDZumQoaf//Z","aspectRatio":2,"src":"/static/d82df298cb57c0123e8c64bd116c3d65/0defe/photo-1512168203104-3910bc2bcd54.jpg","srcSet":"/static/d82df298cb57c0123e8c64bd116c3d65/38b6a/photo-1512168203104-3910bc2bcd54.jpg 150w,\n/static/d82df298cb57c0123e8c64bd116c3d65/e201c/photo-1512168203104-3910bc2bcd54.jpg 300w,\n/static/d82df298cb57c0123e8c64bd116c3d65/0defe/photo-1512168203104-3910bc2bcd54.jpg 600w,\n/static/d82df298cb57c0123e8c64bd116c3d65/a71f1/photo-1512168203104-3910bc2bcd54.jpg 900w,\n/static/d82df298cb57c0123e8c64bd116c3d65/8d595/photo-1512168203104-3910bc2bcd54.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"8c556f1a-071e-532b-947d-ce837a0546ea","html":"<p>Although there is much useful information on the official BrowserStack website, you will certainly have a lot of questions when you run tests for the first time. I will try to explain how to deal with it based on a simple example which uses Jest and Selenium.</p>\n<p><strong>There is no problem in running <a href=\"https://jestjs.io\">Jest</a> with BrowserStack, despite the lack of documentation or examples.</strong></p>\n<p>TLDR; Check the <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example\">example repository</a> it should be self-explanatory.</p>\n<h2>Starting point</h2>\n<p>I have Selenium-based tests that I can run locally. How do I load BrowserStack and run tests against their browsers?</p>\n<p>It seems that it is quite simple and typical task.</p>\n<p>Here is an example of a basic Selenium test powered by Jest. It will be used to show how to integrate existing code with <a href=\"https://www.browserstack.com/docs?product=automate\">BrowserStack Automate</a> testing service.</p>\n<p><strong>test/local.test.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Builder<span class=\"token punctuation\">,</span> By<span class=\"token punctuation\">,</span> until <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'selenium-webdriver'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> firefox <span class=\"token keyword\">from</span> <span class=\"token string\">'selenium-webdriver/firefox'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> path <span class=\"token keyword\">from</span> <span class=\"token string\">'path'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getElementById</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">driver<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> timeout <span class=\"token operator\">=</span> <span class=\"token number\">2000</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> el <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span>until<span class=\"token punctuation\">.</span><span class=\"token function\">elementLocated</span><span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> timeout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span>until<span class=\"token punctuation\">.</span><span class=\"token function\">elementIsVisible</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> timeout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webdriver'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> driver<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> options <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">firefox<span class=\"token punctuation\">.</span>Options</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    options<span class=\"token punctuation\">.</span><span class=\"token function\">headless</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    driver <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">forBrowser</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firefox'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">setFirefoxOptions</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// eslint-disable-next-line no-undef</span>\n    <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'file://'</span> <span class=\"token operator\">+</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'test.html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">quit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> btn <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> <span class=\"token string\">'test-button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> btn<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> <span class=\"token string\">'output'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> outputVal <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> output<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>outputVal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Something'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>As you can see, this is a simple example in which after clicking on <strong>#myBtn</strong> we expect to have <strong>Something</strong> as value of the <strong>#output</strong> input HTML element. Here's tested code.</p>\n<p><strong>test/jest-selenium-browserstack-example.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> JestSeleniumBrowserStackExample <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">exports</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">write</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">elementId</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> el <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>elementId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    el<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token string\">'Something'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  exports<span class=\"token punctuation\">.</span>write <span class=\"token operator\">=</span> write<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> exports<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Here is a local HTML file used for testing in browser.</p>\n<p><strong>test/test.html</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>./jest-selenium-browserstack-example.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">'</span>JestSeleniumBrowserStackExample.write(\"output\")<span class=\"token punctuation\">'</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>copy<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>write<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>output<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>not working<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>All files listed above are available inside <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example/tree/master/test\">test folder of Github example repository</a>. You may run <code class=\"language-text\">yarn test:local</code> in cloned repository to check if everything is working as expected.</p>\n<blockquote>\n<p>NOTE! In order to run Selenium tests locally you will have to download and install approperiate driver, which is geckodriver in this case. It may be downloaded directly from <a href=\"https://github.com/mozilla/geckodriver/releases\">official Mozilla repository</a> .</p>\n</blockquote>\n<h2>Solution</h2>\n<p>The following solution will use <a href=\"https://www.browserstack.com/automate/node#setting-local-tunnel\">Automate with Local Testing</a> for running fully automated tests on selected version of OS and browser.\nIn order to simplify things a bit, I assume that you're working on a Unix system (e.g. Ubuntu, Mac OS X). Windows commands will be different only when it comes to <strong>BrowserStackLocal</strong> executable.</p>\n<h3>1. What is BrowserStackLocal?</h3>\n<p>After reading <a href=\"https://www.browserstack.com/automate/node\">https://www.browserstack.com/automate/node</a> you may already know that <strong>BrowserStackLocal</strong> is \"something\" that can be useful in tests.\nUnfortunately, I didn't find any clear information about how to use it for integration with test (maybe I didn't look carefully enough).</p>\n<p>For starters, just run <a href=\"https://www.browserstack.com/automate/node#local-testing-getting-started\">downloaded</a> <strong>BrowserStackLocal</strong> to check if it works. You will have to provide the <code class=\"language-text\">--key</code> argument with your BrowserStack key (as in <a href=\"https://www.browserstack.com/automate/node#doc-platform-tab\">official docs</a>) e.g. <code class=\"language-text\">Asdafklwe12312kldfasfmaMD</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">./BrowserStackLocal --key <span class=\"token punctuation\">[</span>YOUR_BROWSERSTACK_KEY<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>As a result, you will get some output. Exact messages doesn't matter, just make sure that there are no errors at this point.\nNow run it with additional <code class=\"language-text\">--folder $(pwd)</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">./BrowserStackLocal --key <span class=\"token punctuation\">[</span>YOUR_BROWSERSTACK_KEY<span class=\"token punctuation\">]</span> --folder <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">pwd</span><span class=\"token variable\">)</span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>As you can see on the output, the contents of the current folder will be available for your tests under unique URL <code class=\"language-text\">http://[YOUR_BROWSERSTACK_USERNAME].browserstack.com</code> where <code class=\"language-text\">[YOUR_BROWSERSTACK_USERNAME]</code> is your BrowserStack username.</p>\n<h3>2. Adjust/rewrite tests</h3>\n<p>By default, our test is run using the local Selenium webdriver e.g. <code class=\"language-text\">geckodriver</code> (for Firefox). We would like to run it with remote BrowserStack OS and browser. Exact BrowserStack webdriver settings are defined inside <code class=\"language-text\">capabilities</code> object.\nHere is an example:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">// for more options check https://www.browserstack.com/automate/capabilities</span>\n<span class=\"token keyword\">const</span> capabilities <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  build<span class=\"token punctuation\">:</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../package.json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>version<span class=\"token punctuation\">,</span>\n  project<span class=\"token punctuation\">:</span> <span class=\"token string\">'jest-selenium-browserstack-example'</span><span class=\"token punctuation\">,</span>\n  browserName<span class=\"token punctuation\">:</span> <span class=\"token string\">'chrome'</span><span class=\"token punctuation\">,</span>\n  os<span class=\"token punctuation\">:</span> <span class=\"token string\">'Windows'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'browserstack.local'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'browserstack.user'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'[YOUR_BROWSERSTACK_USERNAME]'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'browserstack.key'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'[YOUR_BROWSERSTACK_KEY]'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>With the above configuration, you will run tests using the Google Chrome browser on Windows. Here is the code that initiates the driver.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">driver <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">webdriver<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">usingServer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://hub-cloud.browserstack.com/wd/hub'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">withCapabilities</span><span class=\"token punctuation\">(</span>capabilities<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Remember to import the Selenium webdriver before using the above code.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> webdriver <span class=\"token keyword\">from</span> <span class=\"token string\">'selenium-webdriver'</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>All this is described on the <a href=\"https://www.browserstack.com/automate/node\">official documentation pages</a>.</p>\n<p>The last important thing is to replace:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'file://'</span> <span class=\"token operator\">+</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'test.html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>\n<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>capabilities<span class=\"token punctuation\">[</span><span class=\"token string\">'browserstack.user'</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.browserstack.com/test.html</span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Because local files are not directly available in the Browser Stack, you can access them only through a webserver (which serves files from <strong>BrowserStackLocal</strong> <code class=\"language-text\">--folder</code>). This makes sense if you think about running tests on multiple OSes because thanks to this webserver you don't have to copy files from one machine to the other, all you have to do is access the internal URL.</p>\n<p>At this stage, if you manually connect to BrowserStack using <code class=\"language-text\">./BroserStackLocal --key [bs_key] --folder $(pwd)</code> executed in the same folder as the test files, you should be able to completet all tests.</p>\n<blockquote>\n<p>NOTE! BrowserStack Selenium tests may require setting a Jest timeouts (default is 5s). This is especially true for connecting and disconnecting which tends to be time consuming process. I would advise something around 10-15s.</p>\n</blockquote>\n<p>If you clone <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example\">example repository</a> initiate <strong>BrowserStackLocal</strong> with <code class=\"language-text\">test/</code> directory inside <code class=\"language-text\">--folder</code> argument and then run <code class=\"language-text\">yarn test:manual</code> to view the results.</p>\n<p>Here is the test code described above <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/manual.test.js\">https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/manual.test.js</a>.</p>\n<h3>3. Automate BrowserStackLocal connection</h3>\n<p>Going further, it's time to go for more automated/autonomous approach.\nIf you don't want (and probably you should not) to implement NodeJS wrapper for <code class=\"language-text\">./BrowserStackLocal</code>, use the official one <a href=\"https://github.com/browserstack/browserstack-local-nodejs\">browserstack-local-nodejs</a>.\nThis package will handle the download of approperiate binary files for you and can serve as an interface between your tests and the <code class=\"language-text\">BrowserStackLocal</code> executable.</p>\n<blockquote>\n<p>To be honest I don't like the <strong>browserstack-local-nodejs</strong> package at all (callbacks, hard to debug, unused variables and more), but since this the official BrowserStack repository, we can hope that it will be maintained.</p>\n</blockquote>\n<p>Let's continue with examples.</p>\n<p>Here is how you may wrap <code class=\"language-text\">start</code> and <code class=\"language-text\">stop</code> methods from <strong>browserstack-local-nodejs</strong> to make them work with my beloved async/await syntax.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">connect</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    local<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span>BrowserStackLocalArgs<span class=\"token punctuation\">,</span> <span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">disconnect</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    local<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now you can use <code class=\"language-text\">await start()</code> and <code class=\"language-text\">await stop()</code> which is much more convenient.\nDon't forget to initialize <strong>browserstack-local-nodejs</strong> first, with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> local <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">browserstack<span class=\"token punctuation\">.</span>Local</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>and set approperiate args for executable with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> BrowserStackLocalArgs <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  key<span class=\"token punctuation\">:</span> <span class=\"token string\">'[YOUR_BROWSERSTACK_KEY]'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// verbose: true,</span>\n  onlyAutomate<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// eslint-disable-next-line</span>\n  folder<span class=\"token punctuation\">:</span> __dirname<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Then connect with BrowserStack by awaiting for <code class=\"language-text\">start()</code> function.\nYou should do this <strong>before</strong> running the webdriver.\nHere's how <code class=\"language-text\">beforeAll()</code> looks like for your tests:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// BrowserStackLocal has to be ready before webdriver initialization</span>\n      <span class=\"token keyword\">await</span> <span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      driver <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">webdriver<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">usingServer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://hub-cloud.browserstack.com/wd/hub'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">withCapabilities</span><span class=\"token punctuation\">(</span>capabilities<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>\n        <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>\n          capabilities<span class=\"token punctuation\">[</span><span class=\"token string\">'browserstack.user'</span><span class=\"token punctuation\">]</span>\n        <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.browserstack.com/test.html</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'connetion error'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// IMPORTANT! Selenium and Browserstack needs more time than regular Jest</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The tests should not require any changes. Remember about disconnecting from BrowserStack after finishing tests.\nYou can do it with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">quit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ~ 11 s !</span>\n      <span class=\"token keyword\">await</span> <span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ~ 3 s</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'disconnection error'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// IMPORTANT! Selenium and Browserstack needs a lot of time!</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>NOTE! At least in my case the disconnection after testing takes really long, which is why I set 20 seconds as a <code class=\"language-text\">afterAll</code> timeout.</p>\n</blockquote>\n<blockquote>\n<p>NOTE! If the waiting time is too short, you'll probably run into this message: <strong>Jest did not exit one second after the test run has completed</strong>. When it appears, check your system process/task manager and kill BrowserStackLocal process(es) which may not close/stop correctly.</p>\n</blockquote>\n<p>This is it. If you have any questions do not hestitate to ask and check out a sample repository that should help you a lot (I hope).</p>\n<p>If you clone <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example\">example repository</a> just run <code class=\"language-text\">yarn test:automate</code> to view the results.</p>\n<p>Here is the test code described above <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js\">https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js</a>.</p>\n<p>In the part 2 of this \"series\" I will present a way to run tests for many browsers and OSes at once, see <a href=\"https://www.grzegorowski.com/integration-tests-with-jest-selenium-and-browserstack-part-2/\">https://www.grzegorowski.com/integration-tests-with-jest-selenium-and-browserstack-part-2/</a>.</p>\n<h2>Sources</h2>\n<p><a href=\"https://seleniumhq.github.io/selenium/docs/api/javascript/module/selenium-webdriver/index.html\">https://seleniumhq.github.io/selenium/docs/api/javascript/module/selenium-webdriver/index.html</a> - Selenium documentation\n<a href=\"https://github.com/Hyddan/se-runner-browserstack-example#readme\">https://github.com/Hyddan/se-runner-browserstack-example#readme</a> - first inspiration for automated tests with BrowserStack\n<a href=\"https://github.com/browserstack/browserstack-local-nodejs\">https://github.com/browserstack/browserstack-local-nodejs</a> - finally a working example of BrowserStack integration\n<a href=\"https://www.browserstack.com/automate/node\">https://www.browserstack.com/automate/node</a> - useful official NodeJS documentation\n<a href=\"https://blog.evantahler.com/testing-javascript-applications-with-selenium-async-await-and-jest-7580ed074f2b\">https://blog.evantahler.com/testing-javascript-applications-with-selenium-async-await-and-jest-7580ed074f2b</a> - nice setup of Jest and Selenium without BrowserStack\n<a href=\"https://www.browserstack.com/local-testing#modifiers\">https://www.browserstack.com/local-testing#modifiers</a> - BrowserStackLocal argument list\n<a href=\"https://github.com/Hyddan/se-runner\">https://github.com/Hyddan/se-runner</a> - one of the inspirations (uses Grunt and Jasmine)</p>","timeToRead":9,"rawMarkdownBody":"Although there is much useful information on the official BrowserStack website, you will certainly have a lot of questions when you run tests for the first time. I will try to explain how to deal with it based on a simple example which uses Jest and Selenium.\n\n**There is no problem in running [Jest](https://jestjs.io) with BrowserStack, despite the lack of documentation or examples.**\n\nTLDR; Check the [example repository](https://github.com/jmarceli/jest-selenium-browserstack-example) it should be self-explanatory.\n\n## Starting point\n\nI have Selenium-based tests that I can run locally. How do I load BrowserStack and run tests against their browsers?\n\nIt seems that it is quite simple and typical task.\n\nHere is an example of a basic Selenium test powered by Jest. It will be used to show how to integrate existing code with [BrowserStack Automate](https://www.browserstack.com/docs?product=automate) testing service.\n\n**test/local.test.js**\n```javascript\nimport { Builder, By, until } from 'selenium-webdriver';\nimport firefox from 'selenium-webdriver/firefox';\nimport path from 'path';\n\nconst getElementById = async (driver, id, timeout = 2000) => {\n  const el = await driver.wait(until.elementLocated(By.id(id)), timeout);\n  return await driver.wait(until.elementIsVisible(el), timeout);\n};\n\ndescribe('webdriver', () => {\n  let driver;\n\n  beforeAll(async () => {\n    const options = new firefox.Options();\n    options.headless();\n    driver = new Builder()\n      .forBrowser('firefox')\n      .setFirefoxOptions(options)\n      .build();\n\n    // eslint-disable-next-line no-undef\n    await driver.get('file://' + path.join(__dirname, 'test.html'));\n  });\n\n  afterAll(async () => {\n    await driver.quit();\n  });\n\n  test('test', async () => {\n    const btn = await getElementById(driver, 'test-button');\n    await btn.click();\n\n    const output = await getElementById(driver, 'output');\n    const outputVal = await output.getAttribute('value');\n\n    expect(outputVal).toEqual('Something');\n  });\n});\n```\n\nAs you can see, this is a simple example in which after clicking on **#myBtn** we expect to have **Something** as value of the **#output** input HTML element. Here's tested code.\n\n**test/jest-selenium-browserstack-example.js**\n```javascript\nvar JestSeleniumBrowserStackExample = (function (exports) {\n  'use strict';\n\n  var write = function write(elementId) {\n    var el = document.getElementById(elementId);\n    el.value = 'Something';\n  };\n\n  exports.write = write;\n\n  return exports;\n\n}({}));\n```\n\nHere is a local HTML file used for testing in browser.\n\n**test/test.html**\n```html\n<html>\n  <head>\n    <script src=\"./jest-selenium-browserstack-example.js\" type=\"text/javascript\"></script>\n  </head>\n  <body>\n    <button onClick='JestSeleniumBrowserStackExample.write(\"output\")' id=\"copy\">write</button>\n    <input id=\"output\" value=\"not working\" />\n  </body>\n</html>\n```\n\nAll files listed above are available inside [test folder of Github example repository](https://github.com/jmarceli/jest-selenium-browserstack-example/tree/master/test). You may run `yarn test:local` in cloned repository to check if everything is working as expected.\n\n> NOTE! In order to run Selenium tests locally you will have to download and install approperiate driver, which is geckodriver in this case. It may be downloaded directly from [official Mozilla repository](https://github.com/mozilla/geckodriver/releases) .\n\n## Solution\n\nThe following solution will use [Automate with Local Testing](https://www.browserstack.com/automate/node#setting-local-tunnel) for running fully automated tests on selected version of OS and browser.\nIn order to simplify things a bit, I assume that you're working on a Unix system (e.g. Ubuntu, Mac OS X). Windows commands will be different only when it comes to **BrowserStackLocal** executable.\n\n### 1. What is BrowserStackLocal?\n\nAfter reading https://www.browserstack.com/automate/node you may already know that **BrowserStackLocal** is \"something\" that can be useful in tests.\nUnfortunately, I didn't find any clear information about how to use it for integration with test (maybe I didn't look carefully enough).\n\nFor starters, just run [downloaded](https://www.browserstack.com/automate/node#local-testing-getting-started) **BrowserStackLocal** to check if it works. You will have to provide the `--key` argument with your BrowserStack key (as in [official docs](https://www.browserstack.com/automate/node#doc-platform-tab)) e.g. `Asdafklwe12312kldfasfmaMD`:\n\n```bash\n./BrowserStackLocal --key [YOUR_BROWSERSTACK_KEY]\n```\n\nAs a result, you will get some output. Exact messages doesn't matter, just make sure that there are no errors at this point.\nNow run it with additional `--folder $(pwd)`.\n\n```bash\n./BrowserStackLocal --key [YOUR_BROWSERSTACK_KEY] --folder $(pwd)\n```\n\nAs you can see on the output, the contents of the current folder will be available for your tests under unique URL `http://[YOUR_BROWSERSTACK_USERNAME].browserstack.com` where `[YOUR_BROWSERSTACK_USERNAME]` is your BrowserStack username.\n\n### 2. Adjust/rewrite tests\n\nBy default, our test is run using the local Selenium webdriver e.g. `geckodriver` (for Firefox). We would like to run it with remote BrowserStack OS and browser. Exact BrowserStack webdriver settings are defined inside `capabilities` object.\nHere is an example:\n\n```javascript\n// for more options check https://www.browserstack.com/automate/capabilities\nconst capabilities = {\n  build: require('../package.json').version,\n  project: 'jest-selenium-browserstack-example',\n  browserName: 'chrome',\n  os: 'Windows',\n  'browserstack.local': true,\n  'browserstack.user': '[YOUR_BROWSERSTACK_USERNAME]',\n  'browserstack.key': '[YOUR_BROWSERSTACK_KEY]',\n};\n```\n\nWith the above configuration, you will run tests using the Google Chrome browser on Windows. Here is the code that initiates the driver.\n\n```javascript\ndriver = new webdriver.Builder()\n  .usingServer('http://hub-cloud.browserstack.com/wd/hub')\n  .withCapabilities(capabilities)\n  .build();\n```\n\nRemember to import the Selenium webdriver before using the above code.\n\n```javascript\nimport webdriver from 'selenium-webdriver';\n```\n\nAll this is described on the [official documentation pages](https://www.browserstack.com/automate/node).\n\nThe last important thing is to replace:\n\n```javascript\nawait driver.get('file://' + path.join(__dirname, 'test.html'));\n```\n\nwith:\n\n```javascript\nawait driver.get(\n`http://${capabilities['browserstack.user']}.browserstack.com/test.html`\n);\n```\nBecause local files are not directly available in the Browser Stack, you can access them only through a webserver (which serves files from **BrowserStackLocal** `--folder`). This makes sense if you think about running tests on multiple OSes because thanks to this webserver you don't have to copy files from one machine to the other, all you have to do is access the internal URL.\n\nAt this stage, if you manually connect to BrowserStack using `./BroserStackLocal --key [bs_key] --folder $(pwd)` executed in the same folder as the test files, you should be able to completet all tests.\n\n> NOTE! BrowserStack Selenium tests may require setting a Jest timeouts (default is 5s). This is especially true for connecting and disconnecting which tends to be time consuming process. I would advise something around 10-15s.\n\nIf you clone [example repository](https://github.com/jmarceli/jest-selenium-browserstack-example) initiate **BrowserStackLocal** with `test/` directory inside `--folder` argument and then run `yarn test:manual` to view the results.\n\nHere is the test code described above https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/manual.test.js.\n\n### 3. Automate BrowserStackLocal connection\n\nGoing further, it's time to go for more automated/autonomous approach.\nIf you don't want (and probably you should not) to implement NodeJS wrapper for `./BrowserStackLocal`, use the official one [browserstack-local-nodejs](https://github.com/browserstack/browserstack-local-nodejs).\nThis package will handle the download of approperiate binary files for you and can serve as an interface between your tests and the `BrowserStackLocal` executable.\n\n> To be honest I don't like the **browserstack-local-nodejs** package at all (callbacks, hard to debug, unused variables and more), but since this the official BrowserStack repository, we can hope that it will be maintained.\n\nLet's continue with examples.\n\nHere is how you may wrap `start` and `stop` methods from **browserstack-local-nodejs** to make them work with my beloved async/await syntax.\n\n```javascript\n\nconst connect = async () =>\n  new Promise((resolve, reject) => {\n    local.start(BrowserStackLocalArgs, error => {\n      if (error) {\n        reject(error);\n      }\n      resolve();\n    });\n  });\n\nconst disconnect = async () =>\n  new Promise((resolve, reject) => {\n    local.stop(function(error) {\n      if (error) {\n        reject(error);\n      }\n\n      resolve();\n    });\n  });\n```\n\nNow you can use `await start()` and `await stop()` which is much more convenient.\nDon't forget to initialize **browserstack-local-nodejs** first, with:\n\n```javascript\nconst local = new browserstack.Local();\n```\n\nand set approperiate args for executable with:\n\n```javascript\nconst BrowserStackLocalArgs = {\n  key: '[YOUR_BROWSERSTACK_KEY]',\n  // verbose: true,\n  onlyAutomate: true,\n  // eslint-disable-next-line\n  folder: __dirname,\n};\n```\n\nThen connect with BrowserStack by awaiting for `start()` function.\nYou should do this **before** running the webdriver.\nHere's how `beforeAll()` looks like for your tests:\n\n```javascript\n  beforeAll(async () => {\n    try {\n      // BrowserStackLocal has to be ready before webdriver initialization\n      await start();\n      driver = new webdriver.Builder()\n        .usingServer('http://hub-cloud.browserstack.com/wd/hub')\n        .withCapabilities(capabilities)\n        .build();\n\n      await driver.get(\n        `http://${\n          capabilities['browserstack.user']\n        }.browserstack.com/test.html`,\n      );\n    } catch (error) {\n      console.error('connetion error', error);\n    }\n    // IMPORTANT! Selenium and Browserstack needs more time than regular Jest\n  }, 10000);\n```\n\nThe tests should not require any changes. Remember about disconnecting from BrowserStack after finishing tests.\nYou can do it with:\n\n```javascript\n  afterAll(async () => {\n    try {\n      await driver.quit(); // ~ 11 s !\n      await stop(); // ~ 3 s\n    } catch (error) {\n      console.error('disconnection error', error);\n    }\n    // IMPORTANT! Selenium and Browserstack needs a lot of time!\n  }, 20000);\n```\n\n> NOTE! At least in my case the disconnection after testing takes really long, which is why I set 20 seconds as a `afterAll` timeout.\n\n> NOTE! If the waiting time is too short, you'll probably run into this message: **Jest did not exit one second after the test run has completed**. When it appears, check your system process/task manager and kill BrowserStackLocal process(es) which may not close/stop correctly.\n\nThis is it. If you have any questions do not hestitate to ask and check out a sample repository that should help you a lot (I hope).\n\nIf you clone [example repository](https://github.com/jmarceli/jest-selenium-browserstack-example) just run `yarn test:automate` to view the results.\n\nHere is the test code described above https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js.\n\nIn the part 2 of this \"series\" I will present a way to run tests for many browsers and OSes at once, see https://www.grzegorowski.com/integration-tests-with-jest-selenium-and-browserstack-part-2/.\n\n## Sources\n\nhttps://seleniumhq.github.io/selenium/docs/api/javascript/module/selenium-webdriver/index.html - Selenium documentation\nhttps://github.com/Hyddan/se-runner-browserstack-example#readme - first inspiration for automated tests with BrowserStack\nhttps://github.com/browserstack/browserstack-local-nodejs - finally a working example of BrowserStack integration\nhttps://www.browserstack.com/automate/node - useful official NodeJS documentation\nhttps://blog.evantahler.com/testing-javascript-applications-with-selenium-async-await-and-jest-7580ed074f2b - nice setup of Jest and Selenium without BrowserStack\nhttps://www.browserstack.com/local-testing#modifiers - BrowserStackLocal argument list\nhttps://github.com/Hyddan/se-runner - one of the inspirations (uses Grunt and Jasmine)\n","excerpt":"Although there is much useful information on the official BrowserStack website, you will certainly have a lot of questions when you runâ€¦","frontmatter":{"title":"Integration tests with Jest, Selenium and BrowserStack - part 1 - simple example","slug":"integration-tests-with-jest-selenium-and-browserstack","date":"2018-10-30T09:29:00.000Z","tags":["javascript","tools"],"date_created":"2018-11-20T10:58:51.000Z","date_updated":"2018-11-04T18:01:19.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1513611771808-7e8ab7f1dec6.jpg","relativePath":"posts/img/photo-1513611771808-7e8ab7f1dec6.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMFBP/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABXvl2MkjSP//EABoQAAIDAQEAAAAAAAAAAAAAAAABAxETAjL/2gAIAQEAAQUCid9ZmYola8n/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAADAAMAAAAAAAAAAAAAAAACEBExgZH/2gAIAQEABj8CkPbyXX//xAAZEAADAAMAAAAAAAAAAAAAAAAAAREQMUH/2gAIAQEAAT8hcje7GDCglxXRn//aAAwDAQACAAMAAAAQVP8A/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/EKx//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERMSFx/9oACAEBAAE/EIP1xGF60VNQi9Yn93tDtUaa9Zo//9k=","aspectRatio":2,"src":"/static/77532cba5dddbaa1e8170b8f97b35b49/0defe/photo-1513611771808-7e8ab7f1dec6.jpg","srcSet":"/static/77532cba5dddbaa1e8170b8f97b35b49/38b6a/photo-1513611771808-7e8ab7f1dec6.jpg 150w,\n/static/77532cba5dddbaa1e8170b8f97b35b49/e201c/photo-1513611771808-7e8ab7f1dec6.jpg 300w,\n/static/77532cba5dddbaa1e8170b8f97b35b49/0defe/photo-1513611771808-7e8ab7f1dec6.jpg 600w,\n/static/77532cba5dddbaa1e8170b8f97b35b49/a71f1/photo-1513611771808-7e8ab7f1dec6.jpg 900w,\n/static/77532cba5dddbaa1e8170b8f97b35b49/8d595/photo-1513611771808-7e8ab7f1dec6.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"ef4d6b89-823d-5f1b-aaec-9271a806d4d5","html":"<p>As described in <a href=\"https://www.grzegorowski.com/integration-tests-with-jest-selenium-and-browserstack/\">part 1</a> you can run Jest based tests with BrowserStack service. Now I will show how they can be automatically run against many browsers and OSes.</p>\n<h2>Parametrized tests</h2>\n<p>Probably the most simple way to convert <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js\">single-browser automatic Browserstack test</a> to multi browser/OS is parametrization using enironment variables. Here is how it might be done regarding example test file <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js\">test/automate.test.js</a>.</p>\n<p>Replace the following lines from <code class=\"language-text\">capabilities</code> object:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  browserName<span class=\"token punctuation\">:</span> <span class=\"token string\">'chrome'</span><span class=\"token punctuation\">,</span>\n  os<span class=\"token punctuation\">:</span> <span class=\"token string\">'Windows'</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  browserName<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">BROWSER</span><span class=\"token punctuation\">,</span>\n  os<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">OS</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>This is it! Now you may run tests against any browser and OS available in BrowserStack service.\nExample:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token assign-left variable\">OS</span><span class=\"token operator\">=</span>Windows <span class=\"token assign-left variable\">BROWSER</span><span class=\"token operator\">=</span>chrome <span class=\"token function\">yarn</span> jest ./test/parametrized.test.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Provided that your parametrized tests file path is: <code class=\"language-text\">./test/parametrized.test.js</code></p>\n<p>Running against multiple browsers and OSes might be achieved by chaining execution of commands like:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token assign-left variable\">OS</span><span class=\"token operator\">=</span>Windows <span class=\"token assign-left variable\">BROWSER</span><span class=\"token operator\">=</span>chrome <span class=\"token function\">yarn</span> jest ./test/parametrized.test.js <span class=\"token operator\">&amp;&amp;</span> <span class=\"token assign-left variable\">OS</span><span class=\"token operator\">=</span>Windows <span class=\"token assign-left variable\">BROWSER</span><span class=\"token operator\">=</span>firefox <span class=\"token function\">yarn</span> jest ./test/parametrized.test.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>or (if you don't care about possible previous command errors):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token assign-left variable\">OS</span><span class=\"token operator\">=</span>Windows <span class=\"token assign-left variable\">BROWSER</span><span class=\"token operator\">=</span>chrome <span class=\"token function\">yarn</span> jest ./test/parametrized.test.js<span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">OS</span><span class=\"token operator\">=</span>Windows <span class=\"token assign-left variable\">BROWSER</span><span class=\"token operator\">=</span>firefox <span class=\"token function\">yarn</span> jest ./test/parametrized.test.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>As you may expect, this is not the most effective method, because the connection to BrowserStack service is opened and closed for each command executed.</p>\n<h2>Sequential tests</h2>\n<p>Another option is to write a sequential test wrapper that will run selected tests against browsers defined in the <code class=\"language-text\">config.json</code> file one after another. It is a bit more complicated as it requires tests code refactoring.</p>\n<p>Here is an example content of a <code class=\"language-text\">config.json</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"browsers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"browserName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"internet explorer\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.0\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"browserName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"chrome\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"22.0\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The file structure is based on the official <code class=\"language-text\">example/config.json</code> from <a href=\"https://www.browserstack.com/automate/node#wd\">https://www.browserstack.com/automate/node#wd</a>. Check the <a href=\"https://www.browserstack.com/automate/capabilities\">https://www.browserstack.com/automate/capabilities</a> for list of all available keys.</p>\n<p>The general idea is to connect to BrowserStackLocal, run tests for all browsers defined inside the <code class=\"language-text\">config.json</code> file and finally disconnect. To achieve this, we will use the <code class=\"language-text\">beforeAll</code> and <code class=\"language-text\">afterAll</code> hooks to handle BrowserStack connection. After establishing a connection with BrowserStackLocal we will loop through all browser versions from config file and run tests for each of them. Here's how it can look.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> webdriver <span class=\"token keyword\">from</span> <span class=\"token string\">'selenium-webdriver'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> browserstack <span class=\"token keyword\">from</span> <span class=\"token string\">'browserstack-local'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> local <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">browserstack<span class=\"token punctuation\">.</span>Local</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> until <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>until<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> By <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>By<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> config <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./config.json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> BrowserStackLocalArgs <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  key<span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  onlyAutomate<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  folder<span class=\"token punctuation\">:</span> __dirname<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">start</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    local<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span>BrowserStackLocalArgs<span class=\"token punctuation\">,</span> <span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">stop</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    local<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getElementById</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">driver<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> timeout <span class=\"token operator\">=</span> <span class=\"token number\">5000</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> el <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span>until<span class=\"token punctuation\">.</span><span class=\"token function\">elementLocated</span><span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> timeout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span>until<span class=\"token punctuation\">.</span><span class=\"token function\">elementIsVisible</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> timeout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> browser <span class=\"token keyword\">of</span> config<span class=\"token punctuation\">.</span>browsers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> driver<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> capabilities <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    os<span class=\"token punctuation\">:</span> <span class=\"token string\">'Windows'</span><span class=\"token punctuation\">,</span>\n    build<span class=\"token punctuation\">:</span> <span class=\"token string\">'0.1.0'</span><span class=\"token punctuation\">,</span>\n    project<span class=\"token punctuation\">:</span> <span class=\"token string\">'jest-selenium-browserstack-example'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'browserstack.local'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'browserstack.user'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'browserstack.key'</span><span class=\"token punctuation\">:</span> BrowserStackLocalArgs<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">...</span>browser<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">describe</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'selenium webdriver'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        driver <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">webdriver<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">usingServer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://hub-cloud.browserstack.com/wd/hub'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">withCapabilities</span><span class=\"token punctuation\">(</span>capabilities<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'driver start'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">quit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'driver quit'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">desc </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>capabilities<span class=\"token punctuation\">.</span>browserName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">test </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>capabilities<span class=\"token punctuation\">.</span>browserName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tests start'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>\n            <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>\n              capabilities<span class=\"token punctuation\">[</span><span class=\"token string\">'browserstack.user'</span><span class=\"token punctuation\">]</span>\n            <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.browserstack.com/test.html</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> btn <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> <span class=\"token string\">'test-button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">await</span> btn<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> <span class=\"token string\">'output'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> outputVal <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> output<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>outputVal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Something'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tests end'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">30000</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Although it seems quite easy, you need to take care of several things:</p>\n<ol>\n<li><code class=\"language-text\">describe</code> can not use <code class=\"language-text\">async</code> function, so there is no way to prepare <code class=\"language-text\">driver</code> instance to use directly inside <code class=\"language-text\">describe</code> block, it can be used only inside <code class=\"language-text\">test</code> body, which may be asynchronous</li>\n<li>Jest scoping is a topic which is worth refreshing to fully understand what is going on in the presented code <a href=\"https://jestjs.io/docs/en/setup-teardown#scoping\">https://jestjs.io/docs/en/setup-teardown#scoping</a></li>\n<li><code class=\"language-text\">beforeAll</code> and <code class=\"language-text\">afterAll</code> are scoped by <code class=\"language-text\">describe</code> blocks and what is more important both of them supports asynchronous function as an argument</li>\n<li>Remember about timeouts, default 5s is often not enough</li>\n</ol>\n<p>More details and sample files can be found in this repository <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example\">https://github.com/jmarceli/jest-selenium-browserstack-example</a>, especially in <code class=\"language-text\">test/sequential.test.js</code> file.</p>\n<h2>Sources</h2>\n<p><a href=\"https://www.browserstack.com/automate/node\">https://www.browserstack.com/automate/node</a>\n<a href=\"https://www.browserstack.com/list-of-browsers-and-platforms?product=automate\">https://www.browserstack.com/list-of-browsers-and-platforms?product=automate</a></p>","timeToRead":4,"rawMarkdownBody":"As described in [part 1](https://www.grzegorowski.com/integration-tests-with-jest-selenium-and-browserstack/) you can run Jest based tests with BrowserStack service. Now I will show how they can be automatically run against many browsers and OSes.\n\n## Parametrized tests\n\nProbably the most simple way to convert [single-browser automatic Browserstack test](https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js) to multi browser/OS is parametrization using enironment variables. Here is how it might be done regarding example test file [test/automate.test.js](https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js).\n\nReplace the following lines from `capabilities` object:\n\n```javascript\n  browserName: 'chrome',\n  os: 'Windows',\n```\n\nwith:\n\n```javascript\n  browserName: process.env.BROWSER,\n  os: process.env.OS,\n```\n\nThis is it! Now you may run tests against any browser and OS available in BrowserStack service.\nExample:\n\n```bash\nOS=Windows BROWSER=chrome yarn jest ./test/parametrized.test.js\n```\n\nProvided that your parametrized tests file path is: `./test/parametrized.test.js`\n\nRunning against multiple browsers and OSes might be achieved by chaining execution of commands like:\n\n```bash\nOS=Windows BROWSER=chrome yarn jest ./test/parametrized.test.js && OS=Windows BROWSER=firefox yarn jest ./test/parametrized.test.js\n```\n\nor (if you don't care about possible previous command errors):\n\n```bash\nOS=Windows BROWSER=chrome yarn jest ./test/parametrized.test.js; OS=Windows BROWSER=firefox yarn jest ./test/parametrized.test.js\n```\n\nAs you may expect, this is not the most effective method, because the connection to BrowserStack service is opened and closed for each command executed.\n\n## Sequential tests\n\nAnother option is to write a sequential test wrapper that will run selected tests against browsers defined in the `config.json` file one after another. It is a bit more complicated as it requires tests code refactoring.\n\nHere is an example content of a `config.json`:\n\n```json\n{\n  \"browsers\": [\n    {\n      \"browserName\": \"internet explorer\",\n      \"version\": \"10.0\"\n    },\n    {\n      \"browserName\": \"chrome\",\n      \"version\": \"22.0\"\n    }\n  ],\n}\n```\n\nThe file structure is based on the official `example/config.json` from https://www.browserstack.com/automate/node#wd. Check the https://www.browserstack.com/automate/capabilities for list of all available keys.\n\nThe general idea is to connect to BrowserStackLocal, run tests for all browsers defined inside the `config.json` file and finally disconnect. To achieve this, we will use the `beforeAll` and `afterAll` hooks to handle BrowserStack connection. After establishing a connection with BrowserStackLocal we will loop through all browser versions from config file and run tests for each of them. Here's how it can look.\n\n```javascript\nimport webdriver from 'selenium-webdriver';\nimport browserstack from 'browserstack-local';\n\nconst local = new browserstack.Local();\nconst until = webdriver.until;\nconst By = webdriver.By;\n\nconst config = require('./config.json');\n\nconst BrowserStackLocalArgs = {\n  key: '',\n  onlyAutomate: true,\n  folder: __dirname,\n};\n\nconst start = async () =>\n  new Promise((resolve, reject) => {\n    local.start(BrowserStackLocalArgs, error => {\n      if (error) {\n        reject(error);\n      }\n      resolve();\n    });\n  });\n\nconst stop = async () =>\n  new Promise((resolve, reject) => {\n    local.stop(function(error) {\n      if (error) {\n        reject(error);\n      }\n      resolve();\n    });\n  });\n\nconst getElementById = async (driver, id, timeout = 5000) => {\n  const el = await driver.wait(until.elementLocated(By.id(id)), timeout);\n  return await driver.wait(until.elementIsVisible(el), timeout);\n};\n\nbeforeAll(async () => {\n  await start();\n}, 20000);\n\nafterAll(async () => {\n  await stop();\n}, 20000);\n\nfor (const browser of config.browsers) {\n  let driver;\n  const capabilities = {\n    os: 'Windows',\n    build: '0.1.0',\n    project: 'jest-selenium-browserstack-example',\n    'browserstack.local': true,\n    'browserstack.user': '',\n    'browserstack.key': BrowserStackLocalArgs.key,\n    ...browser,\n  };\n\n  describe(\n    'selenium webdriver',\n    () => {\n      beforeAll(async () => {\n        driver = await new webdriver.Builder()\n          .usingServer('http://hub-cloud.browserstack.com/wd/hub')\n          .withCapabilities(capabilities)\n          .build();\n        console.log('driver start');\n      }, 20000);\n\n      afterAll(async () => {\n        await driver.quit();\n        console.log('driver quit');\n      }, 20000);\n\n      describe(`desc ${capabilities.browserName}`, () => {\n        test(`test ${capabilities.browserName}`, async () => {\n          console.log('tests start');\n          await driver.get(\n            `http://${\n              capabilities['browserstack.user']\n            }.browserstack.com/test.html`,\n          );\n          const btn = await getElementById(driver, 'test-button');\n          await btn.click();\n\n          const output = await getElementById(driver, 'output');\n          const outputVal = await output.getAttribute('value');\n\n          expect(outputVal).toEqual('Something');\n          console.log('tests end');\n        });\n      });\n    },\n    30000,\n  );\n}\n```\n\nAlthough it seems quite easy, you need to take care of several things:\n\n1. `describe` can not use `async` function, so there is no way to prepare `driver` instance to use directly inside `describe` block, it can be used only inside `test` body, which may be asynchronous\n2. Jest scoping is a topic which is worth refreshing to fully understand what is going on in the presented code https://jestjs.io/docs/en/setup-teardown#scoping\n3. `beforeAll` and `afterAll` are scoped by `describe` blocks and what is more important both of them supports asynchronous function as an argument\n4. Remember about timeouts, default 5s is often not enough\n\nMore details and sample files can be found in this repository https://github.com/jmarceli/jest-selenium-browserstack-example, especially in `test/sequential.test.js` file.\n\n## Sources\n\nhttps://www.browserstack.com/automate/node\nhttps://www.browserstack.com/list-of-browsers-and-platforms?product=automate\n","excerpt":"As described in part 1 you can run Jest based tests with BrowserStack service. Now I will show how they can be automatically run againstâ€¦","frontmatter":{"title":"Integration tests with Jest, Selenium and BrowserStack - part 2 - multiple browsers","slug":"integration-tests-with-jest-selenium-and-browserstack-part-2","date":"2018-11-03T02:58:00.000Z","tags":["frontend","javascript"],"date_created":"2018-11-06T02:33:54.000Z","date_updated":"2018-11-04T18:17:34.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1517607537732-619ace47ec9e.jpg","relativePath":"posts/img/photo-1517607537732-619ace47ec9e.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAE/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAL/2gAMAwEAAhADEAAAAYspJWCP/8QAHBAAAQQDAQAAAAAAAAAAAAAAAAIDERIBBBAy/9oACAEBAAEFAk7FzC7D8Ou+SY5//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHBAAAgICAwAAAAAAAAAAAAAAAREAIQIxEEFh/9oACAEBAAY/AiEHtwl6uHIIeSp3x//EABoQAQACAwEAAAAAAAAAAAAAAAEAESExQWH/2gAIAQEAAT8hED0kcIpPDwgQz1AAchSrGD0cit8hP//aAAwDAQACAAMAAAAQXM//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxCq/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAx/9oACAECAQE/EBF//8QAGxABAAMBAQEBAAAAAAAAAAAAAQARIUExYZH/2gAIAQEAAT8QHVN4GjTxZVYBpQoywy62Ko4AOFHwiXqmhiaedlniVnS55FnPyf/Z","aspectRatio":2,"src":"/static/4035689e780baa3abd3793f7b51bc335/0defe/photo-1517607537732-619ace47ec9e.jpg","srcSet":"/static/4035689e780baa3abd3793f7b51bc335/38b6a/photo-1517607537732-619ace47ec9e.jpg 150w,\n/static/4035689e780baa3abd3793f7b51bc335/e201c/photo-1517607537732-619ace47ec9e.jpg 300w,\n/static/4035689e780baa3abd3793f7b51bc335/0defe/photo-1517607537732-619ace47ec9e.jpg 600w,\n/static/4035689e780baa3abd3793f7b51bc335/a71f1/photo-1517607537732-619ace47ec9e.jpg 900w,\n/static/4035689e780baa3abd3793f7b51bc335/8d595/photo-1517607537732-619ace47ec9e.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"4d2a833f-00a5-538e-9b16-4a2dea23f23a","html":"<p>Here is a description of common tools and files used to create a modern NPM package. Don't hesitate to clone my <a href=\"https://github.com/jmarceli/npm-lib-package-boilerplate\">npm-lib-package-boilerplate</a> repository to check the results before spending any time on reading this.</p>\n<p>Let's start with a list of development dependencies which I'm going to use throughout this article:</p>\n<ul>\n<li><a href=\"https://babeljs.io/\">Babel</a> - ES6-8 features transpiled to ES5</li>\n<li><a href=\"https://jestjs.io/\">Jest</a> - running tests and generate coverage reports</li>\n<li><a href=\"https://flow.org/\">Flow</a> - Javascript type checking</li>\n<li><a href=\"https://eslint.org/\">ESLint</a> - Javascript linting</li>\n<li><a href=\"https://travis-ci.org/\">Travis CI</a> - continuous integration</li>\n<li><a href=\"https://rollupjs.org\">Rollup</a> - package files building</li>\n</ul>\n<p>At the end of this text you should be more or less familiar with a purpose and usage of all packages listed above.</p>\n<p>NOTE: This build is aimed at generating NodeJS/Browser libraries but is not suitable for building/publishing web applications.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 197px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3319baddbbcf1935f186d44f2a73014d/c142b/babel.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.68020304568529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBP/EABcBAAMBAAAAAAAAAAAAAAAAAAECAwX/2gAMAwEAAhADEAAAAe2LZF9Ah//EABgQAQEBAQEAAAAAAAAAAAAAAAECEBIT/9oACAEBAAEFAqsl9ZxgXic//8QAFREBAQAAAAAAAAAAAAAAAAAAECH/2gAIAQMBAT8Bp//EABURAQEAAAAAAAAAAAAAAAAAABAi/9oACAECAQE/AZP/xAAZEAACAwEAAAAAAAAAAAAAAAAAARARITH/2gAIAQEABj8CpmRbOR//xAAaEAADAQADAAAAAAAAAAAAAAAAATEREFGB/9oACAEBAAE/IUWjNXmn5xTAlReiH//aAAwDAQACAAMAAAAQVB//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/EB//xAAXEQADAQAAAAAAAAAAAAAAAAABESEQ/9oACAECAQE/EBNbz//EAB0QAQADAAIDAQAAAAAAAAAAAAEAESExUUFhkfD/2gAIAQEAAT8QVdNTMqFwPznh3+7IaRyK8oXCuKnox8QAAFBP/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"babel\"\n        title=\"babel\"\n        src=\"/static/3319baddbbcf1935f186d44f2a73014d/c142b/babel.jpg\"\n        srcset=\"/static/3319baddbbcf1935f186d44f2a73014d/c142b/babel.jpg 197w\"\n        sizes=\"(max-width: 197px) 100vw, 197px\"\n      />\n  </a>\n    </span></p>\n<h2>Babel</h2>\n<p>Transpile (converts) ES6-8 Javascript syntax into ES5 compliant code.</p>\n<p>NOTE: These instructions are for Babel@6 despite the fact that Babel@7 is already available. It is so due to the fact that the latter is still not supported by all other dependencies. Especially Jest support for Babel@7 is not complete.</p>\n<p>Here is a command to execute in order to install Babel:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev babel-core babel-cli babel-preset-env babel-plugin-transform-object-rest-spread</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Short explanation:</p>\n<ul>\n<li><code class=\"language-text\">babel-preset-env</code> - a starting point for all Babel custom presets (instructions what should be transpiled and how)</li>\n<li><code class=\"language-text\">babel-plugin-transform-object-rest-spread</code> - if you use spread operator anywhere you will need this one</li>\n</ul>\n<p>Finally an example of <strong>.babelrc</strong> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ensures most commonly used transpilations e.g. import</span>\n  <span class=\"token string\">\"presets\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"env\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// some additional plugins: Flow and Rewire (described in the Jest section)</span>\n  <span class=\"token string\">\"plugins\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"transform-flow-strip-types\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"babel-plugin-rewire\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>It will only be used for tests. You won't need it during build process because it will be handled by a <a href=\"#rollup\">Rollup</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 160px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e91ab0590c5d35ff89504657950c88ce/bd8b1/jest.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQCBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHuwaF2smJqwrYZ/8QAGxAAAgIDAQAAAAAAAAAAAAAAAQIDIQAREhD/2gAIAQEAAQUCN50ulGlYEycBcjqOWpAoXz//xAAWEQEBAQAAAAAAAAAAAAAAAAABEDH/2gAIAQMBAT8BI5P/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAgEAABAwMFAQAAAAAAAAAAAAABABEhAjFBEBIiQlFS/9oACAEBAAY/AmeV2t9ZQBRLQ+FyqG7xUv4g0PdQNP/EAB0QAQACAwADAQAAAAAAAAAAAAEAESExURBBYYH/2gAIAQEAAT8hqHEj9gWbYybV8RlCoZYCm4OrrvoiMpjjGuQINgTaHidwqiPH/9oADAMBAAIAAwAAABDo2ID/xAAXEQEBAQEAAAAAAAAAAAAAAAABADEQ/9oACAEDAQE/EAE7Yc//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAfEAEAAQQCAwEAAAAAAAAAAAABEQAhMUFhcRBRobH/2gAIAQEAAT8QieVRDA5KEs84kO+WGiUsEZV3REtcBbJHY+c0gjBbNRDeVvmjiQhHJaphO3B6flRgO0Lvbvx//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jest\"\n        title=\"jest\"\n        src=\"/static/e91ab0590c5d35ff89504657950c88ce/bd8b1/jest.jpg\"\n        srcset=\"/static/e91ab0590c5d35ff89504657950c88ce/bd8b1/jest.jpg 160w\"\n        sizes=\"(max-width: 160px) 100vw, 160px\"\n      />\n  </a>\n    </span></p>\n<h2>Jest</h2>\n<p>Next important package after Babel transpiler is Jest. Facebook alternative to the well known Mocha test runner. Here is an installation command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev jest babel-jest babel-plugin-rewire</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>First two packages are more or less self-explanatory but the last one <code class=\"language-text\">babel-plugin-rewire</code> is in my opinion particularly useful. It let's you <a href=\"https://github.com/speedskater/babel-plugin-rewire\">test even non-exported functions</a> by getting their definitions through <code class=\"language-text\">__get__</code> method.</p>\n<p>As usual you will require some configuration file, which is named <strong>jest.config.js</strong>. It might be auto-generated with:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> jest --init</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>For start I would suggest you to leave <strong>jest.config.js</strong> without any changes as it should work in most cases.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 130px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5d84637d4e2302105b0bc7ad749ff59b/21825/flow.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 119.23076923076923%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAYABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMBAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAADAv/aAAwDAQACEAMQAAAB9nvZhdmGjiQKXCR//8QAGRABAAMBAQAAAAAAAAAAAAAAAQACITER/9oACAEBAAEFArKQcjF8TliWdOf/xAAZEQACAwEAAAAAAAAAAAAAAAAAMQECECH/2gAIAQMBAT8BeU6Sz//EABoRAQADAAMAAAAAAAAAAAAAAAEAAhEDITH/2gAIAQIBAT8BVq7DychnZKuk/8QAGhAAAQUBAAAAAAAAAAAAAAAAEAABESExYf/aAAgBAQAGPwJWeGHwf//EABsQAAMAAgMAAAAAAAAAAAAAAAABESFhMUFR/9oACAEBAAE/IX2iOFidVQtWjmB5HaiIDqYz/9oADAMBAAIAAwAAABAIF73/xAAYEQEBAQEBAAAAAAAAAAAAAAABABEhMf/aAAgBAwEBPxAwBk+3TGGK/8QAGBEBAQEBAQAAAAAAAAAAAAAAAQARMUH/2gAIAQIBAT8QYako3sBfScVv/8QAHBABAAMAAgMAAAAAAAAAAAAAAQARITFBYYGx/9oACAEBAAE/EGBgjIoUPNcw+ol0NPxMkKghA2adLl4nvZL3mB6yM0AKn//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"flow\"\n        title=\"flow\"\n        src=\"/static/5d84637d4e2302105b0bc7ad749ff59b/21825/flow.jpg\"\n        srcset=\"/static/5d84637d4e2302105b0bc7ad749ff59b/21825/flow.jpg 130w\"\n        sizes=\"(max-width: 130px) 100vw, 130px\"\n      />\n  </a>\n    </span></p>\n<h2>Flow</h2>\n<p>Type checking the Facebook way. As for React based development Flow seems to me as more natural choice than Typescript, I've decided to use it also for my non-React projects.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev flow-bin flow-typed babel-plugin-transform-flow-strip-types</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li><code class=\"language-text\">flow-typed</code> is a library with typings (something similar to Typescript DefinitelyTyped)</li>\n<li><code class=\"language-text\">babel-plugin-transform-flow-strip-types</code> allows for using flow with Babel transpiler by stripping flow annotations when necessary</li>\n</ul>\n<p>Flow default configuration available in <strong>.flowconfig</strong> should match your base requirements.</p>\n<p>After all packages are in installed with Yarn execute <code class=\"language-text\">yarn flow-typed install</code> to get most recent types definitions.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 150px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6b0e393a42fbe0dd551e514cae0cce8e/91b8e/eslint.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 103.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAGQABAQADAQAAAAAAAAAAAAAAAAQBAgUD/8QAGAEAAgMAAAAAAAAAAAAAAAAAAAECAwT/2gAMAwEAAhADEAAAAa/HPQ0LVEiWRCOsKn//xAAZEAEBAQEBAQAAAAAAAAAAAAADAgEEERP/2gAIAQEAAQUCRk1dhi2Ok6ka8drnDAcSOg8qAD6TE5E//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAGREBAAIDAAAAAAAAAAAAAAAAAQACEBEi/9oACAECAQE/AXl0ESgwslMf/8QAHxAAAgIBBAMAAAAAAAAAAAAAAAECEhEDITFRE0GR/9oACAEBAAY/Anpw2PJl/Td1fTHdYeR+xyfY5cSRaUiseD//xAAcEAADAAMAAwAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hczCcqWWygU90IDX0BeeDb4UNqsSnywGvJ35MuY+JCeiIf//aAAwDAQACAAMAAAAQGNfC/8QAGBEAAgMAAAAAAAAAAAAAAAAAACEQETH/2gAIAQMBAT8Q0ZTj/8QAGREBAQEAAwAAAAAAAAAAAAAAAQARIUGB/9oACAECAQE/EEhxHPZ4azzHuVXW/8QAHBABAAICAwEAAAAAAAAAAAAAAQARIUExUcGR/9oACAEBAAE/EAcBGxQ7cEsLFparek6nE1iKR9I5UNeK1w+TERaZLWDByxdgHtwwZFCXQ09wAB1cfs1iCXc//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"eslint\"\n        title=\"eslint\"\n        src=\"/static/6b0e393a42fbe0dd551e514cae0cce8e/91b8e/eslint.jpg\"\n        srcset=\"/static/6b0e393a42fbe0dd551e514cae0cce8e/91b8e/eslint.jpg 150w\"\n        sizes=\"(max-width: 150px) 100vw, 150px\"\n      />\n  </a>\n    </span></p>\n<h2>ESLint</h2>\n<p>Having some linter is always a good idea so I've decided to go with probably most popular one which is ESLint. Just execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev eslint eslint-config-airbnb-base eslint-plugin-flowtype eslint-plugin-jest babel-eslint eslint-plugin-import</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>As you can see we have to install a plugin for every package used in development: Flow, Jest and Babel to prevent false positives. As it is a description of creating non-React package you should probably use <code class=\"language-text\">eslint-config-airbnb-base</code> instead of <code class=\"language-text\">eslint-config-airbnb</code> for base of your linting rules.\nWhat is more <code class=\"language-text\">eslint-plugin-import</code> package is required to support ES6 import statements.</p>\n<p>ESLint configuration is stored in <strong>.eslintrc</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"extends\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"airbnb-base\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:jest/recommended\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:flowtype/recommended\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"plugins\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"jest\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"flowtype\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"rules\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// special case for rewire __get__</span>\n    <span class=\"token string\">\"no-underscore-dangle\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"allow\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"__get__\"</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 156px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9dd0e07a3d0ff4c9f0e22afd8e6c3bae/35ffc/travisci.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.35897435897438%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAUEAgP/xAAXAQADAQAAAAAAAAAAAAAAAAABAgMA/9oADAMBAAIQAxAAAAGvj88yG2yGHU01LwM//8QAHhAAAgEDBQAAAAAAAAAAAAAAAQIDAAQREhMhIiP/2gAIAQEAAQUCdqU9xIMTq25jmGPUl2PONA1IoRf/xAAXEQEBAQEAAAAAAAAAAAAAAAABEAIh/9oACAEDAQE/AYKZ5P/EABURAQEAAAAAAAAAAAAAAAAAAAEg/9oACAECAQE/AUj/xAAgEAABAwIHAAAAAAAAAAAAAAAAAREhEjECIkFRYZGh/9oACAEBAAY/AhZ8MwrvNmNeyXvuVGHkpQ//xAAaEAEBAQEBAQEAAAAAAAAAAAABEQAhQTGx/9oACAEBAAE/IfMsPs9zFLLCAwBUf3dAMcVMGY9eHRgRL6l8aQCiM45G1LTmE/E3/9oADAMBAAIAAwAAABDcyDz/xAAYEQACAwAAAAAAAAAAAAAAAAAQEQEhQf/aAAgBAwEBPxCEheGj/8QAGREBAAIDAAAAAAAAAAAAAAAAAQARECEx/9oACAECAQE/EEXsLqJvH//EABsQAQACAwEBAAAAAAAAAAAAAAEAESExQVFh/9oACAEBAAE/EKhsE8LBq4NIQFFsux+ahVbl5NPYpzLN88a7M8510BzfbmIMjYTglCNsgEdjMgQmGK1WIGqHRe36z//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"travisci\"\n        title=\"travisci\"\n        src=\"/static/9dd0e07a3d0ff4c9f0e22afd8e6c3bae/35ffc/travisci.jpg\"\n        srcset=\"/static/9dd0e07a3d0ff4c9f0e22afd8e6c3bae/35ffc/travisci.jpg 156w\"\n        sizes=\"(max-width: 156px) 100vw, 156px\"\n      />\n  </a>\n    </span></p>\n<h2>Travis CI</h2>\n<p>Continuous integration is a nice and useful addition to every publicly available project. In order to use Travis CI you only have to register with your Github account on <a href=\"https://travis-ci.org/\">Travis CI</a>, which is FREE for every open-source project. After registration you should select your repository and activate it (which is fairly simple and intuitive).</p>\n<p>In order to make continuous integration work just add a file <strong>.travis.yml</strong> to the root folder of your project. It should have a content similar to the one presented below:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yml line-numbers\"><code class=\"language-yml\"><span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> node_js\n<span class=\"token key atrule\">node_js</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token string\">'8'</span>\n<span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> yarn test\n  <span class=\"token punctuation\">-</span> yarn build\n<span class=\"token key atrule\">install</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> yarn install\n<span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">only</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> master</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>This file tell Travis to:</p>\n<ul>\n<li>use language <code class=\"language-text\">node_js</code></li>\n<li>in version <code class=\"language-text\">8</code> (it will be selected with <code class=\"language-text\">nvm</code> by Travis)</li>\n<li><code class=\"language-text\">yarn install</code> packages (with Yarn - instead of default NPM installation)</li>\n<li>run scripts <code class=\"language-text\">yarn test</code> and <code class=\"language-text\">yarn build</code> - they will determine the process output, if any of them fails entire building result will be negative</li>\n<li>and use only <code class=\"language-text\">master</code> branch of your repo</li>\n</ul>\n<p>One thing worth noting during package configuration is a behaviour of <code class=\"language-text\">prepublish</code> hook which you may be tempted to implement in <strong>package.json</strong> file. It might be not so obvious that <code class=\"language-text\">prepublish</code> scripts will be run <strong>also</strong> after initial installation, not only before package publishing. You would probably like to use <code class=\"language-text\">prepublishOnly</code> instead of <code class=\"language-text\">prepublish</code>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 118px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/77d523d4050aecce642f246d40d90469/2ac20/rollup.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 131.35593220338984%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMCBAUB/8QAFgEBAQEAAAAAAAAAAAAAAAAAAwQF/9oADAMBAAIQAxAAAAGM2Rl0rQoaftB6CffMIQ//xAAcEAABBAMBAAAAAAAAAAAAAAACAAEDIgQSMhD/2gAIAQEAAQUCLp6IMmojeQlHjuQm+jKI9wn78//EABwRAAIABwAAAAAAAAAAAAAAAAABAgMEESExQf/aAAgBAwEBPwFvg1JuQIdNnZ//xAAaEQEAAQUAAAAAAAAAAAAAAAAAAhESISIx/9oACAECAQE/Aa5bI8Xv/8QAHRAAAgEEAwAAAAAAAAAAAAAAAAERECAhIjFRcf/aAAgBAQAGPwJ+i7N+Rsgl4qnZ/8QAHBABAAIDAQEBAAAAAAAAAAAAAQARITFBcVGh/9oACAEBAAE/If0IU0M+/IZQKOkuZoWZ6ZYLbPRDWtridvsNRzp9mjyEtOz/2gAMAwEAAgADAAAAEH//AEL/xAAZEQEBAQEBAQAAAAAAAAAAAAABEQAhcYH/2gAIAQMBAT8Qqh+65Xu5XGpIPN//xAAZEQEAAwEBAAAAAAAAAAAAAAABABEhMVH/2gAIAQIBAT8QVkg0gq3sM8n/xAAgEAEAAgEEAgMAAAAAAAAAAAABABEhMUFRcRBhgeHw/9oACAEBAAE/EPzOYt2ZWydCodQVchKfZY9tsERG4ua+4uNLIZTmM9LnZXWCuRyu/cFoHDeyJp2NHy+GkEdM/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"rollup\"\n        title=\"rollup\"\n        src=\"/static/77d523d4050aecce642f246d40d90469/2ac20/rollup.jpg\"\n        srcset=\"/static/77d523d4050aecce642f246d40d90469/2ac20/rollup.jpg 118w\"\n        sizes=\"(max-width: 118px) 100vw, 118px\"\n      />\n  </a>\n    </span></p>\n<h2>Rollup</h2>\n<p>Finally, one of the least known packages. Rollup, a package building tool without complicated configuration. Here is a command to install Rollup and all recommended plugins:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev rollup rollup-plugin-babel@3 rollup-plugin-flow rollup-plugin-cpy babel-plugin-external-helpers</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>After finishing installation create one fairly simple <strong>rollup.config.js</strong> file. Here is a commented example:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">// plugins that we are going to use</span>\n<span class=\"token keyword\">import</span> babel <span class=\"token keyword\">from</span> <span class=\"token string\">'rollup-plugin-babel'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> copy <span class=\"token keyword\">from</span> <span class=\"token string\">'rollup-plugin-cpy'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> flow <span class=\"token keyword\">from</span> <span class=\"token string\">'rollup-plugin-flow'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// list of plugins used during building process</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">plugins</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">targets</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token comment\">// remove flow annotations from output</span>\n  <span class=\"token function\">flow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// use Babel to transpile to ES5</span>\n  <span class=\"token function\">babel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ignore node_modules/ in transpilation process</span>\n    exclude<span class=\"token punctuation\">:</span> <span class=\"token string\">'node_modules/**'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// ignore .babelrc (if defined) and use options defined here</span>\n    babelrc<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> use recommended babel<span class=\"token operator\">-</span>preset<span class=\"token operator\">-</span>env without es modules enabled\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> and <span class=\"token keyword\">with</span> possibility to <span class=\"token keyword\">set</span> custom targets e<span class=\"token punctuation\">.</span>g<span class=\"token punctuation\">.</span> <span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">:</span> <span class=\"token string\">'8'</span> <span class=\"token punctuation\">}</span>\n    presets<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'env'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> modules<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> targets <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> solve a problem <span class=\"token keyword\">with</span> spread operator transpilation https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>github<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>rollup<span class=\"token operator\">/</span>rollup<span class=\"token operator\">/</span>issues<span class=\"token operator\">/</span><span class=\"token number\">281</span>\n    plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'babel-plugin-transform-object-rest-spread'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> removes comments <span class=\"token keyword\">from</span> output\n    comments<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> copy Flow definitions <span class=\"token keyword\">from</span> source to destination directory\n  <span class=\"token function\">copy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    files<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'src/*.flow'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    dest<span class=\"token punctuation\">:</span> <span class=\"token string\">'lib'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// packages that should be treated as external dependencies, not bundled</span>\n<span class=\"token keyword\">const</span> external <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">/</span><span class=\"token operator\">/</span> e<span class=\"token punctuation\">.</span>g<span class=\"token punctuation\">.</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'axios'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> source file <span class=\"token operator\">/</span> entrypoint\n  input<span class=\"token punctuation\">:</span> <span class=\"token string\">'src/index.js'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> output configuration\n  output<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> name visible <span class=\"token keyword\">for</span> other scripts\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'npmLibPackageExample'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> output file location\n    file<span class=\"token punctuation\">:</span> <span class=\"token string\">'lib/index.esm.js'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> format <span class=\"token keyword\">of</span> generated <span class=\"token constant\">JS</span> file<span class=\"token punctuation\">,</span> also<span class=\"token punctuation\">:</span> esm<span class=\"token punctuation\">,</span> and others are available\n    format<span class=\"token punctuation\">:</span> <span class=\"token string\">'esm'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> add sourcemaps\n    sourcemap<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  external<span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> build es modules <span class=\"token keyword\">for</span> node <span class=\"token number\">8</span>\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token function\">plugins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">:</span> <span class=\"token string\">'8'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  input<span class=\"token punctuation\">:</span> <span class=\"token string\">'src/index.js'</span><span class=\"token punctuation\">,</span>\n  output<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'npmLibPackageExample'</span><span class=\"token punctuation\">,</span>\n    file<span class=\"token punctuation\">:</span> <span class=\"token string\">'lib/index.js'</span><span class=\"token punctuation\">,</span>\n    format<span class=\"token punctuation\">:</span> <span class=\"token string\">'cjs'</span><span class=\"token punctuation\">,</span>\n    sourcemap<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  external<span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> build common <span class=\"token constant\">JS</span> <span class=\"token keyword\">for</span> node <span class=\"token number\">6</span>\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token function\">plugins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">:</span> <span class=\"token string\">'6'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Some more or less important findings are:</p>\n<ul>\n<li>use <code class=\"language-text\">rollup-plugin-cpy</code> instead of <code class=\"language-text\">rollup-plugin-copy</code> in order to avoid <a href=\"https://github.com/meuter/rollup-plugin-copy/issues/7\">non-existing output directory problem</a></li>\n<li><code class=\"language-text\">rollup-plugin-babel@3</code> you may use version 4 if you upgrade Babel to version 7</li>\n<li>as you may noticed as a result of this Rollup configuration you will get two files: <a href=\"https://github.com/rollup/rollup/wiki/pkg.module\">ES module standard and CommonJS one</a></li>\n</ul>\n<h2>Scripts</h2>\n<p>Custom scripts defined inside <strong>package.json</strong> which are used during development and publishing. Here is a list:</p>\n<ul>\n<li><code class=\"language-text\">&quot;clean&quot;: &quot;rimraf lib&quot;</code> - remove <code class=\"language-text\">lib/</code> directory with build results</li>\n<li><code class=\"language-text\">&quot;test&quot;: &quot;yarn jest src&quot;</code> - run tests defined inside <code class=\"language-text\">src/</code> directory with Jest</li>\n<li><code class=\"language-text\">&quot;test:watch&quot;: &quot;yarn jest src --watch --notify&quot;</code> - run tests and watch for changes as well as display notifications with results</li>\n<li><code class=\"language-text\">&quot;cover&quot;: &quot;jest src --coverage&quot;</code> - generate test coverage report</li>\n<li><code class=\"language-text\">&quot;lint&quot;: &quot;eslint src&quot;</code> - run linting with ESLint</li>\n<li><code class=\"language-text\">&quot;build&quot;: &quot;yarn rollup -c&quot;</code> - build output using Rollup</li>\n<li><code class=\"language-text\">&quot;precommit&quot;: &quot;yarn flow src &amp;&amp; yarn lint &amp;&amp; yarn test&quot;</code> - run before each commit to ensure commited code quality</li>\n<li><code class=\"language-text\">&quot;prepublishOnly&quot;: &quot;yarn clean &amp;&amp; yarn lint &amp;&amp; yarn test &amp;&amp; yarn build&quot;</code> - run <a href=\"https://docs.npmjs.com/misc/scripts\">ONLY before</a> <code class=\"language-text\">yarn publish</code> to ensure quality and most recent output</li>\n</ul>\n<h2>Other tools and files</h2>\n<p>List of useful tools/files:</p>\n<ul>\n<li><code class=\"language-text\">rimraf</code> - cross-platform directory cleaning</li>\n<li><code class=\"language-text\">husky</code> - additional Git hooks e.g. testing code just before making a commit</li>\n<li><code class=\"language-text\">.editorconfig</code> - recommended editor configuration</li>\n<li><code class=\"language-text\">.npmignore</code> - list of ignored files/dirs when publishing to NPM registry</li>\n<li><code class=\"language-text\">LICENSE</code> - info about license e.g. <a href=\"https://en.wikipedia.org/wiki/MIT_License\">MIT</a></li>\n</ul>\n<p>Another important thing is last part of <strong>package.json</strong> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\">  <span class=\"token property\">\"husky\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"hooks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"pre-commit\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"yarn precommit\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>These are lines which actually trigger <code class=\"language-text\">yarn precommit</code> before each Git commit thanks to <a href=\"https://github.com/typicode/husky\">husky</a> provided hooks.</p>\n<p>You will find all files/tools listed above in my <a href=\"https://github.com/jmarceli/npm-lib-package-boilerplate\">boilerplate project on Github</a> or <a href=\"https://www.npmjs.com/package/npm-lib-package-boilerplate\">on NPM</a></p>\n<h2>Sources</h2>\n<ul>\n<li><a href=\"https://codeburst.io/publish-your-own-npm-package-ff918698d450\">https://codeburst.io/publish-your-own-npm-package-ff918698d450</a> - great article with slightly different setup</li>\n<li><a href=\"https://github.com/rollup/rollup/wiki/pkg.module\">https://github.com/rollup/rollup/wiki/pkg.module</a> - ES module, CommonJS and others explained</li>\n<li><a href=\"https://github.com/rollup/rollup/issues/281\">https://github.com/rollup/rollup/issues/281</a> - Rollup spread operator transpilation</li>\n<li><a href=\"https://github.com/rollup/rollup-plugin-babel#configuring-babel\">https://github.com/rollup/rollup-plugin-babel#configuring-babel</a></li>\n<li><a href=\"https://github.com/meuter/rollup-plugin-copy/issues/7\">https://github.com/meuter/rollup-plugin-copy/issues/7</a> - rollup-plugin-copy problem</li>\n</ul>","timeToRead":9,"rawMarkdownBody":"Here is a description of common tools and files used to create a modern NPM package. Don't hesitate to clone my [npm-lib-package-boilerplate](https://github.com/jmarceli/npm-lib-package-boilerplate) repository to check the results before spending any time on reading this.\n\nLet's start with a list of development dependencies which I'm going to use throughout this article:\n\n- [Babel](https://babeljs.io/) - ES6-8 features transpiled to ES5\n- [Jest](https://jestjs.io/) - running tests and generate coverage reports\n- [Flow](https://flow.org/) - Javascript type checking\n- [ESLint](https://eslint.org/) - Javascript linting\n- [Travis CI](https://travis-ci.org/) - continuous integration\n- [Rollup](https://rollupjs.org) - package files building\n\n\nAt the end of this text you should be more or less familiar with a purpose and usage of all packages listed above.\n\nNOTE: This build is aimed at generating NodeJS/Browser libraries but is not suitable for building/publishing web applications.\n\n\n![babel](img/babel.jpg)\n## Babel\n\nTranspile (converts) ES6-8 Javascript syntax into ES5 compliant code.\n\nNOTE: These instructions are for Babel@6 despite the fact that Babel@7 is already available. It is so due to the fact that the latter is still not supported by all other dependencies. Especially Jest support for Babel@7 is not complete.\n\nHere is a command to execute in order to install Babel:\n\n```bash\nyarn add --dev babel-core babel-cli babel-preset-env babel-plugin-transform-object-rest-spread\n```\n\nShort explanation:\n\n- `babel-preset-env` - a starting point for all Babel custom presets (instructions what should be transpiled and how)\n- `babel-plugin-transform-object-rest-spread` - if you use spread operator anywhere you will need this one\n\nFinally an example of **.babelrc** file:\n\n```js\n{\n  // ensures most commonly used transpilations e.g. import\n  \"presets\": [\"env\"],\n  // some additional plugins: Flow and Rewire (described in the Jest section)\n  \"plugins\": [\"transform-flow-strip-types\", \"babel-plugin-rewire\"]\n}\n```\n\nIt will only be used for tests. You won't need it during build process because it will be handled by a [Rollup](#rollup).\n\n\n![jest](img/jest.jpg)\n## Jest\n\nNext important package after Babel transpiler is Jest. Facebook alternative to the well known Mocha test runner. Here is an installation command:\n\n```bash\nyarn add --dev jest babel-jest babel-plugin-rewire\n```\n\nFirst two packages are more or less self-explanatory but the last one `babel-plugin-rewire` is in my opinion particularly useful. It let's you [test even non-exported functions](https://github.com/speedskater/babel-plugin-rewire) by getting their definitions through `__get__` method.\n\nAs usual you will require some configuration file, which is named **jest.config.js**. It might be auto-generated with:\n\n```bash\nyarn jest --init\n```\n\nFor start I would suggest you to leave **jest.config.js** without any changes as it should work in most cases.\n\n\n![flow](img/flow.jpg)\n## Flow\n\nType checking the Facebook way. As for React based development Flow seems to me as more natural choice than Typescript, I've decided to use it also for my non-React projects.\n\n```bash\nyarn add --dev flow-bin flow-typed babel-plugin-transform-flow-strip-types\n```\n\n- `flow-typed` is a library with typings (something similar to Typescript DefinitelyTyped)\n- `babel-plugin-transform-flow-strip-types` allows for using flow with Babel transpiler by stripping flow annotations when necessary\n\nFlow default configuration available in **.flowconfig** should match your base requirements.\n\nAfter all packages are in installed with Yarn execute `yarn flow-typed install` to get most recent types definitions.\n\n\n![eslint](img/eslint.jpg)\n## ESLint\n\nHaving some linter is always a good idea so I've decided to go with probably most popular one which is ESLint. Just execute:\n\n```bash\nyarn add --dev eslint eslint-config-airbnb-base eslint-plugin-flowtype eslint-plugin-jest babel-eslint eslint-plugin-import\n```\n\nAs you can see we have to install a plugin for every package used in development: Flow, Jest and Babel to prevent false positives. As it is a description of creating non-React package you should probably use `eslint-config-airbnb-base` instead of `eslint-config-airbnb` for base of your linting rules.\nWhat is more `eslint-plugin-import` package is required to support ES6 import statements.\n\nESLint configuration is stored in **.eslintrc**:\n\n```javascript\n{\n  \"extends\": [\n    \"airbnb-base\",\n    \"plugin:jest/recommended\",\n    \"plugin:flowtype/recommended\",\n  ],\n  \"plugins\": [\n    \"jest\",\n    \"flowtype\",\n  ],\n  \"rules\": {\n    // special case for rewire __get__\n    \"no-underscore-dangle\": [\"error\", { \"allow\": [\"__get__\"] }]\n  },\n}\n```\n\n\n![travisci](img/travisci.jpg)\n## Travis CI\n\nContinuous integration is a nice and useful addition to every publicly available project. In order to use Travis CI you only have to register with your Github account on [Travis CI](https://travis-ci.org/), which is FREE for every open-source project. After registration you should select your repository and activate it (which is fairly simple and intuitive).\n\nIn order to make continuous integration work just add a file **.travis.yml** to the root folder of your project. It should have a content similar to the one presented below:\n\n```yml\nlanguage: node_js\nnode_js:\n  - '8'\nscript:\n  - yarn test\n  - yarn build\ninstall:\n  - yarn install\nbranches:\n  only:\n    - master\n```\n\nThis file tell Travis to:\n- use language `node_js`\n- in version `8` (it will be selected with `nvm` by Travis)\n- `yarn install` packages (with Yarn - instead of default NPM installation)\n- run scripts `yarn test` and `yarn build` - they will determine the process output, if any of them fails entire building result will be negative\n- and use only `master` branch of your repo\n\nOne thing worth noting during package configuration is a behaviour of `prepublish` hook which you may be tempted to implement in **package.json** file. It might be not so obvious that `prepublish` scripts will be run **also** after initial installation, not only before package publishing. You would probably like to use `prepublishOnly` instead of `prepublish`.\n\n\n![rollup](img/rollup.jpg)\n## Rollup\n\nFinally, one of the least known packages. Rollup, a package building tool without complicated configuration. Here is a command to install Rollup and all recommended plugins:\n\n```bash\nyarn add --dev rollup rollup-plugin-babel@3 rollup-plugin-flow rollup-plugin-cpy babel-plugin-external-helpers\n```\n\nAfter finishing installation create one fairly simple **rollup.config.js** file. Here is a commented example:\n\n```js\n// plugins that we are going to use\nimport babel from 'rollup-plugin-babel';\nimport copy from 'rollup-plugin-cpy';\nimport flow from 'rollup-plugin-flow';\n\n// list of plugins used during building process\nconst plugins = targets => ([\n  // remove flow annotations from output\n  flow(),\n  // use Babel to transpile to ES5\n  babel({\n    // ignore node_modules/ in transpilation process\n    exclude: 'node_modules/**',\n    // ignore .babelrc (if defined) and use options defined here\n    babelrc: false,\n    // use recommended babel-preset-env without es modules enabled\n    // and with possibility to set custom targets e.g. { node: '8' }\n    presets: [['env', { modules: false, targets }]],\n    // solve a problem with spread operator transpilation https://github.com/rollup/rollup/issues/281\n    plugins: ['babel-plugin-transform-object-rest-spread'],\n    // removes comments from output\n    comments: false,\n  }),\n  // copy Flow definitions from source to destination directory\n  copy({\n    files: ['src/*.flow'],\n    dest: 'lib',\n  }),\n]);\n\n// packages that should be treated as external dependencies, not bundled\nconst external = []; // e.g. ['axios']\n\nexport default [{\n  // source file / entrypoint\n  input: 'src/index.js',\n  // output configuration\n  output: {\n    // name visible for other scripts\n    name: 'npmLibPackageExample',\n    // output file location\n    file: 'lib/index.esm.js',\n    // format of generated JS file, also: esm, and others are available\n    format: 'esm',\n    // add sourcemaps\n    sourcemap: true,\n  },\n  external,\n  // build es modules for node 8\n  plugins: plugins({ node: '8' }),\n}, {\n  input: 'src/index.js',\n  output: {\n    name: 'npmLibPackageExample',\n    file: 'lib/index.js',\n    format: 'cjs',\n    sourcemap: true,\n  },\n  external,\n  // build common JS for node 6\n  plugins: plugins({ node: '6' }),\n}];\n```\n\nSome more or less important findings are:\n\n- use `rollup-plugin-cpy` instead of `rollup-plugin-copy` in order to avoid [non-existing output directory problem](https://github.com/meuter/rollup-plugin-copy/issues/7)\n- `rollup-plugin-babel@3` you may use version 4 if you upgrade Babel to version 7\n- as you may noticed as a result of this Rollup configuration you will get two files: [ES module standard and CommonJS one](https://github.com/rollup/rollup/wiki/pkg.module)\n\n\n## Scripts\n\nCustom scripts defined inside **package.json** which are used during development and publishing. Here is a list:\n\n- `\"clean\": \"rimraf lib\"` - remove `lib/` directory with build results\n- `\"test\": \"yarn jest src\"` - run tests defined inside `src/` directory with Jest\n- `\"test:watch\": \"yarn jest src --watch --notify\"` - run tests and watch for changes as well as display notifications with results\n- `\"cover\": \"jest src --coverage\"` - generate test coverage report\n- `\"lint\": \"eslint src\"` - run linting with ESLint\n- `\"build\": \"yarn rollup -c\"` - build output using Rollup\n- `\"precommit\": \"yarn flow src && yarn lint && yarn test\"` - run before each commit to ensure commited code quality\n- `\"prepublishOnly\": \"yarn clean && yarn lint && yarn test && yarn build\"` - run [ONLY before](https://docs.npmjs.com/misc/scripts) `yarn publish` to ensure quality and most recent output\n\n\n## Other tools and files\n\nList of useful tools/files:\n\n- `rimraf` - cross-platform directory cleaning\n- `husky` - additional Git hooks e.g. testing code just before making a commit\n- `.editorconfig` - recommended editor configuration\n- `.npmignore` - list of ignored files/dirs when publishing to NPM registry\n- `LICENSE` - info about license e.g. [MIT](https://en.wikipedia.org/wiki/MIT_License)\n\nAnother important thing is last part of **package.json** file:\n\n```json\n  \"husky\": {\n    \"hooks\": {\n      \"pre-commit\": \"yarn precommit\"\n    }\n  }\n```\n\nThese are lines which actually trigger `yarn precommit` before each Git commit thanks to [husky](https://github.com/typicode/husky) provided hooks.\n\nYou will find all files/tools listed above in my [boilerplate project on Github](https://github.com/jmarceli/npm-lib-package-boilerplate) or [on NPM](https://www.npmjs.com/package/npm-lib-package-boilerplate)\n\n\n## Sources\n\n- https://codeburst.io/publish-your-own-npm-package-ff918698d450 - great article with slightly different setup\n- https://github.com/rollup/rollup/wiki/pkg.module - ES module, CommonJS and others explained\n- https://github.com/rollup/rollup/issues/281 - Rollup spread operator transpilation\n- https://github.com/rollup/rollup-plugin-babel#configuring-babel\n- https://github.com/meuter/rollup-plugin-copy/issues/7 - rollup-plugin-copy problem\n","excerpt":"Here is a description of common tools and files used to create a modern NPM package. Don't hesitate to clone my npm-lib-package-boilerplateâ€¦","frontmatter":{"title":"Publishing NPM package with Rollup, Babel, Flow, Jest and ESLint","slug":"publishing-npm-package-with-rollup-babel-and","date":"2018-10-01T02:57:00.000Z","tags":["javascript"],"date_created":"2018-11-05T01:31:45.000Z","date_updated":"2018-10-02T21:48:08.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1520038410233-7141be7e6f97.jpg","relativePath":"posts/img/photo-1520038410233-7141be7e6f97.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABtpsLZdyeF//EABoQAAIDAQEAAAAAAAAAAAAAAAABAgMREjH/2gAIAQEAAQUCJTmr+kJlvu4f/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/AYx//8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAECAQE/Aa1//8QAGBAAAgMAAAAAAAAAAAAAAAAAABESIEH/2gAIAQEABj8CNgq//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERQRAhUWH/2gAIAQEAAT8hRAVLkrPXDB7ooSP/2gAMAwEAAgADAAAAEAc//8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAwEBPxAa9kbf/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAgEBPxBYchX/xAAcEAEAAwACAwAAAAAAAAAAAAABABExIUGBofD/2gAIAQEAAT8QrUABqg1579UWBQKXT1ETPcVIXiByjdn/2Q==","aspectRatio":2,"src":"/static/53c3d1dd50f0e922033c3793e452e77e/0defe/photo-1520038410233-7141be7e6f97.jpg","srcSet":"/static/53c3d1dd50f0e922033c3793e452e77e/38b6a/photo-1520038410233-7141be7e6f97.jpg 150w,\n/static/53c3d1dd50f0e922033c3793e452e77e/e201c/photo-1520038410233-7141be7e6f97.jpg 300w,\n/static/53c3d1dd50f0e922033c3793e452e77e/0defe/photo-1520038410233-7141be7e6f97.jpg 600w,\n/static/53c3d1dd50f0e922033c3793e452e77e/a71f1/photo-1520038410233-7141be7e6f97.jpg 900w,\n/static/53c3d1dd50f0e922033c3793e452e77e/8d595/photo-1520038410233-7141be7e6f97.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"6e5b33a1-0893-5af0-99b7-17841b60e075","html":"<p>InfluxDB turns out to be a good solution for a time series data which happens to be the cornerstone of my current job. As (probably) every database it has it's pros and cons, but the most annoying thing for me as a developer was lack of a proper administration tool to work with.\nUntil now...\n<br/></p>\n<div style=\"text-align: center\">\n    <a href=\"https://timeseriesadmin.github.io/\" style=\"box-shadow: none; display: inline-block; border: none;\">\n      <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 128px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADNUlEQVQ4y31US08UQRAeTDxwIAZ57AvY7hqUh4hRgfBUEAQVBHmDi254CKIGr/4A7yTcvXLgZuJv8aIYvfAfZHa6rK+ne10S4yZfpqd26ut6fFUBEQX44am1vuTOl+W8LDgW/BCcCyLBT8GJoCDfVONbpdQlzyH2oEyWyWS8cVbwVWwMyPkCKuzfBauB+8m56l9kH8sORJGmUECxwDjE1pZE64kPPamN1KcJsjAMWYmTyudLKpM2qrHBqGzGqFw2QVpsKbHlckYrVZILSvAR3yOXflU5TdwmhlgIYn29jenBpKHZRUNzK0wL64I1ptklppkFo/uHjHzLIFZal8Ik0kJQ0QBbM0QGp3D3wNDMvKHxKdYjo6wHhlgPDrO+P8408ZhpeYPDvfdGDwyzam5CpCD8JahBdMvU2soqnYpoctpQcdeoKzVIly1yWVZNTQkyaVYN9azqr7JqaeHw4IPRHZ04R5Skvg3CY7yoluZId3Ub2txHdKzv9rLu7GKbGsiam1nDqfsW6/5hpuebTIvrRrIyaJJr0OfA6QxdjVWTFFuc6NFTpo1tpnVxKshzrejOWwmRvOuhe6ghO8LYyepb4ESb/NHWjhslpTqbnkiEddfNJCqg84ZNVaUbbdpongSABhlH+DuwmkJDEF3fgKGtN9bZEqN+vma4JNWYpA7n0Qmml69waSXheeDGCS+xdMzowRGm4h7T5mumeZHKk7m/mJ5nWpEOb7+V5wsfcWXKpyA8cQWNRFOJmKUJur3D1snKBDWdmoE2Wff0sW69lkSbydgJkgh9U74EdtDR5VwusimLcEXciQNkg1TragWSdkNd2S71htiNJc/nIzcx+yCsdoOOTpdoqcBWOs9WGOnr2z2s73j0Mo1N2nTDnXeGxh6ipl7YZ4JaP3qrNkqZT8yw6BFTYRCBlU9xNwGkMz2PCbHysnMupXLR7QR+nznSQ/uHRIlbVTZrayQpJmgUpFN+WdjLsZEc2Sdw5PP5qsAvR0d65EjlI6wvQRjG0JpDbG1ufVWSub1QdXE5JucCBv1/C9YRnZXTrOTwaxuR+n2GrYFBx2xinDABbqJOIQ100zcAafrIwPUH1TPgnCdbUBEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Time Series Admin logo - administrator UI for InfluxDB\" title=\"Time Series Admin logo - administrator UI for InfluxDB\" src=\"/static/b62767277a93d049123dd9e282c27923/81a47/timeseries-admin-icon.png\" srcset=\"/static/b62767277a93d049123dd9e282c27923/81a47/timeseries-admin-icon.png 128w\" sizes=\"(max-width: 128px) 100vw, 128px\">\n    </span>\n      <h3 style=\"margin-top:20px\">Time Series Admin</h3>\n    </a>\n</div>\n<h2>Quick start</h2>\n<p>Here it is <a href=\"https://timeseriesadmin.github.io/\">Time Series Admin</a>, which you may <a href=\"https://timeseriesadmin.github.io/#download\">download</a> as an Electron application. It is built as an alternative to <a href=\"https://docs.influxdata.com/influxdb/v1.3/administration/differences/#web-admin-ui-removal\">deprecated Admin UI</a> or current <a href=\"https://docs.influxdata.com/chronograf/v1.6/\">Chronograf</a> based approach.</p>\n<p>It is tested to be compatible with:</p>\n<ul>\n<li>Windows 10 x64</li>\n<li>Ubuntu 18.04</li>\n<li>Mac OS X 10.13</li>\n</ul>\n<p>It should also work with other versions of popular OSes, but this is not yet verified (a feedback will be appreciated).</p>\n<p>In order to ensure a fallback for non-supported OSes and for demo purposes there is also an <a href=\"https://hub.docker.com/r/timeseriesadmin/timeseriesadmin/\">Time Series Admin Docker image</a>.\nYou may run it on (probably) any OS and use through some recent version of Google Chrome browser.\nEverything you need to get it working is a <a href=\"https://www.docker.com/get-started\">Docker installed</a> on your system and a command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">docker run -p <span class=\"token number\">8085</span>:80 -it timeseriesadmin/timeseriesadmin:latest</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>After executing command above visit <a href=\"http://localhost:8085\">http://localhost:8085</a>.</p>\n<h2>Why</h2>\n<p>I know that there is <a href=\"https://grafana.com/\">Grafana</a> and Chronograf, but while these tools are great for plotting and presenting data they are not so convenient to explore and work with raw queries during development phase.\nHere are some reasons which justifies existence of Time Series Admin as an administrator UI for InfluxDB:</p>\n<ul>\n<li>no need for server to run you administrator UI</li>\n<li>you are always one click away from any of your InfluxDB servers (easy access to any of saved connections)</li>\n<li>query history (this is something I was missing most in any other InfluxDB UI)</li>\n<li>ability to browse through Influx structure without worrying about queries</li>\n<li>viewing raw query results</li>\n<li>formatting returned data timestamps</li>\n</ul>\n<h2>Overview</h2>\n<p>General idea was to create a tool (admin UI) which will work through InfluxDB HTTP API allowing for easy query execution and database management/exploration.</p>\n<p>Time Series Admin is aimed primarily at developers/users who have at least base knowledge about <a href=\"https://docs.influxdata.com/influxdb/v1.6/query_language/\">InfluxQL</a>.\nThanks to the \"Explorer\" panel even without any knowledge you may reason about database internals in a human friendly way.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.60176991150442%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACbUlEQVQ4y22SPVMaURSGt82YGR1QaDRF9ifkD6SLmUmVmTS0ETWCBQOMTGZIj9kqdZr8gdili41FChCFkgh+ACts5GMXlt297L0n59ywKtE783K4X895z9mrbL17qyaSG9peLqfl9nJaKpXSkomktpvcvdX21ra282FH24xvagffDzTLtLR2q6W1mi3tWr8mfW632l/Ofp+9UGKx2JuPn/Kwv78PhUIB8vk8pNNpyGaykMlkIJvNAiaRisfjcHR0BDSEEPD/aDQaCaVSrb7yXJf7vs+m0ynD9QdiuGeORmxkTxgeYka3y4amyTyPBWdcAtbr9fdKsVhcN00TLMsSJM/zpFzXFZhIOChgngDuC/AZRi4mjiMMwxAIJ59oVvgzYFw5OTlZZ5gIFYAgEMIAqfBr7MHXzhC+GRY0mU8IMIw/MJUGgWq/A56ens4BsWzA8qUY/Udo1bLhx3ACP0ceGATEvf5gANgKos0DyaHjOGDbtsBI9mXDOedS1CbhOgDUXn8KMFvv9XqyigcOj4+PpUPaQFdiPB4DJQigMuIVH3/IkT9bu7npwdieUEvxHr8DlsvldSxVAqnsfr8PBA2eBonacN81qWv0wLI9rIBjq/x5hzNHHIF8MBhwLJ8jhJ7SrWgEkfbxK3N7MuFsyrhPGf8BN5RKpfL6/uOkvjz2aO8Puu88cu7i4mJLOTw8fHl1ddXBjHq73dZrtZp+fn6u07zb7c6p0+nIeHl5qeNlvdlsyjmebaGGpVIppiwtLT0Jh8PPI5GIilFdWFhQFxcX1ZWVlVvRXiCaR6NR9dnamrq6uirny8vLMoZCoad/AU9JYtF5uGvWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Time Series Admin - browse through InfluxDB database\"\n        title=\"Time Series Admin - browse through InfluxDB database\"\n        src=\"/static/c1a0cd3a957efea5d6b04d866f53ef61/a3419/timeseriesadmin--panel-explorer.png\"\n        srcset=\"/static/c1a0cd3a957efea5d6b04d866f53ef61/a1986/timeseriesadmin--panel-explorer.png 210w,\n/static/c1a0cd3a957efea5d6b04d866f53ef61/ad7fb/timeseriesadmin--panel-explorer.png 420w,\n/static/c1a0cd3a957efea5d6b04d866f53ef61/a3419/timeseriesadmin--panel-explorer.png 840w,\n/static/c1a0cd3a957efea5d6b04d866f53ef61/822a4/timeseriesadmin--panel-explorer.png 1130w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n    </span></p>\n<h2>Features</h2>\n<p>Most of the features are illustrated on the official Time Series Admin project page in <a href=\"https://timeseriesadmin.github.io/#showcase\">showcase</a> section.\nSome of them are extremely helpful (like query history) and others are more or less irrelevant (references panel - at least in current version). Anyway here they are:</p>\n<ul>\n<li>query history</li>\n<li>results browsing, pagination, sorting</li>\n<li>time formatting</li>\n<li>connection credentials list (saving, loading and deleting them)</li>\n<li>server exploration (through the Explorer panel)</li>\n<li>detailed error reporting</li>\n<li>flexible window size</li>\n<li>query reference</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.526361279170274%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACEUlEQVQ4y62Tu24TURCGt+QFeICQN6HBQlRINK6QsOIIBxEXNo4ETlpbB1PAK/ACiAjRure06wegcLB3vd6LL3u/Df+cXTtKGgoY6ffMufg7M3POKicvnh+33jQ+vutdiF63J87fnovW65Y4a50d1Dxpisarhjhtnoqryyth6IYwDEPMf8/F0ljyeKgv9M83s5uXSr1ef3bx4T0Nh0MaDAbU7/ep0+lQt9s9+L3a7TaNRiO6b0VRSO84zlhRNe2Jbdv5brdL4jhOMC+VZVnium7Cluf5HfHezWaTRFEkFYRhxEDMf1Mmk0kNAQFWYLEIw1Bqu90W6/Vaxr7vH8ae5xWAyTHgnBorYyDmryUwCAKCJBBghhMSK4UY82S7azItm7aex5mQ7TjSp2lKAGdVhiUQpzG9YChD9tC9siQmylPkkqMZMVm2TaZp0mq1kkLvsqqH14qqqjU+BSqqsmmvEMqgeRDRF9OjT3OXfmwicgHRdZ04kWqvBAJeAjmrqlzuC5dAuBTp8UNempEapDTxE/oVJuSjbIZlvF7abcmaptW4LG48XwA/Ac6YPc9zTPwsZJvg00Su7Z9KFUsgDrkFIiM+LmcDJMemnF8M+lr6KMpT7IniWK7dU1Ld8ndlOp0+pf9kqPKnMh6PHy8WCwuf0hKNXsKbfxM+hDuyLEvHDfuz2eyrAnsAHUGP/kH8/2Po4R9uiGKT1RH5AgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Time Series Admin - query history\"\n        title=\"Time Series Admin - query history\"\n        src=\"/static/9708b9a911c7742848c582e1909e9ae1/a3419/timeseriesadmin--panel-history.png\"\n        srcset=\"/static/9708b9a911c7742848c582e1909e9ae1/a1986/timeseriesadmin--panel-history.png 210w,\n/static/9708b9a911c7742848c582e1909e9ae1/ad7fb/timeseriesadmin--panel-history.png 420w,\n/static/9708b9a911c7742848c582e1909e9ae1/a3419/timeseriesadmin--panel-history.png 840w,\n/static/9708b9a911c7742848c582e1909e9ae1/e1c78/timeseriesadmin--panel-history.png 1157w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n    </span></p>\n<h2>Further development - wish list of features</h2>\n<p>While Time Series Admin is a usable and fully functional tool there are some improvemenets that are currently in backlog and hopefully will be available in future versions:</p>\n<ul>\n<li>writing data directly from UI</li>\n<li>import/export data (e.g. in CSV format)</li>\n<li>query editor (with some kind of suggestions and autocorrection, maybe a query wizzard)</li>\n<li>users administration UI</li>\n<li>retention policy UI</li>\n<li>automatic/easy application updates</li>\n<li>more UI buttons in Explorer (e.g. drop measurement, preview data, count series etc.</li>\n<li>copy measurement data feature (through <code class=\"language-text\">SELECT ... INTO ...</code> query)</li>\n<li>connection params validation autocorrection (e.g. missing port number or invalid URL)</li>\n</ul>\n<p>If you have any other ideas or feature request please let me know by creating an issue in the <a href=\"https://github.com/timeseriesadmin/timeseriesadmin/issues/new\">project Github repository</a>.</p>\n<h2>Summary</h2>\n<p>You are welcome to go and <a href=\"https://timeseriesadmin.github.io/#download\">try Time Series Admin</a>.\nAs usually it is an open source project <a href=\"https://github.com/timeseriesadmin/timeseriesadmin\">hosted on Github</a> with MIT license.\nIf you find any issues during usage please report them directly on Github.</p>\n<p>Of course you are more than welcome to contribute, more details about that should be available in repository files.</p>","timeToRead":3,"rawMarkdownBody":"\nInfluxDB turns out to be a good solution for a time series data which happens to be the cornerstone of my current job. As (probably) every database it has it's pros and cons, but the most annoying thing for me as a developer was lack of a proper administration tool to work with.\nUntil now...\n<br/>\n\n<div style=\"text-align: center\">\n    <a href=\"https://timeseriesadmin.github.io/\" style=\"box-shadow: none; display: inline-block; border: none;\">\n      <img src=\"./img/timeseries-admin-icon.png\" alt=\"Time Series Admin logo - administrator UI for InfluxDB\" />\n      <h3 style=\"margin-top:20px\">Time Series Admin</h3>\n    </a>\n</div>\n\n## Quick start\n\nHere it is [Time Series Admin](https://timeseriesadmin.github.io/), which you may [download](https://timeseriesadmin.github.io/#download) as an Electron application. It is built as an alternative to [deprecated Admin UI](https://docs.influxdata.com/influxdb/v1.3/administration/differences/#web-admin-ui-removal) or current [Chronograf](https://docs.influxdata.com/chronograf/v1.6/) based approach.\n\nIt is tested to be compatible with:\n\n- Windows 10 x64\n- Ubuntu 18.04\n- Mac OS X 10.13\n\nIt should also work with other versions of popular OSes, but this is not yet verified (a feedback will be appreciated).\n\nIn order to ensure a fallback for non-supported OSes and for demo purposes there is also an [Time Series Admin Docker image](https://hub.docker.com/r/timeseriesadmin/timeseriesadmin/).\nYou may run it on (probably) any OS and use through some recent version of Google Chrome browser.\nEverything you need to get it working is a [Docker installed](https://www.docker.com/get-started) on your system and a command:\n\n```bash\ndocker run -p 8085:80 -it timeseriesadmin/timeseriesadmin:latest\n```\n\nAfter executing command above visit [http://localhost:8085](http://localhost:8085).\n\n## Why\n\nI know that there is [Grafana](https://grafana.com/) and Chronograf, but while these tools are great for plotting and presenting data they are not so convenient to explore and work with raw queries during development phase.\nHere are some reasons which justifies existence of Time Series Admin as an administrator UI for InfluxDB:\n\n- no need for server to run you administrator UI\n- you are always one click away from any of your InfluxDB servers (easy access to any of saved connections)\n- query history (this is something I was missing most in any other InfluxDB UI)\n- ability to browse through Influx structure without worrying about queries\n- viewing raw query results\n- formatting returned data timestamps\n\n## Overview\n\nGeneral idea was to create a tool (admin UI) which will work through InfluxDB HTTP API allowing for easy query execution and database management/exploration.\n\nTime Series Admin is aimed primarily at developers/users who have at least base knowledge about [InfluxQL](https://docs.influxdata.com/influxdb/v1.6/query_language/).\nThanks to the \"Explorer\" panel even without any knowledge you may reason about database internals in a human friendly way.\n\n![Time Series Admin - browse through InfluxDB database](img/timeseriesadmin--panel-explorer.png)\n\n## Features\n\nMost of the features are illustrated on the official Time Series Admin project page in [showcase](https://timeseriesadmin.github.io/#showcase) section.\nSome of them are extremely helpful (like query history) and others are more or less irrelevant (references panel - at least in current version). Anyway here they are:\n\n- query history\n- results browsing, pagination, sorting\n- time formatting\n- connection credentials list (saving, loading and deleting them)\n- server exploration (through the Explorer panel)\n- detailed error reporting\n- flexible window size\n- query reference\n\n![Time Series Admin - query history](img/timeseriesadmin--panel-history.png)\n\n## Further development - wish list of features\n\nWhile Time Series Admin is a usable and fully functional tool there are some improvemenets that are currently in backlog and hopefully will be available in future versions:\n\n- writing data directly from UI\n- import/export data (e.g. in CSV format)\n- query editor (with some kind of suggestions and autocorrection, maybe a query wizzard)\n- users administration UI\n- retention policy UI\n- automatic/easy application updates\n- more UI buttons in Explorer (e.g. drop measurement, preview data, count series etc.\n- copy measurement data feature (through `SELECT ... INTO ...` query)\n- connection params validation autocorrection (e.g. missing port number or invalid URL)\n\nIf you have any other ideas or feature request please let me know by creating an issue in the [project Github repository](https://github.com/timeseriesadmin/timeseriesadmin/issues/new).\n\n## Summary\n\nYou are welcome to go and [try Time Series Admin](https://timeseriesadmin.github.io/#download).\nAs usually it is an open source project [hosted on Github](https://github.com/timeseriesadmin/timeseriesadmin) with MIT license.\nIf you find any issues during usage please report them directly on Github.\n\nOf course you are more than welcome to contribute, more details about that should be available in repository files.\n","excerpt":"InfluxDB turns out to be a good solution for a time series data which happens to be the cornerstone of my current job. As (probably) everyâ€¦","frontmatter":{"title":"Time Series Admin - Electron-based alternative to Admin UI for InfluxDB","slug":"time-series-admin-electron-application-influxdb","date":"2018-10-14T06:44:00.000Z","tags":["javascript","tools"],"date_created":"2018-11-04T18:31:42.000Z","date_updated":"2018-10-20T17:40:52.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1504639725590-34d0984388bd.jpg","relativePath":"posts/img/photo-1504639725590-34d0984388bd.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgMF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAeU0vdnIgH//xAAaEAACAgMAAAAAAAAAAAAAAAAAAQISESEx/9oACAEBAAEFAl1syJxL6sj/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAACAwEAAAAAAAAAAAAAAAAAEQEQIjH/2gAIAQEABj8CMwoR2k6//8QAHRAAAwABBQEAAAAAAAAAAAAAAAERMVFhcZGh8P/aAAgBAQABPyGsBTTbt56XqKszsawyRcnzWf/aAAwDAQACAAMAAAAQ2+//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QhX//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCn/8QAHRABAAICAgMAAAAAAAAAAAAAAREhADFBUXHR8P/aAAgBAQABPxDS3uLMDhTuSvNMFmUvvLyKmoF6yPNQAaeaxHlfjrP/2Q==","aspectRatio":2,"src":"/static/64e6b6511ddfd7fea6aac62db0ec7ece/0defe/photo-1504639725590-34d0984388bd.jpg","srcSet":"/static/64e6b6511ddfd7fea6aac62db0ec7ece/38b6a/photo-1504639725590-34d0984388bd.jpg 150w,\n/static/64e6b6511ddfd7fea6aac62db0ec7ece/e201c/photo-1504639725590-34d0984388bd.jpg 300w,\n/static/64e6b6511ddfd7fea6aac62db0ec7ece/0defe/photo-1504639725590-34d0984388bd.jpg 600w,\n/static/64e6b6511ddfd7fea6aac62db0ec7ece/a71f1/photo-1504639725590-34d0984388bd.jpg 900w,\n/static/64e6b6511ddfd7fea6aac62db0ec7ece/8d595/photo-1504639725590-34d0984388bd.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"b1fbb88b-acde-56d7-986f-daf1adac67db","html":"<p>Type checking with Flow is a nice addition to your code. Unfortunately, it is not so intuitive to use Flow with libraries like Axios. The main problem is lack of easily available usage examples.</p>\n<h2>Problem</h2>\n<p>Using Axios type annotations <code class=\"language-text\">$AxiosXHR</code> and <code class=\"language-text\">$AxiosXHRConfig</code> may result in error messages similar to this:</p>\n<blockquote>\n<p>Cannot call resolve with result bound to result because string [1] is incompatible with object type [2] in type argument T [3]</p>\n</blockquote>\n<p>or this:</p>\n<blockquote>\n<p>Cannot call resolve with result bound to result because object type [1] is incompatible with string [2] in type argument R [3].</p>\n</blockquote>\n<p>What are <code class=\"language-text\">T</code> and <code class=\"language-text\">R</code> and how to fix that?</p>\n<h2>Solution</h2>\n<p>If you would like to find out the answer yourself you will have to read the source code of Axios Flow implementation. The code is not so complicated if you have some experience with Flow types, but for newcomers it looks cryptic (at best).</p>\n<p>Moving forward...</p>\n<p><code class=\"language-text\">$AxiosXHR</code> is defined as <code class=\"language-text\">$AxiosXHR&lt;T, R=T&gt;</code> which means that we have to provide at least one argument <code class=\"language-text\">T</code> and optionally another <code class=\"language-text\">R</code>.</p>\n<ul>\n<li><code class=\"language-text\">T</code> - input data <strong>T</strong>ype, should be a type of <code class=\"language-text\">data</code> parameter in your Axios request</li>\n<li><code class=\"language-text\">R</code> - <strong>R</strong>esponse type, should define expected type for a response</li>\n</ul>\n<p>As you may noticed <code class=\"language-text\">R</code> is optional and equals <code class=\"language-text\">T</code> by default which is useful especially when dealing with no request data (e.g. all <code class=\"language-text\">GET</code> queries) or no response data (e.g. <code class=\"language-text\">POST</code> query with just <code class=\"language-text\">200 OK</code> as a response).</p>\n<h2>Example</h2>\n<p>As usual we have to begin with <code class=\"language-text\">// @flow</code> declaration, import of Axios library and appropriate type definitions:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">// @flow</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> type <span class=\"token punctuation\">{</span> $AxiosXHR <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Let's define expected Axios response structure type:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> type RateLimit <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  limit<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">,</span>\n  remaining<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">,</span>\n  reset<span class=\"token punctuation\">:</span> number\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\ntype RateLimitResponse <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  resources<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    core<span class=\"token punctuation\">:</span> RateLimit<span class=\"token punctuation\">,</span>\n    search<span class=\"token punctuation\">:</span> RateLimit<span class=\"token punctuation\">,</span>\n    graphql<span class=\"token punctuation\">:</span> RateLimit<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  rate<span class=\"token punctuation\">:</span> RateLimit<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now it's time for a \"magical\" <code class=\"language-text\">$AxiosXHR</code> type annotation:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> getRateLimit <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Promise<span class=\"token operator\">&lt;</span>$AxiosXHR<span class=\"token operator\">&lt;</span>RateLimitResponse<span class=\"token operator\">>></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token function\">axios</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://api.github.com/rate_limit</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>We know that Github API endpoint <code class=\"language-text\">/rate_limit</code> is going to return something which should match <code class=\"language-text\">RateLimitResponse</code>. As we don't have any input data type there is no need to define more than one <code class=\"language-text\">$AxiosXHR</code> parameter (<code class=\"language-text\">R</code> equals <code class=\"language-text\">T</code>  by default).</p>\n<p>What is more, we know that <code class=\"language-text\">async</code> function should return a promise, thus we wrap returned type with <code class=\"language-text\">Promise&lt;....&gt;</code>.</p>\n<p>Now we can use Axios with Flow typings.</p>\n<p><strong>NOTE</strong>\nAs mentioned by @Joey M. you may replace:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">Promise<span class=\"token operator\">&lt;</span>$AxiosXHR<span class=\"token operator\">&lt;</span>RateLimitResponse<span class=\"token operator\">>></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>with</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">AxiosPromise<span class=\"token operator\">&lt;</span>RateLimitResponse<span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>It's a hand wrapper which simplifies typings a bit. Of course it has to be imported before usage: <code class=\"language-text\">import type { AxiosPromise } from &#39;axios&#39;;</code></p>\n<h2>Another example</h2>\n<p>Let say we have an API endpoint <code class=\"language-text\">http://your-api-enpoint.test</code> which will respond with string <code class=\"language-text\">OK</code> to every POST request with JSON <code class=\"language-text\">data</code> body: <code class=\"language-text\">{ getStatus: true }</code>.</p>\n<p>In this case Axios Flow typing for request is going to look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">type StatusRequest <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  getStatus<span class=\"token punctuation\">:</span> boolean\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> getStatus <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> AxiosPromise<span class=\"token operator\">&lt;</span>StatusRequest<span class=\"token punctuation\">,</span> string<span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token function\">axios</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    method<span class=\"token punctuation\">:</span> <span class=\"token string\">'post'</span><span class=\"token punctuation\">,</span>\n    data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> getStatus<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    url<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://your-api-enpoint.test'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>That's all?</p>\n<p>Unfortunately, I don't know yet if it is possible to add Flow typings without wrapping Axios call in a wrapper function.</p>\n<p>Ideally something like this might be possible:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> response<span class=\"token punctuation\">:</span> $AxiosXHR<span class=\"token operator\">&lt;</span>RateLimitResponse<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">axios</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://api.github.com/rate_limit</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","timeToRead":3,"rawMarkdownBody":"Type checking with Flow is a nice addition to your code. Unfortunately, it is not so intuitive to use Flow with libraries like Axios. The main problem is lack of easily available usage examples.\n\n## Problem\n\nUsing Axios type annotations `$AxiosXHR` and `$AxiosXHRConfig` may result in error messages similar to this:\n\n> Cannot call resolve with result bound to result because string [1] is incompatible with object type [2] in type argument T [3]\n\nor this:\n\n> Cannot call resolve with result bound to result because object type [1] is incompatible with string [2] in type argument R [3].\n\nWhat are `T` and `R` and how to fix that?\n\n## Solution\n\nIf you would like to find out the answer yourself you will have to read the source code of Axios Flow implementation. The code is not so complicated if you have some experience with Flow types, but for newcomers it looks cryptic (at best).\n\nMoving forward...\n\n`$AxiosXHR` is defined as `$AxiosXHR<T, R=T>` which means that we have to provide at least one argument `T` and optionally another `R`.\n\n- `T` - input data **T**ype, should be a type of `data` parameter in your Axios request\n- `R` - **R**esponse type, should define expected type for a response\n\nAs you may noticed `R` is optional and equals `T` by default which is useful especially when dealing with no request data (e.g. all `GET` queries) or no response data (e.g. `POST` query with just `200 OK` as a response).\n\n## Example\n\nAs usual we have to begin with `// @flow` declaration, import of Axios library and appropriate type definitions:\n\n```javascript\n// @flow\nimport axios from 'axios';\nimport type { $AxiosXHR } from 'axios';\n```\n\nLet's define expected Axios response structure type:\n\n```javascript\nexport type RateLimit = {\n  limit: number,\n  remaining: number,\n  reset: number\n};\ntype RateLimitResponse = {\n  resources: {\n    core: RateLimit,\n    search: RateLimit,\n    graphql: RateLimit,\n  },\n  rate: RateLimit,\n};\n```\n\nNow it's time for a \"magical\" `$AxiosXHR` type annotation:\n\n```javascript\nconst getRateLimit = async (): Promise<$AxiosXHR<RateLimitResponse>> => (\n  axios(`https://api.github.com/rate_limit`)\n);\n```\n\nWe know that Github API endpoint `/rate_limit` is going to return something which should match `RateLimitResponse`. As we don't have any input data type there is no need to define more than one `$AxiosXHR` parameter (`R` equals `T`  by default).\n\nWhat is more, we know that `async` function should return a promise, thus we wrap returned type with `Promise<....>`.\n\nNow we can use Axios with Flow typings.\n\n**NOTE**\nAs mentioned by @Joey M. you may replace:\n```javascript\nPromise<$AxiosXHR<RateLimitResponse>>\n```\nwith\n```javascript\nAxiosPromise<RateLimitResponse>\n```\nIt's a hand wrapper which simplifies typings a bit. Of course it has to be imported before usage: `import type { AxiosPromise } from 'axios';`\n\n## Another example\n\nLet say we have an API endpoint `http://your-api-enpoint.test` which will respond with string `OK` to every POST request with JSON `data` body: `{ getStatus: true }`.\n\nIn this case Axios Flow typing for request is going to look like this:\n\n```javascript\ntype StatusRequest = {\n  getStatus: boolean\n};\nconst getStatus = async (): AxiosPromise<StatusRequest, string> => (\n  axios({\n    method: 'post',\n    data: { getStatus: true },\n    url: 'http://your-api-enpoint.test',\n  })\n);\n```\n\nThat's all?\n\nUnfortunately, I don't know yet if it is possible to add Flow typings without wrapping Axios call in a wrapper function.\n\nIdeally something like this might be possible:\n\n```javascript\nconst response: $AxiosXHR<RateLimitResponse> = await axios(`https://api.github.com/rate_limit`);\n```\n\n\n","excerpt":"Type checking with Flow is a nice addition to your code. Unfortunately, it is not so intuitive to use Flow with libraries like Axios. Theâ€¦","frontmatter":{"title":"Flow type checking for Axios","slug":"flow-type-checking-for-axios","date":"2018-10-07T18:41:00.000Z","tags":["javascript"],"date_created":"2018-10-17T05:48:40.000Z","date_updated":"2018-11-08T00:24:46.000Z","author":"jan","feature_image":null}}},{"node":{"id":"8664a21a-d2ff-57c1-836b-d9c5581d7bca","html":"<p>The \"ugly\" 4 window view of the default <code class=\"language-text\">vimdiff</code> configuration can scare you out even if you were using Vim for a while. It's just too much information for most of the common merge cases.</p>\n<h2>Problem</h2>\n<p>How to configure <strong>vim</strong> or <strong>nvim</strong> with <strong>git</strong> to get a comfortable mergetool experience?</p>\n<p>Not 4 windows...\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/89222b274460cf86f70c9119d01b049e/462bf/screen-shot-2018-08-10-at-22.30.12.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.14642262895175%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACt0lEQVQoz5WR208TURCH9xkToi+8AAlC2V44u0uF7bZQoQUUIxcxUgnWlvul3XK/xYMIkVYrRBHECMHQFqRIu1ANiURM/Ks0ths442mN8cUXHr7M5PvNvMww7+cXLyd2V6dPDqOzpzEFH0fi+Dgcw1+iR/goruDIdgi/W3+L11Ze462NTby/F8Wf4kc4Hklg5cMh3t/ZxfuR3dm98M7UcnDpCmO1VCL8aAQCgWlYnJ+Hx6NBwEMBCM6tgHfuCbRNTEE7pUUeynB/fBz2liOQ8K/C4cIGRMfDsD8Rgi15HW5ItTxTikpQfd/AzyqP76x60KvaZZ963SOrrdMz6t3hEbVqUFbtXp9aIw+pNlpvD4+q3TNYvSV71SbfsNokT6rNvsmzhoGRHxrEc4wkSai6ri4lSBIYzRaShisTSX1jI7nZ0Ei4cjHjjJI501trakiLw0F018qIYKZOMhHeLAFnEpP5BQU8Y7ZYkGSpSGmKWdDqtERr0EGhphBsNdVgr7VDUXER6KjT6rVQxGqgzFQOTXea6MxV0Jfo056kM1bHJnPzcnnGZq9FM8Oe1HifGyb7PGSsexBGOvsBe0dhqk+GgTY3+Fw9MNY1CKPUT/f7Mll/mwu8zq70LJno8cCQuzdZijie0ZcIaPP5curz9hoorxSiBL6B8uwU4v6vcPD0BGK0pnslcArpLO4/hY/Up13sjyeJ4HeILhwnbWIdzwgGFvUurKa8bw6g92WIuF5sg/svS6F/PcX1f086lsPg9G8kDSYrz0hmM7JarSmEEAiCcM5xPLkg5zwvAOK4X/n5+TxTUVGJLBaLWqzRgFZLD8zS51wMQveAZdlkXi59itFoRM4H7akOtws6O9yEAheEdHd1guuhM1liMPDMpaysbINB3yyK5Q6TWH6P0npB6I7oMJnE5pycnOzfl3i/aPixbssAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4 windows vimdiff view\"\n        title=\"4 windows vimdiff view\"\n        src=\"/static/89222b274460cf86f70c9119d01b049e/a3419/screen-shot-2018-08-10-at-22.30.12.png\"\n        srcset=\"/static/89222b274460cf86f70c9119d01b049e/a1986/screen-shot-2018-08-10-at-22.30.12.png 210w,\n/static/89222b274460cf86f70c9119d01b049e/ad7fb/screen-shot-2018-08-10-at-22.30.12.png 420w,\n/static/89222b274460cf86f70c9119d01b049e/a3419/screen-shot-2018-08-10-at-22.30.12.png 840w,\n/static/89222b274460cf86f70c9119d01b049e/4d498/screen-shot-2018-08-10-at-22.30.12.png 1260w,\n/static/89222b274460cf86f70c9119d01b049e/70b58/screen-shot-2018-08-10-at-22.30.12.png 1680w,\n/static/89222b274460cf86f70c9119d01b049e/462bf/screen-shot-2018-08-10-at-22.30.12.png 2404w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<h2>Solution</h2>\n<p>Install <a href=\"https://github.com/tpope/vim-fugitive\">vim-fugitive</a> and use following configuration in your <code class=\"language-text\">~/.gitconfig</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">[mergetool &quot;nvim&quot;]\n  cmd = nvim -f -c \\&quot;Gdiff\\&quot; \\&quot;$MERGED\\&quot;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>It will give you a \"nice\" view with 3 windows horizontally splitted.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4d5a9da1b300ab345c93f5b613517897/462bf/screen-shot-2018-08-10-at-22.19.52.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.14642262895175%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACQ0lEQVQoz82Sy2sTQRzHc/JBaEmyj4Zk0ybpvDbEtITG0JTa1CARHwVxqwcPelCRKpKC7WEKHtSL1oPVIohFkzZ9iUgVCgX7ZykmQ7s/ZzZbC1I8e/jym539fj/zm0dgYXomtNR4Pbu1uzO3vfudf/qyw5tr21Lf+PrKOl9+s8YXn33g7+bf88ZinW9+3OTLq+u8sbLF642vvLnxmddXN+fqzY2Z5y9ehgPRRCp7vTgAC5MVeHXtHPBiFaZJBe5my3Bx/BI8vfMI5mv3oXZ5Cu6NTcGtyk1whs/D2ys1WLrxAJ4UHsLjgSmYzd2GEi7kAno8ni1o4Z+jwWN7I8HjYrTrhBjrPilK4W6RttMCXUgKOpEQPWVTGGcM0VOKioJpiKoZEdVYRIyHdFEJGXvlsPEjpRmnApYE9jO7nc5kIG1nXE/MdpGshBAXJbHb30dckqZSxGWIuYgxN0mpmyTUTTEpm0KKkVbMsnKBuAQSjNsUY5DVJZ0KlBAgSrQjTLAnNfb+KY+fodj7bkmWDySkTTom1RVgZaYUDsbEhx81jw8zRwDlFv974L6CKpMMSnkLyHM9lJo/8PgN7PvAX3+ACCHx12ry4KmsFBBGgAjyLkRV75L+1aFlWdl8Pt/OyGfD5HOwbSa3ZUM2h6FylsIwHoFi+jQM9Q5BobcAg2gQWIaBzWzl9zO2OopWLBbLBYLBYLekT5imOalp2lVd1x1N0x3DDDsIRZw+PeUkQgkn3hV3rC7LiYaijqZrjvL5UhmVnVCs35uXUYRHxd2fAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vim 3 window vimdiff view\"\n        title=\"vim 3 window vimdiff view\"\n        src=\"/static/4d5a9da1b300ab345c93f5b613517897/a3419/screen-shot-2018-08-10-at-22.19.52.png\"\n        srcset=\"/static/4d5a9da1b300ab345c93f5b613517897/a1986/screen-shot-2018-08-10-at-22.19.52.png 210w,\n/static/4d5a9da1b300ab345c93f5b613517897/ad7fb/screen-shot-2018-08-10-at-22.19.52.png 420w,\n/static/4d5a9da1b300ab345c93f5b613517897/a3419/screen-shot-2018-08-10-at-22.19.52.png 840w,\n/static/4d5a9da1b300ab345c93f5b613517897/4d498/screen-shot-2018-08-10-at-22.19.52.png 1260w,\n/static/4d5a9da1b300ab345c93f5b613517897/70b58/screen-shot-2018-08-10-at-22.19.52.png 1680w,\n/static/4d5a9da1b300ab345c93f5b613517897/462bf/screen-shot-2018-08-10-at-22.19.52.png 2404w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nOn the left side you have a current working copy (LOCAL).\nOn the right side you can view the remote (merged) file (REMOTE).\nThe central part of your screen shows a result (MERGED).</p>\n<p>What is good about that setup (and why I use it all the time)?</p>\n<ol>\n<li>In Vim <strong>normal</strong> mode place the cursor inside a right window in a merge conflict section (it is marked with a violet/pink highlight).\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0c92867c429d2b8686767ef0186eb5cf/462bf/screen-shot-2018-08-10-at-22.17.47.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.14642262895175%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACQ0lEQVQoz72S70tTURjHD9tIa8O23au23et277Zz7r22H9oPQwp6EczyhRbbmCVRSUWEI4YocYR6LY1AX2RI0HJODYsSIkH/rSJ30PN07n5J4ate9OLD8/A9z/d77j3noMXirPddeWlue29n/vveLv30eYdWq98E2/TjxjrdWlujK6/LdLm0Qstv3tPN8iatVNdpZfULXS1/pdWNLbq6tjn/obIxu7DwyocCajieHb4ApfwIlCauw9zwKBSsNEwlrsF4+gYsv3wIi88fQTFdgOkr0zB19QHcujwKS5kZeHv3Gby4VAQ6WICZgccwTIaSyKv2xUdOun7mETrIIsRyggnBuAsxfVBngSc9LPDUyzomTzDHbSfrvHmKpT2d7H4HYvc8iN1xONikw3mQd7p+GKe9CRRU1Xg8otcGdA1SusZTepinNEFE56Sf8OhFzI0hi4fPa1w5p/DwoMYTEY0nQypPhPp4UlPFfB8kNHU/FAwkkaIo8RgxajHDAAG3a5QYgE0TCCFAogRwBIMRNeqY2ATcmIUjj2l79hVFbQQSjGuEYBCVC+wKhh0mwLberPXeaOitubrHXsdYBCrNQEJqpBHQWgRD7N7qSSv8GB3/78BDO1T8GhdGXu8bhnZ/jH7YDPx1FIgxa59H+wz/8QuD9i33GzUctyB21uQCiFrCZJlgWVY94G9s3cYUL0HAm3P7wWAwidweT5e/t3vMf6Y75+uVM4Ksr0fK+mUpK0tyVpKkP/D7/fUqy3KLjCAntDG32931G6iDUDUfw1cCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nvimdiff merging\"\n        title=\"nvimdiff merging\"\n        src=\"/static/0c92867c429d2b8686767ef0186eb5cf/a3419/screen-shot-2018-08-10-at-22.17.47.png\"\n        srcset=\"/static/0c92867c429d2b8686767ef0186eb5cf/a1986/screen-shot-2018-08-10-at-22.17.47.png 210w,\n/static/0c92867c429d2b8686767ef0186eb5cf/ad7fb/screen-shot-2018-08-10-at-22.17.47.png 420w,\n/static/0c92867c429d2b8686767ef0186eb5cf/a3419/screen-shot-2018-08-10-at-22.17.47.png 840w,\n/static/0c92867c429d2b8686767ef0186eb5cf/4d498/screen-shot-2018-08-10-at-22.17.47.png 1260w,\n/static/0c92867c429d2b8686767ef0186eb5cf/70b58/screen-shot-2018-08-10-at-22.17.47.png 1680w,\n/static/0c92867c429d2b8686767ef0186eb5cf/462bf/screen-shot-2018-08-10-at-22.17.47.png 2404w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></li>\n<li>Hit the keys <strong>dp</strong> (a shortcut from <code class=\"language-text\">:diffput</code>).</li>\n<li>Code under the cursor will replace conflicted part in the MERGED file.</li>\n<li>Conflict solved, you are good to go.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c3416978c6b2bfb11fbed6147fed1237/462bf/screen-shot-2018-08-10-at-22.18.12.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.14642262895175%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAB7ElEQVQoz9WSzWsTQRjG96qBYjYb87FJE7M7H9tuc5C2QQriRfwgxkDTWz3aU6EYag5TaAn0Yk+FHloPoTTuWrceilCR+ncpNkPd13ey2VqD4NnDb593npn3eQdmtd1XnVuHh7udz+dnG1/Pv4jTj2ciePdJfPBOxXvvWPR7fXGwdyD29/ZF721PHKPnHXki8AJx4p+IwA+E3/c3/CP/9c6bnaSWK5bd5sIcbC/XYftFA9buP4eXM3VYvvsInj2ow9aTLdh8vAnr99ahPduGldoKNB82oVvvQvdpFzoLHWjPt2F1dhVqrFbVMrmca5VK3ytm/hKRVrEgyWRR2uVJaVUs6VQc6ViO5GUunTLqHS5ty458hJeG/iXuf8tn8zNawTRdwtiAcg6UsZAoKAtxHVJGQ5vYoU1/ozxKx3xmA+qFaZpVDT8uJWSAhwA1RJQCowwij0Y6qhkb88lwABBCrgVSOhg1xZtXjaqOA//mE3WJ/zrwpwpVh7AxjOvRoD/92It6VOCP64FybNq/b2hHjxc95OiGhUIUyDkfOI4DqCECMVOOCw6fGoZcwRmQaQ7E5WBPK/A3Q7UouchnslUtkUhMGIbRQJaQRaSlSKVSrbRxG+v0sI7Rdb2VzBgtPZseKrKILCUNvZG4cXPiF4LTUEcwEi9fAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nvimdiff merged\"\n        title=\"nvimdiff merged\"\n        src=\"/static/c3416978c6b2bfb11fbed6147fed1237/a3419/screen-shot-2018-08-10-at-22.18.12.png\"\n        srcset=\"/static/c3416978c6b2bfb11fbed6147fed1237/a1986/screen-shot-2018-08-10-at-22.18.12.png 210w,\n/static/c3416978c6b2bfb11fbed6147fed1237/ad7fb/screen-shot-2018-08-10-at-22.18.12.png 420w,\n/static/c3416978c6b2bfb11fbed6147fed1237/a3419/screen-shot-2018-08-10-at-22.18.12.png 840w,\n/static/c3416978c6b2bfb11fbed6147fed1237/4d498/screen-shot-2018-08-10-at-22.18.12.png 1260w,\n/static/c3416978c6b2bfb11fbed6147fed1237/70b58/screen-shot-2018-08-10-at-22.18.12.png 1680w,\n/static/c3416978c6b2bfb11fbed6147fed1237/462bf/screen-shot-2018-08-10-at-22.18.12.png 2404w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nRepeat above steps for all merge conflicts (if you have more of them). You can navigate between left (LOCAL) and right (REMOTE) windows making diffputs to MERGED file as well as making manual changes directly inside merged content.</li>\n</ol>\n<h2>Hints</h2>\n<p>You may execute <code class=\"language-text\">:Gw!</code> command in any of the opened windows. The window where you execute that command will be commited and marked as a merge resolution. It is very useful if you want to use just REMOTE or just LOCAL version without any further merge resolution steps.</p>\n<p>Want more?\nWhen in the central window use <code class=\"language-text\">d2o</code> or <code class=\"language-text\">d3o</code> to pull changes from LOCAL or REMOTE file.</p>\n<h2>Sources</h2>\n<p>Where does it come from? Check out this tutorial if you would like to know the details <a href=\"http://vimcasts.org/episodes/fugitive-vim-resolving-merge-conflicts-with-vimdiff/\">vimcasts #33</a>.\nAlso vim-fugitive docs are very helpful. Check out the <a href=\"https://github.com/tpope/vim-fugitive\">https://github.com/tpope/vim-fugitive</a></p>","timeToRead":2,"rawMarkdownBody":"The \"ugly\" 4 window view of the default `vimdiff` configuration can scare you out even if you were using Vim for a while. It's just too much information for most of the common merge cases.\n\n## Problem\nHow to configure **vim** or **nvim** with **git** to get a comfortable mergetool experience?\n\nNot 4 windows...\n![4 windows vimdiff view](img/screen-shot-2018-08-10-at-22.30.12.png)\n## Solution\n\nInstall [vim-fugitive](https://github.com/tpope/vim-fugitive) and use following configuration in your `~/.gitconfig` file:\n```\n[mergetool \"nvim\"]\n  cmd = nvim -f -c \\\"Gdiff\\\" \\\"$MERGED\\\"\n```\n\nIt will give you a \"nice\" view with 3 windows horizontally splitted.\n![vim 3 window vimdiff view](img/screen-shot-2018-08-10-at-22.19.52.png)\nOn the left side you have a current working copy (LOCAL).\nOn the right side you can view the remote (merged) file (REMOTE).\nThe central part of your screen shows a result (MERGED).\n\nWhat is good about that setup (and why I use it all the time)?\n\n1. In Vim **normal** mode place the cursor inside a right window in a merge conflict section (it is marked with a violet/pink highlight).\n![nvimdiff merging](img/screen-shot-2018-08-10-at-22.17.47.png)\n2. Hit the keys **dp** (a shortcut from `:diffput`).\n3. Code under the cursor will replace conflicted part in the MERGED file.\n4. Conflict solved, you are good to go.\n![nvimdiff merged](img/screen-shot-2018-08-10-at-22.18.12.png)\nRepeat above steps for all merge conflicts (if you have more of them). You can navigate between left (LOCAL) and right (REMOTE) windows making diffputs to MERGED file as well as making manual changes directly inside merged content.\n\n## Hints\n\nYou may execute `:Gw!` command in any of the opened windows. The window where you execute that command will be commited and marked as a merge resolution. It is very useful if you want to use just REMOTE or just LOCAL version without any further merge resolution steps.\n\nWant more?\nWhen in the central window use `d2o` or `d3o` to pull changes from LOCAL or REMOTE file.\n\n## Sources\n\nWhere does it come from? Check out this tutorial if you would like to know the details [vimcasts #33](http://vimcasts.org/episodes/fugitive-vim-resolving-merge-conflicts-with-vimdiff/).\nAlso vim-fugitive docs are very helpful. Check out the https://github.com/tpope/vim-fugitive\n","excerpt":"The \"ugly\" 4 window view of the default  configuration can scare you out even if you were using Vim for a while. It's just too muchâ€¦","frontmatter":{"title":"Using Vim or NeoVim as a git mergetool","slug":"using-vim-or-neovim-nvim-as-a-git-mergetool","date":"2018-08-09T09:20:00.000Z","tags":["vim","tools"],"date_created":"2018-08-22T21:42:00.000Z","date_updated":"2018-09-12T11:16:26.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1436377991866-f9af228d2b47.jpg","relativePath":"posts/img/photo-1436377991866-f9af228d2b47.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIGAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAfVZqjSM0ThRnUCz/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAECEQMTIRT/2gAIAQEAAQUCuJcWcNs5myaPRkEUNd//xAAXEQADAQAAAAAAAAAAAAAAAAAAASEQ/9oACAEDAQE/AYQWf//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABkQAAIDAQAAAAAAAAAAAAAAAAAxARAhIP/aAAgBAQAGPwJjrZMkfH//xAAdEAEBAAEEAwAAAAAAAAAAAAABADERIUFhcaHw/9oACAEBAAE/IehGEG85y0PUcxvkQ2gWlk3/2gAMAwEAAgADAAAAEIMXwv/EABcRAQEBAQAAAAAAAAAAAAAAAAEAECH/2gAIAQMBAT8QDASdv//EABcRAQEBAQAAAAAAAAAAAAAAAAABETH/2gAIAQIBAT8Q2tqpx//EABwQAQADAQADAQAAAAAAAAAAAAEAESExUWFxkf/aAAgBAQABPxDFaA6sMsz1PjHLAcIDu1XCoHma8war2s2UHIDB+k//2Q==","aspectRatio":2,"src":"/static/ebae058bb362b6e24b9309ec106a1c4b/0defe/photo-1436377991866-f9af228d2b47.jpg","srcSet":"/static/ebae058bb362b6e24b9309ec106a1c4b/38b6a/photo-1436377991866-f9af228d2b47.jpg 150w,\n/static/ebae058bb362b6e24b9309ec106a1c4b/e201c/photo-1436377991866-f9af228d2b47.jpg 300w,\n/static/ebae058bb362b6e24b9309ec106a1c4b/0defe/photo-1436377991866-f9af228d2b47.jpg 600w,\n/static/ebae058bb362b6e24b9309ec106a1c4b/a71f1/photo-1436377991866-f9af228d2b47.jpg 900w,\n/static/ebae058bb362b6e24b9309ec106a1c4b/8d595/photo-1436377991866-f9af228d2b47.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"d8089e2c-7c85-5eb5-8e47-f762ddec6800","html":"<p>General advice is to never convert data from <a href=\"https://facebook.github.io/immutable-js/\">Immutable</a> to native JS types. But if you have to do it use <code class=\"language-text\">.toArray()</code> rather than <code class=\"language-text\">.toJS()</code> of course if you work with some array-like data structure.</p>\n<h2>Problem</h2>\n<p>Immutable is a great library if you need immutability of your code, unfortunately conversion between Immutable and native JS is terribly inefficient process.</p>\n<h2>Solution</h2>\n<p>Here is my test case created using <a href=\"https://benchmarkjs.com/\">benchmark</a> library.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> Benchmark <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'benchmark'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> suite <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Benchmark<span class=\"token punctuation\">.</span>Suite</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> List <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'immutable'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">List</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// add tests</span>\n<span class=\"token keyword\">return</span> suite\n\n<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'toArray()'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> b <span class=\"token operator\">=</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">toArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'toJS()'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> b <span class=\"token operator\">=</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">toJS</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// add listeners</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cycle'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'complete'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Fastest is '</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fastest'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>You may copy/paste it if you want and run with:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">node benchmark.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where <strong>benchmark.js</strong> is a path to the file with mentioned benchmark JS script.</p>\n<p>Here are my results:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">toArray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> x <span class=\"token number\">657,624</span> ops/sec Â±0.99% <span class=\"token punctuation\">(</span><span class=\"token number\">89</span> runs sampled<span class=\"token punctuation\">)</span>\ntoJS<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> x <span class=\"token number\">189,606</span> ops/sec Â±5.62% <span class=\"token punctuation\">(</span><span class=\"token number\">64</span> runs sampled<span class=\"token punctuation\">)</span>\nFastest is toArray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>So try to avoid <code class=\"language-text\">.toJS()</code> whenever you can.</p>","timeToRead":1,"rawMarkdownBody":"General advice is to never convert data from [Immutable](https://facebook.github.io/immutable-js/) to native JS types. But if you have to do it use `.toArray()` rather than `.toJS()` of course if you work with some array-like data structure.\n\n## Problem\n\nImmutable is a great library if you need immutability of your code, unfortunately conversion between Immutable and native JS is terribly inefficient process.\n\n## Solution\n\nHere is my test case created using [benchmark](https://benchmarkjs.com/) library.\n\n```javascript\nconst Benchmark = require('benchmark');\nvar suite = new Benchmark.Suite;\n\nconst { List } = require('immutable');\nconst list = new List([1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10]));\n\n// add tests\nreturn suite\n\n.add('toArray()', function() {\n  const b = list.toArray();\n})\n.add('toJS()', function() {\n  const b = list.toJS();\n})\n\n// add listeners\n.on('cycle', function(event) {\n  console.log(String(event.target));\n})\n.on('complete', function() {\n  console.log('Fastest is ' + this.filter('fastest').map('name'));\n})\n  .run();\n```\n\nYou may copy/paste it if you want and run with:\n\n```bash\nnode benchmark.js\n```\n\nWhere **benchmark.js** is a path to the file with mentioned benchmark JS script.\n\nHere are my results:\n\n```bash\ntoArray() x 657,624 ops/sec Â±0.99% (89 runs sampled)\ntoJS() x 189,606 ops/sec Â±5.62% (64 runs sampled)\nFastest is toArray()\n```\n\nSo try to avoid `.toJS()` whenever you can.\n","excerpt":"General advice is to never convert data from Immutable to native JS types. But if you have to do it use  rather than  of course if you workâ€¦","frontmatter":{"title":"ImmutableJS .toJS() vs .toArray()","slug":"immutable-js-tojs-vs-toarray","date":"2018-09-15T17:19:51.000Z","tags":["javascript"],"date_created":"2018-07-29T11:46:14.000Z","date_updated":"2018-09-15T18:41:36.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1522115900503-5dc493006ffd.jpg","relativePath":"posts/img/photo-1522115900503-5dc493006ffd.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHRgIrjD//EABgQAAMBAQAAAAAAAAAAAAAAAAECEAAR/9oACAEBAAEFAs0B6Gn/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAVEAEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAQAGPwJr/8QAHhABAAICAQUAAAAAAAAAAAAAAQARITGBUXGhscH/2gAIAQEAAT8hfACDfdjvCcszPVPcVLx8iFtl1P/aAAwDAQACAAMAAAAQ08//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAeEAACAgICAwAAAAAAAAAAAAABEQAhMcFBoVFx8f/aAAgBAQABPxCgD6AlyXQuxuODCHocMQstQfnokOm4eILEH4zuf//Z","aspectRatio":2,"src":"/static/0b43ec23a5ca48aa03632c864a61bd16/0defe/photo-1522115900503-5dc493006ffd.jpg","srcSet":"/static/0b43ec23a5ca48aa03632c864a61bd16/38b6a/photo-1522115900503-5dc493006ffd.jpg 150w,\n/static/0b43ec23a5ca48aa03632c864a61bd16/e201c/photo-1522115900503-5dc493006ffd.jpg 300w,\n/static/0b43ec23a5ca48aa03632c864a61bd16/0defe/photo-1522115900503-5dc493006ffd.jpg 600w,\n/static/0b43ec23a5ca48aa03632c864a61bd16/a71f1/photo-1522115900503-5dc493006ffd.jpg 900w,\n/static/0b43ec23a5ca48aa03632c864a61bd16/8d595/photo-1522115900503-5dc493006ffd.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"e2d5e7f3-2182-588c-913b-a9278703d114","html":"<p>If you are struggling with the <strong>406 error</strong> message which is included in title of this post you may be interested in reading the whole story.</p>\n<h2>Problem</h2>\n<p>I was using <a href=\"https://github.com/squaremo/amqp.node\">amqplib</a> for conneting NodeJS based messages processor with RabbitMQ broker.\nEverything seems to be working fine, but from time to time <strong>406 (PRECONDINTION-FAILED)</strong> message shows up in the log:</p>\n<blockquote>\n<p>\"Error: Channel closed by server: 406 (PRECONDITION-FAILED) with message \"PRECONDITION_FAILED - unknown delivery tag 1\"</p>\n</blockquote>\n<h2>Solution</h2>\n<p>Keeping things simple:</p>\n<ul>\n<li>You have to ACK messages in same order as they arrive to your system</li>\n<li>You can't ACK messages on a different channel than that they arrive on</li>\n</ul>\n<p>If you break any of these rules you will face <strong>406 (PRECONDITION-FAILED)</strong> error message.</p>","timeToRead":1,"rawMarkdownBody":"If you are struggling with the **406 error** message which is included in title of this post you may be interested in reading the whole story.\n\n## Problem\n\nI was using [amqplib](https://github.com/squaremo/amqp.node) for conneting NodeJS based messages processor with RabbitMQ broker.\nEverything seems to be working fine, but from time to time **406 (PRECONDINTION-FAILED)** message shows up in the log:\n\n> \"Error: Channel closed by server: 406 (PRECONDITION-FAILED) with message \"PRECONDITION_FAILED - unknown delivery tag 1\"\n\n## Solution\n\nKeeping things simple:\n- You have to ACK messages in same order as they arrive to your system\n- You can't ACK messages on a different channel than that they arrive on\n\nIf you break any of these rules you will face **406 (PRECONDITION-FAILED)** error message.\n","excerpt":"If you are struggling with the 406 error message which is included in title of this post you may be interested in reading the whole storyâ€¦","frontmatter":{"title":"RabbitMQ amqplib - \"Error: Channel closed by server: 406 (PRECONDITION-FAILED) with message \"PRECONDITION_FAILED - unknown delivery tag 1\"","slug":"rabbitmq-406-channel-closed-precondition-failed","date":"2018-08-09T08:25:00.000Z","tags":["backend"],"date_created":"2018-07-29T04:59:48.000Z","date_updated":"2018-09-20T10:18:10.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1534279172812-fed91fae8966.jpg","relativePath":"posts/img/photo-1534279172812-fed91fae8966.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABcBAAMBAAAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAYarEzzSKX//xAAaEAACAwEBAAAAAAAAAAAAAAABAgADIREi/9oACAEBAAEFAqkBlnDGXR5Sk4x3/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFREBAQAAAAAAAAAAAAAAAAAAABL/2gAIAQIBAT8BW//EABkQAQEAAwEAAAAAAAAAAAAAAAARAQIxQf/aAAgBAQAGPwK15XFbXFcf/8QAGxABAAIDAQEAAAAAAAAAAAAAAQAhEUFRMXH/2gAIAQEAAT8hK8Xkx0ArfyIQGcZUKuXAW3OJP//aAAwDAQACAAMAAAAQ6B//xAAWEQADAAAAAAAAAAAAAAAAAAABEDH/2gAIAQMBAT8QEX//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQIBAT8QUxWJ/8QAGxABAAMAAwEAAAAAAAAAAAAAAQARITFBYYH/2gAIAQEAAT8QHsatheu4sgtQOPUSgvhcNsybYLh3ARo8gDCg4yf/2Q==","aspectRatio":2,"src":"/static/2929536528310985128f48a405cf2d81/0defe/photo-1534279172812-fed91fae8966.jpg","srcSet":"/static/2929536528310985128f48a405cf2d81/38b6a/photo-1534279172812-fed91fae8966.jpg 150w,\n/static/2929536528310985128f48a405cf2d81/e201c/photo-1534279172812-fed91fae8966.jpg 300w,\n/static/2929536528310985128f48a405cf2d81/0defe/photo-1534279172812-fed91fae8966.jpg 600w,\n/static/2929536528310985128f48a405cf2d81/a71f1/photo-1534279172812-fed91fae8966.jpg 900w,\n/static/2929536528310985128f48a405cf2d81/8d595/photo-1534279172812-fed91fae8966.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"520123f7-9cff-51fc-9507-82555e8c99d4","html":"<p>This will be a simple tutorial about running Jest tests with Flow typed Javascript files in NodeJS project.</p>\n<h2>Problem</h2>\n<p>Recently I've started adding <a href=\"https://github.com/facebook/flow\">Flow</a> types to my existing NodeJS project which uses <a href=\"https://github.com/facebook/jest\">Jest</a> testing framework. It turns out immidiately that there is no \"out of the box\" support for Flow in Jest. This is strange for me because both are Facebook products, so I was hoping for seamless integration.</p>\n<h2>Solution</h2>\n<p>There is a quite simple solution which is based on two Babel originated packages: <a href=\"https://github.com/babel/babel-jest\">babel-jest</a> and <a href=\"https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-flow-strip-types\">babel-plugin-transform-flow-strip-types</a>.\nInstall them with:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev babel-jest babel-plugin-transform-flow-strip-types</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Then adjust configuration inside <strong>.babelrc</strong> file as described on <a href=\"https://www.npmjs.com/package/babel-plugin-transform-flow-strip-types\">babel-plugin-transform-flow-strip-types</a> NPM repository page:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"transform-flow-strip-types\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Now after executing <code class=\"language-text\">yarn jest</code> all my Flow type hinted JS files works as expected.</p>\n<p>No <strong>jest.config.js</strong> modification required!</p>\n<h2>Issues</h2>\n<p>While trying to get Jest tests to work with Flow I've got one problem - a dead end. It was <a href=\"https://www.npmjs.com/package/jest-flow-transform\">jest-flow-transform</a> package. Despite declaring approperiate configuration inside <strong>jest.config.js</strong> file in <code class=\"language-text\">transform</code> section I was constantly getting a message:</p>\n<blockquote>\n<p>TypeError: ...mockResolvedValue is not a function</p>\n</blockquote>\n<p>I didn't find any solution for that and move on to <strong>babel-jest</strong> which is described above in a <a href=\"#solution\">solution</a> section.</p>\n<h2>Create React App (CRA) Jest tests</h2>\n<p>If you are using <a href=\"https://github.com/facebookincubator/create-react-app\">Create React App</a> and Jest tests reports a lot of Flow bugs just install <code class=\"language-text\">jest</code> directly with:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> flow-typed <span class=\"token function\">install</span> jest@20.0.4</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>You should replace <code class=\"language-text\">20.0.4</code> with whichever Jest version is currently used by CRA (check it with <code class=\"language-text\">yarn list | grep jest</code>). Unfortunatelly, there seems to be no way to automatically install Flow definitions for Jest. See <a href=\"https://github.com/facebook/create-react-app/issues/3904\">CRA #3904</a> for more info.</p>","timeToRead":2,"rawMarkdownBody":"This will be a simple tutorial about running Jest tests with Flow typed Javascript files in NodeJS project.\n\n## Problem\n\nRecently I've started adding [Flow](https://github.com/facebook/flow) types to my existing NodeJS project which uses [Jest](https://github.com/facebook/jest) testing framework. It turns out immidiately that there is no \"out of the box\" support for Flow in Jest. This is strange for me because both are Facebook products, so I was hoping for seamless integration.\n\n## Solution\n\nThere is a quite simple solution which is based on two Babel originated packages: [babel-jest](https://github.com/babel/babel-jest) and [babel-plugin-transform-flow-strip-types](https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-flow-strip-types).\nInstall them with:\n```bash\nyarn add --dev babel-jest babel-plugin-transform-flow-strip-types\n```\n\nThen adjust configuration inside **.babelrc** file as described on [babel-plugin-transform-flow-strip-types](https://www.npmjs.com/package/babel-plugin-transform-flow-strip-types) NPM repository page:\n\n```json\n{\n  \"plugins\": [\"transform-flow-strip-types\"]\n}\n```\n\nNow after executing `yarn jest` all my Flow type hinted JS files works as expected.\n\nNo **jest.config.js** modification required!\n\n## Issues\n\nWhile trying to get Jest tests to work with Flow I've got one problem - a dead end. It was [jest-flow-transform](https://www.npmjs.com/package/jest-flow-transform) package. Despite declaring approperiate configuration inside **jest.config.js** file in `transform` section I was constantly getting a message:\n\n> TypeError: ...mockResolvedValue is not a function\n\nI didn't find any solution for that and move on to **babel-jest** which is described above in a [solution](#solution) section.\n\n## Create React App (CRA) Jest tests\n\nIf you are using [Create React App](https://github.com/facebookincubator/create-react-app) and Jest tests reports a lot of Flow bugs just install `jest` directly with:\n```bash\nyarn flow-typed install jest@20.0.4\n```\n\nYou should replace `20.0.4` with whichever Jest version is currently used by CRA (check it with `yarn list | grep jest`). Unfortunatelly, there seems to be no way to automatically install Flow definitions for Jest. See [CRA #3904](https://github.com/facebook/create-react-app/issues/3904) for more info.\n","excerpt":"This will be a simple tutorial about running Jest tests with Flow typed Javascript files in NodeJS project. Problem Recently I've startedâ€¦","frontmatter":{"title":"Running Jest tests with Flow typed Javascript files","slug":"jest-tests-flow-type","date":"2018-07-18T09:29:00.000Z","tags":["javascript"],"date_created":"2018-07-28T14:51:37.000Z","date_updated":"2018-10-17T12:12:45.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1518133910546-b6c2fb7d79e3.jpg","relativePath":"posts/img/photo-1518133910546-b6c2fb7d79e3.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGQAAAwADAAAAAAAAAAAAAAAAAAIDAQQF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgEA/9oADAMBAAIQAxAAAAHsyeN0wLFbOmXcmI//xAAdEAEAAQMFAAAAAAAAAAAAAAABAAIDEBESISMx/9oACAEBAAEFAnDHHreUB1m6V827D1z/xAAVEQEBAAAAAAAAAAAAAAAAAAAQQf/aAAgBAwEBPwEh/8QAFREBAQAAAAAAAAAAAAAAAAAAEEH/2gAIAQIBAT8BKf/EABsQAAEEAwAAAAAAAAAAAAAAAAABAhBBESAh/9oACAEBAAY/Atke2jNR0WP/xAAeEAACAgICAwAAAAAAAAAAAAAAAREhMUFRcWGh0f/aAAgBAQABPyHAn6PDgdOtvXgn2x2D0OvKEok0lM7FjIdnw6HeT//aAAwDAQACAAMAAAAQU/wy/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEREFH/2gAIAQMBAT8Qxq3wh//EABgRAAMBAQAAAAAAAAAAAAAAAAABERAh/9oACAECAQE/EFi5BT//xAAfEAACAgICAwEAAAAAAAAAAAABEQAhMVFBgWGRscH/2gAIAQEAAT8QTt8gaz01qFHbDKcYONjIi7FiiriEoZhoxdH3BMzZBi4QB5O7gBRhzEZkceAT/YAQgCVqf//Z","aspectRatio":2,"src":"/static/9c7ef059ecff4ec4f83b5da3c20b8084/0defe/photo-1518133910546-b6c2fb7d79e3.jpg","srcSet":"/static/9c7ef059ecff4ec4f83b5da3c20b8084/38b6a/photo-1518133910546-b6c2fb7d79e3.jpg 150w,\n/static/9c7ef059ecff4ec4f83b5da3c20b8084/e201c/photo-1518133910546-b6c2fb7d79e3.jpg 300w,\n/static/9c7ef059ecff4ec4f83b5da3c20b8084/0defe/photo-1518133910546-b6c2fb7d79e3.jpg 600w,\n/static/9c7ef059ecff4ec4f83b5da3c20b8084/a71f1/photo-1518133910546-b6c2fb7d79e3.jpg 900w,\n/static/9c7ef059ecff4ec4f83b5da3c20b8084/8d595/photo-1518133910546-b6c2fb7d79e3.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"cd382999-9f2e-55ec-b113-3624ddb8782e","html":"<p>Another Jest connected post. How to test internal module functions that are not exported?</p>\n<h2>Problem</h2>\n<p>I want to test internal function defined inside <strong>./index.js</strong> file without exporting it with <code class=\"language-text\">module.exports</code>. Let say that <strong>./index.js</strong> looks similar to this (implementation details are irrelevant):</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">someFunction</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">something</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string\">'anything'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>This function is not a part of public interface so exporting it just for testing with Jest seems like a bad idea/solution.\nOf course the following test won't work:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> someFunction <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">__get__</span><span class=\"token punctuation\">(</span><span class=\"token string\">'someFunction'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'someFunction'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should work'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">someFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'anything'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The error message may looks as follows:</p>\n<blockquote>\n<p>TypeError: require(...).__get__ is not a function</p>\n</blockquote>\n<p>This is caused by lack of <a href=\"https://github.com/jhnns/rewire\">rewire</a> package (as you may expect).</p>\n<h2>Solution</h2>\n<p>Use <a href=\"https://www.npmjs.com/package/babel-plugin-rewire\">babel-plugin-rewire</a> it's extremly easy to do. Just:</p>\n<ol>\n<li>Install it with <code class=\"language-text\">yarn add --dev babel-plugin-rewire</code></li>\n<li>If you don't have <code class=\"language-text\">babel-jest</code> installed execute also <code class=\"language-text\">yarn add --dev babel-jest</code></li>\n<li>Add plugin to the <strong>.babelrc</strong> config file:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"plugins\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"babel-plugin-rewire\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Now just run your tests as usual <code class=\"language-text\">yarn jest</code>. Everything should work smoothly.\nYou don't have to install <code class=\"language-text\">rewire</code> itself.</p>\n<p>If you are trying/willing to run Jest tests with Flow typed Javascript files check my other article <a href=\"https://grzegorowski.com/jest-tests-flow-type\">Running Jest tests with Flow typed Javascript files</a>.</p>\n<h2>Issues</h2>\n<p>The one which cost me a lot of time to figure it out.</p>\n<blockquote>\n<p>TypeError: _get__(...) is not a function</p>\n</blockquote>\n<p>According to the @joshnuss <a href=\"https://github.com/speedskater/babel-plugin-rewire/issues/109#issuecomment-202526786\">Github answer</a> with <strong>babel-plugin-rewire</strong> you can't actually use <code class=\"language-text\">__get__</code> method (or any other e.g. <code class=\"language-text\">__Rewire__</code>) for function/constant which is not referenced anywhere in your module file.</p>\n<p>Example of a \"buggy\" module code which you won't be able to rewire and use <code class=\"language-text\">__get__</code> method.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">test123</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>A \"fixed\" version (just reference <code class=\"language-text\">test123</code> anywhere it doesn't have to be even executed):</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">test123</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\ntest123<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>And here is a test case which will fail if we use \"buggy\" implementation of the module.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> test123 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">__get__</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test123'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test123'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">test123</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>When such case might happen? Well, for example if you try to test some currently unused function (e.g. just a new internal module function).</p>\n<h2>Sources</h2>\n<p><a href=\"https://www.npmjs.com/package/babel-plugin-rewire\">https://www.npmjs.com/package/babel-plugin-rewire</a>\n<a href=\"https://github.com/facebook/jest/issues/1003\">https://github.com/facebook/jest/issues/1003</a>\n<a href=\"https://www.npmjs.com/package/babel-plugin-rewire\">https://www.npmjs.com/package/babel-plugin-rewire</a></p>","timeToRead":2,"rawMarkdownBody":"Another Jest connected post. How to test internal module functions that are not exported?\n\n## Problem\n\nI want to test internal function defined inside **./index.js** file without exporting it with `module.exports`. Let say that **./index.js** looks similar to this (implementation details are irrelevant):\n```js\nfunction someFunction(something) {\n  return 'anything';\n}\n```\n\nThis function is not a part of public interface so exporting it just for testing with Jest seems like a bad idea/solution.\nOf course the following test won't work:\n```js\nconst someFunction = require('./index').__get__('someFunction');\ndescribe('someFunction', () => {\n  it('should work', () => {\n    expect(someFunction()).toEqual('anything');\n  });\n});\n```\nThe error message may looks as follows:\n\n> TypeError: require(...).\\_\\_get__ is not a function\n\nThis is caused by lack of [rewire](https://github.com/jhnns/rewire) package (as you may expect).\n\n## Solution\n\nUse [babel-plugin-rewire](https://www.npmjs.com/package/babel-plugin-rewire) it's extremly easy to do. Just:\n\n1. Install it with `yarn add --dev babel-plugin-rewire`\n2. If you don't have `babel-jest` installed execute also `yarn add --dev babel-jest`\n3. Add plugin to the **.babelrc** config file:\n\n```javascript\n{\n  \"plugins\": [\"babel-plugin-rewire\"]\n}\n```\n\nNow just run your tests as usual `yarn jest`. Everything should work smoothly.\nYou don't have to install `rewire` itself.\n\nIf you are trying/willing to run Jest tests with Flow typed Javascript files check my other article [Running Jest tests with Flow typed Javascript files](https://grzegorowski.com/jest-tests-flow-type).\n\n## Issues\n\nThe one which cost me a lot of time to figure it out.\n\n> TypeError: _get__(...) is not a function\n\nAccording to the @joshnuss [Github answer](https://github.com/speedskater/babel-plugin-rewire/issues/109#issuecomment-202526786) with **babel-plugin-rewire** you can't actually use `__get__` method (or any other e.g. `__Rewire__`) for function/constant which is not referenced anywhere in your module file.\n\nExample of a \"buggy\" module code which you won't be able to rewire and use `__get__` method.\n\n```javascript\nconst test123 = () => {\n  return true;\n}\n```\n\nA \"fixed\" version (just reference `test123` anywhere it doesn't have to be even executed):\n\n```javascript\nconst test123 = () => {\n  return true;\n}\ntest123;\n```\n\nAnd here is a test case which will fail if we use \"buggy\" implementation of the module.\n\n```javascript\nconst test123 = require('./index').__get__('test123');\n\ntest('test123', () => {\n  expect(test123()).toEqual(true);\n});\n```\n\nWhen such case might happen? Well, for example if you try to test some currently unused function (e.g. just a new internal module function).\n\n## Sources\n\nhttps://www.npmjs.com/package/babel-plugin-rewire\nhttps://github.com/facebook/jest/issues/1003\nhttps://www.npmjs.com/package/babel-plugin-rewire\n","excerpt":"Another Jest connected post. How to test internal module functions that are not exported? Problem I want to test internal function definedâ€¦","frontmatter":{"title":"How to run Jest tests with Rewire plugin","slug":"jest-tests-with-rewire-plugin","date":"2018-07-20T08:33:17.000Z","tags":["javascript"],"date_created":"2018-07-25T02:36:15.000Z","date_updated":"2018-10-17T12:09:33.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1478809956569-c7ce9654a947.jpg","relativePath":"posts/img/photo-1478809956569-c7ce9654a947.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABUBAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAGjbHVERYH/xAAXEAEBAQEAAAAAAAAAAAAAAAAAAQIS/9oACAEBAAEFAs5WRyy5iv/EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/AYj/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwGq/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAEQESExQf/aAAgBAQABPyHUc0FRcIlij//aAAwDAQACAAMAAAAQ+8//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEDAQE/EEswk//EABYRAAMAAAAAAAAAAAAAAAAAAAABEf/aAAgBAgEBPxBvSz//xAAbEAADAQEAAwAAAAAAAAAAAAAAAREhMWFxof/aAAgBAQABPxBVSLO4KOI6uuGvHsieIcNXwaxiH//Z","aspectRatio":2,"src":"/static/b031fc0360e5fe303ab52343284d1ff1/0defe/photo-1478809956569-c7ce9654a947.jpg","srcSet":"/static/b031fc0360e5fe303ab52343284d1ff1/38b6a/photo-1478809956569-c7ce9654a947.jpg 150w,\n/static/b031fc0360e5fe303ab52343284d1ff1/e201c/photo-1478809956569-c7ce9654a947.jpg 300w,\n/static/b031fc0360e5fe303ab52343284d1ff1/0defe/photo-1478809956569-c7ce9654a947.jpg 600w,\n/static/b031fc0360e5fe303ab52343284d1ff1/a71f1/photo-1478809956569-c7ce9654a947.jpg 900w,\n/static/b031fc0360e5fe303ab52343284d1ff1/8d595/photo-1478809956569-c7ce9654a947.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"0915f800-08af-530b-8999-60ec663e456e","html":"<p>Here is a complete Bootstrap-like solution for showing and hiding selected Ionic components based on screen size.</p>\n<p><a href=\"#solution\">Go to solution</a></p>\n<h1>Introduction</h1>\n<p>In Ionic 3 Framework we already have an option to show or hide elements for selected devices using <a href=\"https://ionicframework.com/docs/api/components/show-hide-when/ShowWhen/\">showWhen</a> and <a href=\"https://ionicframework.com/docs/api/components/show-hide-when/HideWhen/\">hideWhen</a>. It is very convenient and well documented but it won't allow you to handle different screen sizes which is required sooner or later if your Ionic App handles both mobile and desktop devices.</p>\n<p>One thing I try to avoid is building a non-reusable project specific solution. To achieve this the only possible solution seems to be using standard Ionic SCSS breakpoints as a base. Here is a default definition:</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-scss line-numbers\"><code class=\"language-scss\"><span class=\"token property\"><span class=\"token variable\">$screen-breakpoints</span></span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token property\">xs</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">,</span>\n  <span class=\"token property\">sm</span><span class=\"token punctuation\">:</span> 576px<span class=\"token punctuation\">,</span>\n  <span class=\"token property\">md</span><span class=\"token punctuation\">:</span> 768px<span class=\"token punctuation\">,</span>\n  <span class=\"token property\">lg</span><span class=\"token punctuation\">:</span> 992px<span class=\"token punctuation\">,</span>\n  <span class=\"token property\">xl</span><span class=\"token punctuation\">:</span> 1200px\n<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>It is taken from inside Ionic Framework SCSS files (you shouldn't do a copy/paste of above code) and it doesn't look like something that will change frequently. <code class=\"language-text\">$screen-breakpoints</code> are widely used by all Ionic SCSS files/rules and documented on official <a href=\"https://ionicframework.com/docs/theming/overriding-ionic-variables/\">overriding-ionic-variables</a> page. Let say that <code class=\"language-text\">$screen-breakpoints</code> looks like a fairly reliable choice for the purpose of creating universal Ionic show/hide solution.</p>\n<p>The key benefit from using <code class=\"language-text\">$screen-breakpoints</code> is that generated CSS styles will work regardless of any changes/customizations that might be done to this SCSS variable. This covers adding/removing some breakpoint or changing breakpoint value. You may test it using <a href=\"https://www.sassmeister.com/gist/d2af1ee566d454337663caa4b462c9b\">this gist</a>.</p>\n<h1>Solution</h1>\n<p>It's time to write some SCSS code. My solution will be based on Bootstrap 4 convention <code class=\"language-text\">hidden-*</code> where elements with given class are hidden on selected screen size (<a href=\"https://v4-alpha.getbootstrap.com/layout/responsive-utilities/#available-classes\">see bootstrap docs</a>). Replicating <code class=\"language-text\">hidden-*-up</code> or <code class=\"language-text\">hidden-*-down</code> should be equally easy.</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-scss line-numbers\"><code class=\"language-scss\"><span class=\"token property\"><span class=\"token variable\">$breakpoints-keys</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">map-keys</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$screen-breakpoints</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token property\"><span class=\"token variable\">$breakpoints-values</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">map-values</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$screen-breakpoints</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">@for</span> <span class=\"token variable\">$i</span> <span class=\"token keyword\">from</span> 1 to <span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-keys</span><span class=\"token punctuation\">)</span><span class=\"token selector\">+1 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">@if</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-keys</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    .hidden-#<span class=\"token punctuation\">{</span><span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-keys</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span>\n      @media <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-values</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span> #<span class=\"token punctuation\">{</span><span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-values</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span>+1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">@else</span> <span class=\"token punctuation\">{</span>\n    .hidden-#<span class=\"token punctuation\">{</span><span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-keys</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span>\n      @media <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-values</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Why it looks so scary? Well I didn't find any other option to iterate over a <a href=\"http://sass-lang.com/documentation/Sass/Script/Functions.html\">SCSS map</a> with numerical index. The only option was to get map keys with <code class=\"language-text\">map-keys()</code> and then iterate over them with a regular <code class=\"language-text\">@for</code> loop.</p>\n<p>If you would like to see a CSS output of the code please check my <a href=\"https://www.sassmeister.com/gist/d2af1ee566d454337663caa4b462c9ba\">SCSS gist</a>.</p>\n<h1>How to use it?</h1>\n<p>Just declare mentioned <strong>SCSS</strong> code somewhere in you Ionic SCSS files e.g. inside <strong>src/app/show-hide-screen-size.scss</strong> and then import it (with <code class=\"language-text\">@import &quot;./show-hide-screen-size&quot;;</code>) to the main SCSS file e.g. <strong>src/app/app.scss</strong>.</p>\n<p>Now you may add <code class=\"language-text\">hidden-xs hidden-sm hidden-md hidden-lg hidden-xl</code> classes to any HTML element to hide it for selected screen size e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden-xs hidden-lg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\nNot visible on XS and LG screens, but visible on any other screen sizes\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h1>Code description</h1>\n<p>Let's start from the beginning.</p>\n<p>First we need to get keys (e.g. <code class=\"language-text\">xs</code>, <code class=\"language-text\">sm</code>, etc.) and values (e.g. <code class=\"language-text\">0</code>, <code class=\"language-text\">576px</code>, etc.) from <code class=\"language-text\">$screen-breakpoints</code> map to be able to reference them using numerical index which will allow to look ahead of current index and get <code class=\"language-text\">max-width</code> value.</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-scss line-numbers\"><code class=\"language-scss\"><span class=\"token property\"><span class=\"token variable\">$breakpoints-keys</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">map-keys</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$screen-breakpoints</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token property\"><span class=\"token variable\">$breakpoints-values</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">map-values</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$screen-breakpoints</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Then there is a loop over all breakpoints which generates a CSS rules. Please note that lists in SCSS are indexed from <code class=\"language-text\">1</code> to <code class=\"language-text\">n+1</code> (which is kind of tricky if you are used to any \"normal\" programming language).</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-scss line-numbers\"><code class=\"language-scss\"><span class=\"token keyword\">@for</span> <span class=\"token variable\">$i</span> <span class=\"token keyword\">from</span> 1 to <span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-keys</span><span class=\"token punctuation\">)</span><span class=\"token selector\">+1 </span><span class=\"token punctuation\">{</span>\n  ...\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Unfortunately there is no easy/readable way of handling an edge case which is last breakpoint <code class=\"language-text\">hidden-xl</code> where <code class=\"language-text\">max-width</code> limit should be omitted thus this ugly <code class=\"language-text\">@if</code> construction seems to be required:</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-scss line-numbers\"><code class=\"language-scss\">  <span class=\"token keyword\">@if</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-keys</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ...\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">@else</span> <span class=\"token punctuation\">{</span>\n    ...\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now look at code which generates a common CSS rule <code class=\"language-text\">@media (min-width: ...) and (max-width: ...)</code>. As you can see for a lower bound <code class=\"language-text\">min-width</code> we take current index <code class=\"language-text\">$i</code> while an upper bound <code class=\"language-text\">max-width</code> is generated using next index <code class=\"language-text\">$i+1</code>. A second value selected from <code class=\"language-text\">$breakpoints-values</code> will always be larger than the first one. This is exactly what we need here.</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-scss line-numbers\"><code class=\"language-scss\">.hidden-#<span class=\"token punctuation\">{</span><span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-keys</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span>\n  @media <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-values</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span> #<span class=\"token punctuation\">{</span><span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-values</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span>+1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Lastly an \"edge case\" of last CSS rule has to be handled. It is generated using same structure as before but without upper bound <code class=\"language-text\">max-width:...</code></p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-scss line-numbers\"><code class=\"language-scss\">.hidden-#<span class=\"token punctuation\">{</span><span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-keys</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span>\n  @media <span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">nth</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$breakpoints-values</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1>Sources</h1>\n<p><a href=\"https://forum.ionicframework.com/t/how-do-i-hide-or-show-content-depending-on-screen-size/94081/11\">https://forum.ionicframework.com/t/how-do-i-hide-or-show-content-depending-on-screen-size/94081/11</a>\n<a href=\"https://ionicframework.com/docs/theming/overriding-ionic-variables/\">https://ionicframework.com/docs/theming/overriding-ionic-variables/</a>\n<a href=\"http://sass-lang.com/documentation/Sass/Script/Functions.html\">http://sass-lang.com/documentation/Sass/Script/Functions.html</a></p>","timeToRead":4,"rawMarkdownBody":"Here is a complete Bootstrap-like solution for showing and hiding selected Ionic components based on screen size.\n\n[Go to solution](#solution)\n# Introduction\nIn Ionic 3 Framework we already have an option to show or hide elements for selected devices using [showWhen](https://ionicframework.com/docs/api/components/show-hide-when/ShowWhen/) and [hideWhen](https://ionicframework.com/docs/api/components/show-hide-when/HideWhen/). It is very convenient and well documented but it won't allow you to handle different screen sizes which is required sooner or later if your Ionic App handles both mobile and desktop devices.\n\nOne thing I try to avoid is building a non-reusable project specific solution. To achieve this the only possible solution seems to be using standard Ionic SCSS breakpoints as a base. Here is a default definition:\n```scss\n$screen-breakpoints: (\n  xs: 0,\n  sm: 576px,\n  md: 768px,\n  lg: 992px,\n  xl: 1200px\n)\n```\nIt is taken from inside Ionic Framework SCSS files (you shouldn't do a copy/paste of above code) and it doesn't look like something that will change frequently. `$screen-breakpoints` are widely used by all Ionic SCSS files/rules and documented on official [overriding-ionic-variables](https://ionicframework.com/docs/theming/overriding-ionic-variables/) page. Let say that `$screen-breakpoints` looks like a fairly reliable choice for the purpose of creating universal Ionic show/hide solution.\n\nThe key benefit from using `$screen-breakpoints` is that generated CSS styles will work regardless of any changes/customizations that might be done to this SCSS variable. This covers adding/removing some breakpoint or changing breakpoint value. You may test it using [this gist](https://www.sassmeister.com/gist/d2af1ee566d454337663caa4b462c9b).\n\n# Solution\nIt's time to write some SCSS code. My solution will be based on Bootstrap 4 convention `hidden-*` where elements with given class are hidden on selected screen size ([see bootstrap docs](https://v4-alpha.getbootstrap.com/layout/responsive-utilities/#available-classes)). Replicating `hidden-*-up` or `hidden-*-down` should be equally easy.\n\n```scss\n$breakpoints-keys: map-keys($screen-breakpoints);\n$breakpoints-values: map-values($screen-breakpoints);\n@for $i from 1 to length($breakpoints-keys)+1 {\n  @if $i < length($breakpoints-keys) {\n    .hidden-#{nth($breakpoints-keys, $i)} {\n      @media (min-width: nth($breakpoints-values, $i)) and (max-width: #{nth($breakpoints-values, $i+1)}) {\n        display: none;\n      }\n    }\n  } @else {\n    .hidden-#{nth($breakpoints-keys, $i)} {\n      @media (min-width: nth($breakpoints-values, $i)) {\n        display: none;\n      }\n    }\n  }\n}\n```\nWhy it looks so scary? Well I didn't find any other option to iterate over a [SCSS map](http://sass-lang.com/documentation/Sass/Script/Functions.html) with numerical index. The only option was to get map keys with `map-keys()` and then iterate over them with a regular `@for` loop.\n\nIf you would like to see a CSS output of the code please check my [SCSS gist](https://www.sassmeister.com/gist/d2af1ee566d454337663caa4b462c9ba).\n\n# How to use it?\nJust declare mentioned **SCSS** code somewhere in you Ionic SCSS files e.g. inside **src/app/show-hide-screen-size.scss** and then import it (with `@import \"./show-hide-screen-size\";`) to the main SCSS file e.g. **src/app/app.scss**.\n\nNow you may add `hidden-xs hidden-sm hidden-md hidden-lg hidden-xl` classes to any HTML element to hide it for selected screen size e.g.\n```html\n<div class=\"hidden-xs hidden-lg\">\nNot visible on XS and LG screens, but visible on any other screen sizes\n</div>\n```\n\n# Code description\nLet's start from the beginning.\n\nFirst we need to get keys (e.g. `xs`, `sm`, etc.) and values (e.g. `0`, `576px`, etc.) from `$screen-breakpoints` map to be able to reference them using numerical index which will allow to look ahead of current index and get `max-width` value.\n```scss\n$breakpoints-keys: map-keys($screen-breakpoints);\n$breakpoints-values: map-values($screen-breakpoints);\n```\n\nThen there is a loop over all breakpoints which generates a CSS rules. Please note that lists in SCSS are indexed from `1` to `n+1` (which is kind of tricky if you are used to any \"normal\" programming language).\n```scss\n@for $i from 1 to length($breakpoints-keys)+1 {\n  ...\n}\n```\n\nUnfortunately there is no easy/readable way of handling an edge case which is last breakpoint `hidden-xl` where `max-width` limit should be omitted thus this ugly `@if` construction seems to be required:\n```scss\n  @if $i < length($breakpoints-keys) {\n    ...\n  } @else {\n    ...\n  }\n}\n```\n\nNow look at code which generates a common CSS rule `@media (min-width: ...) and (max-width: ...)`. As you can see for a lower bound `min-width` we take current index `$i` while an upper bound `max-width` is generated using next index `$i+1`. A second value selected from `$breakpoints-values` will always be larger than the first one. This is exactly what we need here.\n```scss\n.hidden-#{nth($breakpoints-keys, $i)} {\n  @media (min-width: nth($breakpoints-values, $i)) and (max-width: #{nth($breakpoints-values, $i+1)}) {\n    display: none;\n  }\n}\n```\n\nLastly an \"edge case\" of last CSS rule has to be handled. It is generated using same structure as before but without upper bound `max-width:...`\n```scss\n.hidden-#{nth($breakpoints-keys, $i)} {\n  @media (min-width: nth($breakpoints-values, $i)) {\n    display: none;\n  }\n}\n```\n\n# Sources\nhttps://forum.ionicframework.com/t/how-do-i-hide-or-show-content-depending-on-screen-size/94081/11\nhttps://ionicframework.com/docs/theming/overriding-ionic-variables/\nhttp://sass-lang.com/documentation/Sass/Script/Functions.html\n","excerpt":"Here is a complete Bootstrap-like solution for showing and hiding selected Ionic components based on screen size. Go to solutionâ€¦","frontmatter":{"title":"Ionic 3 show/hide content based on screen size","slug":"ionic-3-conditional-visibility-of-elements","date":"2018-06-12T22:46:00.000Z","tags":["frontend"],"date_created":"2018-07-02T09:23:24.000Z","date_updated":"2018-06-14T10:50:47.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1464380573004-8ca85a08751a.jpg","relativePath":"posts/img/photo-1464380573004-8ca85a08751a.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIFAwT/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGtOfY6xw//xAAZEAACAwEAAAAAAAAAAAAAAAACAwEEEhD/2gAIAQEAAQUCY0FQVySWBaC4vYoqgnn/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAdEAACAgEFAAAAAAAAAAAAAAAAAgFRAxARISIx/9oACAEBAAY/Au7DTiXlbohrIs39bT//xAAdEAEBAAEEAwAAAAAAAAAAAAABEQAQITGhQWHR/9oACAEBAAE/IawD15c3VgU7shQkWOA6yuesQlZSvzT/2gAMAwEAAgADAAAAEADP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHxABAAEEAQUAAAAAAAAAAAAAAREAITFBsRBhcYGR/9oACAEBAAE/ELvjjLwBQPhS4VWgHe3ujNU4EJOqeUIxCcouT5U+GktkOjDnp//Z","aspectRatio":2,"src":"/static/6429bd08cf84df049f2b650726b45862/0defe/photo-1464380573004-8ca85a08751a.jpg","srcSet":"/static/6429bd08cf84df049f2b650726b45862/38b6a/photo-1464380573004-8ca85a08751a.jpg 150w,\n/static/6429bd08cf84df049f2b650726b45862/e201c/photo-1464380573004-8ca85a08751a.jpg 300w,\n/static/6429bd08cf84df049f2b650726b45862/0defe/photo-1464380573004-8ca85a08751a.jpg 600w,\n/static/6429bd08cf84df049f2b650726b45862/a71f1/photo-1464380573004-8ca85a08751a.jpg 900w,\n/static/6429bd08cf84df049f2b650726b45862/8d595/photo-1464380573004-8ca85a08751a.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"eddb7efd-26dd-57b6-8933-072249c5a882","html":"<p>The Splash Screen component is available for a long time but only as <a href=\"https://ionicframework.com/docs/native/splash-screen/\">Ionic Native component</a>, so we can't use it inside browser. I will describe here my approach to create a browser compilant splash screen implementation for Ionic 3 based applications.</p>\n<h2>Github</h2>\n<p>The complete code with all modifications may be reviewed on the Github repository <a href=\"https://github.com/jmarceli/ionic-splash-screen-pwa\">ionic-splash-screen-pwa</a>.\nDemo is available on <a href=\"https://jmarceli.github.io/ionic-splash-screen-pwa/\">https://jmarceli.github.io/ionic-splash-screen-pwa/</a> (you won't see much unless you simulate not-so fast \"Fast 3G\" connection in Google Dev Tools)</p>\n<h2>Step 1 - Initialization</h2>\n<p>Let's start by creating sample project according to the official <a href=\"https://ionicframework.com/getting-started\">docs</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">ionic start splash-screen-ionic tabs</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>After answering a few simple questions (with \"n\" - for no) you should see the sample app.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/70ec1a89a842ee3db066eb9f2fa51151/235e3/screen-shot-2018-05-14-at-12.14.42.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.55795677799607%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAADPUlEQVQ4y6WS3W/bVBTALU1CQLuukE4wxANIwKoIQSsQ4nEvLFnb0VL2UCHRB4uPPQypYnvoH8BLH6a1otnKUlKKMlT6d/A8xES7NMmSOLET27F949jO1/W9h3Pv2ANISAiO9PM5tqyfzz3Hyhnl1VOvvzx55aXzr33+7vsX1JnZGfXtmVnMs+rZF86pz45NqGOnJ9XxiUl1bOKvWfDM6TPq0+MTn+G7n0w+PzWmvPLiG8/NXbxgfbSyAl+t3YCrV7+E1dVVyfLyMqQuzUEqfQkuplKQSqUfk07jfRo+QBbm5mBpYUHUw+nz09PKx1eWp+7f/7Va1zRotZq02WzGjUYj1jQt1g0jfnR0FJ8UCvFJsRyXisX46LgY/350LJ+VSsX4YeGEPqpo8ODBb+7GxkZSuf719US5XNaMZhOFLabrOh8OhxwAOF44sS3uOg7vdgPexqwbJjeaLe66Liekw4MwYv3hCDzXJblcLqmsra1JYb1eB+yKIWAYBogP9KIQdD8CE/GjPkRRBP1+XyLqqNfD3GOcMfA8QnZ3d5PK+vp6olAoaELiOA5DwLIsME0TOp0O+CFKBgPAroGzGJggprIWMewPmMhRGJI90aGqqgmcmSa+2O12me/7UoQ1hGEI1boBx6Ua1HQLKg0TaoYND8t1cPweNFoOlBsmI9EINMMmma1MUpmfn0/gETR4HAz+FpbjQbmmQ6vtocAG3Wyj3IRoQKGiGVAxXUZx2G3XJ3dufZtUlpaWEkEQSCHnnCHwBBFiBPL4hMhRtNttsTygdCRnXTIdJrrokg65u7WdVBYXFxN4tH8Umihp6Aa4noeLakET0eoNGI1GUKtW4ZeKxXwKEHY65M7mvxA6jiuFjuvK2rJtqNbqctOW3QbbJXJMxMMOhfDy5Q9RGFTkABkbYaIok4gal0Qty6Z+tytrlFL8H+lg0KOu69AoDEYMOBDiO1s3cYafrixOeZ3AebIESmP4L9ELwnjvu903lffeeWv83k8H3+znD/cOD3++u7+/nz04OMjm83kJ/qzZ7e1MNpO5LdnZ2cG8l93czGdvbeWzt7d/yN7LZHI/fp+7+cW1a+eUP+MU8tT/RDiUPwA9KHAlrj4A8wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen-Shot-2018-05-14-at-12.14.42\"\n        title=\"Screen-Shot-2018-05-14-at-12.14.42\"\n        src=\"/static/70ec1a89a842ee3db066eb9f2fa51151/a3419/screen-shot-2018-05-14-at-12.14.42.png\"\n        srcset=\"/static/70ec1a89a842ee3db066eb9f2fa51151/a1986/screen-shot-2018-05-14-at-12.14.42.png 210w,\n/static/70ec1a89a842ee3db066eb9f2fa51151/ad7fb/screen-shot-2018-05-14-at-12.14.42.png 420w,\n/static/70ec1a89a842ee3db066eb9f2fa51151/a3419/screen-shot-2018-05-14-at-12.14.42.png 840w,\n/static/70ec1a89a842ee3db066eb9f2fa51151/4d498/screen-shot-2018-05-14-at-12.14.42.png 1260w,\n/static/70ec1a89a842ee3db066eb9f2fa51151/70b58/screen-shot-2018-05-14-at-12.14.42.png 1680w,\n/static/70ec1a89a842ee3db066eb9f2fa51151/235e3/screen-shot-2018-05-14-at-12.14.42.png 2036w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\n<strong>At this point please make sure that you've checked \"Disable cache\" in Chrome Dev Tools. It is required to view the results easily.</strong>\nNow refresh browser tab with your App. You should see a \"flash\" of white screen before viewing actual App content.</p>\n<h2>Step 2 - Preloader</h2>\n<p>The splash screen should be simple and shouldn't require any images in order to load as fast as possible.</p>\n<p>As an example let's use the Ionic theme primary color. In order to do so append this code to the <strong>src/app/app.scss</strong> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-scss line-numbers\"><code class=\"language-scss\"><span class=\"token selector\">body </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">color</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$colors</span><span class=\"token punctuation\">,</span> primary<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Now after refreshing the App you will see no white screen at all (it will be blue screen instead).\nBut wait it is just a background color change not a \"real\" splash screen!</p>\n<p>Time to mess with some HTML. Nice HTML/CSS based \"preloaders\" may be found on the <a href=\"http://tobiasahlin.com/spinkit/\">SpinKit</a> project pages. I will use the <strong>fading-circle</strong> animation but feel free to select your own (you may, of course, change it later).\nOpen <strong>src/index.html</strong> and after <code class=\"language-text\">&lt;ion-app&gt;&lt;/ion-app&gt;</code> add following lines (please note that top <code class=\"language-text\">&lt;div&gt;</code> has an ID, it will be important):</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- custom splash screen (non-angular component) --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>splash-screen<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>splash<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-fading-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle1 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle2 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle3 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle4 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle5 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle6 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle7 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle8 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle9 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle10 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle11 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sk-circle12 sk-circle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Then head to <strong>src/app/app.scss</strong> and append a few more lines:</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-scss line-numbers\"><code class=\"language-scss\"><span class=\"token selector\">.sk-fading-circle </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 100px auto<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 40px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 40px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">left</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">top</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> block<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0 auto<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 15%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 15%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #333<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">animation</span><span class=\"token punctuation\">:</span> sk-circleFadeDelay 1.2s infinite ease-in-out both<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle2 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>30deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle3 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>60deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle4 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>90deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle5 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>120deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle6 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>150deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle7 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>180deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle8 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>210deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle9 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>240deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle10 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>270deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle11 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>300deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle12 </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>330deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle2:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -1.1s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle3:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -1s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle4:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -0.9s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle5:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -0.8s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle6:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -0.7s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle7:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -0.6s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle8:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -0.5s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle9:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -0.4s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle10:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -0.3s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle11:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -0.2s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.sk-fading-circle .sk-circle12:before </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> -0.1s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token atrule\"><span class=\"token rule\">@keyframes</span> sk-circleFadeDelay</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">0%, 39%, 100% </span><span class=\"token punctuation\">{</span> <span class=\"token property\">opacity</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">40% </span><span class=\"token punctuation\">{</span> <span class=\"token property\">opacity</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Browser prefixes were omitted for brevity but you should copy entire code from mentioned SpinKit project page. It is available after clicking on \"Source\" link (on the top of the page).\nFinally add some custom CSS to <strong>src/app/app.scss</strong> which will position the animation:</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-scss line-numbers\"><code class=\"language-scss\"><span class=\"token selector\">#splash-screen </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">opacity</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> opacity 0.2s<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">z-index</span><span class=\"token punctuation\">:</span> 999<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">align-items</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">justify-content</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">color</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$colors</span><span class=\"token punctuation\">,</span> primary<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now our splash screen/preloader looks much nicer.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5c8b25e90719b11193bde0d5d08359a5/235e3/screen-shot-2018-05-14-at-12.14.57.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.55795677799607%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAADOUlEQVQ4y6WSW2gcVRjHBwqi5NLUpNr0QfsihrUPXaMg+KBCNjPZTtoqfSgKKUwt0Qcf9cUHH5Im3YQqtjZqJtnYzZvgBXwoggVBsBSLJWI3l6bJbvY2szuXTXbntjPn/D2zm6JSCIIHfnzfN8z5cb7zHW4/99S+544cOP105JnzL738qvRi/zGp//mo9EJ/VOo93Cu1tXdKbR1dUntnl9TW+e8Y8ljHfunR9s63Dz7Z+2bX4z1t3JFDfQcGXntFPX76DN597wOcO/8Ozrx1ljEC8cQbiAlx8MIQBnkePC+0EARWC4gxxHgcp0QxzL2+Z/v6uEMRvkf4KLM5PKFDHFd88UI5EMfV4PiYEogTWnD9p3SQWV8O0qvrwdraWvBnmnE3HaysrAT3WL28vOqvb2Txx9KSnkgkItzByKnugQtudugTYHAKhEH56RaxBOiN3yrUrxvUqtWpruu0WFQYJWoYBq1Wq9SyLOI1GjANw0wmkxHuiciJ7thYLRu/BAgJQhhoMkUxMBng13QNS6qKWyUbZs2GUXea6CzXGKblEsunKGqGuTA/FwpPdsfG69n4xwCfoESYQlMWxtgkxe11DxQBKraPIAjg/wMKwPM8wgIs2zK/Wkg+LOQTD4QUYf7DTRXlShn5ko6NLQXZYhkr97egbdvIKzrWcgox6g2UKlVzZnb+YeEwaz0+Hcpawh9v68jlc8irBnKlChNXkMkrqLs+slsFLOXLRHWBne0d84u5hb1abglv/K5jx1RhGFWo7C41TUOppMD3G1CLBdzJlci9OoVe3TYvy3u1HJ6Qya/fUlBWcqzt8KQF5AtFbGaycD0Puc0N/HK/QL7OBfg5Y5rvfzq/91AGL1LcXHVAGha7dBeO48K2HbCnAkIIHDucskM8NhQ3HMq1a61nMzBW2xiaDoWkwfCFJtSPTRL/Tob67H/2MNCMD6B09zsJGuGUbdvWFlMpJjz6es/ghKud/BwQLzOuAMO7xFl9V8F/Wo7jBIuLi0e5jsPH2qMj34xHz36/EB35dpYh/8138ocX5+XZL6/KVz6bka/OtJDlOZltllOpVBOWJ1m8NDo62svtrn2MR/4noYP7CzzKE65qeJnbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen-Shot-2018-05-14-at-12.14.57\"\n        title=\"Screen-Shot-2018-05-14-at-12.14.57\"\n        src=\"/static/5c8b25e90719b11193bde0d5d08359a5/a3419/screen-shot-2018-05-14-at-12.14.57.png\"\n        srcset=\"/static/5c8b25e90719b11193bde0d5d08359a5/a1986/screen-shot-2018-05-14-at-12.14.57.png 210w,\n/static/5c8b25e90719b11193bde0d5d08359a5/ad7fb/screen-shot-2018-05-14-at-12.14.57.png 420w,\n/static/5c8b25e90719b11193bde0d5d08359a5/a3419/screen-shot-2018-05-14-at-12.14.57.png 840w,\n/static/5c8b25e90719b11193bde0d5d08359a5/4d498/screen-shot-2018-05-14-at-12.14.57.png 1260w,\n/static/5c8b25e90719b11193bde0d5d08359a5/70b58/screen-shot-2018-05-14-at-12.14.57.png 1680w,\n/static/5c8b25e90719b11193bde0d5d08359a5/235e3/screen-shot-2018-05-14-at-12.14.57.png 2036w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nStill there is a room for improvement as it is not hiding even after the App is fully loaded...</p>\n<h2>Step 3 - Fading out</h2>\n<p>It's time to add some JS to our <strong>src/app/app.component.ts</strong> which will handle splash screen hiding when App is ready. Open mentioned file and replace its content with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Platform <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'ionic-angular'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> TabsPage <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../pages/tabs/tabs'</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  templateUrl<span class=\"token punctuation\">:</span> <span class=\"token string\">'app.html'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyApp</span> <span class=\"token punctuation\">{</span>\n  rootPage<span class=\"token punctuation\">:</span>any <span class=\"token operator\">=</span> TabsPage<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">public</span> platform<span class=\"token punctuation\">:</span> Platform</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleSplashScreen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// hide #splash-screen when app is ready</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">handleSplashScreen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Promise<span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// wait for App to finish loading</span>\n      <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>platform<span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Platform initialization bug'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Any operation that shoud be performed BEFORE showing user UI,</span>\n    <span class=\"token comment\">// in a real App that may be cookie based authentication check e.g.</span>\n    <span class=\"token comment\">// await this.authProvider.authenticate(...)</span>\n\n    <span class=\"token comment\">// fade out and remove the #splash-screen</span>\n    <span class=\"token keyword\">const</span> splash <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'splash-screen'</span><span class=\"token punctuation\">)</span>\n    splash<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>opacity <span class=\"token operator\">=</span> <span class=\"token string\">'0'</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> splash<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Save it. Your App is ready!</p>\n<p>Here is a description of <strong>src/app/app.component.ts</strong> modifications</p>\n<h3>imports</h3>\n<p>First of all <code class=\"language-text\">@ionic-native</code> <strong>StatusBar</strong> and <strong>SplashScreen</strong> were removed because we are dealing with browser only app. This is also the reason why we can simplify MyApp <code class=\"language-text\">constructor()</code> method.</p>\n<h3>constructor()</h3>\n<p>As mentioned above, no need for native components.</p>\n<h3>handleSpashScreen()</h3>\n<p>This method will take advantage of <code class=\"language-text\">async/await</code> construction supported by the Ionic 3 Framework. Reading method code line by line:</p>\n<ol>\n<li>We are waiting for App to be ready with <code class=\"language-text\">await</code></li>\n<li>Then we may execute some initialization related custom code</li>\n<li>Finally <strong>#splash-screen</strong> should fade out and then it should be removed, timeout of <strong>300 ms</strong> is not a general solution but in this case <strong>200 ms</strong> animation is hardcoded into CSS, so it should be a reasonable value</li>\n</ol>\n<p>The result (from Chrome Performance tab):\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8a34195d68d9186f79225d343c065dc5/a55da/screen-shot-2018-05-14-at-11.33.17.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.067961165048544%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACzklEQVQoz23SzU8TQRQA8L0aTx78DzyZWA2QLcSDQFsI8eqfYsQUPw6KnjxoYiShkEgjFRGMXORDoyWY0oYGFLrt0lYou9vudtvdpWz3Y3ZnngMSjcZJfnkvk3nJm5nHpN68PbeV/Ty8U8iP8PliNJ/fjX7fyUdzHB/luEI0nd6IpjPUeiaaofJcPloqlf41UiwWh5PJ5Hkm8Sp+uW0aAMQDjNsA4FAYXA8B8S3wEd0jLt3xwKNnfOLD/9aRacLCwvtu5vnYs0sHAm+LlZK/USyjHf4bKu2mEc9nEF9Io+JuBmWzW0hu1FDbN5Gq1ZF4ICJJlJAoiCcEQfS4HGfFYjGWiU/PBZTagbdfzMDXdJqktstkfdcgqYJGUrxOaWQtpxFB1onZPiLaoUZkVSY1pUbUpkLqDYU0dBWqsoTi8XiQmU5MB1pHLXqfNiDXJE8+aHD/nQF35w24M2fAvXmdRh1uJhpwa0ajdMqA2691WMzKINarRG7WQJQFlEgkgszMzEzA933v+B00k5AbT1249sCG3ocOZUNo1IK+4/jIhshjC/pH7RMRKrFqQbvtENdxwTwy0crKCu1wmnbYMulru+B4QOJrLrz46MD4F4CJVYBJKpb8ZSL5Jx//5MNmmda4iHi+D5ZloaWlpSAzERsLFEplJEs5MKQyxr6PAVxsKBwu/+BwZZ/DosBjqVo+VcKitIdbDRGDrWIfE0yLwHEcd2l5Oci8nJoKVIU9kBo1UBUJLJuOCx2NplyAvdImyGIO1BoHisRB9WCb5gVQZR5ahwpgzwRyOja2bZPFxcVuZmJy6mKlsqdIlYIuSNUmHVCtWq1pDfqdmk7R2DzWPGb8pjaamlJXNUVRmvV6Xac1yuzsbCdzpSN45vpQuKOv50Lwak+Q7Q52sqFQmB2I9LOh/l6a97LhUB8bDv8tEgmzgwMRdnBw8MTQ0FBHV1fX2Z+Sd7q1yISSvAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen-Shot-2018-05-14-at-11.33.17\"\n        title=\"Screen-Shot-2018-05-14-at-11.33.17\"\n        src=\"/static/8a34195d68d9186f79225d343c065dc5/a3419/screen-shot-2018-05-14-at-11.33.17.png\"\n        srcset=\"/static/8a34195d68d9186f79225d343c065dc5/a1986/screen-shot-2018-05-14-at-11.33.17.png 210w,\n/static/8a34195d68d9186f79225d343c065dc5/ad7fb/screen-shot-2018-05-14-at-11.33.17.png 420w,\n/static/8a34195d68d9186f79225d343c065dc5/a3419/screen-shot-2018-05-14-at-11.33.17.png 840w,\n/static/8a34195d68d9186f79225d343c065dc5/a55da/screen-shot-2018-05-14-at-11.33.17.png 1236w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<h2>Evaluation</h2>\n<p>Is it any better than it was before <strong>#splash-screen</strong> modification?</p>\n<p><strong>Before</strong> adding the splash screen inside Chrome Performance tab we can see this:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/469a4e562fbcc5e6a0e192d73749e6b4/a55da/screen-shot-2018-05-14-at-11.34.28.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.067961165048544%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACfUlEQVQoz4XRS2/TQBAAYF8RJw78Am5IBNQgp+2pNClV+EOV0v+BBBRRiSaljwtwaXtBKki0aUFI1InzapvEjzh+Nn6svevdYWMJ1CIkVv7snZVmNeMRvm7v3vnx7dOKJDdXW3KrInNnklxpNtucXDk5Oc3Uj+uV+lE9O+t2u3/prHbarZXDwy93hXfVtw/DwANKCWAcA0kTSCkFHyWQJAiiKABMEiAUA2EECCHwrzWZePD+w8dZ4fnLFw+UoYR0tZcif4xD+wwn1hFGZj0Tm8fYVGQcxBMckADrIx0PBwpWFRUrQ+U30pAa0draK1Gobu7mdG1AzMEpjPufWeD2WRgFzA/dTBB5zPNcdjXxeOwzyzGZYRlMN3Q2to1sb7kmqLqC19fXC0Jts5bz/QkhSQh+aLE4RpAQDCEJMxEXYB/8eML3AaA0BEQReBMXRqYKmqkyw9FBGQ1xrVorCFtbWzk6/YF8Mf6w6Xf6ZnAT3IwxwhBHCFAUM5xgCPwAHxwc8AqrG7zCgGQ5acJSmmZD+d8imPGh8cFhnpOmfHgR3t/fLwgb1Vqu2W5jU2uDobZoFCEK/FpTa1BJlqjcbtDOuUy7l91Mj+tc9Kih9ikjiDfH6LSjOI6T7MLq9m5O7Z+DoV+CZpuA4jjraWJ1od/7DoYigT1qwFiTQB/+BNuQwRrJ4HvqtKU/FSOE2N7e3qyw9vrN/X7/wlAGLXc4VOxOp+NomuZY9pXjuJxz5dhT9jU8Ni3HMYwxZ9jj8djlOcbOzk5eeJSfu/WsXJxZnLtXmJ8viLOFvFgslcSnS4ticXFBLBYXxFLxiVgqXcPjpaWiuLy8/Ee5XJ7JP87f/gX9EdxcKG7X1AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen-Shot-2018-05-14-at-11.34.28\"\n        title=\"Screen-Shot-2018-05-14-at-11.34.28\"\n        src=\"/static/469a4e562fbcc5e6a0e192d73749e6b4/a3419/screen-shot-2018-05-14-at-11.34.28.png\"\n        srcset=\"/static/469a4e562fbcc5e6a0e192d73749e6b4/a1986/screen-shot-2018-05-14-at-11.34.28.png 210w,\n/static/469a4e562fbcc5e6a0e192d73749e6b4/ad7fb/screen-shot-2018-05-14-at-11.34.28.png 420w,\n/static/469a4e562fbcc5e6a0e192d73749e6b4/a3419/screen-shot-2018-05-14-at-11.34.28.png 840w,\n/static/469a4e562fbcc5e6a0e192d73749e6b4/a55da/screen-shot-2018-05-14-at-11.34.28.png 1236w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nSo the App shows blank page for first <strong>1100ms</strong> while splash screen \"solution\" should make an impression that something is going on just after <strong>~300ms</strong>. For larger applications with much more JS (or slow GSM connections) this difference should be even larger.</p>\n<h2>Disclaimer</h2>\n<p>All tests were performed using local build and integrated webpack web server. So the results for <a href=\"https://jmarceli.github.io/ionic-splash-screen-pwa/\">Demo page</a> accessed through the Internet should/may be different.</p>\n<h2>Sources</h2>\n<p>These are pages I was looking at while creating my solution:\n<a href=\"https://ionicframework.com/docs/native/splash-screen/\">https://ionicframework.com/docs/native/splash-screen/</a>\n<a href=\"https://angularfirebase.com/lessons/generate-a-custom-spash-screen-and-icons-in-ionic/\">https://angularfirebase.com/lessons/generate-a-custom-spash-screen-and-icons-in-ionic/</a>\n<a href=\"http://tobiasahlin.com/spinkit/\">http://tobiasahlin.com/spinkit/</a>\n<a href=\"https://stackoverflow.com/questions/29017379/how-to-make-fadeout-effect-with-pure-javascript#answer-29017677\">https://stackoverflow.com/questions/29017379/how-to-make-fadeout-effect-with-pure-javascript#answer-29017677</a></p>","timeToRead":7,"rawMarkdownBody":"The Splash Screen component is available for a long time but only as [Ionic Native component](https://ionicframework.com/docs/native/splash-screen/), so we can't use it inside browser. I will describe here my approach to create a browser compilant splash screen implementation for Ionic 3 based applications.\n\n## Github\nThe complete code with all modifications may be reviewed on the Github repository [ionic-splash-screen-pwa](https://github.com/jmarceli/ionic-splash-screen-pwa).\nDemo is available on https://jmarceli.github.io/ionic-splash-screen-pwa/ (you won't see much unless you simulate not-so fast \"Fast 3G\" connection in Google Dev Tools)\n\n## Step 1 - Initialization\nLet's start by creating sample project according to the official [docs](https://ionicframework.com/getting-started).\n```bash\nionic start splash-screen-ionic tabs\n```\nAfter answering a few simple questions (with \"n\" - for no) you should see the sample app.\n![Screen-Shot-2018-05-14-at-12.14.42](img/screen-shot-2018-05-14-at-12.14.42.png)\n**At this point please make sure that you've checked \"Disable cache\" in Chrome Dev Tools. It is required to view the results easily.**\nNow refresh browser tab with your App. You should see a \"flash\" of white screen before viewing actual App content.\n\n## Step 2 - Preloader\nThe splash screen should be simple and shouldn't require any images in order to load as fast as possible.\n\nAs an example let's use the Ionic theme primary color. In order to do so append this code to the **src/app/app.scss** file:\n```scss\nbody {\n  background: color($colors, primary);\n}\n```\nNow after refreshing the App you will see no white screen at all (it will be blue screen instead).\nBut wait it is just a background color change not a \"real\" splash screen!\n\nTime to mess with some HTML. Nice HTML/CSS based \"preloaders\" may be found on the [SpinKit](http://tobiasahlin.com/spinkit/) project pages. I will use the **fading-circle** animation but feel free to select your own (you may, of course, change it later).\nOpen **src/index.html** and after `<ion-app></ion-app>` add following lines (please note that top `<div>` has an ID, it will be important):\n```html\n<!-- custom splash screen (non-angular component) -->\n<div id=\"splash-screen\" class=\"splash\">\n  <div class=\"sk-fading-circle\">\n    <div class=\"sk-circle1 sk-circle\"></div>\n    <div class=\"sk-circle2 sk-circle\"></div>\n    <div class=\"sk-circle3 sk-circle\"></div>\n    <div class=\"sk-circle4 sk-circle\"></div>\n    <div class=\"sk-circle5 sk-circle\"></div>\n    <div class=\"sk-circle6 sk-circle\"></div>\n    <div class=\"sk-circle7 sk-circle\"></div>\n    <div class=\"sk-circle8 sk-circle\"></div>\n    <div class=\"sk-circle9 sk-circle\"></div>\n    <div class=\"sk-circle10 sk-circle\"></div>\n    <div class=\"sk-circle11 sk-circle\"></div>\n    <div class=\"sk-circle12 sk-circle\"></div>\n  </div>\n</div>\n```\nThen head to **src/app/app.scss** and append a few more lines:\n```scss\n.sk-fading-circle {\n  margin: 100px auto;\n  width: 40px;\n  height: 40px;\n  position: relative;\n}\n.sk-fading-circle .sk-circle {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n.sk-fading-circle .sk-circle:before {\n  content: '';\n  display: block;\n  margin: 0 auto;\n  width: 15%;\n  height: 15%;\n  background-color: #333;\n  border-radius: 100%;\n  animation: sk-circleFadeDelay 1.2s infinite ease-in-out both;\n}\n.sk-fading-circle .sk-circle2 {\n  transform: rotate(30deg);\n}\n.sk-fading-circle .sk-circle3 {\n  transform: rotate(60deg);\n}\n.sk-fading-circle .sk-circle4 {\n  transform: rotate(90deg);\n}\n.sk-fading-circle .sk-circle5 {\n  transform: rotate(120deg);\n}\n.sk-fading-circle .sk-circle6 {\n  transform: rotate(150deg);\n}\n.sk-fading-circle .sk-circle7 {\n  transform: rotate(180deg);\n}\n.sk-fading-circle .sk-circle8 {\n  transform: rotate(210deg);\n}\n.sk-fading-circle .sk-circle9 {\n  transform: rotate(240deg);\n}\n.sk-fading-circle .sk-circle10 {\n  transform: rotate(270deg);\n}\n.sk-fading-circle .sk-circle11 {\n  transform: rotate(300deg);\n}\n.sk-fading-circle .sk-circle12 {\n  transform: rotate(330deg);\n}\n.sk-fading-circle .sk-circle2:before {\n  animation-delay: -1.1s;\n}\n.sk-fading-circle .sk-circle3:before {\n  animation-delay: -1s;\n}\n.sk-fading-circle .sk-circle4:before {\n  animation-delay: -0.9s;\n}\n.sk-fading-circle .sk-circle5:before {\n  animation-delay: -0.8s;\n}\n.sk-fading-circle .sk-circle6:before {\n  animation-delay: -0.7s;\n}\n.sk-fading-circle .sk-circle7:before {\n  animation-delay: -0.6s;\n}\n.sk-fading-circle .sk-circle8:before {\n  animation-delay: -0.5s;\n}\n.sk-fading-circle .sk-circle9:before {\n  animation-delay: -0.4s;\n}\n.sk-fading-circle .sk-circle10:before {\n  animation-delay: -0.3s;\n}\n.sk-fading-circle .sk-circle11:before {\n  animation-delay: -0.2s;\n}\n.sk-fading-circle .sk-circle12:before {\n  animation-delay: -0.1s;\n}\n@keyframes sk-circleFadeDelay {\n  0%, 39%, 100% { opacity: 0; }\n  40% { opacity: 1; }\n}\n```\nBrowser prefixes were omitted for brevity but you should copy entire code from mentioned SpinKit project page. It is available after clicking on \"Source\" link (on the top of the page).\nFinally add some custom CSS to **src/app/app.scss** which will position the animation:\n```scss\n#splash-screen {\n  opacity: 1;\n  transition: opacity 0.2s;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 999;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: color($colors, primary);\n}\n```\n\nNow our splash screen/preloader looks much nicer.\n![Screen-Shot-2018-05-14-at-12.14.57](img/screen-shot-2018-05-14-at-12.14.57.png)\nStill there is a room for improvement as it is not hiding even after the App is fully loaded...\n\n## Step 3 - Fading out\nIt's time to add some JS to our **src/app/app.component.ts** which will handle splash screen hiding when App is ready. Open mentioned file and replace its content with:\n```js\nimport { Component } from '@angular/core';\nimport { Platform } from 'ionic-angular';\n\nimport { TabsPage } from '../pages/tabs/tabs';\n\n@Component({\n  templateUrl: 'app.html'\n})\nexport class MyApp {\n  rootPage:any = TabsPage;\n\n  constructor(public platform: Platform) {\n    this.handleSplashScreen()\n  }\n\n  // hide #splash-screen when app is ready\n  async handleSplashScreen(): Promise<void> {\n    try {\n      // wait for App to finish loading\n      await this.platform.ready()\n    } catch (error) {\n      console.error('Platform initialization bug')\n    }\n\n    // Any operation that shoud be performed BEFORE showing user UI,\n    // in a real App that may be cookie based authentication check e.g.\n    // await this.authProvider.authenticate(...)\n\n    // fade out and remove the #splash-screen\n    const splash = document.getElementById('splash-screen')\n    splash.style.opacity = '0'\n    setTimeout(() => { splash.remove() }, 300)\n  }\n}\n```\nSave it. Your App is ready!\n\nHere is a description of **src/app/app.component.ts** modifications\n\n### imports\nFirst of all `@ionic-native` **StatusBar** and **SplashScreen** were removed because we are dealing with browser only app. This is also the reason why we can simplify MyApp `constructor()` method.\n\n### constructor()\nAs mentioned above, no need for native components.\n\n### handleSpashScreen()\nThis method will take advantage of `async/await` construction supported by the Ionic 3 Framework. Reading method code line by line:\n1. We are waiting for App to be ready with `await`\n2. Then we may execute some initialization related custom code\n3. Finally **#splash-screen** should fade out and then it should be removed, timeout of **300 ms** is not a general solution but in this case **200 ms** animation is hardcoded into CSS, so it should be a reasonable value\n\nThe result (from Chrome Performance tab):\n![Screen-Shot-2018-05-14-at-11.33.17](img/screen-shot-2018-05-14-at-11.33.17.png)\n\n## Evaluation\nIs it any better than it was before **#splash-screen** modification?\n\n**Before** adding the splash screen inside Chrome Performance tab we can see this:\n![Screen-Shot-2018-05-14-at-11.34.28](img/screen-shot-2018-05-14-at-11.34.28.png)\nSo the App shows blank page for first **1100ms** while splash screen \"solution\" should make an impression that something is going on just after **~300ms**. For larger applications with much more JS (or slow GSM connections) this difference should be even larger.\n\n## Disclaimer\nAll tests were performed using local build and integrated webpack web server. So the results for [Demo page](https://jmarceli.github.io/ionic-splash-screen-pwa/) accessed through the Internet should/may be different.\n\n## Sources\nThese are pages I was looking at while creating my solution:\nhttps://ionicframework.com/docs/native/splash-screen/\nhttps://angularfirebase.com/lessons/generate-a-custom-spash-screen-and-icons-in-ionic/\nhttp://tobiasahlin.com/spinkit/\nhttps://stackoverflow.com/questions/29017379/how-to-make-fadeout-effect-with-pure-javascript#answer-29017677\n","excerpt":"The Splash Screen component is available for a long time but only as Ionic Native component, so we can't use it inside browser. I willâ€¦","frontmatter":{"title":"Ionic 3 browser splash screen / preloader","slug":"ionic-3-pwa-browser-splash-screen","date":"2018-05-14T04:07:00.000Z","tags":["frontend","javascript"],"date_created":"2018-06-05T06:53:30.000Z","date_updated":"2018-09-15T13:29:47.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/screen-shot-2018-05-14-at-11.46.25.png","relativePath":"posts/img/screen-shot-2018-05-14-at-11.46.25.png","childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAAbUlEQVQ4y2Pw6Pr/n5qYYdTAIWigeyeI/gfGCDaZBsIMIMVQAi78h2IoqgVkufAfnPYEGuTVTRUXQgyJnPrvf+ikf/9dOygyEOI6n57//+NmUMGFsLACGerSToUwRA5H1FimOB1iskfz8hAyEABqmGVGdRg2EwAAAABJRU5ErkJggg==","aspectRatio":2,"src":"/static/d6cbc93ab7bf76ff909a2325ad0d59a1/a40a8/screen-shot-2018-05-14-at-11.46.25.png","srcSet":"/static/d6cbc93ab7bf76ff909a2325ad0d59a1/eed6b/screen-shot-2018-05-14-at-11.46.25.png 150w,\n/static/d6cbc93ab7bf76ff909a2325ad0d59a1/44052/screen-shot-2018-05-14-at-11.46.25.png 300w,\n/static/d6cbc93ab7bf76ff909a2325ad0d59a1/a40a8/screen-shot-2018-05-14-at-11.46.25.png 364w","sizes":"(max-width: 364px) 100vw, 364px"}}}}}},{"node":{"id":"8baad875-6986-5327-9e09-0a8e971f5d77","html":"<p><a href=\"https://www.duplicati.com/\">Duplicati</a> is a free backup tool which is my current choice for cloud backups.</p>\n<h2>Why</h2>\n<p>Some time ago I wrote a <a href=\"https://grzegorowski.com/restic-backblaze-b2-backups\">post about Restic</a> which is a nice backup tool, but at the time of writing this...\nIt lacks backup files compression.\nIt doesn't have built-in scheduler.\nIt has only command line interface.\nIt has some <a href=\"https://grzegorowski.com/restic-backblaze-b2-backups/#backblazeb2pricing\">\"cost effectiveness\" issues regarding Backblaze B2</a> integration.\nIt is hard to tell/verify which files are excluded from backup.</p>\n<p>All of those makes me wonder if there is some other (preferably open source) tool. As for now it's <a href=\"https://www.duplicati.com/\">Duplicati</a>.</p>\n<h2>Duplicati regex filters</h2>\n<p>The main problem with regexes in Duplicati (at least for me) was .NET syntax. If you want to write anything more sophisticated than examples from the <a href=\"https://duplicati.readthedocs.io/en/latest/appendix-d-filters/\">official documentation</a> you should test it on <a href=\"http://regexstorm.net/tester\">http://regexstorm.net/tester</a> first.</p>\n<p>Examples:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">.*/sources/.*/cache/<span class=\"token punctuation\">\\</span>S+</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Will match every file inside <code class=\"language-text\">anotherdir</code> except directory itself (it is useful construction for every auto-generated cache).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">.*<span class=\"token punctuation\">\\</span>.DS_Store</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Matches every <code class=\"language-text\">.DS_Store</code> file (which is useful for Mac OS X).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">.*/sources/.*/images/_<span class=\"token punctuation\">[</span>^original<span class=\"token punctuation\">]</span><span class=\"token punctuation\">\\</span>S+</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Matches every directory/file inside <code class=\"language-text\">images</code> directory which name doesn't start with <code class=\"language-text\">_original</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">.*/sources/.*/?somedirectory/</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Will match every <code class=\"language-text\">somedirectory/</code> inside <code class=\"language-text\">sources/</code> dir no matter how deeply nested it is (or even if it is not nested at all). These paths matches regex above:</p>\n<ul>\n<li><code class=\"language-text\">something/sources/first/second/third/somedirectory/</code></li>\n<li><code class=\"language-text\">something/sources/somedirectory/</code></li>\n<li><code class=\"language-text\">something/sources/another/dir/somedirectory/</code></li>\n</ul>\n<p><strong>NOTE</strong>\nFor reasons I don't understand:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">.*/sources/.*/cache/.+</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Does also match <code class=\"language-text\">test/sources/sth/cache/</code> directory itself that is why I use <code class=\"language-text\">\\S+</code> instead of <code class=\"language-text\">.+</code> when I don't want to exclude cache directories only files/folders inside them.</p>\n<p><strong>IMPORTANT</strong>\nIf you decide to play with filters it is good to know that <strong>Source data</strong> panel inside <strong>Source data</strong> section works \"live\".\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b14f7964400920f3e52099d7cbe0f944/4bb96/duplicati_source_data_panel.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.4080459770115%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACX0lEQVQ4y5VT207bQBDNV1R9rvorjdQ89BE/lh+AF9RHXgKqKA75HCRaVa2IqCrRAKkKhJALt+CU1MHxZb073t3p7CYxaolU1fKRZ3fOHJ9ZjwtfdrafXXQa7tX1pdtunm72+zfu+Xnb7bS7bq974XY7PYvOFN1uz201z9zWWcvymq32ZqvV3DxrnlR23n94Xjj69rXU69/h6fUQB2GKHCRmUiCiJGicfxEnE8iExIRnmKYxCsFx5+OnV4UfjfqL405fkShECYM4TiBhEfjRAPzQgyAZQZwG0L/3YRiOIGIBCCloj8F9GEPKEmAsFaNxpD/v1l4WDg8OipN3otb6wVKmaI9WnBKKnlcB4K+EnFEsKGGgJlQ9a6Ver5cKx9+PikGa4SACHRkW5Yyy0pIEAU2ZWc/q8thy7DoX3N/fnwiGdA4+y3RmGFOTjIcYxHeYcoZaTYT+hlJzBA9My3Zv8lqtp72b1gDQH3nI03TSm54r/FhQTwX1Q2AFRMbRu7vEKIzIjZrztf9HkO5MAg6GfRx4AxoL8cilVOrfgjN3MpNI40AzxmjmMpRSWpfSOtV4eZ/ibi+YLzhtx+TUjMAhtphdxMljw5S0DLk0BaZY5YKNRqOIf86ThQCuoyjUcUzCnGtymOemo6APPaaFsrHK57BWqxXH4zGGYYhUjEmSUKsMfd/H29tb9DzPxkEQWI7JmaPIQOD2yU8cRQkC/XbmjPf29kqF14uLT5aXlxeWlpac1dVVZ21tzSmXyxYmXl9fz7GxseG4rmtR3ao4i2/Kztt3rrNVqTjVanVhZWXl6W8l3fAL9qOnbQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"duplicati_source_data_panel\"\n        title=\"duplicati_source_data_panel\"\n        src=\"/static/b14f7964400920f3e52099d7cbe0f944/a3419/duplicati_source_data_panel.png\"\n        srcset=\"/static/b14f7964400920f3e52099d7cbe0f944/a1986/duplicati_source_data_panel.png 210w,\n/static/b14f7964400920f3e52099d7cbe0f944/ad7fb/duplicati_source_data_panel.png 420w,\n/static/b14f7964400920f3e52099d7cbe0f944/a3419/duplicati_source_data_panel.png 840w,\n/static/b14f7964400920f3e52099d7cbe0f944/4d498/duplicati_source_data_panel.png 1260w,\n/static/b14f7964400920f3e52099d7cbe0f944/70b58/duplicati_source_data_panel.png 1680w,\n/static/b14f7964400920f3e52099d7cbe0f944/4bb96/duplicati_source_data_panel.png 2784w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nYou may edit filters list as text and then go back to filters list view.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/787f0be0a024ba4880882884335d4359/4bb96/duplicati_filters_edit_as_text.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.4080459770115%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACbElEQVQ4y5WT3U7bMBTH+xTTrqe9yiqNi12SS3gBuEG75KagDUjH40xiH9q0qtM0VkYnGKX0AwolHZCSOIljn9g+s5207KPSNCt/5djn+OdznJPSx52XD067TXdwfuZ2Wkdbw+GFe3LScbudntvvnbq9bt+qW6jX67vt1rHbPm7buFa7s9Vut7aOW9+rO69ePyztf/k01x9e4dH5NY5IigwEZoIjotBSOHvomIwj5QITlmGaxsg5w523756UDpqNR4fdodRQiBIKcZxAQiPwoxH4xIMgGUOcBjC89eGajCGiAXDB9RqFWxJDShOgNOXjMFLvP9Qel77u7ZXzM1EpdZdSJvWanjHtkPo9CABvEp2Ztrl2GMk8VE1KaTQac6XDb/vlIM1wFIGKTJT2GbJUQgMBzTYzn+yb2jbGzqfA3d3dHEj0Pfg0U5mJKJKkjGAQX2HKKCqZg/6UlDOAe6Zku5Yfq1RRuykNAP2xhyxN89rUTPDfQFUA1Z1hATxj6F2dYUQinY2c8bX/B6ifTACOroc48ka6LbhFyOLujISU/wZOshOZQN0Ouseo7rkMhRBFlrnfIwzrZ+FsYFGO8clJAIPY6tdhnDcJqB8xqEHAlBdxU7PZLKfAZrNZxt/7yYoDU1FEVBxrMGNKCmGBBx5RjYtQfR6E6k1nPGkLOe3DWq1WDsMQCSGoN2OSJLpUir7v4+XlJXqeZ+0gCGyM4ClKYBoBWOve4G1EEfRvZ+64Xq/PlRYWF+8tLy/PLy0tOaurq87a2ppTqVSsjL2+vj7VxsaG83zTdZ5pbbpVZ+FpxdovqlVne3t7fmVl5f5P8gzulqL7ajAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"duplicati_filters_edit_as_text-1\"\n        title=\"duplicati_filters_edit_as_text-1\"\n        src=\"/static/787f0be0a024ba4880882884335d4359/a3419/duplicati_filters_edit_as_text.png\"\n        srcset=\"/static/787f0be0a024ba4880882884335d4359/a1986/duplicati_filters_edit_as_text.png 210w,\n/static/787f0be0a024ba4880882884335d4359/ad7fb/duplicati_filters_edit_as_text.png 420w,\n/static/787f0be0a024ba4880882884335d4359/a3419/duplicati_filters_edit_as_text.png 840w,\n/static/787f0be0a024ba4880882884335d4359/4d498/duplicati_filters_edit_as_text.png 1260w,\n/static/787f0be0a024ba4880882884335d4359/70b58/duplicati_filters_edit_as_text.png 1680w,\n/static/787f0be0a024ba4880882884335d4359/4bb96/duplicati_filters_edit_as_text.png 2784w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nSo after adding a filter inside <strong>Filters</strong> panel you can preview included/excluded files directly inside <strong>Source data</strong> panel.\n<strong>Source data</strong> panel is updated when you remove focus (click outside) <strong>Filters</strong> edit box.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/79975be21e35fdf666e3179d55e6b686/4bb96/duplicati_filters_focus_out.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.4080459770115%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACG0lEQVQ4y5VT647SQBTuUxh/G19FEvnhz+VBSHgFIwUexwSN8RYMCYKscV3oclkWyXZhC7WXuXeOZ1pusk2Mk3zpuXzzzTkzp9aX5usn1+Nz+2Y+s0eDy+pi8cu+uhrZ49HEnk6u7cl4mmK8xWQytZ3B0HaGTsobOKOq4wyqw8HPWvPN26dW/2u7OF0s4XK+AjegwIQCqTgAKISG/IUcyYFwBTGTQGkEnDNovnv/wvpx3n12MV4kKCrCmIgoikVMQuGFrvCCW+HHaxFRXyw2nlgFaxESX3DFMUbEJogEJbEghPL171B/+PT5ufWt1ytkZ4LW+lCSTDCGHsNEgt8bX8B9jJWhzTFhkGRUvWul2+0WrYvv/YJPJbih0KFhYc4oJ1qhoACzzfi7fXs75aT+XrDT6WSCAd6DR6SWhrEtkrAA/GgJlBHQSSZ0iiTJEeyZltNYdqzW295Na0KAt74FRmnWm84Vfiiot4L6YKQCXDK4Xc0gDEKsJsl57f8UNKNxdzcH13VxLPiDKs0h/xQ8iCkghACOBdoSlFKpgEor1TDbUPg49fMFt+2YXLIjcBkhyP55j5fxzAMSodI9mE/2gv1+vwB/z1MKKYWO40hjZfo0l4NkP4ftdrvAGEvviOJrGpvhbxSGESyXS/A87xBHHNvHvtnfarWKVqVSeVSv189qtVrpFBgvNRqN9LuLvay+Ktk5XOSdlcvlx38AyM30SG0BSBYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"duplicati_filters_focus_out\"\n        title=\"duplicati_filters_focus_out\"\n        src=\"/static/79975be21e35fdf666e3179d55e6b686/a3419/duplicati_filters_focus_out.png\"\n        srcset=\"/static/79975be21e35fdf666e3179d55e6b686/a1986/duplicati_filters_focus_out.png 210w,\n/static/79975be21e35fdf666e3179d55e6b686/ad7fb/duplicati_filters_focus_out.png 420w,\n/static/79975be21e35fdf666e3179d55e6b686/a3419/duplicati_filters_focus_out.png 840w,\n/static/79975be21e35fdf666e3179d55e6b686/4d498/duplicati_filters_focus_out.png 1260w,\n/static/79975be21e35fdf666e3179d55e6b686/70b58/duplicati_filters_focus_out.png 1680w,\n/static/79975be21e35fdf666e3179d55e6b686/4bb96/duplicati_filters_focus_out.png 2784w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<h3>Example</h3>\n<p>Here are my Duplicati filters. You may use them as a starting point if you wish (just paste them after clicking \"Edit as text\" in <strong>Filters</strong> inside <strong>Source Data</strong> section):</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">-[.*\\.DS_Store]\n-[.*\\.tmp]\n-[.*/?node_modules.*]\n-[.*/presta/.*/?cache/\\S+]\n-[.*/wordpress/.*/?cache/\\S+]\n-[.*/wordpress/.*app/themes/.*dist.*]\n-[.*/wordpress/.*app/themes/.*vendor/.*]\n-[.*/wordpress/.*vendor/.*]\n-[.*/wordpress/.*fly-images/.*]\n-[.*/ruby/.*log/\\S+]\n-[.*/ruby/.*tmp/\\S+]\n-%HOME%/Dropbox/\n-%HOME%/Calibre Library/\n-%HOME%/Azure/\n-%HOME%/Movies/\n-%HOME%/Music/\n-%HOME%/VboxShared/\n-%HOME%/VirtualBox VMs/\n-%HOME%/backup_test/\n-%HOME%/tmp/\n-%HOME%/.babel-cache/\n-%HOME%/.cache/\n-%HOME%/.composer/\n-%HOME%/.cordova/\n-%HOME%/.cups/\n-%HOME%/.dropbox/\n-%HOME%/.docker/\n-%HOME%/.electron/\n-%HOME%/.electron-gyp/\n-%HOME%/.fontconfig/\n-%HOME%/.gem/\n-%HOME%/.ghost/\n-%HOME%/.grip/\n-%HOME%/.heroku/\n-%HOME%/.ievms/\n-%HOME%/.ionic/\n-%HOME%/.kayak-installer/\n-%HOME%/.kube/\n-%HOME%/.jspm/\n-%HOME%/.meteor/\n-%HOME%/.local/\n-%HOME%/.ngrok/\n-%HOME%/.node-gyp/\n-%HOME%/.npm/\n-%HOME%/.nvm/\n-%HOME%/.oracle_jre_usage/\n-%HOME%/.pachyderm/\n-%HOME%/.pgadmin/\n-%HOME%/.prisma/\n-%HOME%/.putty/\n-%HOME%/.raygun/\n-%HOME%/.reaction/\n-%HOME%/.rvm/\n-%HOME%/.subversion/\n-%HOME%/.vagrant.d/\n-%HOME%/.wireshark/\n-%HOME%/.wireshark-etc/\n-%HOME%/.wp-cli/\n-%HOME%/.yarn/\n-%HOME%/.Trash/\n-%HOME%/Downloads/\n-%HOME%/Library/Logs/\n-%HOME%/Library/iMovie/\n-%HOME%/Library/iTunes/\n-%HOME%/Library/WebKit/\n-%HOME%/Library/VirtualBox/\n-%HOME%/Library/Dropbox/\n-%HOME%/Library/Caches/\n-%HOME%/lib/azure-cli/</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Restoring</h2>\n<p>Files restoring is easy but you should be aware of the fact that if you select let say <code class=\"language-text\">/Users/username/your/foldername</code> the <code class=\"language-text\">foldername</code> itself won't be restored, just files inside it. I don't know if it is normal but for me it was a little tricky.</p>\n<h2>Sources</h2>\n<p><a href=\"https://duplicati.readthedocs.io/en/latest/appendix-d-filters/\">https://duplicati.readthedocs.io/en/latest/appendix-d-filters/</a>\n<a href=\"https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference\">https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference</a>\n<a href=\"https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expressions\">https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expressions</a>\n<a href=\"http://regexstorm.net/tester\">http://regexstorm.net/tester</a></p>","timeToRead":4,"rawMarkdownBody":"[Duplicati](https://www.duplicati.com/) is a free backup tool which is my current choice for cloud backups.\n\n## Why\nSome time ago I wrote a [post about Restic](https://grzegorowski.com/restic-backblaze-b2-backups) which is a nice backup tool, but at the time of writing this...\nIt lacks backup files compression.\nIt doesn't have built-in scheduler.\nIt has only command line interface.\nIt has some [\"cost effectiveness\" issues regarding Backblaze B2](https://grzegorowski.com/restic-backblaze-b2-backups/#backblazeb2pricing) integration.\nIt is hard to tell/verify which files are excluded from backup.\n\nAll of those makes me wonder if there is some other (preferably open source) tool. As for now it's [Duplicati](https://www.duplicati.com/).\n\n## Duplicati regex filters\nThe main problem with regexes in Duplicati (at least for me) was .NET syntax. If you want to write anything more sophisticated than examples from the [official documentation](https://duplicati.readthedocs.io/en/latest/appendix-d-filters/) you should test it on http://regexstorm.net/tester first.\n\nExamples:\n```bash\n.*/sources/.*/cache/\\S+\n```\nWill match every file inside `anotherdir` except directory itself (it is useful construction for every auto-generated cache).\n\n```bash\n.*\\.DS_Store\n```\nMatches every `.DS_Store` file (which is useful for Mac OS X).\n\n```bash\n.*/sources/.*/images/_[^original]\\S+\n```\nMatches every directory/file inside `images` directory which name doesn't start with `_original`.\n\n```bash\n.*/sources/.*/?somedirectory/\n```\nWill match every `somedirectory/` inside `sources/` dir no matter how deeply nested it is (or even if it is not nested at all). These paths matches regex above:\n- `something/sources/first/second/third/somedirectory/`\n- `something/sources/somedirectory/`\n- `something/sources/another/dir/somedirectory/`\n\n**NOTE**\nFor reasons I don't understand:\n```bash\n.*/sources/.*/cache/.+\n```\nDoes also match `test/sources/sth/cache/` directory itself that is why I use `\\S+` instead of `.+` when I don't want to exclude cache directories only files/folders inside them.\n\n**IMPORTANT**\nIf you decide to play with filters it is good to know that **Source data** panel inside **Source data** section works \"live\".\n![duplicati_source_data_panel](img/duplicati_source_data_panel.png)\nYou may edit filters list as text and then go back to filters list view.\n![duplicati_filters_edit_as_text-1](img/duplicati_filters_edit_as_text.png)\nSo after adding a filter inside **Filters** panel you can preview included/excluded files directly inside **Source data** panel.\n**Source data** panel is updated when you remove focus (click outside) **Filters** edit box.\n![duplicati_filters_focus_out](img/duplicati_filters_focus_out.png)\n\n### Example\n\nHere are my Duplicati filters. You may use them as a starting point if you wish (just paste them after clicking \"Edit as text\" in **Filters** inside **Source Data** section):\n```\n-[.*\\.DS_Store]\n-[.*\\.tmp]\n-[.*/?node_modules.*]\n-[.*/presta/.*/?cache/\\S+]\n-[.*/wordpress/.*/?cache/\\S+]\n-[.*/wordpress/.*app/themes/.*dist.*]\n-[.*/wordpress/.*app/themes/.*vendor/.*]\n-[.*/wordpress/.*vendor/.*]\n-[.*/wordpress/.*fly-images/.*]\n-[.*/ruby/.*log/\\S+]\n-[.*/ruby/.*tmp/\\S+]\n-%HOME%/Dropbox/\n-%HOME%/Calibre Library/\n-%HOME%/Azure/\n-%HOME%/Movies/\n-%HOME%/Music/\n-%HOME%/VboxShared/\n-%HOME%/VirtualBox VMs/\n-%HOME%/backup_test/\n-%HOME%/tmp/\n-%HOME%/.babel-cache/\n-%HOME%/.cache/\n-%HOME%/.composer/\n-%HOME%/.cordova/\n-%HOME%/.cups/\n-%HOME%/.dropbox/\n-%HOME%/.docker/\n-%HOME%/.electron/\n-%HOME%/.electron-gyp/\n-%HOME%/.fontconfig/\n-%HOME%/.gem/\n-%HOME%/.ghost/\n-%HOME%/.grip/\n-%HOME%/.heroku/\n-%HOME%/.ievms/\n-%HOME%/.ionic/\n-%HOME%/.kayak-installer/\n-%HOME%/.kube/\n-%HOME%/.jspm/\n-%HOME%/.meteor/\n-%HOME%/.local/\n-%HOME%/.ngrok/\n-%HOME%/.node-gyp/\n-%HOME%/.npm/\n-%HOME%/.nvm/\n-%HOME%/.oracle_jre_usage/\n-%HOME%/.pachyderm/\n-%HOME%/.pgadmin/\n-%HOME%/.prisma/\n-%HOME%/.putty/\n-%HOME%/.raygun/\n-%HOME%/.reaction/\n-%HOME%/.rvm/\n-%HOME%/.subversion/\n-%HOME%/.vagrant.d/\n-%HOME%/.wireshark/\n-%HOME%/.wireshark-etc/\n-%HOME%/.wp-cli/\n-%HOME%/.yarn/\n-%HOME%/.Trash/\n-%HOME%/Downloads/\n-%HOME%/Library/Logs/\n-%HOME%/Library/iMovie/\n-%HOME%/Library/iTunes/\n-%HOME%/Library/WebKit/\n-%HOME%/Library/VirtualBox/\n-%HOME%/Library/Dropbox/\n-%HOME%/Library/Caches/\n-%HOME%/lib/azure-cli/\n```\n\n## Restoring\nFiles restoring is easy but you should be aware of the fact that if you select let say `/Users/username/your/foldername` the `foldername` itself won't be restored, just files inside it. I don't know if it is normal but for me it was a little tricky.\n\n## Sources\nhttps://duplicati.readthedocs.io/en/latest/appendix-d-filters/\nhttps://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference\nhttps://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expressions\nhttp://regexstorm.net/tester\n","excerpt":"Duplicati is a free backup tool which is my current choice for cloud backups. Why Some time ago I wrote a post about Restic which is a niceâ€¦","frontmatter":{"title":"Duplicati backup filters configuration","slug":"duplicati-backup-with-backblaze-b2","date":"2018-09-04T00:06:00.000Z","tags":["tools"],"date_created":"2018-05-16T11:34:01.000Z","date_updated":"2018-09-15T13:21:16.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1522675397120-8cb88c83ac16.jpg","relativePath":"posts/img/photo-1522675397120-8cb88c83ac16.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAZABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAgP/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgD/2gAMAwEAAhADEAAAAXYFNaKbNicl9J4qipR//8QAIBAAAgECBwEAAAAAAAAAAAAAAQMCEhMABCIjMTJBQv/aAAgBAQABBQJ52PFnRXE5YW5xVEGBCrUQnCmUw+Dwrr//xAAXEQADAQAAAAAAAAAAAAAAAAAAARAR/9oACAEDAQE/AVEaf//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/AWM//8QAGxAAAgMAAwAAAAAAAAAAAAAAAQIAEBESYXH/2gAIAQEABj8CbyhG1hp7gVm490cQbByJ2m8i1//EAB8QAQACAAYDAAAAAAAAAAAAAAEAERAhMUGRsWGBof/aAAgBAQABPyECshKzdTijqJQI6QvBhS4Vas24i8pTY0gKDzbQQEfWB+JnbP/aAAwDAQACAAMAAAAQfNv8/8QAGBEBAQEBAQAAAAAAAAAAAAAAAQAxESH/2gAIAQMBAT8QGzsuM+r/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEh/9oACAECAQE/EFGwg5f/xAAhEAEAAgIABgMAAAAAAAAAAAABABEhMUFRYaHB8HGR4f/aAAgBAQABPxBoQsZqjhEBwLvqhFt/k6zBhDvMmzxLIQGl8tlHx3hqZAJ3VIzjCr96FlJXEVyxLq/djCUQ7HxPZc2bPWif/9k=","aspectRatio":2,"src":"/static/88bf1ca54882c92295c2be5bb8e9cdd0/0defe/photo-1522675397120-8cb88c83ac16.jpg","srcSet":"/static/88bf1ca54882c92295c2be5bb8e9cdd0/38b6a/photo-1522675397120-8cb88c83ac16.jpg 150w,\n/static/88bf1ca54882c92295c2be5bb8e9cdd0/e201c/photo-1522675397120-8cb88c83ac16.jpg 300w,\n/static/88bf1ca54882c92295c2be5bb8e9cdd0/0defe/photo-1522675397120-8cb88c83ac16.jpg 600w,\n/static/88bf1ca54882c92295c2be5bb8e9cdd0/a71f1/photo-1522675397120-8cb88c83ac16.jpg 900w,\n/static/88bf1ca54882c92295c2be5bb8e9cdd0/8d595/photo-1522675397120-8cb88c83ac16.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"c591049c-829c-512b-8029-966498054423","html":"<p>How to create <a href=\"https://restic.net/\">Restic</a> based backup using <a href=\"https://www.backblaze.com/b2/cloud-storage.html\">Backblaze B2</a> cloud storage as a backend.</p>\n<p><small>This tutorial was made on <strong>Mac OS X High Sierra</strong> with <strong>restic 0.8.3</strong> (which may or may not be relevant to you).</small></p>\n<p><strong>NOTE</strong>\nExample shell script is available <a href=\"#examples\">at the end</a> of this post.</p>\n<h2>Backblaze B2</h2>\n<p>Let's start with Backblaze B2 as you will need some cheap cloud storage.</p>\n<p>Create a Backblaze account.</p>\n<p>Login and create Backblaze B2 Bucket. You should easily find large \"Create a Bucket\" button after logging in to your account (which is also visible on the next screenshot).\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/290716c0a4da09509e540e690e31beb2/b5d1b/screen_shot_2018-05-01_at_14_40_30.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.03731343283582%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAADI0lEQVQ4y6VT30vTURSf0I83U7PQsDByjjDBUrdB2UNJ4aboQ+JT2KbCwByW+/md+7q5TTcbpe41wvYfOAicOAnRmUIvPVT04ymYtY3N1G04v9/v6dzrZJUIQRc+33O+9577uZ9zzr0iqajy+OWLZ+6Lay71N12/qbnRRNCkqblSqzlVfFpTWFSiKURbVFJ6JDCmv+JCZXfd1WsnRHWS2rN379xKdXV1wsDDAdBqtRR9fX1wr7MT2ts7oL2jA5StbaBUtqI9QBsoFEpoaVGAAudvNzdnq6rE50RysbhcN6D9bjAawWKxZBmG4fR6PWcymTjiE2swGDij0cjpdHrqk3WdTkfXbTZblmVZwLh4Y2NjhUhWX1/GmM1Ru90OGMD7/X5haWlJCIVCwuLiojA/Py/MzQWFYDBI/RDOLSws0JiZmRkBD+BZ1kbEJKRSJJTKZGXDw8NRl8sJeCq/trYGvw9BECCbzcLu7i78PdbX12FoSMePOpyAHAmqUC6Xl1kYJmoyMTA4+IhfXl6mBPF4HJKbSUgkkrC5uQnJJPoIYmOxGPA8D6urq1SE0+kEq9WaaGhoIISyMpQbNTMj8BhPC4fDlDAajUIqlYJ0Og3pTGbfIjLo7+zsUIXh8CoqHOIdDsdhwmGrnRKurKzQ4O3tbboZMwYePzwv5CxPQQZRiM3iXS5XPmWZbJ/QZhsF7F6ecGsLle5BKp3Bv71DdT0gJE0hKedrmCNkWTsM6fIKCRkZs2+j8Px1BF6uxODNhwh8+vgeYljf/ZTDVARJ+RDhyMifCjluP61331IQ/vwTwl+24GskCT82IrCF6o9UKJVKKSGpA1nEU0k+/wS8YsJRhBvkYmOnsh6Ph/P5fNz09HQOPu7Z5CQ3NYW+j/hTnHviKef1TnIezwTHstYsvhZyseMHTSnHp5P2er3gdrthbGwMSE1ydSGHAHla5N+JsI06QG9kwWhmwW53wvi4G7zeJyRmD7nOiyQSSbFKpXqhVqtfoZ1FG+jp6aEgPoFKpQ709vZSqHFepSZrPYHuB6pAbg/Z66+uri4V4ShAHEOc/E8QjoJfr1wBEmQJpkAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen_Shot_2018-05-01_at_14_40_30\"\n        title=\"Screen_Shot_2018-05-01_at_14_40_30\"\n        src=\"/static/290716c0a4da09509e540e690e31beb2/a3419/screen_shot_2018-05-01_at_14_40_30.png\"\n        srcset=\"/static/290716c0a4da09509e540e690e31beb2/a1986/screen_shot_2018-05-01_at_14_40_30.png 210w,\n/static/290716c0a4da09509e540e690e31beb2/ad7fb/screen_shot_2018-05-01_at_14_40_30.png 420w,\n/static/290716c0a4da09509e540e690e31beb2/a3419/screen_shot_2018-05-01_at_14_40_30.png 840w,\n/static/290716c0a4da09509e540e690e31beb2/b5d1b/screen_shot_2018-05-01_at_14_40_30.png 1072w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nSelect <strong>Private</strong> type for <strong>Files in Bucket</strong>.</p>\n<p><strong>NOTE</strong>\nBucket name has to be globally unique so you would probably end up with prefixing it with your account name or something similar.</p>\n<p>Check your Backblaze B2 credentials using link \"Show Account ID and Application Key\".\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6bdfbb0459fab7a33c23c2952ffd68ef/b5d1b/screen_shot_2018-05-01_at_14_24_10.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.03731343283582%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJklEQVQ4y6VTW08TQRReEgVF1JgYUrD4wKWliMaCCE++GUmAaADRRAzRF0tbbiHAv/HBf8AmJD4IxhDCzUBRgRfjvYXWdmm3e52dneOZKSWaSHzwJF/O7Mw533znnFmpVbp0sq76/OPL9TWR9raO0M0ORHt7yOfzh06fORs6VV4hfHnFuWOBMZFKT/VQ89VrpdKN5pbKe3e79adPhmBmegampqdhamoKotEoPBochIEHDwV6+/qhD9H7B/oE+u8PQHdPD2lsDFRLo7fvVH19v70f39sHRVGIZVnUMk1KbEK5GYZBczmV6rpOs9kc1TSd5vMaVdW8ODNNk2haHpLJZDoUCnmlsWchj66qKUBjjLnc/QvcbNtmSMYMw3QdCmBalhKNRrxSdGTEY5imIHQchxNCJp2GVColkNzfh8SPuFjH4wkghPAQQPGApBwiBytThoeHvdL4+LhH17VUOq0AluJyCcSlYBIbLIcIGLYFFiajIkHCSfHyIgQh7hcJR5HQSGWyBGVTcZjf+wkH3+KQ/b6HPgG5eBIOlBxkDjS8VBekqKiII0LRwyKhqnFVrgsmKnn7EfTYF9A2PoOKsDc/AegWHGNHJYfDYa80Ooo9NIyUQxm4aLztLpK6hoUoeGYR0NFnVQsOsibwKnEuGH+Y8zvh2FhBIZaLvSmUTHHYLk9Adu75t4ND4IMQ+awAvsa9vxPahE+ucBtPRNWgZJSjqRZNw4vnd7Lw8p0CyRw5KhkHpkQi+GzC4YhH07TUIZGLYDg58cYymQzDM5ZIJFga13lVZTZxWFYnTNFs7ITDXLegEB9+YcqTk5Me/N47FMCvpEVww17h36FRVIp7TOzbDlB8zMW4YgnpiYkJr9TZ2Vk1Pz9v7O7swubmJmxtbcHGxgasrq7C4uIiLC0twfLyCqyvr8Pq2hqsxz7Aq9cr8GZxDeNjEIvFYHt7GxYWFpyurq4aqbS09EJdXd1zv88/52vwzfp8PrmhoUGura2Vg8Gg3NbWJgevB+XWlhbZH2iWr9zqkwNNTXJTwC/i/H7/LGKuvr7+RVlZ2UUJrQRxAlH2n+AcJb8AnLunGZcZ/u4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen_Shot_2018-05-01_at_14_24_10\"\n        title=\"Screen_Shot_2018-05-01_at_14_24_10\"\n        src=\"/static/6bdfbb0459fab7a33c23c2952ffd68ef/a3419/screen_shot_2018-05-01_at_14_24_10.png\"\n        srcset=\"/static/6bdfbb0459fab7a33c23c2952ffd68ef/a1986/screen_shot_2018-05-01_at_14_24_10.png 210w,\n/static/6bdfbb0459fab7a33c23c2952ffd68ef/ad7fb/screen_shot_2018-05-01_at_14_24_10.png 420w,\n/static/6bdfbb0459fab7a33c23c2952ffd68ef/a3419/screen_shot_2018-05-01_at_14_24_10.png 840w,\n/static/6bdfbb0459fab7a33c23c2952ffd68ef/b5d1b/screen_shot_2018-05-01_at_14_24_10.png 1072w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nThey will be required for the next steps so copy and paste them somewhere or just leave them open.</p>\n<p><strong>NOTE</strong>\nAfter closing credentials popup you won't be able to view <strong>Application Key</strong> you will have to generate a new one.</p>\n<h2>Restic</h2>\n<p>When your cloud storage space is ready it's time to install and initialize Restic repository.</p>\n<h3>Install Restic on Mac OS X (with Homebrew):</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">brew <span class=\"token function\">install</span> restic</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>Install Restic on Ubuntu 16.04:</h3>\n<p>Check current release at <a href=\"https://github.com/restic/restic/releases\">https://github.com/restic/restic/releases</a>\nCopy url of selected version (for Ubuntu you should use <code class=\"language-text\">..._linux_386.bz2</code> packages)\nGet the package and install it</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/restic/restic/releases/download/v0.8.3/restic_0.8.3_linux_386.bz2\n<span class=\"token function\">bzip2</span> -d restic_0.8.3_linux_386.bz2\n<span class=\"token function\">chmod</span> +x restic_0.8.3_linux_386\n<span class=\"token function\">mv</span> restic_0.8.3_linux_386 /usr/bin/restic</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Logout from the system and the login back.\nNow you should be able to execute <code class=\"language-text\">restic version</code>, if it returns Restic related info it means that Restic is installed properly.</p>\n<p>For other systems check the <a href=\"https://restic.readthedocs.io/en/stable/020_installation.html\">official installation guides</a>.</p>\n<p>If restic is installed execute following commands inside console replacing placeholders <code class=\"language-text\">&lt;...&gt;</code> with your Backblaze B2 account data:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">B2_ACCOUNT_ID</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>MY_ACCOUNT_ID<span class=\"token operator\">></span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">B2_ACCOUNT_KEY</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>MY_SECRET_ACCOUNT_KEY<span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Now it's time to initialize your Restic repository.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">restic -r b2:<span class=\"token punctuation\">[</span>bucket-name<span class=\"token punctuation\">]</span>:<span class=\"token punctuation\">[</span>repository-name<span class=\"token punctuation\">]</span> init</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where:</p>\n<ul>\n<li><code class=\"language-text\">-r</code> repository to backup or restore from</li>\n<li><code class=\"language-text\">b2</code> indicates Backblaze B2 storage</li>\n<li><code class=\"language-text\">[bucket-name]</code> is a name of Backblaze B2 bucket which was created</li>\n<li><code class=\"language-text\">[repository-name]</code> is an arbitrary name which will be the name of Restic root folder inside Backblaze B2 bucket</li>\n</ul>\n<p>You may check that repository is initialized by using \"Browse Files\" link and then clicking on your bucket name (inside Backblaze B2 account). As an example here is mine bucket (with <strong>macbook</strong> as a <code class=\"language-text\">[repository-name]</code>).\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bec089aa607355dee7a393c9e7e31610/822a4/screen_shot_2018-05-01_at_17_17_20.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.05309734513274%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQklEQVQ4y6VTO48TQQy+Og8lFIlOQiQVXSoQRWqUBoUUSZQiqVkO8ReOYjcXdET01PwOBAUFLT0NIIGWU553O7PPGRt7NoHkNkCBV9/aO+v57LE9R41G4/HN42OrXq9b1WrVqlQq1o1y2crlclY+nzcoFAobm/TG5rViscj6UalUelqr1R4csbRaLRz0evjk5ASHwyGORiOjB4MB9vt97Ha7GfR6qe50HhI62G63sdlsfjCE7ucveDGbJXEUJ4iodpEkSgkpVRhFyvcDg60dhpGKophA7zhG13XfGEIEQKUUkAIigV1RSoPW+2AJghA8T4AQEoSMOBH0ff9tSpgKpKTAPyjaD5zN5zhfLNBE2oDcftlJkmBMoKAqQyhEAIvFCtgJTaIKqQQYxwr/LZAlXK8FuBdLZsJvyxBfv3fx03cPNQWgAqGUksgTk9UWO5IlvBIxLNeRIVzLBD9+9fDS500aqS9Idec6I9XQaP5mBEHARFlCig7UK0hPoBHiAANfcr82tfutYyLyPM9kzeSU7aEahrBa+2YHZyGpMUKIvYZswSMShqEBEyp+XSdMEg3c5Ey5ry1B1uVwDXm8KHM4lNEe6FF0QnnlmWbxaXhcM4RBGOnV6hJ8XwLVBuhYmYHmoKzp+kAofePDs0trSVo2sTfY/yPbYX1nCMfjMTqOoxyb4DiavjXZ2rZtPZlM9HQ61WeT53r88pW2nTPtODb9S/3Yh/bE5+cv8NnpaXqXSe7+DeVSObVv3f+Tzx3CPcJtJvsJseThx/embjcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen_Shot_2018-05-01_at_17_17_20\"\n        title=\"Screen_Shot_2018-05-01_at_17_17_20\"\n        src=\"/static/bec089aa607355dee7a393c9e7e31610/a3419/screen_shot_2018-05-01_at_17_17_20.png\"\n        srcset=\"/static/bec089aa607355dee7a393c9e7e31610/a1986/screen_shot_2018-05-01_at_17_17_20.png 210w,\n/static/bec089aa607355dee7a393c9e7e31610/ad7fb/screen_shot_2018-05-01_at_17_17_20.png 420w,\n/static/bec089aa607355dee7a393c9e7e31610/a3419/screen_shot_2018-05-01_at_17_17_20.png 840w,\n/static/bec089aa607355dee7a393c9e7e31610/822a4/screen_shot_2018-05-01_at_17_17_20.png 1130w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>After initialization you may start with first backup (it will take some/a lot of time depending on the backup size).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">restic -r b2:<span class=\"token punctuation\">[</span>bucket-name<span class=\"token punctuation\">]</span>:<span class=\"token punctuation\">[</span>repository-name<span class=\"token punctuation\">]</span> backup <span class=\"token punctuation\">[</span>dirs-to-backup<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where:</p>\n<ul>\n<li><code class=\"language-text\">-r</code> repository to backup or restore from</li>\n<li><code class=\"language-text\">b2</code> indicates Backblaze B2 storage</li>\n<li><code class=\"language-text\">[bucket-name]</code> is a name of Backblaze B2 bucket which was created</li>\n<li><code class=\"language-text\">[repository-name]</code> is an arbitrary name which will be the name of Restic root folder inside Backblaze B2 bucket</li>\n<li><code class=\"language-text\">[dir-to-backup]</code> is the directory which you would like to backup e.g. <code class=\"language-text\">/Users/jmarceli/workspace</code></li>\n</ul>\n<p>The next executions of this command takes much shorter time as Restic backups are incremental, so only changes are going to be uploaded.</p>\n<p>After successful backup you may/should check the backup integrity with:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">restic -r b2:<span class=\"token punctuation\">[</span>bucket-name<span class=\"token punctuation\">]</span>:<span class=\"token punctuation\">[</span>repository-name<span class=\"token punctuation\">]</span> check</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>NOTE</strong>\nExecuting Restic check using cache may be a good solution if you want to save time and money, but remember that this won't be a full integrity test.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">restic -r b2:<span class=\"token punctuation\">[</span>bucket-name<span class=\"token punctuation\">]</span>:<span class=\"token punctuation\">[</span>repository-name<span class=\"token punctuation\">]</span> check --with-cache</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>NOTE</strong>\nTo ease things you may define (executing following command in console):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">RESTIC_REPOSITORY</span><span class=\"token operator\">=</span>b2:<span class=\"token punctuation\">[</span>bucket-name<span class=\"token punctuation\">]</span>:<span class=\"token punctuation\">[</span>repository-name<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Now you can ommit <code class=\"language-text\">-r</code> option in every <code class=\"language-text\">restic</code> call.</p>\n<p><strong>NOTE</strong>\nIf you want (and you probably should) exclude some files from backup here is more info <a href=\"https://restic.readthedocs.io/en/latest/040_backup.html\">https://restic.readthedocs.io/en/latest/040_backup.html</a>\nFor testing your path regexes you may use <a href=\"https://regex-golang.appspot.com/assets/html/index.html\">https://regex-golang.appspot.com/assets/html/index.html</a></p>\n<h2>Restoring</h2>\n<p>Restoring is easy just check desired snapshot ID with:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">restic snapshots</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>And with selected ID execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">restic restore <span class=\"token punctuation\">[</span>ID<span class=\"token punctuation\">]</span> --target /tmp/tmp-restore --include some/file</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where:</p>\n<ul>\n<li><code class=\"language-text\">/tmp/tmp-restore</code> is a path where files would be restored</li>\n<li><code class=\"language-text\">some/file</code> limit restored files just to those which match <code class=\"language-text\">some/file</code> pattern</li>\n</ul>\n<p>After that you will probably go to the <code class=\"language-text\">/tmp/tmp-restore</code> path (or any other that you define as a <strong>--target</strong>) and move restored files to correct locations.</p>\n<h2>Removing old/outdated backups</h2>\n<p>You should probably run it after making a backup with <code class=\"language-text\">restic backup ...</code> command.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">restic forget --keep-last <span class=\"token number\">48</span> --keep-daily <span class=\"token number\">7</span> --keep-weekly <span class=\"token number\">4</span> --keep-monthly <span class=\"token number\">3</span> --keep-yearly <span class=\"token number\">3</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Exact meaning of the flags with an example is described in the <a href=\"https://github.com/restic/restic/issues/1562\">Github issue#1562</a></p>\n<p><strong>NOTE</strong>\nThere is a <code class=\"language-text\">--dry-run</code> flag which may be useful</p>\n<h2>Scheduled backups</h2>\n<p>It's always nice to have some kind of automation for your backups. Restic doesn't come with any buildin solution, so the only option is a CRON job creation.</p>\n<p>Provided that you created a Restic backup shell script named <code class=\"language-text\">~/restic_backup.sh</code> just execute <code class=\"language-text\">crontab -e</code> and add a line:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">0 12 * * * /Users/username/restic_backup.sh</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Now your <code class=\"language-text\">~/restic_backup.sh</code> will be executed each day exactly at 12:00.</p>\n<p><strong>NOTE</strong>\nIf you are using Vim you may need to <code class=\"language-text\">:set backupcopy=yes</code> when editing crontab file see <a href=\"https://stackoverflow.com/questions/15395479/why-ive-got-no-crontab-entry-on-os-x-when-using-vim\">SO question</a></p>\n<h2>Troubleshooting</h2>\n<p>As always there are some issues, this one is definitely my fault because of breaking the backup process due to sudden power off.</p>\n<blockquote>\n<p>Fatal: unable to create lock in backend: repository is already locked by PID 16697 on [mycomputername] by [username] (UID 501, GID 20)</p>\n</blockquote>\n<p>Following the Google I found the Github <a href=\"https://github.com/restic/restic/issues/1450\">issue#1450</a></p>\n<p>Simple:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">restic unlock</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Does the job. After executing this command I was able to work with my repository again.</p>\n<p><strong>NOTE</strong>\nOn Mac OS X you may use following command to prevent system from sleeping:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">caffeinate -s</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>Backblaze B2 pricing</h2>\n<p>You may think that BackBlaze B2 and restic will guarantee you nearly free cloud backup. Well...</p>\n<p>It's cheap, but definitely not as cheap as you may think.</p>\n<p>Uploading is free and storage is really cheap (or event cheapest ATM), but there are some other (more or less) hidden charges like \"Class B Transactions\" and \"Class C Transactions\". Go <a href=\"https://www.backblaze.com/b2/b2-transactions-price.html\">here</a> for more info.</p>\n<p>Unfortunatelly currently Restic makes a lot of \"Class B Transactions\" calls during <code class=\"language-text\">restic check</code> execution (which may be both costly and time consuming) see <a href=\"https://github.com/restic/restic/pull/1696\">issue#1696</a>. Next (0.8.4+) restic release with \"smart caching\" should fix it.</p>\n<p>Browsing files stored on your B2 (using \"Browse Files\" option) is counted to the downloads quota. It's cheap but not free.</p>\n<p>Fortunatelly <strong>restic</strong> nearly doesn't use \"Class C Transactions\" but \"Class B\" is used a lot during <code class=\"language-text\">restic check</code> (which you may/should run after each backup).</p>\n<p>What is more, with B2 pricing there is no point in running <code class=\"language-text\">restic prune</code> (as you may see I give up after 1.5 hour).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ restic prune\nenter password <span class=\"token keyword\">for</span> repository:\npassword is correct\ncounting files <span class=\"token keyword\">in</span> repo\nbuilding new index <span class=\"token keyword\">for</span> repo\n<span class=\"token punctuation\">[</span><span class=\"token number\">23</span>:04<span class=\"token punctuation\">]</span> <span class=\"token number\">100.00</span>%  <span class=\"token number\">13521</span> / <span class=\"token number\">13521</span> packs\nrepository contains <span class=\"token number\">13521</span> packs <span class=\"token punctuation\">(</span><span class=\"token number\">897977</span> blobs<span class=\"token punctuation\">)</span> with <span class=\"token number\">62.648</span> GiB\nprocessed <span class=\"token number\">897977</span> blobs: <span class=\"token number\">267</span> duplicate blobs, <span class=\"token number\">443.513</span> MiB duplicate\nload all snapshots\n<span class=\"token function\">find</span> data that is still <span class=\"token keyword\">in</span> use <span class=\"token keyword\">for</span> <span class=\"token number\">2</span> snapshots\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>:24<span class=\"token punctuation\">]</span> <span class=\"token number\">100.00</span>%  <span class=\"token number\">2</span> / <span class=\"token number\">2</span> snapshots\nfound <span class=\"token number\">861259</span> of <span class=\"token number\">897977</span> data blobs still <span class=\"token keyword\">in</span> use, removing <span class=\"token number\">36718</span> blobs\nwill remove <span class=\"token number\">0</span> invalid files\nwill delete <span class=\"token number\">1055</span> packs and rewrite <span class=\"token number\">6590</span> packs, this frees <span class=\"token number\">27.166</span> GiB\n  signal interrupt received, cleaning up</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>This may/will result in massive download for (as I think) packs rewritting (I've downloaded 6GB, made around 34k Class B Transactions and give up with progress around 17%). It's just cheaper to run a new backup and delete the old one... (at least in my case where I have around 60GB and want to remove a snapshot with accidentally added files).</p>\n<h3>The first impression</h3>\n<p>Calculations based on <a href=\"https://www.backblaze.com/b2/cloud-storage-pricing.html\">https://www.backblaze.com/b2/cloud-storage-pricing.html</a> may lead you to this equation (let say you got 100GB of data):</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">months * data_in_GB * storage_price = yearly_backup_price\n12 * 100 * $0.005 = $6</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>But that is <strong>not true</strong> for real backup scenarios.</p>\n<h3>The reality</h3>\n<p><strong>A year of incremental backups of 100GB data won't use 100GB but much more space.</strong>\n1TB, maybe more depends how much redundancy in data do you have and how often you would like to create snapshots.</p>\n<p><strong>You may think why should I bother with a download price, you will do it only in case of data loss right?</strong>\nNo. You should do <code class=\"language-text\">restic prune</code> from time to time to ensure old snapshots removal (we want to save space and money right?). Unfortunatelly <code class=\"language-text\">restic prune</code> downloads a lot of data to rewrite data packs that are going to stay on server after prune operation. That may cost you <strong>a lot</strong>.</p>\n<p><strong>\"Hidden\" costs</strong>\nThings like \"Transactions Class B and C\" they seems to be cheap but they may become costly if you would like to (which you probably should) run <code class=\"language-text\">restic check</code> command frequently. Without that check you can't be 100% sure that backup files are not corrupted. If you doesn't have such certainty what's the point of paying for backup storage space?</p>\n<h2>What's the real price?</h2>\n<p>I don't know. I've just started using <strong>Backblaze B2</strong> and <strong>restic</strong> combo with around 60GB of initial data.</p>\n<p>Maybe you should check available storage options once more?\nThis seems to be fine starting point for the comparison: <a href=\"https://www.arqbackup.com/features/\">https://www.arqbackup.com/features/</a></p>\n<h2>Alternatives?</h2>\n<p>From what I checked it seems that Wasabi is really the cheapest cloud storage, it seems to have nearly none hidden payments.\n<a href=\"https://wasabi.com/pricing/pricing-faqs/\">https://wasabi.com/pricing/pricing-faqs/</a></p>\n<p>The only catch is a <strong>minimal</strong> space which you may buy which is 1TB, so it's <strong>$4.99 per month</strong>. In my case it makes Wasabi not so cheap (as I had only ~60GB) but if you have more data e.g. 800GB+ it might be worth it.</p>\n<h2>Examples</h2>\n<p>Here is my example script for backups <code class=\"language-text\">~/restic_backup.sh</code>. Feel free to use it and modify according to your needs (especially replace all <code class=\"language-text\">[...]</code> with data approperiate for your backup configuration/storage space).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">B2_ACCOUNT_ID</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>account-id<span class=\"token punctuation\">]</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">B2_ACCOUNT_KEY</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>account-key<span class=\"token punctuation\">]</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">RESTIC_REPOSITORY</span><span class=\"token operator\">=</span>b2:<span class=\"token punctuation\">[</span>bucket-name<span class=\"token punctuation\">]</span>:<span class=\"token punctuation\">[</span>repository-name<span class=\"token punctuation\">]</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">RESTIC_PASSWORD</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>repository-pass<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># for the first run uncomment</span>\n<span class=\"token comment\">#restic init</span>\n\n<span class=\"token comment\"># prevent sleeping on OS X with: caffeinate -sw [backup_pid]</span>\n\n<span class=\"token comment\"># --quiet - should speed up backup process see: https://github.com/restic/restic/pull/1676</span>\nrestic backup /Users/<span class=\"token punctuation\">[</span>username<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">\\</span>\n  --quiet <span class=\"token punctuation\">\\</span>\n  --exclude-caches <span class=\"token punctuation\">\\</span>\n  --exclude<span class=\"token operator\">=</span><span class=\"token string\">'/Users/[username]/Dropbox'</span><span class=\"token punctuation\">\\</span>\n  --exclude<span class=\"token operator\">=</span><span class=\"token string\">'/Users/[username]/Downloads'</span><span class=\"token punctuation\">\\</span>\n  --exclude<span class=\"token operator\">=</span><span class=\"token string\">'/Users/[username]/Virtualbox\\ VMs'</span><span class=\"token punctuation\">\\</span>\n  --exclude<span class=\"token operator\">=</span><span class=\"token string\">'/Users/[username]/tmp'</span><span class=\"token punctuation\">\\</span>\n  --exclude<span class=\"token operator\">=</span><span class=\"token string\">'/Users/[username]/**/node_modules'</span><span class=\"token punctuation\">\\</span>\n  --exclude<span class=\"token operator\">=</span><span class=\"token string\">'/Users/[username]/**/bower_components'</span><span class=\"token punctuation\">\\</span>\n  --exclude<span class=\"token operator\">=</span><span class=\"token string\">'/Users/[username]/**/wordpress/**/vendor/*'</span>\n\n<span class=\"token comment\"># remove outdated snapshots</span>\n<span class=\"token comment\"># --keep-last 20 - there won't be probably more hourly snapshots in last two days than 20</span>\n<span class=\"token comment\"># --prune - delete repositories which should be forgotten</span>\nrestic forget --keep-last <span class=\"token number\">20</span> <span class=\"token punctuation\">\\</span>\n  --keep-daily <span class=\"token number\">7</span> <span class=\"token punctuation\">\\</span>\n  --keep-weekly <span class=\"token number\">4</span> <span class=\"token punctuation\">\\</span>\n  --keep-monthly <span class=\"token number\">6</span> <span class=\"token punctuation\">\\</span>\n  --keep-yearly <span class=\"token number\">3</span> <span class=\"token punctuation\">\\</span>\n  --limit-upload <span class=\"token number\">500</span> <span class=\"token punctuation\">\\</span>\n  --prune\n\n<span class=\"token comment\"># --with-cache - limits Class B Transactions on BackBlaze B2 see: https://forum.restic.net/t/limiting-b2-transactions/209/4</span>\nrestic check --with-cache</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>That's all.</p>","timeToRead":10,"rawMarkdownBody":"How to create [Restic](https://restic.net/) based backup using [Backblaze B2](https://www.backblaze.com/b2/cloud-storage.html) cloud storage as a backend.\n\n<small>This tutorial was made on **Mac OS X High Sierra** with **restic 0.8.3** (which may or may not be relevant to you).</small>\n\n**NOTE**\nExample shell script is available [at the end](#examples) of this post.\n\n## Backblaze B2\nLet's start with Backblaze B2 as you will need some cheap cloud storage.\n\nCreate a Backblaze account.\n\nLogin and create Backblaze B2 Bucket. You should easily find large \"Create a Bucket\" button after logging in to your account (which is also visible on the next screenshot).\n![Screen_Shot_2018-05-01_at_14_40_30](img/screen_shot_2018-05-01_at_14_40_30.png)\nSelect **Private** type for **Files in Bucket**.\n\n**NOTE**\nBucket name has to be globally unique so you would probably end up with prefixing it with your account name or something similar.\n\nCheck your Backblaze B2 credentials using link \"Show Account ID and Application Key\".\n![Screen_Shot_2018-05-01_at_14_24_10](img/screen_shot_2018-05-01_at_14_24_10.png)\nThey will be required for the next steps so copy and paste them somewhere or just leave them open.\n\n**NOTE**\nAfter closing credentials popup you won't be able to view **Application Key** you will have to generate a new one.\n\n## Restic\nWhen your cloud storage space is ready it's time to install and initialize Restic repository.\n\n### Install Restic on Mac OS X (with Homebrew):\n```bash\nbrew install restic\n```\n\n### Install Restic on Ubuntu 16.04:\nCheck current release at https://github.com/restic/restic/releases\nCopy url of selected version (for Ubuntu you should use `..._linux_386.bz2` packages)\nGet the package and install it\n```bash\nwget https://github.com/restic/restic/releases/download/v0.8.3/restic_0.8.3_linux_386.bz2\nbzip2 -d restic_0.8.3_linux_386.bz2\nchmod +x restic_0.8.3_linux_386\nmv restic_0.8.3_linux_386 /usr/bin/restic\n```\nLogout from the system and the login back.\nNow you should be able to execute `restic version`, if it returns Restic related info it means that Restic is installed properly.\n\nFor other systems check the [official installation guides](https://restic.readthedocs.io/en/stable/020_installation.html).\n\nIf restic is installed execute following commands inside console replacing placeholders `<...>` with your Backblaze B2 account data:\n\n```bash\nexport B2_ACCOUNT_ID=<MY_ACCOUNT_ID>\nexport B2_ACCOUNT_KEY=<MY_SECRET_ACCOUNT_KEY>\n```\n\nNow it's time to initialize your Restic repository.\n```bash\nrestic -r b2:[bucket-name]:[repository-name] init\n```\nWhere:\n- `-r` repository to backup or restore from\n- `b2` indicates Backblaze B2 storage\n- `[bucket-name]` is a name of Backblaze B2 bucket which was created\n- `[repository-name]` is an arbitrary name which will be the name of Restic root folder inside Backblaze B2 bucket\n\nYou may check that repository is initialized by using \"Browse Files\" link and then clicking on your bucket name (inside Backblaze B2 account). As an example here is mine bucket (with **macbook** as a `[repository-name]`).\n![Screen_Shot_2018-05-01_at_17_17_20](img/screen_shot_2018-05-01_at_17_17_20.png)\n\nAfter initialization you may start with first backup (it will take some/a lot of time depending on the backup size).\n```bash\nrestic -r b2:[bucket-name]:[repository-name] backup [dirs-to-backup]\n```\nWhere:\n- `-r` repository to backup or restore from\n- `b2` indicates Backblaze B2 storage\n- `[bucket-name]` is a name of Backblaze B2 bucket which was created\n- `[repository-name]` is an arbitrary name which will be the name of Restic root folder inside Backblaze B2 bucket\n- `[dir-to-backup]` is the directory which you would like to backup e.g. `/Users/jmarceli/workspace`\n\nThe next executions of this command takes much shorter time as Restic backups are incremental, so only changes are going to be uploaded.\n\nAfter successful backup you may/should check the backup integrity with:\n```bash\nrestic -r b2:[bucket-name]:[repository-name] check\n```\n\n**NOTE**\nExecuting Restic check using cache may be a good solution if you want to save time and money, but remember that this won't be a full integrity test.\n```bash\nrestic -r b2:[bucket-name]:[repository-name] check --with-cache\n```\n\n**NOTE**\nTo ease things you may define (executing following command in console):\n```bash\nexport RESTIC_REPOSITORY=b2:[bucket-name]:[repository-name]\n```\nNow you can ommit `-r` option in every `restic` call.\n\n**NOTE**\nIf you want (and you probably should) exclude some files from backup here is more info https://restic.readthedocs.io/en/latest/040_backup.html\nFor testing your path regexes you may use https://regex-golang.appspot.com/assets/html/index.html\n\n## Restoring\nRestoring is easy just check desired snapshot ID with:\n```bash\nrestic snapshots\n```\n\nAnd with selected ID execute:\n```bash\nrestic restore [ID] --target /tmp/tmp-restore --include some/file\n```\nWhere:\n- `/tmp/tmp-restore` is a path where files would be restored\n- `some/file` limit restored files just to those which match `some/file` pattern\n\nAfter that you will probably go to the `/tmp/tmp-restore` path (or any other that you define as a **--target**) and move restored files to correct locations.\n\n## Removing old/outdated backups\nYou should probably run it after making a backup with `restic backup ...` command.\n```bash\nrestic forget --keep-last 48 --keep-daily 7 --keep-weekly 4 --keep-monthly 3 --keep-yearly 3\n```\nExact meaning of the flags with an example is described in the [Github issue#1562](https://github.com/restic/restic/issues/1562)\n\n**NOTE**\nThere is a `--dry-run` flag which may be useful\n\n## Scheduled backups\nIt's always nice to have some kind of automation for your backups. Restic doesn't come with any buildin solution, so the only option is a CRON job creation.\n\nProvided that you created a Restic backup shell script named `~/restic_backup.sh` just execute `crontab -e` and add a line:\n```\n0 12 * * * /Users/username/restic_backup.sh\n```\n\nNow your `~/restic_backup.sh` will be executed each day exactly at 12:00.\n\n**NOTE**\nIf you are using Vim you may need to `:set backupcopy=yes` when editing crontab file see [SO question](https://stackoverflow.com/questions/15395479/why-ive-got-no-crontab-entry-on-os-x-when-using-vim)\n\n## Troubleshooting\nAs always there are some issues, this one is definitely my fault because of breaking the backup process due to sudden power off.\n\n> Fatal: unable to create lock in backend: repository is already locked by PID 16697 on [mycomputername] by [username] (UID 501, GID 20)\n\nFollowing the Google I found the Github [issue#1450](https://github.com/restic/restic/issues/1450)\n\nSimple:\n```bash\nrestic unlock\n```\nDoes the job. After executing this command I was able to work with my repository again.\n\n**NOTE**\nOn Mac OS X you may use following command to prevent system from sleeping:\n```bash\ncaffeinate -s\n```\n\n## Backblaze B2 pricing\nYou may think that BackBlaze B2 and restic will guarantee you nearly free cloud backup. Well...\n\nIt's cheap, but definitely not as cheap as you may think.\n\nUploading is free and storage is really cheap (or event cheapest ATM), but there are some other (more or less) hidden charges like \"Class B Transactions\" and \"Class C Transactions\". Go [here](https://www.backblaze.com/b2/b2-transactions-price.html) for more info.\n\nUnfortunatelly currently Restic makes a lot of \"Class B Transactions\" calls during `restic check` execution (which may be both costly and time consuming) see [issue#1696](https://github.com/restic/restic/pull/1696). Next (0.8.4+) restic release with \"smart caching\" should fix it.\n\nBrowsing files stored on your B2 (using \"Browse Files\" option) is counted to the downloads quota. It's cheap but not free.\n\nFortunatelly **restic** nearly doesn't use \"Class C Transactions\" but \"Class B\" is used a lot during `restic check` (which you may/should run after each backup).\n\nWhat is more, with B2 pricing there is no point in running `restic prune` (as you may see I give up after 1.5 hour).\n```bash\n$ restic prune\nenter password for repository:\npassword is correct\ncounting files in repo\nbuilding new index for repo\n[23:04] 100.00%  13521 / 13521 packs\nrepository contains 13521 packs (897977 blobs) with 62.648 GiB\nprocessed 897977 blobs: 267 duplicate blobs, 443.513 MiB duplicate\nload all snapshots\nfind data that is still in use for 2 snapshots\n[1:24] 100.00%  2 / 2 snapshots\nfound 861259 of 897977 data blobs still in use, removing 36718 blobs\nwill remove 0 invalid files\nwill delete 1055 packs and rewrite 6590 packs, this frees 27.166 GiB\n  signal interrupt received, cleaning up\n```\nThis may/will result in massive download for (as I think) packs rewritting (I've downloaded 6GB, made around 34k Class B Transactions and give up with progress around 17%). It's just cheaper to run a new backup and delete the old one... (at least in my case where I have around 60GB and want to remove a snapshot with accidentally added files).\n\n### The first impression\nCalculations based on https://www.backblaze.com/b2/cloud-storage-pricing.html may lead you to this equation (let say you got 100GB of data):\n```\nmonths * data_in_GB * storage_price = yearly_backup_price\n12 * 100 * $0.005 = $6\n```\nBut that is **not true** for real backup scenarios.\n\n### The reality\n\n**A year of incremental backups of 100GB data won't use 100GB but much more space.**\n1TB, maybe more depends how much redundancy in data do you have and how often you would like to create snapshots.\n\n**You may think why should I bother with a download price, you will do it only in case of data loss right?**\nNo. You should do `restic prune` from time to time to ensure old snapshots removal (we want to save space and money right?). Unfortunatelly `restic prune` downloads a lot of data to rewrite data packs that are going to stay on server after prune operation. That may cost you **a lot**.\n\n**\"Hidden\" costs**\nThings like \"Transactions Class B and C\" they seems to be cheap but they may become costly if you would like to (which you probably should) run `restic check` command frequently. Without that check you can't be 100% sure that backup files are not corrupted. If you doesn't have such certainty what's the point of paying for backup storage space?\n\n## What's the real price?\nI don't know. I've just started using **Backblaze B2** and **restic** combo with around 60GB of initial data.\n\nMaybe you should check available storage options once more?\nThis seems to be fine starting point for the comparison: https://www.arqbackup.com/features/\n\n## Alternatives?\nFrom what I checked it seems that Wasabi is really the cheapest cloud storage, it seems to have nearly none hidden payments.\nhttps://wasabi.com/pricing/pricing-faqs/\n\nThe only catch is a **minimal** space which you may buy which is 1TB, so it's **$4.99 per month**. In my case it makes Wasabi not so cheap (as I had only ~60GB) but if you have more data e.g. 800GB+ it might be worth it.\n\n## Examples\nHere is my example script for backups `~/restic_backup.sh`. Feel free to use it and modify according to your needs (especially replace all `[...]` with data approperiate for your backup configuration/storage space).\n```bash\n#!/bin/bash\n\nexport B2_ACCOUNT_ID=[account-id]\nexport B2_ACCOUNT_KEY=[account-key]\nexport RESTIC_REPOSITORY=b2:[bucket-name]:[repository-name]\nexport RESTIC_PASSWORD=[repository-pass]\n\n# for the first run uncomment\n#restic init\n\n# prevent sleeping on OS X with: caffeinate -sw [backup_pid]\n\n# --quiet - should speed up backup process see: https://github.com/restic/restic/pull/1676\nrestic backup /Users/[username] \\\n  --quiet \\\n  --exclude-caches \\\n  --exclude='/Users/[username]/Dropbox'\\\n  --exclude='/Users/[username]/Downloads'\\\n  --exclude='/Users/[username]/Virtualbox\\ VMs'\\\n  --exclude='/Users/[username]/tmp'\\\n  --exclude='/Users/[username]/**/node_modules'\\\n  --exclude='/Users/[username]/**/bower_components'\\\n  --exclude='/Users/[username]/**/wordpress/**/vendor/*'\n\n# remove outdated snapshots\n# --keep-last 20 - there won't be probably more hourly snapshots in last two days than 20\n# --prune - delete repositories which should be forgotten\nrestic forget --keep-last 20 \\\n  --keep-daily 7 \\\n  --keep-weekly 4 \\\n  --keep-monthly 6 \\\n  --keep-yearly 3 \\\n  --limit-upload 500 \\\n  --prune\n\n# --with-cache - limits Class B Transactions on BackBlaze B2 see: https://forum.restic.net/t/limiting-b2-transactions/209/4\nrestic check --with-cache\n```\n\nThat's all.\n","excerpt":"How to create Restic based backup using Backblaze B2 cloud storage as a backend. This tutorial was made on Mac OS X High Sierra with resticâ€¦","frontmatter":{"title":"Restic backups with Backblaze B2","slug":"restic-backblaze-b2-backups","date":"2018-05-01T15:26:00.000Z","tags":["tools"],"date_created":"2018-05-15T23:52:23.000Z","date_updated":"2018-05-09T22:58:04.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1470173274384-c4e8e2f9ea4c.jpg","relativePath":"posts/img/photo-1470173274384-c4e8e2f9ea4c.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQCAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABofzmoWIC/wD/xAAbEAABBAMAAAAAAAAAAAAAAAABAAIREgMhQv/aAAgBAQABBQLt8p7NkQMhsjZf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERMQIhMmH/2gAIAQEABj8ChaFF+nTFlbEdH//EABwQAQACAwADAAAAAAAAAAAAAAEAETFRYUGhsf/aAAgBAQABPyHFumoBQ8QyFRTdeZcDZM76mD6Oz//aAAwDAQACAAMAAAAQvO//xAAVEQEBAAAAAAAAAAAAAAAAAAAAIf/aAAgBAwEBPxBH/8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQIBAT8QV//EABoQAQEBAQEBAQAAAAAAAAAAAAERIQAxYUH/2gAIAQEAAT8Q1vLoj73tiaoh9Zr7yLsVsejA8M62EC3DeRGhDFSdehpGbJr97//Z","aspectRatio":2,"src":"/static/2025734ce94f464cc816a4e0f76cff08/0defe/photo-1470173274384-c4e8e2f9ea4c.jpg","srcSet":"/static/2025734ce94f464cc816a4e0f76cff08/38b6a/photo-1470173274384-c4e8e2f9ea4c.jpg 150w,\n/static/2025734ce94f464cc816a4e0f76cff08/e201c/photo-1470173274384-c4e8e2f9ea4c.jpg 300w,\n/static/2025734ce94f464cc816a4e0f76cff08/0defe/photo-1470173274384-c4e8e2f9ea4c.jpg 600w,\n/static/2025734ce94f464cc816a4e0f76cff08/a71f1/photo-1470173274384-c4e8e2f9ea4c.jpg 900w,\n/static/2025734ce94f464cc816a4e0f76cff08/8d595/photo-1470173274384-c4e8e2f9ea4c.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"0f294d7c-bfe2-59de-a858-ee8d56350099","html":"<p>A solution for live reload \"bug\" while using <a href=\"https://github.com/ionic-team/ionic-app-scripts\">ionic-app-scripts</a> which causes showing old content after automatic page refresh.</p>\n<p>If you are developing Ionic PWA (Progressive Web App) you may encounter this strange and annoying live reload bug. Your content is updated only after refreshing page manually after the live reload triggers first page refresh.</p>\n<p><strong>This behavior may be caused by the Service Workers inside your browser!</strong></p>\n<p>Just update them after each page reload by checking an option <strong>Update on reload</strong> in Google Chrome Developer Tools inside <strong>Application > Service Workers</strong>:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 584px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2741a394278159ba14c7e3a80bd62d62/90dd3/screen-shot-2018-05-10-at-08.41.43.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.23972602739725%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACK0lEQVQ4y21T6c7iMAzs+78ZEmhBaAv6OAQ9aGnSpC29D2Zt80Xix0aycKkznvG4XpqmSJIEWZbhcrkgpfx2u+HxSBCGAeL4gUwp3O53JFQbRgn++j+4BzHyPEdRFBK5zgXDi+NIgBRder1eqKoKZVlK1HUNrTXix4OaxojiGE03ohvf6Cne7zf48A/n8zzDu1Pn9XqNg3+QC8/nU0C4W1lW6PoeRmfYRy0uYYrC5rDGoG0ayi3V5igLQ0RKAfeCIMBqtcJ2u8Vms8H9Hgjog1hZujBNEwwB1O2IeWEWk/y3LLMwGinPbYuiosblAI+l8hydXJbJwc9d12EYBmKrKG/xXhYCItAFEu+ZtE4zdDnBVhMS1X0Yns9nkcjARVEKmJuhOwuB1fULytS4hiUuUYU41KiUIZYDV3wkR1FEcv/gcPCx2+1EKgMxYENzcmDOgLZtxEBrDXSuSa5BSiPqSQmRh8fz2u/3OB6PwpDBWDqHA3SgFZmkKw1ttMxVaSWrw82t1SS5gccgvu/jdDrBkAkyy995fgOyAU3TEkMyoCxgCyuRGwKkWl2M1JQY8lKz9VzI4Rh+z5DlcvBq8CoplYlMTQyV0r9bMCEjHC8MQ5HL5lyvV3HUgTqGDpBlN3UjX5YxVrag63qMw0jvSQHN1+MZnE4/4vT5fAE3cC5/S+bDq9PTorPbHxWF7CoT4JHwJyouJ0n6H8mVAPMSuxiGXgBdLUfTfprwe87/AXP83Y208jTWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen-Shot-2018-05-10-at-08.41.43\"\n        title=\"Screen-Shot-2018-05-10-at-08.41.43\"\n        src=\"/static/2741a394278159ba14c7e3a80bd62d62/90dd3/screen-shot-2018-05-10-at-08.41.43.png\"\n        srcset=\"/static/2741a394278159ba14c7e3a80bd62d62/a1986/screen-shot-2018-05-10-at-08.41.43.png 210w,\n/static/2741a394278159ba14c7e3a80bd62d62/ad7fb/screen-shot-2018-05-10-at-08.41.43.png 420w,\n/static/2741a394278159ba14c7e3a80bd62d62/90dd3/screen-shot-2018-05-10-at-08.41.43.png 584w\"\n        sizes=\"(max-width: 584px) 100vw, 584px\"\n      />\n  </a>\n    </span></p>\n<p>That should solve it, at least in my case that helps instantly.</p>\n<h2>Sources</h2>\n<p><a href=\"https://github.com/ionic-team/ionic-app-scripts/issues/825\">https://github.com/ionic-team/ionic-app-scripts/issues/825</a>\n<a href=\"https://github.com/ionic-team/ionic-app-scripts/issues/1432\">https://github.com/ionic-team/ionic-app-scripts/issues/1432</a>\n<a href=\"https://github.com/ionic-team/ionic-app-scripts/issues/1132\">https://github.com/ionic-team/ionic-app-scripts/issues/1132</a>\nand many more... (may or may be not related to that issue)</p>","timeToRead":1,"rawMarkdownBody":"A solution for live reload \"bug\" while using [ionic-app-scripts](https://github.com/ionic-team/ionic-app-scripts) which causes showing old content after automatic page refresh.\n\nIf you are developing Ionic PWA (Progressive Web App) you may encounter this strange and annoying live reload bug. Your content is updated only after refreshing page manually after the live reload triggers first page refresh.\n\n**This behavior may be caused by the Service Workers inside your browser!**\n\nJust update them after each page reload by checking an option **Update on reload** in Google Chrome Developer Tools inside **Application > Service Workers**:\n\n![Screen-Shot-2018-05-10-at-08.41.43](img/screen-shot-2018-05-10-at-08.41.43.png)\n\nThat should solve it, at least in my case that helps instantly.\n\n## Sources\nhttps://github.com/ionic-team/ionic-app-scripts/issues/825\nhttps://github.com/ionic-team/ionic-app-scripts/issues/1432\nhttps://github.com/ionic-team/ionic-app-scripts/issues/1132\nand many more... (may or may be not related to that issue)\n","excerpt":"A solution for live reload \"bug\" while using ionic-app-scripts which causes showing old content after automatic page refresh. If you areâ€¦","frontmatter":{"title":"Ionic Framework - ionic-app-scripts live reload shows old content","slug":"ionic-framework-live-reloading","date":"2018-05-09T14:54:00.000Z","tags":["frontend"],"date_created":"2018-05-13T16:40:46.000Z","date_updated":"2018-05-10T10:56:01.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1504966981333-1ac8809be1ca.jpg","relativePath":"posts/img/photo-1504966981333-1ac8809be1ca.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB4Oq1Kg//xAAXEAEBAQEAAAAAAAAAAAAAAAAAEQEQ/9oACAEBAAEFAuRqq//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAAICAwAAAAAAAAAAAAAAAAABEBEhMVH/2gAIAQEAAT8hhBEqrhgtFj//2gAMAwEAAgADAAAAEKQv/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/ELGP/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EBLb/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERITFBUWH/2gAIAQEAAT8QSFOhDUlXO5WxYlui8D//2Q==","aspectRatio":2,"src":"/static/4efdc6e19b9b93efe5a482b78ea73252/0defe/photo-1504966981333-1ac8809be1ca.jpg","srcSet":"/static/4efdc6e19b9b93efe5a482b78ea73252/38b6a/photo-1504966981333-1ac8809be1ca.jpg 150w,\n/static/4efdc6e19b9b93efe5a482b78ea73252/e201c/photo-1504966981333-1ac8809be1ca.jpg 300w,\n/static/4efdc6e19b9b93efe5a482b78ea73252/0defe/photo-1504966981333-1ac8809be1ca.jpg 600w,\n/static/4efdc6e19b9b93efe5a482b78ea73252/a71f1/photo-1504966981333-1ac8809be1ca.jpg 900w,\n/static/4efdc6e19b9b93efe5a482b78ea73252/8d595/photo-1504966981333-1ac8809be1ca.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"a9ec266a-5bb7-5808-b034-29da818e8feb","html":"<p>It is possible to split you type definitions to multiple <code class=\"language-text\">.graphql</code> files and then merge them back using <a href=\"https://github.com/okgrow/merge-graphql-schemas\">merge-graphql-schemas</a> ensuring graphql modularization.</p>\n<p>This was one of the key features I was looking for when working with <strong>graphql-yoga</strong>. The example available in their repo <a href=\"https://github.com/graphcool/graphql-yoga/tree/master/examples/modular-resolvers\">modular-resolvers</a> is really helpfull but it doesn't explain how to handle <code class=\"language-text\">.graphql</code> files in subfolders.</p>\n<p>In order to achieve this kind of modularization you will have to change:\n<strong>typeDefs/index.ts</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> path <span class=\"token keyword\">from</span> <span class=\"token string\">\"path\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> fileLoader<span class=\"token punctuation\">,</span> mergeTypes <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"merge-graphql-schemas\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> typesArray <span class=\"token operator\">=</span> <span class=\"token function\">fileLoader</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"./\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> typesMerged <span class=\"token operator\">=</span> <span class=\"token function\">mergeTypes</span><span class=\"token punctuation\">(</span>typesArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> typesMerged<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>to:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> path <span class=\"token keyword\">from</span> <span class=\"token string\">\"path\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> fileLoader<span class=\"token punctuation\">,</span> mergeTypes <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"merge-graphql-schemas\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> typesArray <span class=\"token operator\">=</span> <span class=\"token function\">fileLoader</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\".\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> recursive<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> typesMerged <span class=\"token operator\">=</span> <span class=\"token function\">mergeTypes</span><span class=\"token punctuation\">(</span>typesArray<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> all<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> typesMerged<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>That's all and that's easy if you know the available options.</p>\n<p>Now instead of:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">â–¾ typeDefs/\n    index.ts\n    user.typedefs.graphql\n    welcome.typedefs.graphql</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>You may have more granular structure like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">â–¾ typeDefs/\n  â–¾ Mutation/\n      User.graphql\n  â–¾ Subscription/\n      User.graphql\n  User.graphql\n  Welcome.graphql\n  Query.graphql\n  index.ts</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Is it better in any way than example from <strong>graphql-yoga</strong> repo? I don't know, maybe not, but if it suits you better you may use it.</p>\n<p><strong>NOTE</strong>\nThese are versions of the relevant packages:\n<strong>package.json</strong> (part of it)</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"graphql-yoga\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^1.13.1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"merge-graphql-schemas\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^1.5.1\"</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>They may differ from the official example <a href=\"https://github.com/graphcool/graphql-yoga/blob/master/examples/modular-resolvers/package.json\">package.json</a> file.</p>\n<h2>Sidenotes</h2>\n<p>My other attempt to split grapql into multiple files uses <a href=\"https://github.com/graphcool/graphql-import\">graphql-import</a>. Unfortunatelly it wasn't a good option because of lack of support for extending types (see <a href=\"https://github.com/graphcool/graphql-import/issues/42\">graphql-import issue#42</a>) e.g.:</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-graphql line-numbers\"><code class=\"language-graphql\">extend <span class=\"token keyword\">type</span> <span class=\"token class-name\">Query</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token attr-name\">allUsers</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>User<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>This was for me one of the core features required to split files easily, so I've decided to go with <strong>merge-graphql-schemas</strong> instead.</p>\n<p>Another option which I manage to avoid was adding Webpack for bundling server files. While it should/may work as discussed in <a href=\"https://github.com/apollographql/graphql-tools/issues/273\">graphql-tools issue#273</a> I think that keeping <strong>graphql-yoga</strong> as simple as possible is generally a good idea.</p>\n<h2>Sources</h2>\n<p><a href=\"https://github.com/graphcool/graphql-yoga/tree/master/examples/modular-resolvers\">https://github.com/graphcool/graphql-yoga/tree/master/examples/modular-resolvers</a>\n<a href=\"https://github.com/okgrow/merge-graphql-schemas\">https://github.com/okgrow/merge-graphql-schemas</a>\n<a href=\"https://github.com/apollographql/graphql-tools/issues/273\">https://github.com/apollographql/graphql-tools/issues/273</a>\n<a href=\"https://github.com/graphcool/graphql-import/issues/42\">https://github.com/graphcool/graphql-import/issues/42</a></p>","timeToRead":2,"rawMarkdownBody":"It is possible to split you type definitions to multiple `.graphql` files and then merge them back using [merge-graphql-schemas](https://github.com/okgrow/merge-graphql-schemas) ensuring graphql modularization.\n\nThis was one of the key features I was looking for when working with **graphql-yoga**. The example available in their repo [modular-resolvers](https://github.com/graphcool/graphql-yoga/tree/master/examples/modular-resolvers) is really helpfull but it doesn't explain how to handle `.graphql` files in subfolders.\n\nIn order to achieve this kind of modularization you will have to change:\n**typeDefs/index.ts**\n```javascript\nimport * as path from \"path\";\nimport { fileLoader, mergeTypes } from \"merge-graphql-schemas\";\n\nconst typesArray = fileLoader(path.join(__dirname, \"./\"));\nconst typesMerged = mergeTypes(typesArray);\n\nexport default typesMerged;\n```\nto:\n```javascript\nimport * as path from \"path\";\nimport { fileLoader, mergeTypes } from \"merge-graphql-schemas\";\n\nconst typesArray = fileLoader(path.join(__dirname, \".\"), { recursive: true });\nconst typesMerged = mergeTypes(typesArray, { all: true });\n\nexport default typesMerged;\n```\n\nThat's all and that's easy if you know the available options.\n\nNow instead of:\n```bash\nâ–¾ typeDefs/\n    index.ts\n    user.typedefs.graphql\n    welcome.typedefs.graphql\n```\nYou may have more granular structure like this:\n```bash\nâ–¾ typeDefs/\n  â–¾ Mutation/\n      User.graphql\n  â–¾ Subscription/\n      User.graphql\n  User.graphql\n  Welcome.graphql\n  Query.graphql\n  index.ts\n```\nIs it better in any way than example from **graphql-yoga** repo? I don't know, maybe not, but if it suits you better you may use it.\n\n**NOTE**\nThese are versions of the relevant packages:\n**package.json** (part of it)\n```json\n\"dependencies\": {\n    \"graphql-yoga\": \"^1.13.1\",\n    \"merge-graphql-schemas\": \"^1.5.1\"\n}\n```\nThey may differ from the official example [package.json](https://github.com/graphcool/graphql-yoga/blob/master/examples/modular-resolvers/package.json) file.\n\n## Sidenotes\nMy other attempt to split grapql into multiple files uses [graphql-import](https://github.com/graphcool/graphql-import). Unfortunatelly it wasn't a good option because of lack of support for extending types (see [graphql-import issue#42](https://github.com/graphcool/graphql-import/issues/42)) e.g.:\n```graphql\nextend type Query {\n  allUsers: [User]\n}\n```\nThis was for me one of the core features required to split files easily, so I've decided to go with **merge-graphql-schemas** instead.\n\nAnother option which I manage to avoid was adding Webpack for bundling server files. While it should/may work as discussed in [graphql-tools issue#273](https://github.com/apollographql/graphql-tools/issues/273) I think that keeping **graphql-yoga** as simple as possible is generally a good idea.\n\n## Sources\nhttps://github.com/graphcool/graphql-yoga/tree/master/examples/modular-resolvers\nhttps://github.com/okgrow/merge-graphql-schemas\nhttps://github.com/apollographql/graphql-tools/issues/273\nhttps://github.com/graphcool/graphql-import/issues/42\n","excerpt":"It is possible to split you type definitions to multiple  files and then merge them back using merge-graphql-schemas ensuring graphqlâ€¦","frontmatter":{"title":"graphql-yoga import .graphql files","slug":"graphql-yoga-import-graphql-files","date":"2018-05-05T14:34:55.000Z","tags":["javascript","graphql"],"date_created":"2018-05-12T19:59:43.000Z","date_updated":"2018-05-05T14:34:55.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1444312645910-ffa973656eba.jpg","relativePath":"posts/img/photo-1444312645910-ffa973656eba.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAeABQDASIAAhEBAxEB/8QAGQAAAwADAAAAAAAAAAAAAAAAAAMEAQIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAb8SqOmSkIjfMtZsR//EABwQAQACAgMBAAAAAAAAAAAAAAEAAhESAxMhMv/aAAgBAQABBQKilTny9rNxrxeW2qy/yW1gLLhjbwvk/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAHxAAAQMDBQAAAAAAAAAAAAAAAAERMRAhMkFRYYGR/9oACAEBAAY/AnRiDAlWL2MX6NiLcjopDU08P//EAB0QAQACAwEAAwAAAAAAAAAAAAEAESExQVGBobH/2gAIAQEAAT8hrhlnGWNgXjiIuzP1UdiLm2+bnoDibTcfZuMrbdQZouqgLh7KmMAFlif/2gAMAwEAAgADAAAAEJDxj//EABgRAAIDAAAAAAAAAAAAAAAAAAABEBEh/9oACAEDAQE/ENKY4//EABkRAAMAAwAAAAAAAAAAAAAAAAABERAhMf/aAAgBAgEBPxDRUKLuP//EAB4QAQEAAwACAwEAAAAAAAAAAAERACFBMVFhcYGR/9oACAEBAAE/EF8AQDh31gjVu3vJLfLQwOXwiQdNB8YmpFSMp4mKqAaVQc7kA2WxAIeu/sxLB62IHd5Ao3wQT8c2XUPf7rrEIA225EEAOjX+5//Z","aspectRatio":2,"src":"/static/c3b8665195a8448b3da6587755201ce8/0defe/photo-1444312645910-ffa973656eba.jpg","srcSet":"/static/c3b8665195a8448b3da6587755201ce8/38b6a/photo-1444312645910-ffa973656eba.jpg 150w,\n/static/c3b8665195a8448b3da6587755201ce8/e201c/photo-1444312645910-ffa973656eba.jpg 300w,\n/static/c3b8665195a8448b3da6587755201ce8/0defe/photo-1444312645910-ffa973656eba.jpg 600w,\n/static/c3b8665195a8448b3da6587755201ce8/a71f1/photo-1444312645910-ffa973656eba.jpg 900w,\n/static/c3b8665195a8448b3da6587755201ce8/8d595/photo-1444312645910-ffa973656eba.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"b44de6d6-2b1d-5c39-8923-4a78f42773c2","html":"<p>Use <code class=\"language-text\">ngAfterViewChecked()</code> Angular hook and execute <code class=\"language-text\">.setFocus()</code> inside it.</p>\n<p>While working with the Ionic 3 Framework I came across (as it turns out) popular problem of autofocusing an input after showing a component on the page.</p>\n<p>The most popular answer to this problem advises to use <code class=\"language-text\">setTimeout</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token function\">ionViewLoaded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myInput<span class=\"token punctuation\">.</span><span class=\"token function\">setFocus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>I hate such workarounds so I've decided to dig deeper. While none of the available <a href=\"https://blog.ionicframework.com/navigating-lifecycle-events/\">Ionic lifecycle hooks</a> works in that case there are also <a href=\"https://angular.io/guide/lifecycle-hooks\">Angular lifecycle hooks</a>. It turns out that <code class=\"language-text\">ngAfterViewChecked</code> is the one I was looking for:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token function\">ngAfterViewChecked</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myInput<span class=\"token punctuation\">.</span><span class=\"token function\">setFocus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>So that is clean <code class=\"language-text\">setFocus()</code> solution for Ionic without using <code class=\"language-text\">setTimeout()</code> workaround.</p>\n<h2>Sidenote</h2>\n<p>In order to be able to refer to the input element with <code class=\"language-text\">this.myInput</code> you have to define it inside your Component as a ViewChild.</p>\n<p>Here is the example of Modal Component which will autofocus its input after showing itself on the page.\nJavascript:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token punctuation\">:</span> <span class=\"token string\">'location-modal-create'</span><span class=\"token punctuation\">,</span>\n  templateUrl<span class=\"token punctuation\">:</span> <span class=\"token string\">'modal-create.html'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LocationCreateModal</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> location<span class=\"token punctuation\">:</span> FormGroup<span class=\"token punctuation\">;</span>\n\n  @<span class=\"token function\">ViewChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">'myInput'</span><span class=\"token punctuation\">)</span> myInput<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\"><span class=\"token keyword\">public</span> platform<span class=\"token punctuation\">:</span> Platform<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">public</span> params<span class=\"token punctuation\">:</span> NavParams<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">public</span> viewCtrl<span class=\"token punctuation\">:</span> ViewController<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">private</span> formBuilder<span class=\"token punctuation\">:</span> FormBuilder</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>formBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">group</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> Validators<span class=\"token punctuation\">.</span>required<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>params <span class=\"token operator\">=</span> params<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>viewCtrl <span class=\"token operator\">=</span> viewCtrl<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">ngAfterViewChecked</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>myInput<span class=\"token punctuation\">.</span><span class=\"token function\">setFocus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">dismiss</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>viewCtrl<span class=\"token punctuation\">.</span><span class=\"token function\">dismiss</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Html:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-header</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-toolbar</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-title</span><span class=\"token punctuation\">></span></span>\n      New Location\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-title</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-buttons</span> <span class=\"token attr-name\">end</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">ion-button</span> <span class=\"token attr-name\">(click)</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>dismiss()<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">ion-text</span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>primary<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">showWhen</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>ios<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Cancel<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-icon</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>close<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">hideWhen</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>ios<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-icon</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-buttons</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-toolbar</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-header</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-content</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">[formGroup]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>location<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">(ngSubmit)</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit()<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-item</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-label</span> <span class=\"token attr-name\">floating</span><span class=\"token punctuation\">></span></span>Location name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-label</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-input</span> <span class=\"token attr-name\">#myInput</span> <span class=\"token attr-name\">formControlName</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-input</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-item</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">padding</span> <span class=\"token attr-name\">*ngIf</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>location.valid<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">ion-button</span> <span class=\"token attr-name\">block</span><span class=\"token punctuation\">></span></span>Create Location<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">padding</span> <span class=\"token attr-name\">*ngIf</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>!location.valid<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">ion-button</span> <span class=\"token attr-name\">block</span> <span class=\"token attr-name\">disabled</span> <span class=\"token attr-name\">outline</span><span class=\"token punctuation\">></span></span>Please fill Location data<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-content</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Sources</h2>\n<p><a href=\"https://forum.ionicframework.com/t/setting-focus-to-an-input-in-ionic/62789/36\">https://forum.ionicframework.com/t/setting-focus-to-an-input-in-ionic/62789/36</a>\n<a href=\"https://stackoverflow.com/questions/42693567/not-been-able-to-set-focus-to-my-ion-input-as-i-enter-the-page/43193925\">https://stackoverflow.com/questions/42693567/not-been-able-to-set-focus-to-my-ion-input-as-i-enter-the-page/43193925</a></p>","timeToRead":2,"rawMarkdownBody":"Use `ngAfterViewChecked()` Angular hook and execute `.setFocus()` inside it.\n\nWhile working with the Ionic 3 Framework I came across (as it turns out) popular problem of autofocusing an input after showing a component on the page.\n\nThe most popular answer to this problem advises to use `setTimeout`:\n```js\nionViewLoaded() {\n    setTimeout(() => {\n        this.myInput.setFocus();\n    },150);\n}\n```\n\nI hate such workarounds so I've decided to dig deeper. While none of the available [Ionic lifecycle hooks](https://blog.ionicframework.com/navigating-lifecycle-events/) works in that case there are also [Angular lifecycle hooks](https://angular.io/guide/lifecycle-hooks). It turns out that `ngAfterViewChecked` is the one I was looking for:\n\n```js\nngAfterViewChecked() {\n    this.myInput.setFocus()\n}\n```\n\nSo that is clean `setFocus()` solution for Ionic without using `setTimeout()` workaround.\n\n## Sidenote\nIn order to be able to refer to the input element with `this.myInput` you have to define it inside your Component as a ViewChild.\n\nHere is the example of Modal Component which will autofocus its input after showing itself on the page.\nJavascript:\n```js\n@Component({\n  selector: 'location-modal-create',\n  templateUrl: 'modal-create.html'\n})\nexport class LocationCreateModal {\n  private location: FormGroup;\n\n  @ViewChild('myInput') myInput;\n\n  constructor(\n    public platform: Platform,\n    public params: NavParams,\n    public viewCtrl: ViewController,\n    private formBuilder: FormBuilder\n  ) {\n    this.location = this.formBuilder.group({\n      name: ['', Validators.required],\n    });\n    this.params = params;\n    this.viewCtrl = viewCtrl;\n  }\n\n  ngAfterViewChecked() {\n    this.myInput.setFocus()\n  }\n\n  dismiss() {\n    this.viewCtrl.dismiss();\n  }\n}\n```\n\nHtml:\n```html\n<ion-header>\n  <ion-toolbar>\n    <ion-title>\n      New Location\n    </ion-title>\n    <ion-buttons end>\n      <button ion-button (click)=\"dismiss()\">\n        <span ion-text color=\"primary\" showWhen=\"ios\">Cancel</span>\n        <ion-icon name=\"close\" hideWhen=\"ios\"></ion-icon>\n      </button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n  <form [formGroup]=\"location\" (ngSubmit)=\"submit()\">\n\n    <ion-item>\n      <ion-label floating>Location name</ion-label>\n      <ion-input #myInput formControlName=\"name\" type=\"text\"></ion-input>\n    </ion-item>\n\n    <div padding *ngIf=\"location.valid\">\n      <button ion-button block>Create Location</button>\n    </div>\n    <div padding *ngIf=\"!location.valid\">\n      <button ion-button block disabled outline>Please fill Location data</button>\n    </div>\n\n  </form>\n</ion-content>\n```\n\n## Sources\nhttps://forum.ionicframework.com/t/setting-focus-to-an-input-in-ionic/62789/36\nhttps://stackoverflow.com/questions/42693567/not-been-able-to-set-focus-to-my-ion-input-as-i-enter-the-page/43193925\n","excerpt":"Use  Angular hook and execute  inside it. While working with the Ionic 3 Framework I came across (as it turns out) popular problem ofâ€¦","frontmatter":{"title":"Ionic 3 Framework - setFocus on opened modal input","slug":"ionic-3-framework-setfocus-of-an-input","date":"2018-04-20T03:41:00.000Z","tags":["frontend","javascript"],"date_created":"2018-04-25T22:59:15.000Z","date_updated":"2018-09-15T12:13:23.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1528916484197-ce92c83dc038.jpg","relativePath":"posts/img/photo-1528916484197-ce92c83dc038.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAeABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMBAgUE/8QAFwEAAwEAAAAAAAAAAAAAAAAAAAECA//aAAwDAQACEAMQAAABW7N73NwGZzFTGlxIL//EABwQAAICAgMAAAAAAAAAAAAAAAARAQMCEiEiM//aAAgBAQABBQKEJmh6Z1WRXGV+L1I4OoxjP//EABYRAQEBAAAAAAAAAAAAAAAAABEAEP/aAAgBAwEBPwE1v//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAECAQE/AWP/xAAbEAACAgMBAAAAAAAAAAAAAAAAASExESAyQf/aAAgBAQAGPwKTKKH4hqDohlFaf//EAB8QAQACAQMFAAAAAAAAAAAAAAEAESExQXEQYYGh0f/aAAgBAQABPyFjFCFWqdpeMIvciAwvC4myDggDPpiBoeYlviE+fT//2gAMAwEAAgADAAAAEKwED//EABYRAAMAAAAAAAAAAAAAAAAAAAABEf/aAAgBAwEBPxCIQTSIP//EABcRAQEBAQAAAAAAAAAAAAAAAAABETH/2gAIAQIBAT8Q6asrK//EAB0QAQACAgMBAQAAAAAAAAAAAAEAESExQVFhcYH/2gAIAQEAAT8QrkT1qa4fnIlmVRaI4y6DQex/k75DqnBcTZxdMh+3HxK9MtDJcudxtgHyKe4mnZjZ5n//2Q==","aspectRatio":2,"src":"/static/e821a3b0cfa5d2a914083a69ee468196/0defe/photo-1528916484197-ce92c83dc038.jpg","srcSet":"/static/e821a3b0cfa5d2a914083a69ee468196/38b6a/photo-1528916484197-ce92c83dc038.jpg 150w,\n/static/e821a3b0cfa5d2a914083a69ee468196/e201c/photo-1528916484197-ce92c83dc038.jpg 300w,\n/static/e821a3b0cfa5d2a914083a69ee468196/0defe/photo-1528916484197-ce92c83dc038.jpg 600w,\n/static/e821a3b0cfa5d2a914083a69ee468196/a71f1/photo-1528916484197-ce92c83dc038.jpg 900w,\n/static/e821a3b0cfa5d2a914083a69ee468196/8d595/photo-1528916484197-ce92c83dc038.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"3aa3f52c-fe1e-563f-9be6-a1368b06c3d2","html":"<p>This will be a tutorial about adding <strong>new</strong> partition to the existing Vagrant (Virtual Box) machine. It should be safe to follow but <strong>please backup your data before proceeding</strong>.</p>\n<p>Use <strong>vagrant-disksize</strong> plugin from <a href=\"https://github.com/sprotheroe/vagrant-disksize\">https://github.com/sprotheroe/vagrant-disksize</a></p>\n<h2>Installation is easy</h2>\n<p>Execute inside you Vagrant VM folder:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">vagrant plugin <span class=\"token function\">install</span> vagrant-disksize</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>Then configure</h2>\n<p>Modify your <strong>Vagrantfile</strong> according to plugin <strong>Usage</strong> section:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token constant\">Vagrant</span><span class=\"token punctuation\">.</span>configure<span class=\"token punctuation\">(</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>config<span class=\"token operator\">|</span>\n  config<span class=\"token punctuation\">.</span>vm<span class=\"token punctuation\">.</span>box <span class=\"token operator\">=</span> <span class=\"token string\">'ubuntu/xenial64'</span>\n  config<span class=\"token punctuation\">.</span>disksize<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> <span class=\"token string\">'50GB'</span>\n<span class=\"token keyword\">end</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Finally</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">vagrant up</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>Now the tricky part</h2>\n<p>If you are not an experienced Linux user it might be not so easy. You will have to create and format new partition using command line.</p>\n<h3>Enter your Vagrant box</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">vagrant <span class=\"token function\">ssh</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>Become root user</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">su</span> -</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>Enter partitioning utility</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">fdisk</span> /dev/sda</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ol>\n<li>Press <code class=\"language-text\">p</code> to check current partitions table (just for your information)</li>\n<li>Press <code class=\"language-text\">n</code> in order to create new partition</li>\n<li>Press <code class=\"language-text\">e</code> to create extended (logical) partition</li>\n<li>Select its number (or hit ENTER to leave the default selection which should be OK in most cases)</li>\n<li>Select first sector (or hit ENTER to leave the default number which should be OK in most cases)</li>\n<li>Select last sector (hit ENTER to leave the default number which should ensure that entire available space will be used)</li>\n<li>Press <code class=\"language-text\">p</code> and check that you have now a new partition (compared to step 1.)</li>\n<li>Press <code class=\"language-text\">w</code> to save your modifications</li>\n</ol>\n<p>After these steps you should see output similar to this one:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">The partition table has been altered.\nCalling ioctl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> to re-read partition table.\nRe-reading the partition table failed.: Device or resource busy\n\nThe kernel still uses the old table. The new table will be used at the next <span class=\"token function\">reboot</span> or after you run partprobe<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> or kpartx<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>You shouldn't worry about <code class=\"language-text\">...: Device or resource busy</code> message</p>\n<h3>Exit your Vagrant box</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token builtin class-name\">exit</span>\n<span class=\"token builtin class-name\">exit</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Yes execute it two times: first one leaves root and second one exits Vagrant.</p>\n<h3>Restart your Vagrant box</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">vagrant reload</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>(or <code class=\"language-text\">vagrant halt</code> and <code class=\"language-text\">vagrant up</code> if you prefer)</p>\n<h3>Reenter Vagrant</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">vagrant <span class=\"token function\">ssh</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>You may check with <code class=\"language-text\">df -h</code> that your new partition is not currently mounted</p>\n<h3>Format new partition</h3>\n<p>Assuming that you new partition is located at <code class=\"language-text\">/dev/sda3</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">sudo mkfs -t ext4 /dev/sda3</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>If it asks you about proceeding <strong>Proceed anyway?</strong> you should probably answer with <code class=\"language-text\">y</code>.</p>\n<h3>Mount your new partition!</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">sudo mkdir /mnt/new_partition\nsudo mount /dev/sda3 /mnt/new_partition</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>So it is now available on <code class=\"language-text\">/mnt/new_partition</code> path.</p>\n<p>That's it you are done.</p>\n<h2>Automounting new partition</h2>\n<p>After setting up new partition you will probably want it to mount on VM startup without need for manual <code class=\"language-text\">mount</code>.</p>\n<p>Check the <a href=\"https://askubuntu.com/a/165462/175659\">https://askubuntu.com/a/165462/175659</a> for info about automount setup using <code class=\"language-text\">/etc/fstab</code> file.</p>\n<h2>Sources</h2>\n<p>If you want to play with resizing existing disk please refer to the: <a href=\"https://gist.github.com/christopher-hopper/9755310\">https://gist.github.com/christopher-hopper/9755310</a>\nand/or (I had no luck with this solution but it might work):\n<a href=\"https://askubuntu.com/a/116367/175659\">https://askubuntu.com/a/116367/175659</a></p>","timeToRead":3,"rawMarkdownBody":"This will be a tutorial about adding **new** partition to the existing Vagrant (Virtual Box) machine. It should be safe to follow but **please backup your data before proceeding**.\n\nUse **vagrant-disksize** plugin from https://github.com/sprotheroe/vagrant-disksize\n\n## Installation is easy\nExecute inside you Vagrant VM folder:\n```bash\nvagrant plugin install vagrant-disksize\n```\n\n## Then configure\nModify your **Vagrantfile** according to plugin **Usage** section:\n```ruby\nVagrant.configure('2') do |config|\n  config.vm.box = 'ubuntu/xenial64'\n  config.disksize.size = '50GB'\nend\n```\n\n## Finally\n```\nvagrant up\n```\n\n## Now the tricky part\nIf you are not an experienced Linux user it might be not so easy. You will have to create and format new partition using command line.\n\n### Enter your Vagrant box\n```bash\nvagrant ssh\n```\n\n### Become root user\n```bash\nsudo su -\n```\n\n### Enter partitioning utility\n```bash\nfdisk /dev/sda\n```\n\n1. Press `p` to check current partitions table (just for your information)\n2. Press `n` in order to create new partition\n3. Press `e` to create extended (logical) partition\n4. Select its number (or hit ENTER to leave the default selection which should be OK in most cases)\n5. Select first sector (or hit ENTER to leave the default number which should be OK in most cases)\n6. Select last sector (hit ENTER to leave the default number which should ensure that entire available space will be used)\n7. Press `p` and check that you have now a new partition (compared to step 1.)\n8. Press `w` to save your modifications\n\nAfter these steps you should see output similar to this one:\n\n```bash\nThe partition table has been altered.\nCalling ioctl() to re-read partition table.\nRe-reading the partition table failed.: Device or resource busy\n\nThe kernel still uses the old table. The new table will be used at the next reboot or after you run partprobe(8) or kpartx(8).\n```\nYou shouldn't worry about `...: Device or resource busy` message\n\n### Exit your Vagrant box\n```bash\nexit\nexit\n```\nYes execute it two times: first one leaves root and second one exits Vagrant.\n\n### Restart your Vagrant box\n```bash\nvagrant reload\n```\n(or `vagrant halt` and `vagrant up` if you prefer)\n\n### Reenter Vagrant\n```bash\nvagrant ssh\n```\nYou may check with `df -h` that your new partition is not currently mounted\n\n### Format new partition\nAssuming that you new partition is located at `/dev/sda3`\n```\nsudo mkfs -t ext4 /dev/sda3\n```\nIf it asks you about proceeding **Proceed anyway?** you should probably answer with `y`.\n\n### Mount your new partition!\n```\nsudo mkdir /mnt/new_partition\nsudo mount /dev/sda3 /mnt/new_partition\n```\nSo it is now available on `/mnt/new_partition` path.\n\nThat's it you are done.\n\n## Automounting new partition\nAfter setting up new partition you will probably want it to mount on VM startup without need for manual `mount`.\n\nCheck the https://askubuntu.com/a/165462/175659 for info about automount setup using `/etc/fstab` file.\n\n## Sources\n\nIf you want to play with resizing existing disk please refer to the: https://gist.github.com/christopher-hopper/9755310\nand/or (I had no luck with this solution but it might work):\nhttps://askubuntu.com/a/116367/175659\n","excerpt":"This will be a tutorial about adding new partition to the existing Vagrant (Virtual Box) machine. It should be safe to follow but pleaseâ€¦","frontmatter":{"title":"Adding new partition to the existing Vagrant VM","slug":"resizing-vagrant-vm-disksize","date":"2018-04-06T01:00:00.000Z","tags":["tools"],"date_created":"2018-04-15T18:50:52.000Z","date_updated":"2018-04-06T18:29:00.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1520194057472-0410cf11178e.jpg","relativePath":"posts/img/photo-1520194057472-0410cf11178e.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIEAQP/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdWBy04G5//EABsQAQEAAQUAAAAAAAAAAAAAAAECAAMREiIj/9oACAEBAAEFAhdPLtZitwp5zXtT2//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABURAQEAAAAAAAAAAAAAAAAAAAAB/9oACAECAQE/AUf/xAAdEAACAQQDAAAAAAAAAAAAAAAAARECIjFREiFC/9oACAEBAAY/Aubqt0OtO0zJDwR50dH/xAAbEAADAQADAQAAAAAAAAAAAAAAAREhMUFRgf/aAAgBAQABPyHAjr4uEcjvw3XyPTsSrB0elomySJH/2gAMAwEAAgADAAAAEAAv/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAEh/9oACAEDAQE/EMWv/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAgEBPxB3WHC//8QAGxABAQADAQEBAAAAAAAAAAAAAREAITFBUWH/2gAIAQEAAT8Q9rAQ1RS/CZx8inoJb8/MpkTq8dvMdQjoMXmrh+uvR4kuTA1AM//Z","aspectRatio":2,"src":"/static/ef3e55960019e5a5405d942164a35b83/0defe/photo-1520194057472-0410cf11178e.jpg","srcSet":"/static/ef3e55960019e5a5405d942164a35b83/38b6a/photo-1520194057472-0410cf11178e.jpg 150w,\n/static/ef3e55960019e5a5405d942164a35b83/e201c/photo-1520194057472-0410cf11178e.jpg 300w,\n/static/ef3e55960019e5a5405d942164a35b83/0defe/photo-1520194057472-0410cf11178e.jpg 600w,\n/static/ef3e55960019e5a5405d942164a35b83/a71f1/photo-1520194057472-0410cf11178e.jpg 900w,\n/static/ef3e55960019e5a5405d942164a35b83/8d595/photo-1520194057472-0410cf11178e.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"cb11d09f-3eee-5921-9663-38fa54beb444","html":"<p>While playing with Ionic Framework v3 I came across few errors/problems which I would like to describe here.</p>\n<h2>ion-app did not match eny elements</h2>\n<p>Exact error message is:</p>\n<blockquote>\n<p>ERROR Error: The selector \"ion-app\" did not match any elements</p>\n</blockquote>\n<p>or/and:</p>\n<blockquote>\n<p>Unhandled Promise rejection: The selector \"ion-app\" did not match any elements ; Zone: <root> ; Task: Promise.then ; Value: Error: The selector \"ion-app\" did not match any elements</p>\n</blockquote>\n<p>For me this wasn't descriptive enough to troubleshoot the issue instantly, but after spending some time debugging and rewriting my App I find out that this error means:</p>\n<p>Application can't find <code class=\"language-text\">&lt;ion-app&gt;&lt;/ion-app&gt;</code> DOM element, so there is probably some issue with \"root/main\" template and Javascript interpreter/compiler can't find <code class=\"language-text\">&lt;ion-app&gt;&lt;/ion-app&gt;</code> inside this template. That is why Ionic is not rendered/bootstraped.</p>\n<h3>Here is my case</h3>\n<p>My initial (buggy) <code class=\"language-text\">main.html</code> template:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token doctype\">&lt;!DOCTYPE html></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Todos<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-app</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-app</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>It turns out that wrapping Ionic template with:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>was a terrible idea.</p>\n<h3>Solution</h3>\n<p>In my case it was just removing <code class=\"language-text\">&lt;html&gt;&lt;/html&gt;</code> tags which wraps entire app template. So after modification <code class=\"language-text\">main.html</code> file looks as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Todos<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ion-app</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ion-app</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Easy? Very easy if know what's going on...</p>\n<h2>Auto opening new browser tab on every Ionic App start</h2>\n<p>That one drives me crazy. While it is fine for first run to pop-up a new tab with a developed App it doesn't make any sense in a long run. App restarts are required from time to time and auto-opening new tab becomes very annoying.</p>\n<h3>Solution</h3>\n<p>Quick and easy if you know where to look for it. Head to the <strong>package.json</strong> file, find <code class=\"language-text\">&quot;scripts&quot;</code> section and replace:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\">    <span class=\"token property\">\"ionic:serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ionic-app-scripts serve\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>with:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\">    <span class=\"token property\">\"ionic:serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ionic-app-scripts serve --nobrowser\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Now you may restart your App server as many times as you want without worring about opening new browser tab on each start.</p>","timeToRead":2,"rawMarkdownBody":"While playing with Ionic Framework v3 I came across few errors/problems which I would like to describe here.\n\n## ion-app did not match eny elements\n\nExact error message is:\n\n> ERROR Error: The selector \"ion-app\" did not match any elements\n\nor/and:\n\n> Unhandled Promise rejection: The selector \"ion-app\" did not match any elements ; Zone: <root> ; Task: Promise.then ; Value: Error: The selector \"ion-app\" did not match any elements\n\nFor me this wasn't descriptive enough to troubleshoot the issue instantly, but after spending some time debugging and rewriting my App I find out that this error means:\n\nApplication can't find `<ion-app></ion-app>` DOM element, so there is probably some issue with \"root/main\" template and Javascript interpreter/compiler can't find `<ion-app></ion-app>` inside this template. That is why Ionic is not rendered/bootstraped.\n\n### Here is my case\n\nMy initial (buggy) `main.html` template:\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Todos</title>\n</head>\n\n<body>\n  <ion-app></ion-app>\n</body>\n</html>\n```\n\nIt turns out that wrapping Ionic template with:\n```html\n<html>\n</html>\n```\nwas a terrible idea.\n\n### Solution\n\nIn my case it was just removing `<html></html>` tags which wraps entire app template. So after modification `main.html` file looks as follows:\n\n```html\n<head>\n  <title>Todos</title>\n</head>\n\n<body>\n  <ion-app></ion-app>\n</body>\n```\n\nEasy? Very easy if know what's going on...\n\n## Auto opening new browser tab on every Ionic App start\nThat one drives me crazy. While it is fine for first run to pop-up a new tab with a developed App it doesn't make any sense in a long run. App restarts are required from time to time and auto-opening new tab becomes very annoying.\n\n### Solution\nQuick and easy if you know where to look for it. Head to the **package.json** file, find `\"scripts\"` section and replace:\n```json\n    \"ionic:serve\": \"ionic-app-scripts serve\"\n```\nwith:\n```json\n    \"ionic:serve\": \"ionic-app-scripts serve --nobrowser\"\n```\nNow you may restart your App server as many times as you want without worring about opening new browser tab on each start.\n","excerpt":"While playing with Ionic Framework v3 I came across few errors/problems which I would like to describe here. ion-app did not match enyâ€¦","frontmatter":{"title":"Ionic Framework 3 - troubleshooting","slug":"ionic-framework-3-troubleshooting","date":"2018-04-11T03:03:00.000Z","tags":["javascript","frontend"],"date_created":"2018-04-13T02:00:28.000Z","date_updated":"2018-09-15T12:23:50.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1536349156324-682aa16f0c26.jpg","relativePath":"posts/img/photo-1536349156324-682aa16f0c26.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAeABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAQX/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQID/9oADAMBAAIQAxAAAAGrcSiwiKhS0Txp1jniX//EABwQAAMAAgMBAAAAAAAAAAAAAAABAgMSERMhIv/aAAgBAQABBQLHKRVsXAqIG6NtV2LWcnlv5Qmf/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEB/9oACAEDAQE/AYmtV//EABgRAQADAQAAAAAAAAAAAAAAAAABAhIR/9oACAECAQE/AetQqxD/xAAeEAABBAEFAAAAAAAAAAAAAAABABARIQIgIjEyQf/aAAgBAQAGPwK/FJAAfKphdS23nT//xAAdEAEAAwABBQAAAAAAAAAAAAABABEhMUFRcYGR/9oACAEBAAE/IS76FwQJHaUGRE1U4jFGSxiGz1M3blfIUOFtlht3xLIUSuZ//9oADAMBAAIAAwAAABBs8n//xAAYEQEBAQEBAAAAAAAAAAAAAAABACERYf/aAAgBAwEBPxDV5S5hDL//xAAYEQADAQEAAAAAAAAAAAAAAAAAAREhYf/aAAgBAgEBPxCTqJVo3On/xAAdEAEBAAMAAgMAAAAAAAAAAAABEQAhMVFhgbHB/9oACAEBAAE/EFoNZga17xY9ybMfLjURtvc3cQxyCRxShYZu4yfGUpCDxOGO2TQW9MD9wTqD0ApPOMz2sbzd+8csxtUXP//Z","aspectRatio":2,"src":"/static/7a740a32b8d434ef1d9ebea4222f0bad/0defe/photo-1536349156324-682aa16f0c26.jpg","srcSet":"/static/7a740a32b8d434ef1d9ebea4222f0bad/38b6a/photo-1536349156324-682aa16f0c26.jpg 150w,\n/static/7a740a32b8d434ef1d9ebea4222f0bad/e201c/photo-1536349156324-682aa16f0c26.jpg 300w,\n/static/7a740a32b8d434ef1d9ebea4222f0bad/0defe/photo-1536349156324-682aa16f0c26.jpg 600w,\n/static/7a740a32b8d434ef1d9ebea4222f0bad/a71f1/photo-1536349156324-682aa16f0c26.jpg 900w,\n/static/7a740a32b8d434ef1d9ebea4222f0bad/8d595/photo-1536349156324-682aa16f0c26.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"46eaa7e0-2f2e-5733-a0e1-682a65796069","html":"<p>Use vagrant-disksize plugin from <a href=\"https://github.com/sprotheroe/vagrant-disksize\">https://github.com/sprotheroe/vagrant-disksize</a></p>\n<h3>Set required disk size</h3>\n<p>Inside <strong>Vagrantfile</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">Vagrant.configure<span class=\"token punctuation\">(</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>config<span class=\"token operator\">|</span>\n  config.vm.box <span class=\"token operator\">=</span> <span class=\"token string\">'ubuntu/xenial64'</span>\n  config.disksize.size <span class=\"token operator\">=</span> <span class=\"token string\">'100GB'</span>\nend</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>Start Vagrant</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">vagrant up</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>or just reload it (if it's already up) with:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">vagrant reload</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>Enter partitioning tool</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">fdisk</span> /dev/sda3</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ol>\n<li>Press <code class=\"language-text\">p</code> to check current partitions setup</li>\n<li>Press <code class=\"language-text\">d</code> to delete last partition</li>\n<li>Press <code class=\"language-text\">n</code> to create new partition</li>\n<li>Press <code class=\"language-text\">t</code> to adjust filesystem to match previous settings</li>\n<li>Press <code class=\"language-text\">p</code> and make sure that new setup looks similar to the base one (from step 1.)</li>\n<li>Press <code class=\"language-text\">w</code> to save settings</li>\n</ol>\n<p>You are suppose to see that message:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">The partition table has been altered.\nCalling ioctl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> to re-read partition table.\nRe-reading the partition table failed.: Device or resource busy\n\nThe kernel still uses the old table. The new table will be used at the next <span class=\"token function\">reboot</span> or after you run partprobe<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> or kpartx<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>Exit Vagrant</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token builtin class-name\">exit</span>\n<span class=\"token builtin class-name\">exit</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Restart Vagrant</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">vagrant reload</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Enter Vagrant</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">vagrant <span class=\"token function\">ssh</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Resize existing partition to span to new available space</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> resize2fs /dev/sda3</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Hopefully it's working now and you have much more free space!</p>\n<h2>Sources</h2>\n<p><a href=\"https://askubuntu.com/a/116367/175659\">https://askubuntu.com/a/116367/175659</a></p>","timeToRead":1,"rawMarkdownBody":"Use vagrant-disksize plugin from https://github.com/sprotheroe/vagrant-disksize\n\n### Set required disk size\nInside **Vagrantfile**\n```bash\nVagrant.configure('2') do |config|\n  config.vm.box = 'ubuntu/xenial64'\n  config.disksize.size = '100GB'\nend\n```\n\n### Start Vagrant\n```bash\nvagrant up\n```\nor just reload it (if it's already up) with:\n```bash\nvagrant reload\n```\n\n### Enter partitioning tool\n```bash\nsudo fdisk /dev/sda3\n```\n\n1. Press `p` to check current partitions setup\n2. Press `d` to delete last partition\n3. Press `n` to create new partition\n4. Press `t` to adjust filesystem to match previous settings\n5. Press `p` and make sure that new setup looks similar to the base one (from step 1.)\n6. Press `w` to save settings\n\nYou are suppose to see that message:\n```bash\nThe partition table has been altered.\nCalling ioctl() to re-read partition table.\nRe-reading the partition table failed.: Device or resource busy\n\nThe kernel still uses the old table. The new table will be used at the next reboot or after you run partprobe(8) or kpartx(8).\n```\n\n### Exit Vagrant\n```bash\nexit\nexit\n```\n\nRestart Vagrant\n```bash\nvagrant reload\n```\n\nEnter Vagrant\n```bash\nvagrant ssh\n```\n\nResize existing partition to span to new available space\n```bash\nsudo resize2fs /dev/sda3\n```\n\nHopefully it's working now and you have much more free space!\n\n\n## Sources\nhttps://askubuntu.com/a/116367/175659\n","excerpt":"Use vagrant-disksize plugin from https://github.com/sprotheroe/vagrant-disksize Set required disk size Inside Vagrantfile Start Vagrant orâ€¦","frontmatter":{"title":"Resizing existing VM partition","slug":"resizing-existing-vm-partition","date":"2018-04-25T03:49:00.000Z","tags":["tools"],"date_created":"2018-04-09T14:07:30.000Z","date_updated":"2018-05-07T01:53:52.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1494412685616-a5d310fbb07d.jpg","relativePath":"posts/img/photo-1494412685616-a5d310fbb07d.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAID/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgAB/9oADAMBAAIQAxAAAAHJcFYrbf/EABkQAAMBAQEAAAAAAAAAAAAAAAABAhESMf/aAAgBAQABBQKm2I8LRzsNYf/EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAwEBPwFkf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAICAwAAAAAAAAAAAAAAAAABAjEQQWH/2gAIAQEABj8Cs7mL2yz/xAAaEAEBAQEBAQEAAAAAAAAAAAABEQAhMUFx/9oACAEBAAE/IQBHThU5qFbP1q88xRfnsyfCpdxFeb//2gAMAwEAAgADAAAAEEAv/8QAFxEBAQEBAAAAAAAAAAAAAAAAEQABMf/aAAgBAwEBPxAdcg7f/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAERIUH/2gAIAQIBAT8QyyWf/8QAHRABAAMAAgMBAAAAAAAAAAAAAQARITGRQVFhwf/aAAgBAQABPxCwBbAa91EsPMYszqNQNuXh2GoaDL6H7AC0EksxrO4yCgHgn//Z","aspectRatio":2,"src":"/static/920f86ec9cc029d341cd88b690ac829a/0defe/photo-1494412685616-a5d310fbb07d.jpg","srcSet":"/static/920f86ec9cc029d341cd88b690ac829a/38b6a/photo-1494412685616-a5d310fbb07d.jpg 150w,\n/static/920f86ec9cc029d341cd88b690ac829a/e201c/photo-1494412685616-a5d310fbb07d.jpg 300w,\n/static/920f86ec9cc029d341cd88b690ac829a/0defe/photo-1494412685616-a5d310fbb07d.jpg 600w,\n/static/920f86ec9cc029d341cd88b690ac829a/a71f1/photo-1494412685616-a5d310fbb07d.jpg 900w,\n/static/920f86ec9cc029d341cd88b690ac829a/8d595/photo-1494412685616-a5d310fbb07d.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"b6ac5d04-c0c6-5cc7-a989-1b2468754b6e","html":"<p>iOS simulator is a handy tool available for every OS X user but you may encounter <strong>This Connection Is Not Private</strong> or other strange bugs when using it along some antivirus software.</p>\n<h2>Problem</h2>\n<p>If you have a problem with running your iOS App/WebApp inside simulator please check if you can establish <strong>any</strong> SSL connection. In my case it wasn't possible to connect to even <a href=\"https://apple.com\">https://apple.com</a>.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 517px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 181.04448742746615%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAACXBIWXMAABYlAAAWJQFJUiTwAAAFsUlEQVRIx6WWzW8TVxDA40pVJUDqB80FKWkPJYGqQggCoalAAqpAUNoLN64kNkkEUeOEpq7UGxck/olI5AJVi+ixBCURxCEhcuI4ieMEYu/aXq+9u17b8dd633TmrRfs5uPQOprM8/Pu783Mm5n3Ghrwc/z48Yb/+2k91moN2tvbuT506NDHJ0+e/K27u/thZ2fn2Pnz58cuX748dunSpTqhuQsXLnD9Y/cPD8+cPnPvk88+/bzKcjQ8ffrUQV8uXrw4/vvjx+Dz+bhcv34d2traoKOjA86dOwffotD47Nmz0HWtC2a9s+Dz++DRH4/gSueVvxDxAQC8s/jIrVu3ZJyAZDJZKpfLxvp6yJicnDJmZmaMGa+X65cvZ4ypqSljeXnZqOBfQpHLBpjMPeTOIeOr2hA037lzJ57J5kCSk2ZMSjBFS7PtQhEiYhQCK6sQ2nwDQjQGuXwB1LQO8YTMIoLIIhERfvF4Msg4Vgv8cmBgIFkqlUHVNFPDF1CjpCEuSSCIIsTicZDlJJ/TUPRMBhRVZQVcdHR0NPtvYHtvby8YhsGy2RzL5bZhezvPhV6ghUqlEhSLJEWu6XupWGIUpt2ArX19fRq9qOsZM5PJAoLfCS1gL5LPkxQgXyiQtoE6Mlpqgd84na48razrOsugOxY0WwXmqsD3lhMUNQe63W6GjI5a4HfkMrpjYnwYQslSDt0PjGMCmsPDw+BwOK7VAk/39PRWaFVN01gaN4WEoPXg+hBQvAnodg9TAl6tBbb19PSY2xgfFXcunU6DJQS1pR5M1uK4CnSThV11LiOQx0RBC5PJFII1LgS2IQStgngYCFipmIAul8jLWuDXrsHb2bR3EeQ//2aLwTWYnpyChYUFePHiJUxPT3P97NkzwGqBV6/mYHJyErxeLwfevfszJXZrLbCp//bteDaWgFRg3Zydn4PnE89hYmICFheXIJGQIR6XuCZJpRQgLzDRmWFUEHh3Rx429/f1JXR0I6EqZiQSgc3NTVhbWwMRq4Tctt2nuOLG2ZvGsOxhZGQXIJaelJAS4F/ym6urq7C05IdgMIjQICwvB2AF69nnW0S9AoFAAGWFLK0CR3axsL9fkmWZXDTJTYoVaYKHQhvg9/sRvMwXIg/IYgJSCe4KJAvD4TDMzc2b8/PzHEAvv369gOBFLtQnaaNsizc336CFZdzlPSyMxWIIsSy0rFmCjY0NehHdX69KEELrQQgs+SAeFRmVK6bNTiA2WInaErptkuvWbqZgaysMb9++5bK1tcXnBEmDoJiGkKgyahZ7AhVFAbTSjMXimCZxkLAX0qaQu360mLSE8yFBgdl1FeY3lP2BlF8WMMaB8WpTpXlaTFVU8gCUpAy6IoOmyLx37gNMQTQaNaPY6glKltpiLUDJneDhkEgkmRoytq89gHhAUSKbIp4jCK5CY3VACoMkJTgYNaO6xuawE+hyuXgeCoJgUnWQELQWbIfBgkq0AG/GewJpVUxaE6EItqC2tbVhsMEovBnvCaRVw+EIr2ULKoBt7W5g1Lx3Dg3tCwybCOXlFYkIsJ+1OGaUu0NDQzuBTqdTiuHDmMCmncQkVI7vF4iAiAtERYGf1aIoME1V4KfdgFR6dPBgazLRjZpjwDrYSet6GhRNh6SqY7fWWUrF57bL2A9HdtwcvhgcHJTyBtDhY2L2MzzZ8FZQoOLHei2yAkrFKLNUpsjeyHlWLOSZpOZMOQ/wq8dDFtbdCRtv3LghUOfAD/0zUSqMMTwJ8xUEW4JjbPkV+q36jEEv3Lx5UyOjOAlvDPw6d+LEiVE6vcbHx2FsbIzrBw8eUHsHj8fDhcb379+ve4bmT506dY8YOHa8u3Di58MDBw58f/jwYVdjY2MvamdTU5OzpaXFefToUS40bm5udtJv1WdcBw8epPP4IwJcvVpzNOON1PFfr8NdXV2OJ0+e8PE/1OAh2njj7wAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen-Shot-2018-04-02-at-21.23.58\"\n        title=\"Screen-Shot-2018-04-02-at-21.23.58\"\n        src=\"/static/d83c5078dc5ce79846306dd81c6f4d34/f1c97/screen-shot-2018-04-02-at-21.23.58.png\"\n        srcset=\"/static/d83c5078dc5ce79846306dd81c6f4d34/a1986/screen-shot-2018-04-02-at-21.23.58.png 210w,\n/static/d83c5078dc5ce79846306dd81c6f4d34/ad7fb/screen-shot-2018-04-02-at-21.23.58.png 420w,\n/static/d83c5078dc5ce79846306dd81c6f4d34/f1c97/screen-shot-2018-04-02-at-21.23.58.png 517w\"\n        sizes=\"(max-width: 517px) 100vw, 517px\"\n      />\n    </span>\nAfter scratching my head a couple of times I finally found a solution which was changing Avast Security settings. Let's start from the beginning.</p>\n<h2>Solution</h2>\n<p>Open your Avast antivirus program and you should see something like this.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/885a7247ecc1d703be3db00c629ea4ab/8212b/screen-shot-2018-04-02-at-21.16.46.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.8343949044586%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC2klEQVQ4y6WSy08TURTGq/+Eio8QkGhLKbSl9sFDYox/AI2BYEiMRtfq1g6RkBAIGBvdauLClQkrY9goMS5IiyEtj3YGMUqhlLb0MWU6zEx7e4/n3pYEookLT/LlzpzJ/HK+811TdP5d39elj0Px2MZgbC3m35Qk/8/NTX98Pe7fEDf8ocWQf+HTgn8lssLfxZjoF+MnNCjFpSH83mpiNTI8tHT3wX24PXQHhkdGIfQtArmCAoqiQlnVQC4pkMsXoYSnUj7k/eOS5QNgtbq6/pQD2yydIWuXC5ovX6m2mm21xc8falp+p1aQD2qlUl2abtQMo4KnXpfWEPZRlTpwTeBAp9sXvubrB4vVRtrdN+nqm3sUll/RrVSObie2aCqVooVCgSqKQnVNo4auU8MwaLVapXr9ucqAkijWgb7+G2F3z3WwdjqJxeaAaDTCLRTlEui6Afv7OTg8PARKKe+XyyoUizKkM1mo1WqsSVhfFMUxDuz29HKgze4i5g4ERpb5j8ndFO4uD3t7aQ5mxaCKUoZCsQjpdAYIIX8CEdSY0E46vLcg+vYhwPJLSGZl2Els4dJlnBADKpdB0zRAi4B2GQyYZZyeAyVJqgNd3t6wB4EuTw9xegcg+mUOQE3AASbMAGxKZhHtcaloX0G4jCthE2Lv5IQOlzfc7e6Frm4PabfZISoluL1MJsP3tZPchVwuD0fFLGdwf7+2En+33GHvDjvdPWDGlK86+mj0/RiF73N0J7VPU7tJms1meZpHwqkprSdEG1VtAOsp260toS6bGZpb2yotFjuJzL8mUFglql4heE2IqqoE7yBhhbvjwnAJgkhjusoJoMPliXr7BphlsKBl8cc2t8aSNCpV3F8JQyDwr0LgOAeebbo4eu78pfEzTRcCKOHJ40dC8MVzYXJyUpienhYmJiaEqakpYXZ2VpiZmeHncWEvEAwGnwUCAZ/pWJ3+T51iEBzU9BsSIwz0bSP92wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen-Shot-2018-04-02-at-21.16.46\"\n        title=\"Screen-Shot-2018-04-02-at-21.16.46\"\n        src=\"/static/885a7247ecc1d703be3db00c629ea4ab/a3419/screen-shot-2018-04-02-at-21.16.46.png\"\n        srcset=\"/static/885a7247ecc1d703be3db00c629ea4ab/a1986/screen-shot-2018-04-02-at-21.16.46.png 210w,\n/static/885a7247ecc1d703be3db00c629ea4ab/ad7fb/screen-shot-2018-04-02-at-21.16.46.png 420w,\n/static/885a7247ecc1d703be3db00c629ea4ab/a3419/screen-shot-2018-04-02-at-21.16.46.png 840w,\n/static/885a7247ecc1d703be3db00c629ea4ab/4d498/screen-shot-2018-04-02-at-21.16.46.png 1260w,\n/static/885a7247ecc1d703be3db00c629ea4ab/70b58/screen-shot-2018-04-02-at-21.16.46.png 1680w,\n/static/885a7247ecc1d703be3db00c629ea4ab/8212b/screen-shot-2018-04-02-at-21.16.46.png 1884w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nUnder <strong>Tools</strong> tab you will find this popup.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ad88527c685af594786836aad308cdb8/73b7f/screen-shot-2018-04-02-at-21.16.50.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.03871829105475%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAADBElEQVQ4y6WUWU8TURTHW0xjIATEsIRFttKWAoW2lH1x/Bi++Ak0JD5oQBMTZZOYSBM/g8b44Prio7KGFxFrkZZNmulqoaV0pjN3Zo5nrl3RN0/yzzlz585v/ueeaTUaDEjGawCUXgDoQVkTsbh1Y33D+vXLpnVtedX64e1767vXb6zLn5bo9drySjrTumd9ZdWOuUWTids3rk8/nJyAqakp/uatCfL8xUsSDITI/v4hCfiDZNe7Rzw7XsKyARLA9Xz5/cHUyUkc9vYOPiKqiAJr66qdBn0DGPRXpAsXS+DO5H2IRo/Bvb0DfEqElChBSiDAYc3xQlb0niDK2BUc+dhlRJVQoKmzZ9E+MAI9jiGxvkmvTM/OK7hHSZydKYlEQhEEURHFQhFCFI7jlXDkmIiSDCzLLmWBRrPF2YvA/qExUofAR7PzEIvHIRQKUSmKyv87BEGAPfemdBY/gUjkVw7Y2W13DowyMDAyToEz8wvZByRJAlmWKfS8JHTGJWKSujcUCuc57LA4bX1DYHMMkvqsw1Pw+/1qK4At0hfkw9Tg+RTsuF1SPBaDcDhSCHQMjcHg6FXSYjArs2mHqrvzoHypzvl45I/DcJ7DtvZOp61/GOz9w6Sx1aRMzz3GCaaARYd+dJjCmoLTZ5dxyPE8bLvd0sl5h6bObucgnuHw2DViMFuyDnGS1EUm1DqntNNklDoM5p9hq8Hs7Oi2A4rUNDRThyLCAoEAnbKao9FogbtkkoPtHzvw7fu2FDs9U/flgHpjx2KX1QEoobaxVZ6ZW1BtyRzHyTgQGactY9tyfuD5ZtYJdRgMfs4BTR3PLPZ+sNj6AD8bWHjyNOsimUwCgv/5HeJPDw5/HtEaO1jLAptajQ8M7V2neJZH1XWN7N3JeziPAOvxeFiv18vu7u6yPp+vQAcHB6zL5WK3trZ8eD+K9asMUIvRpNUWjWNm8IrR6XTMpfJypqysjCnHrKq4uLhApaWlTGVlJVNVVcVcrqhQ18zI0mma20wUmv6n+B9pjUaj5jc3JCkC28IqsQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen-Shot-2018-04-02-at-21.16.50\"\n        title=\"Screen-Shot-2018-04-02-at-21.16.50\"\n        src=\"/static/ad88527c685af594786836aad308cdb8/a3419/screen-shot-2018-04-02-at-21.16.50.png\"\n        srcset=\"/static/ad88527c685af594786836aad308cdb8/a1986/screen-shot-2018-04-02-at-21.16.50.png 210w,\n/static/ad88527c685af594786836aad308cdb8/ad7fb/screen-shot-2018-04-02-at-21.16.50.png 420w,\n/static/ad88527c685af594786836aad308cdb8/a3419/screen-shot-2018-04-02-at-21.16.50.png 840w,\n/static/ad88527c685af594786836aad308cdb8/4d498/screen-shot-2018-04-02-at-21.16.50.png 1260w,\n/static/ad88527c685af594786836aad308cdb8/73b7f/screen-shot-2018-04-02-at-21.16.50.png 1498w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nThen you may try to click on <strong>Disable</strong> button next to <strong>Web Shield</strong> option and check if this resolves the issue.\nIf so reenable the <strong>Web Shield</strong> and proceed to the less <strong>radical</strong> solution :)</p>\n<p>Click on the <strong>Settings</strong> link under the <strong>Disable</strong> button and you should see the following configuration.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f3413edb2bdcd4b820b9d8b9ad0dfd58/73b7f/screen-shot-2018-04-02-at-21.17.04.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.03871829105475%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAADKElEQVQ4y6WUW08TQRTHWw0BNPpohSrFlhYpFJZyR9T6MXzxE2hMNDGBF6NpQMQYm/gVNCYmGp/UF40URI0X6gO0LG3FdttuSy+7Qrvt7MzxdFIsXqIPnuSfMzPZ+e257RoMaLCtmADYAAD0oYQtRRXeLb0VAh+Xhc+fAsLzp8+EJ48eCwvzfmFp4TVqseb5uu/N4ms3+mOGHbt07qz3+uRFmJqaKp2/cJHcu/+ApJIyiUSiJBKOktXVIFkLiUSKJ0gymSKJRAq9vCOtkFcgHI4+R9QeDmxpPeSz246A3XZU39u0Hy5fmYR8QQFxPQIrq0FIZzaBMgCtTKBc0bmKpTLXVrFEMSv4GpMWELWPAzu7++64R05A38BoxWyxseveGaYoKpMSCZZKyWxzc5Ol0xmG0TFJqp6lWKmksUqlwsplfAsanvt/AB1dLt8AAofHJojZ0sGueachEv0Cy8vLEAwGIR6Pw8bGBqiqCpTqoOs67DK+yWQydWB3r9s3MuGBkROnSDVC78wsZLM5CIVCsL6+zqErKysgyzIoigK5XI57SikwxjgwnU7vitDp8vUPjUH/4ChpbbOymdlb/NWq+g00TeMRVS9jioApclUqPNM6UP4FODh2EkYnThOrw8m80zfwARkCgQCIogj5fB4jzkIBfb6m6j6H0rTy7xF2HO/29Q+Pg3t4nLRZHWz6xhxeKkA4EsXOVrtZgmKxVPe1dQEnQVFVDsTm+Xd1udc3ijUcP3mG2LtcPOXt7SLEpQRs42WKM6Pr9CdVz+R0Bmv5jQOTyWQdaLV3+Zy9bkARk7kdI7wJKha92oxYLMZr9ifD8anWtxZhqg60OZx3eoRBQJVb2qwUgRS7SNdEkcbjEsVmUB27gndrolwpWaZabQ4ROF8HdjrvutzD4OofglaLDWbnbvMIKkSHf1m51m0pkVz6AbRYHVftx3vUTmfvV5O5TcJPDwc/Ka0GQ1JoTfyzQqK0Joal9x8+xl68fJWd9y883AEa0SxG455T6D248zQ0NHiam5s9TU3N3P9NTagDBw56Ghsbu5DVYGjv6OTQ2p/if2Q0mQ4bvgPl9CC9rby2TwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen-Shot-2018-04-02-at-21.17.04\"\n        title=\"Screen-Shot-2018-04-02-at-21.17.04\"\n        src=\"/static/f3413edb2bdcd4b820b9d8b9ad0dfd58/a3419/screen-shot-2018-04-02-at-21.17.04.png\"\n        srcset=\"/static/f3413edb2bdcd4b820b9d8b9ad0dfd58/a1986/screen-shot-2018-04-02-at-21.17.04.png 210w,\n/static/f3413edb2bdcd4b820b9d8b9ad0dfd58/ad7fb/screen-shot-2018-04-02-at-21.17.04.png 420w,\n/static/f3413edb2bdcd4b820b9d8b9ad0dfd58/a3419/screen-shot-2018-04-02-at-21.17.04.png 840w,\n/static/f3413edb2bdcd4b820b9d8b9ad0dfd58/4d498/screen-shot-2018-04-02-at-21.17.04.png 1260w,\n/static/f3413edb2bdcd4b820b9d8b9ad0dfd58/73b7f/screen-shot-2018-04-02-at-21.17.04.png 1498w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span>\nThe preffered solution would be adding <strong>Excluded servers</strong> with plus sign on the bottom of the excluded servers list. In the popup type in desired server address e.g. <strong>apple.com</strong> and select <strong>https</strong> in <strong>Service</strong> selection.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/41c3bc76cc37483de6dd5864e53f0a7b/73b7f/screen-shot-2018-04-02-at-21.17.08.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.03871829105475%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAADNklEQVQ4y6WU208TQRTGqQQSSFAEyqW0tFSgBSRs9N3wJxhjYjThpuGB+IYJr77gLUGlRKEg9A4UC1taEmi5gwrKA5EXEogILax0aWvQkEgZusfTkTsPmjjZX87OpPP1O/NNNioKBwCkIVeRYoRZ96wxk2OTzNT4FDMxOsGwNpaxWW3M6PAoXR8bGWM+fphhvKtexrviKV5b9V5BsqMORlVVVV1tbS08qKn5VV19n7jdQyQYCBLfho/4N/1k5esKWf6yTHgfT+eBQIB4Vj1kfGwiws709AwMDrjcKHWOCp5PiNeIkxNAnHJhD9egXaeHv41gMAidXVbo6OoK2x1OaGl98x6l4qmgVJ7dkKMqBGWOejclNUMwWzqE7e1tYWvrhxDa3RV2dkKUUOhPJYQIPM8LdrtdYFk7cblcYDQa3x0KZkrlmpy8fMhTFZBkcbpgMJrA7w8Ax20Av+kHH+8Hnj+qgeB3WFtfh/5+Jzgcjr3h4WGwWCxHglkKpUaVfxny1IUkKSVN6H5rg53QLni962daRYfAffOh8CY4HY5DQbPZfMyhTK7BdrFlFXVY9+gxLC4uwqfZWVhYWKDvi0tLsIRE5p/n52Fubg4d9lPBoaGhs4K5qgJAlyRdIhNu3b4DuvZ2eF5fD42NjaDX60Gn09FqMBgi50VrZ0cH9Pb27o2MnHIoyczSXMpVA0LEaRKhvOIuWK1WaGtrBzx46GVZ3Mge1X26MGWrtXsPrxmYTKYjQalMoVEVFIG6oIhIpHKhrKISbLYe0BuMtGJb0Nd3Clwzmy1U0OV2n0w5PUOqkSkugUyuJInJqUJpeQV12NzcRFtl0VkkUafzJOgKxftoKCcc4rk1yLNzAAlhyuHSsoowCoa12pawXm8I410L48YzmEzmMLZO9lueOhTMkMheKZR5oFDmAqYM5ZX3IPIj1t6HTvrBiWnSegoHgn8GA4MuDMk4cyiYmi55KJFm/cyUKbyJSWLu+o2bHJ4f97qpmWvWtiDa/XocLadtaeVevGxYw2sWfPL0Wc+BoAgfuUgkuoaU4LwkOjq6JDY29p+Ji4sriYmJyce9MRF3+6L0S/E/iBITL0b9Bvxgt0rdkHmnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen-Shot-2018-04-02-at-21.17.08\"\n        title=\"Screen-Shot-2018-04-02-at-21.17.08\"\n        src=\"/static/41c3bc76cc37483de6dd5864e53f0a7b/a3419/screen-shot-2018-04-02-at-21.17.08.png\"\n        srcset=\"/static/41c3bc76cc37483de6dd5864e53f0a7b/a1986/screen-shot-2018-04-02-at-21.17.08.png 210w,\n/static/41c3bc76cc37483de6dd5864e53f0a7b/ad7fb/screen-shot-2018-04-02-at-21.17.08.png 420w,\n/static/41c3bc76cc37483de6dd5864e53f0a7b/a3419/screen-shot-2018-04-02-at-21.17.08.png 840w,\n/static/41c3bc76cc37483de6dd5864e53f0a7b/4d498/screen-shot-2018-04-02-at-21.17.08.png 1260w,\n/static/41c3bc76cc37483de6dd5864e53f0a7b/73b7f/screen-shot-2018-04-02-at-21.17.08.png 1498w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>If you don't know the address or need more universal solution you may uncheck <strong>Scan secured connections</strong> checkbox but I think that this is less desirable solution.</p>\n<p>This solution probably may be applied to other antiviruses which are scanning your SSL secured connections. Fell free to comment if you come across similar problem.</p>\n<h2>Sources</h2>\n<p>Official Apple forum - <a href=\"https://forums.developer.apple.com/thread/90510\">https://forums.developer.apple.com/thread/90510</a></p>","timeToRead":2,"rawMarkdownBody":"iOS simulator is a handy tool available for every OS X user but you may encounter **This Connection Is Not Private** or other strange bugs when using it along some antivirus software.\n\n## Problem\n\nIf you have a problem with running your iOS App/WebApp inside simulator please check if you can establish **any** SSL connection. In my case it wasn't possible to connect to even https://apple.com.\n![Screen-Shot-2018-04-02-at-21.23.58](img/screen-shot-2018-04-02-at-21.23.58.png)\nAfter scratching my head a couple of times I finally found a solution which was changing Avast Security settings. Let's start from the beginning.\n\n## Solution\n\nOpen your Avast antivirus program and you should see something like this.\n![Screen-Shot-2018-04-02-at-21.16.46](img/screen-shot-2018-04-02-at-21.16.46.png)\nUnder **Tools** tab you will find this popup.\n![Screen-Shot-2018-04-02-at-21.16.50](img/screen-shot-2018-04-02-at-21.16.50.png)\nThen you may try to click on **Disable** button next to **Web Shield** option and check if this resolves the issue.\nIf so reenable the **Web Shield** and proceed to the less **radical** solution :)\n\nClick on the **Settings** link under the **Disable** button and you should see the following configuration.\n![Screen-Shot-2018-04-02-at-21.17.04](img/screen-shot-2018-04-02-at-21.17.04.png)\nThe preffered solution would be adding **Excluded servers** with plus sign on the bottom of the excluded servers list. In the popup type in desired server address e.g. **apple.com** and select **https** in **Service** selection.\n![Screen-Shot-2018-04-02-at-21.17.08](img/screen-shot-2018-04-02-at-21.17.08.png)\n\nIf you don't know the address or need more universal solution you may uncheck **Scan secured connections** checkbox but I think that this is less desirable solution.\n\nThis solution probably may be applied to other antiviruses which are scanning your SSL secured connections. Fell free to comment if you come across similar problem.\n\n## Sources\n\nOfficial Apple forum - https://forums.developer.apple.com/thread/90510\n\n","excerpt":"iOS simulator is a handy tool available for every OS X user but you may encounter This Connection Is Not Private or other strange bugs whenâ€¦","frontmatter":{"title":"iOS simulator SSL certificates problems","slug":"ios-simulator","date":"2018-04-02T14:35:00.000Z","tags":["tools"],"date_created":"2018-04-08T01:11:57.000Z","date_updated":"2018-04-02T23:37:15.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1517503733723-8ea1cf616798.jpg","relativePath":"posts/img/photo-1517503733723-8ea1cf616798.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIEAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB5L4slhCL/8QAGxAAAgIDAQAAAAAAAAAAAAAAAQIAAxESEyH/2gAIAQEAAQUCKMi1uVsvXo+xwPYWM//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABwQAAICAgMAAAAAAAAAAAAAAAABITEQERJhcf/aAAgBAQAGPwLlU6E2J9Ez6Usf/8QAGxABAQEBAAMBAAAAAAAAAAAAAREAITFhcYH/2gAIAQEAAT8hpD9GNwfcjk6DI66rEgbFzcLH8dT53//aAAwDAQACAAMAAAAQ5M//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAwADAQAAAAAAAAAAAAABABEhMUHRof/aAAgBAQABPxA/zkVoa2ah6q8jOSoAQxvri5AsUhjZu2oulHr0hq/C+z//2Q==","aspectRatio":2,"src":"/static/a55c5ce6dabe33fe80cec6dc4c71a4e3/0defe/photo-1517503733723-8ea1cf616798.jpg","srcSet":"/static/a55c5ce6dabe33fe80cec6dc4c71a4e3/38b6a/photo-1517503733723-8ea1cf616798.jpg 150w,\n/static/a55c5ce6dabe33fe80cec6dc4c71a4e3/e201c/photo-1517503733723-8ea1cf616798.jpg 300w,\n/static/a55c5ce6dabe33fe80cec6dc4c71a4e3/0defe/photo-1517503733723-8ea1cf616798.jpg 600w,\n/static/a55c5ce6dabe33fe80cec6dc4c71a4e3/a71f1/photo-1517503733723-8ea1cf616798.jpg 900w,\n/static/a55c5ce6dabe33fe80cec6dc4c71a4e3/8d595/photo-1517503733723-8ea1cf616798.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"8ce80307-c370-5281-8c79-d3cf15de632a","html":"<p>How to setup MongoDB Docker container to use Let's Encrypt SSL certificate with autorenewal support?\nThat's something which should be much easier to do than it is now.</p>\n<p><a href=\"https://docs.docker.com/engine/api/v1.36/#operation/SystemEvents\">https://docs.docker.com/engine/api/v1.36/#operation/SystemEvents</a>\nExample:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">curl -G -v --unix-socket /var/run/docker.sock http:/events --data-urlencode &#39;filters={&quot;container&quot;:[&quot;nginx-mongo&quot;]}&#39;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Filter <strong>nginx-mongo</strong> container restarts:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">curl -G -v --unix-socket /var/run/docker.sock http:/events --data-urlencode &#39;filters={&quot;container&quot;:[&quot;nginx-mongo&quot;],&quot;event&quot;:[&quot;restart&quot;]}&#39;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>This should work (but doesn't):</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">while read l; do echo &quot;OK&quot;; done &lt; &lt;(curl -GET -s --unix-socket /var/run/docker.sock http:/events --data-urlencode &#39;filters={&quot;container&quot;:[&quot;nginx-mongo&quot;],&quot;event&quot;:[&quot;restart&quot;]}&#39;)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Such command may trigger <strong>mongodb.pem</strong> key+cert file generation by:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">awk 1 /etc/nginx/certs/srp.predictail.com.key /etc/nginx/certs/srp.predictail.com.crt &gt; /mongo-ssl/mongodb.pem</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>Sources:</h3>\n<p><a href=\"https://stackoverflow.com/questions/878600/how-to-create-a-cron-job-using-bash-automatically-without-the-interactive-editor\">https://stackoverflow.com/questions/878600/how-to-create-a-cron-job-using-bash-automatically-without-the-interactive-editor</a>\n<a href=\"https://askubuntu.com/questions/640055/concatenate-two-files-and-separate-them-with-a-newline\">https://askubuntu.com/questions/640055/concatenate-two-files-and-separate-them-with-a-newline</a>\n<a href=\"https://docs.mongodb.com/manual/tutorial/configure-ssl/\">https://docs.mongodb.com/manual/tutorial/configure-ssl/</a>\n<a href=\"https://medium.com/lucjuggery/about-var-run-docker-sock-3bfd276e12fd\">https://medium.com/lucjuggery/about-var-run-docker-sock-3bfd276e12fd</a></p>","timeToRead":1,"rawMarkdownBody":"How to setup MongoDB Docker container to use Let's Encrypt SSL certificate with autorenewal support?\nThat's something which should be much easier to do than it is now.\n\n\nhttps://docs.docker.com/engine/api/v1.36/#operation/SystemEvents\nExample:\n```sh\ncurl -G -v --unix-socket /var/run/docker.sock http:/events --data-urlencode 'filters={\"container\":[\"nginx-mongo\"]}'\n```\n\nFilter **nginx-mongo** container restarts:\n\n```sh\ncurl -G -v --unix-socket /var/run/docker.sock http:/events --data-urlencode 'filters={\"container\":[\"nginx-mongo\"],\"event\":[\"restart\"]}'\n```\n\nThis should work (but doesn't):\n\n```sh\nwhile read l; do echo \"OK\"; done < <(curl -GET -s --unix-socket /var/run/docker.sock http:/events --data-urlencode 'filters={\"container\":[\"nginx-mongo\"],\"event\":[\"restart\"]}')\n```\n\nSuch command may trigger **mongodb.pem** key+cert file generation by:\n```sh\nawk 1 /etc/nginx/certs/srp.predictail.com.key /etc/nginx/certs/srp.predictail.com.crt > /mongo-ssl/mongodb.pem\n```\n\n### Sources:\n\nhttps://stackoverflow.com/questions/878600/how-to-create-a-cron-job-using-bash-automatically-without-the-interactive-editor\nhttps://askubuntu.com/questions/640055/concatenate-two-files-and-separate-them-with-a-newline\nhttps://docs.mongodb.com/manual/tutorial/configure-ssl/\nhttps://medium.com/lucjuggery/about-var-run-docker-sock-3bfd276e12fd\n","excerpt":"How to setup MongoDB Docker container to use Let's Encrypt SSL certificate with autorenewal support?\nThat's something which should be muchâ€¦","frontmatter":{"title":"MongoDB + Letsencrypt + Docker","slug":"mongodb-letsencrypt-docker","date":"2017-12-03T18:19:00.000Z","tags":[],"date_created":"2018-02-18T02:01:20.000Z","date_updated":"2019-03-03T16:20:05.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/docker-containers.jpg","relativePath":"posts/img/docker-containers.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABy6TZyghP/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERECH/2gAIAQEAAQUCqRTgsZ//xAAWEQEBAQAAAAAAAAAAAAAAAAAAEQH/2gAIAQMBAT8BmI//xAAXEQADAQAAAAAAAAAAAAAAAAAAARES/9oACAECAQE/AdMrP//EABYQAAMAAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwIi/wD/xAAbEAACAgMBAAAAAAAAAAAAAAAAAREhMVFhgf/aAAgBAQABPyHEaIq4x0blrwSitEE8H//aAAwDAQACAAMAAAAQBO//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8Qiy//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/EAv/xAAbEAEAAgIDAAAAAAAAAAAAAAABABEhUTFBcf/aAAgBAQABPxAcoa1MYI+4Vki0qAhQfSNjjiKjSf/Z","aspectRatio":2,"src":"/static/519a97714c74ce11183212fe7806cb18/0defe/docker-containers.jpg","srcSet":"/static/519a97714c74ce11183212fe7806cb18/38b6a/docker-containers.jpg 150w,\n/static/519a97714c74ce11183212fe7806cb18/e201c/docker-containers.jpg 300w,\n/static/519a97714c74ce11183212fe7806cb18/0defe/docker-containers.jpg 600w,\n/static/519a97714c74ce11183212fe7806cb18/a71f1/docker-containers.jpg 900w,\n/static/519a97714c74ce11183212fe7806cb18/9f6c3/docker-containers.jpg 1200w,\n/static/519a97714c74ce11183212fe7806cb18/e95fb/docker-containers.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"df69f421-43f1-5ed6-a1c2-32ebe170cbc7","html":"<p>It seems extremely easy to do if you know all required Docker containers, but it's not so obvious if you are not a fluent Docker user.</p>\n<h2>Update!</h2>\n<p>Despite the fact that LE will automatically regenerate certificate files there is no way (which I'm aware of) to trigger Influx container restart in order to use regenerated certificate files. The only workaround is setting <code class=\"language-text\">REUSE_PRIVATE_KEYS=true</code> environment variable for <strong>letsencrypt</strong> container. See updated post for more details.</p>\n<p>Here is what it takes to create SSL secured <strong>Grafana + InfluxDB</strong> Docker setup:</p>\n<ul>\n<li>Grafana (<a href=\"https://hub.docker.com/r/grafana/grafana/\">https://hub.docker.com/r/grafana/grafana/</a>)</li>\n<li>InfluxDB (<a href=\"https://hub.docker.com/_/influxdb/\">https://hub.docker.com/_/influxdb/</a>)</li>\n<li>Nginx-proxy (<a href=\"https://hub.docker.com/r/jwilder/nginx-proxy/\">https://hub.docker.com/r/jwilder/nginx-proxy/</a>)</li>\n<li>Let's Encrypt Nginx-proxy companion (<a href=\"https://hub.docker.com/r/jrcs/letsencrypt-nginx-proxy-companion/\">https://hub.docker.com/r/jrcs/letsencrypt-nginx-proxy-companion/</a>)</li>\n</ul>\n<p>The additional benefit of this setup is certificate autogeneration and auto-renewal (no more worries/downtime related to expired Let's Encrypt certificate.</p>\n<p>Required tools:</p>\n<ul>\n<li>docker (<a href=\"https://www.docker.com/\">https://www.docker.com/</a>)</li>\n<li>docker-compose (<a href=\"https://docs.docker.com/compose/install/\">https://docs.docker.com/compose/install/</a> eases multi-container setup and removal operations)</li>\n</ul>\n<h2>Spoiler</h2>\n<p>Create <strong>docker-compose.yml</strong> file with the content similar to the example below and execute <strong>docker-compose up -d</strong> command in the directory where your <strong>yml</strong> file is saved.\nHere is the example content of <strong>docker-compose.yml</strong> with some comments related to the required modifications/adjustments (don't worry about the file length, feel free to skip this section and continue reading starting from Architecture description):</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'2'</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">grafana</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> grafana/grafana<span class=\"token punctuation\">:</span>5.0.0 <span class=\"token comment\"># or probably any other version</span>\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> grafana\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> VIRTUAL_HOST=YOUR.DOMAIN.TEST <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> VIRTUAL_PROTO=https\n      <span class=\"token punctuation\">-</span> VIRTUAL_PORT=3000\n      <span class=\"token punctuation\">-</span> LETSENCRYPT_HOST=YOUR.DOMAIN.TEST <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> LETSENCRYPT_EMAIL=YOUR.EMAIL@ADDRESS.TEST <span class=\"token comment\"># adjust to match your email</span>\n\n      <span class=\"token punctuation\">-</span> GF_SERVER_CERT_FILE=/etc/letsencrypt/certs/YOUR.DOMAIN.TEST.crt <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> GF_SERVER_CERT_KEY=/etc/letsencrypt/certs/YOUR.DOMAIN.TEST.key <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> GF_SERVER_PROTOCOL=https\n\n      <span class=\"token punctuation\">-</span> GF_SERVER_DOMAIN=YOUR.DOMAIN.TEST <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> GF_SECURITY_ADMIN_USER=SECURE_USERNAME <span class=\"token comment\"># adjust to create Grafana admin account</span>\n      <span class=\"token punctuation\">-</span> GF_SECURITY_ADMIN_PASSWORD=SECURE_PASS <span class=\"token comment\"># adjust to set Grafana admin password</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./letsencrypt/certs<span class=\"token punctuation\">:</span>/etc/letsencrypt/certs<span class=\"token punctuation\">:</span>ro\n\n      <span class=\"token punctuation\">-</span> grafana<span class=\"token punctuation\">-</span>data<span class=\"token punctuation\">:</span>/var/lib/grafana\n\n  <span class=\"token key atrule\">influx</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> influxdb<span class=\"token punctuation\">:</span>1.4.2 <span class=\"token comment\"># or any other recent version</span>\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> influx\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> influx<span class=\"token punctuation\">-</span>data<span class=\"token punctuation\">:</span>/var/lib/influxdb\n\n      <span class=\"token punctuation\">-</span> ./letsencrypt/certs<span class=\"token punctuation\">:</span>/etc/letsencrypt/certs<span class=\"token punctuation\">:</span>ro\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"8086:8086\"</span>\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># might be used someday when issue #59 will be resolved/merged</span>\n      <span class=\"token comment\">#- VIRTUAL_HOST=YOUR.DOMAIN.TEST:8086</span>\n      <span class=\"token comment\">#- VIRTUAL_PROTO=https</span>\n      <span class=\"token comment\">#- VIRTUAL_PORT=8086</span>\n\n      <span class=\"token punctuation\">-</span> INFLUXDB_HTTP_HTTPS_ENABLED=true\n      <span class=\"token punctuation\">-</span> INFLUXDB_HTTP_HTTPS_CERTIFICATE=/etc/letsencrypt/certs/YOUR.DOMAIN.TEST.crt <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> INFLUXDB_HTTP_HTTPS_PRIVATE_KEY=/etc/letsencrypt/certs/YOUR.DOMAIN.TEST.key <span class=\"token comment\"># adjust to match your domain name</span>\n\n      <span class=\"token punctuation\">-</span> INFLUXDB_DB=SOME_DB_NAME <span class=\"token comment\"># set any other to create database on initialization</span>\n      <span class=\"token punctuation\">-</span> INFLUXDB_HTTP_ENABLED=true\n      <span class=\"token punctuation\">-</span> INFLUXDB_HTTP_AUTH_ENABLED=true\n\n      <span class=\"token punctuation\">-</span> INFLUXDB_ADMIN_USER=SECURE_USERNAME <span class=\"token comment\"># adjust to create InfluxDB admin account</span>\n      <span class=\"token punctuation\">-</span> INFLUXDB_ADMIN_PASSWORD=SECURE_PASS <span class=\"token comment\"># adjust to create InfluxDB admin password</span>\n\n  <span class=\"token comment\"># Containers below ensures automatic cert creation and renewal</span>\n  <span class=\"token key atrule\">nginx</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> jwilder/nginx<span class=\"token punctuation\">-</span>proxy<span class=\"token punctuation\">:</span>0.6.0\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> nginx\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> com.github.jrcs.letsencrypt_nginx_proxy_companion.nginx_proxy\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"80:80\"</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"443:443\"</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/tmp/docker.sock<span class=\"token punctuation\">:</span>ro\n      <span class=\"token punctuation\">-</span> ./nginx/html<span class=\"token punctuation\">:</span>/usr/share/nginx/html\n      <span class=\"token punctuation\">-</span> ./nginx/vhost.d<span class=\"token punctuation\">:</span>/etc/nginx/vhost.d\n      <span class=\"token punctuation\">-</span> ./letsencrypt/certs<span class=\"token punctuation\">:</span>/etc/nginx/certs<span class=\"token punctuation\">:</span>ro\n  <span class=\"token key atrule\">letsencrypt</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> jrcs/letsencrypt<span class=\"token punctuation\">-</span>nginx<span class=\"token punctuation\">-</span>proxy<span class=\"token punctuation\">-</span>companion<span class=\"token punctuation\">:</span>v1.7\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> letsencrypt\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n    <span class=\"token key atrule\">volumes_from</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> nginx\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./letsencrypt/certs<span class=\"token punctuation\">:</span>/etc/nginx/certs<span class=\"token punctuation\">:</span>rw\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock<span class=\"token punctuation\">:</span>ro\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> REUSE_PRIVATE_KEYS=true\n\n<span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">influx-data</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> local\n  <span class=\"token key atrule\">grafana-data</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> local</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>That's all. Just replace:</p>\n<ul>\n<li><strong>YOUR.DOMAIN.TEST</strong>  - appropriate domain name</li>\n<li><strong>YOUR.EMAIL@ADDRESS.TEST</strong> - your email address</li>\n<li><strong>SECURE_USERNAME</strong> - some username</li>\n<li><strong>SECURE_PASS</strong> - secure password for the user</li>\n</ul>\n<p>After executing <strong>docker-compose up -d</strong> you SSLed <strong>Grafana + Influx</strong> stack should be available over <strong><a href=\"https://YOUR.DOMAIN.TEST\">https://YOUR.DOMAIN.TEST</a></strong> and <strong><a href=\"https://YOUR.DOMAIN.TEST:8086\">https://YOUR.DOMAIN.TEST:8086</a></strong>. It may take a couple of minutes on the first run because of Let's Encrypt certificate generation.</p>\n<p>As an \"extra\" benefit the Nginx ensures <a href=\"https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security\">HSTS headers</a> for SSLed service, which basically means that all requests have to be done using an encrypted connection (the browser will force <code class=\"language-text\">https://</code> at the beginning of the address).</p>\n<h2>Architecture</h2>\n<p>As we know by default Docker creates it's own subnetwork for running containers and communication between them. Here is how it looks in the above example.</p>\n<p><img src=\"/d3743181cb54fc46ca696349736269b3/influx-grafna-ssl-2.svg\" alt=\"Influx-Grafana-Let&#x27;s Encrypt SSL\"></p>\n<p><strong>NOTE 1: Influx URL</strong>.\nInside Grafana data sources panel you will have to define your Influx URL using a fully qualified domain name (<a href=\"https://en.wikipedia.org/wiki/Fully_qualified_domain_name\">FQDN</a> e.g. <a href=\"https://YOUR.DOMAIN.TEST:8086\">https://YOUR.DOMAIN.TEST:8086</a>) and not internal Docker subnetwork alias e.g. influx. This is due to the fact that SSL certificate will work with Influx only if it is accessed through the URL for which certificate was requested.</p>\n<p><strong>NOTE 2: Grafana port</strong>. In this setup Grafana still uses its default 3000 port, the redirection from 80 and 443 ports is handled by the Nginx proxy server.</p>\n<p><strong>NOTE 3: Influx without proxy</strong>. As you may notice InfluxDB connections doesn't go through Nginx. That fact is caused by the Nginx env variables configuration limitation. It doesn't allow to specify port-based routing (only subdomain routing is available). For more details please refer to the <a href=\"https://github.com/jwilder/nginx-proxy/issues/59\">Github issue #59</a></p>\n<h2>Detailed description</h2>\n<p>Here is some more information about setup presented above. Some of them may be evident especially for (more or less) experienced Docker users. I think that they are worth at least skimming through.</p>\n<h3>container_name</h3>\n<p>The container name option, once specified, let's you refer to the deployed container using a custom name instead of SHA code. It is useful especially for checking container status with <code class=\"language-text\">docker logs [container_name]</code> or executing custom commands with <code class=\"language-text\">docker exec -it [container_name]</code>.</p>\n<h3>restart: always</h3>\n<p>Just to ensure continuous work even after Docker/host restart. Be careful with <strong>restart: unless-stopped</strong> as this option lacks the container autostart feature.</p>\n<h3>labels</h3>\n<p>They are used (in this setup) just to mark which container is the Nginx proxy in order to trigger its reloading on certificate update. It's a handy feature implemented by <strong>letsencrypt-nginx-proxy-companion</strong>.</p>\n<h3>/var/run/docker.sock:/var/run/docker.sock:ro</h3>\n<p>That's a tricky one. The <strong>docker.sock</strong> allows the container to work with <a href=\"https://docs.docker.com/engine/api/v1.36/\">Docker Engine API</a>. It is used by the <strong>jwilder/nginx-proxy</strong> to do its <strong>VIRTUAL_...</strong> env variables magic. The docker API works similar to any JSON based HTTP API, but it is exposed on <strong>docker.sock</strong> socket.</p>\n<h3>:ro and :rw suffixes</h3>\n<p>I think it's an obvious one but to cover \"everything\" I can say that those are folder/file permissions: \"<strong>R</strong>ead <strong>O</strong>nly\" and \"<strong>R</strong>ead and <strong>W</strong>rite\".</p>\n<h3>volumes</h3>\n<p>There are 3 kinds of \"paths\" used in this setup:</p>\n<ul>\n<li>absolute paths like <strong>/var/run/docker.sock:...</strong> which points to the host system internal files</li>\n<li>relative paths e.g. <strong>*./letsencrypt/certs:...</strong> which are a handy way of storing/sharing container files with the host system</li>\n<li>volumes dirs <strong>influx-data:...</strong> these are used for ensuring data persistence ensured by the Docker</li>\n</ul>\n<h3>cert files</h3>\n<p>Don't worry that the cert file paths are invalid on the first run when there are no certificate files. As soon as Let's Encrypt certificate request will be fulfilled you will find appropriate certificates in the specified localizations.</p>\n<h3>REUSE<em>PRIVATE</em>KEYS</h3>\n<p>This option passed to the letsencrypt container via environment variables allows you to reuse same keys after 90 days expiry time. That's the only way to avoid manual restart of the <strong>influx</strong> container after certificates renewal (because of certificate file changes).</p>\n<h2>Footnotes</h2>\n<p>That's all for now. I'd be happy to answer some questions. I hope to be able to explain everything about this or similar setup.\nFor testing SSL configuration you may use <a href=\"https://www.ssllabs.com/ssltest\">https://www.ssllabs.com/ssltest</a> (thanks to @Kjetil MjÃ¸s who remid me about this tool in one of his comments). The expected overall grade is <strong>A+</strong>.</p>\n<h2>Question: How to add another Grafana instance on separate (sub)domain?</h2>\n<p>It should be fairly easy, just point your new (sub)domain at your existing Docker host and add following \"section\" to the <strong>docker-compose.yml</strong> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token comment\">#... existing docker-compose.yml content omitted for brevity</span>\n  <span class=\"token key atrule\">grafana2</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># just for clarification: this is a service name</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> grafana/grafana<span class=\"token punctuation\">:</span>5.0.0 <span class=\"token comment\"># or probably any other version</span>\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> grafana2\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> VIRTUAL_HOST=ANOTHER.DOMAIN.TEST <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> VIRTUAL_PROTO=https\n      <span class=\"token punctuation\">-</span> VIRTUAL_PORT=3000\n      <span class=\"token punctuation\">-</span> LETSENCRYPT_HOST=ANOTHER.DOMAIN.TEST <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> LETSENCRYPT_EMAIL=YOUR.EMAIL@ADDRESS.TEST <span class=\"token comment\"># adjust to match your email</span>\n\n      <span class=\"token punctuation\">-</span> GF_SERVER_CERT_FILE=/etc/letsencrypt/certs/ANOTHER.DOMAIN.TEST.crt <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> GF_SERVER_CERT_KEY=/etc/letsencrypt/certs/ANOTHER.DOMAIN.TEST.key <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> GF_SERVER_PROTOCOL=https\n\n      <span class=\"token punctuation\">-</span> GF_SERVER_DOMAIN=ANOTHER.DOMAIN.TEST <span class=\"token comment\"># adjust to match your domain name</span>\n      <span class=\"token punctuation\">-</span> GF_SECURITY_ADMIN_USER=SECURE_USERNAME <span class=\"token comment\"># adjust to create Grafana admin account</span>\n      <span class=\"token punctuation\">-</span> GF_SECURITY_ADMIN_PASSWORD=SECURE_PASS <span class=\"token comment\"># adjust to set Grafana admin password</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./letsencrypt/certs<span class=\"token punctuation\">:</span>/etc/letsencrypt/certs<span class=\"token punctuation\">:</span>ro\n\n      <span class=\"token punctuation\">-</span> grafana2<span class=\"token punctuation\">-</span>data<span class=\"token punctuation\">:</span>/var/lib/grafana</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Notable changes compared to direct \"copy/paste\" of existing <strong>grafana</strong> service:</p>\n<ul>\n<li>please remember to change service name and <strong>container_name</strong> to make them different from existing ones (<strong>grafana2</strong> in this example)</li>\n<li>every <strong>YOUR.DOMAIN.TEST</strong> is replaced with <strong>ANOTHER.DOMAIN.TEST</strong> (it might be <strong>any</strong> domain name which is pointed at your host, not necessarly a subdomain with common root domain e.g. <strong>MYDOMAIN.TEST</strong> will work as well)</li>\n<li>as you may noticed <strong>LETSENCRYPT_EMAIL</strong> doesn't require any changes as you may use one email for multiple domains</li>\n<li>in <strong>volumes</strong> section please remember to change <strong>grafana-data</strong> to any other volume (<strong>grafana2-data</strong> in my example), in other case your Grafana instances will share files (you probably don't want that)</li>\n</ul>\n<p>You should also add volume mapping for a new Grafana instance at the end of <strong>docker-compose.yml</strong> (which was modified before) in <strong>volumes</strong> section append:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token comment\">#... existing docker-compose.yml content omitted for brevity</span>\n<span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\">#... existing volumes omitted for brevity</span>\n  <span class=\"token key atrule\">grafana2-data</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> local</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>That's it.\nNow execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">docker-compose up -d\ndocker-compose restart</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Docker should now run two independent Grafana instances on different (sub)domains.</p>","timeToRead":8,"rawMarkdownBody":"It seems extremely easy to do if you know all required Docker containers, but it's not so obvious if you are not a fluent Docker user.\n\n## Update!\nDespite the fact that LE will automatically regenerate certificate files there is no way (which I'm aware of) to trigger Influx container restart in order to use regenerated certificate files. The only workaround is setting `REUSE_PRIVATE_KEYS=true` environment variable for **letsencrypt** container. See updated post for more details.\n\nHere is what it takes to create SSL secured **Grafana + InfluxDB** Docker setup:\n\n- Grafana (https://hub.docker.com/r/grafana/grafana/)\n- InfluxDB (https://hub.docker.com/_/influxdb/)\n- Nginx-proxy (https://hub.docker.com/r/jwilder/nginx-proxy/)\n- Let's Encrypt Nginx-proxy companion (https://hub.docker.com/r/jrcs/letsencrypt-nginx-proxy-companion/)\n\nThe additional benefit of this setup is certificate autogeneration and auto-renewal (no more worries/downtime related to expired Let's Encrypt certificate.\n\nRequired tools:\n\n- docker (https://www.docker.com/)\n- docker-compose (https://docs.docker.com/compose/install/ eases multi-container setup and removal operations)\n\n## Spoiler\nCreate **docker-compose.yml** file with the content similar to the example below and execute **docker-compose up -d** command in the directory where your **yml** file is saved.\nHere is the example content of **docker-compose.yml** with some comments related to the required modifications/adjustments (don't worry about the file length, feel free to skip this section and continue reading starting from Architecture description):\n\n```yaml\nversion: '2'\n\nservices:\n  grafana:\n    image: grafana/grafana:5.0.0 # or probably any other version\n    container_name: grafana\n    restart: always\n    environment:\n      - VIRTUAL_HOST=YOUR.DOMAIN.TEST # adjust to match your domain name\n      - VIRTUAL_PROTO=https\n      - VIRTUAL_PORT=3000\n      - LETSENCRYPT_HOST=YOUR.DOMAIN.TEST # adjust to match your domain name\n      - LETSENCRYPT_EMAIL=YOUR.EMAIL@ADDRESS.TEST # adjust to match your email\n\n      - GF_SERVER_CERT_FILE=/etc/letsencrypt/certs/YOUR.DOMAIN.TEST.crt # adjust to match your domain name\n      - GF_SERVER_CERT_KEY=/etc/letsencrypt/certs/YOUR.DOMAIN.TEST.key # adjust to match your domain name\n      - GF_SERVER_PROTOCOL=https\n\n      - GF_SERVER_DOMAIN=YOUR.DOMAIN.TEST # adjust to match your domain name\n      - GF_SECURITY_ADMIN_USER=SECURE_USERNAME # adjust to create Grafana admin account\n      - GF_SECURITY_ADMIN_PASSWORD=SECURE_PASS # adjust to set Grafana admin password\n    volumes:\n      - ./letsencrypt/certs:/etc/letsencrypt/certs:ro\n\n      - grafana-data:/var/lib/grafana\n\n  influx:\n    image: influxdb:1.4.2 # or any other recent version\n    container_name: influx\n    restart: always\n    volumes:\n      - influx-data:/var/lib/influxdb\n\n      - ./letsencrypt/certs:/etc/letsencrypt/certs:ro\n    ports:\n      - \"8086:8086\"\n    environment:\n      # might be used someday when issue #59 will be resolved/merged\n      #- VIRTUAL_HOST=YOUR.DOMAIN.TEST:8086\n      #- VIRTUAL_PROTO=https\n      #- VIRTUAL_PORT=8086\n\n      - INFLUXDB_HTTP_HTTPS_ENABLED=true\n      - INFLUXDB_HTTP_HTTPS_CERTIFICATE=/etc/letsencrypt/certs/YOUR.DOMAIN.TEST.crt # adjust to match your domain name\n      - INFLUXDB_HTTP_HTTPS_PRIVATE_KEY=/etc/letsencrypt/certs/YOUR.DOMAIN.TEST.key # adjust to match your domain name\n\n      - INFLUXDB_DB=SOME_DB_NAME # set any other to create database on initialization\n      - INFLUXDB_HTTP_ENABLED=true\n      - INFLUXDB_HTTP_AUTH_ENABLED=true\n\n      - INFLUXDB_ADMIN_USER=SECURE_USERNAME # adjust to create InfluxDB admin account\n      - INFLUXDB_ADMIN_PASSWORD=SECURE_PASS # adjust to create InfluxDB admin password\n\n  # Containers below ensures automatic cert creation and renewal\n  nginx:\n    image: jwilder/nginx-proxy:0.6.0\n    container_name: nginx\n    restart: always\n    labels:\n      - com.github.jrcs.letsencrypt_nginx_proxy_companion.nginx_proxy\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n    volumes:\n      - /var/run/docker.sock:/tmp/docker.sock:ro\n      - ./nginx/html:/usr/share/nginx/html\n      - ./nginx/vhost.d:/etc/nginx/vhost.d\n      - ./letsencrypt/certs:/etc/nginx/certs:ro\n  letsencrypt:\n    image: jrcs/letsencrypt-nginx-proxy-companion:v1.7\n    container_name: letsencrypt\n    restart: always\n    volumes_from:\n      - nginx\n    volumes:\n      - ./letsencrypt/certs:/etc/nginx/certs:rw\n      - /var/run/docker.sock:/var/run/docker.sock:ro\n    environment:\n      - REUSE_PRIVATE_KEYS=true\n\nvolumes:\n  influx-data:\n    driver: local\n  grafana-data:\n    driver: local\n```\n\nThat's all. Just replace:\n\n- **YOUR.DOMAIN.TEST**  - appropriate domain name\n- **YOUR.EMAIL@ADDRESS.TEST** - your email address\n- **SECURE_USERNAME** - some username\n- **SECURE_PASS** - secure password for the user\n\nAfter executing **docker-compose up -d** you SSLed **Grafana + Influx** stack should be available over **https://YOUR.DOMAIN.TEST** and **https://YOUR.DOMAIN.TEST:8086**. It may take a couple of minutes on the first run because of Let's Encrypt certificate generation.\n\nAs an \"extra\" benefit the Nginx ensures [HSTS headers](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security) for SSLed service, which basically means that all requests have to be done using an encrypted connection (the browser will force `https://` at the beginning of the address).\n\n## Architecture\n\nAs we know by default Docker creates it's own subnetwork for running containers and communication between them. Here is how it looks in the above example.\n\n![Influx-Grafana-Let's Encrypt SSL](img/influx-grafna-ssl-2.svg)\n\n**NOTE 1: Influx URL**.\nInside Grafana data sources panel you will have to define your Influx URL using a fully qualified domain name ([FQDN](https://en.wikipedia.org/wiki/Fully_qualified_domain_name) e.g. https://YOUR.DOMAIN.TEST:8086) and not internal Docker subnetwork alias e.g. influx. This is due to the fact that SSL certificate will work with Influx only if it is accessed through the URL for which certificate was requested.\n\n**NOTE 2: Grafana port**. In this setup Grafana still uses its default 3000 port, the redirection from 80 and 443 ports is handled by the Nginx proxy server.\n\n**NOTE 3: Influx without proxy**. As you may notice InfluxDB connections doesn't go through Nginx. That fact is caused by the Nginx env variables configuration limitation. It doesn't allow to specify port-based routing (only subdomain routing is available). For more details please refer to the [Github issue #59](https://github.com/jwilder/nginx-proxy/issues/59)\n\n## Detailed description\n\nHere is some more information about setup presented above. Some of them may be evident especially for (more or less) experienced Docker users. I think that they are worth at least skimming through.\n\n### container_name\n\nThe container name option, once specified, let's you refer to the deployed container using a custom name instead of SHA code. It is useful especially for checking container status with `docker logs [container_name]` or executing custom commands with `docker exec -it [container_name]`.\n\n### restart: always\n\nJust to ensure continuous work even after Docker/host restart. Be careful with **restart: unless-stopped** as this option lacks the container autostart feature.\n\n### labels\n\nThey are used (in this setup) just to mark which container is the Nginx proxy in order to trigger its reloading on certificate update. It's a handy feature implemented by **letsencrypt-nginx-proxy-companion**.\n\n### /var/run/docker.sock:/var/run/docker.sock:ro\n\nThat's a tricky one. The **docker.sock** allows the container to work with [Docker Engine API](https://docs.docker.com/engine/api/v1.36/). It is used by the **jwilder/nginx-proxy** to do its **VIRTUAL_...** env variables magic. The docker API works similar to any JSON based HTTP API, but it is exposed on **docker.sock** socket.\n\n### :ro and :rw suffixes\n\nI think it's an obvious one but to cover \"everything\" I can say that those are folder/file permissions: \"**R**ead **O**nly\" and \"**R**ead and **W**rite\".\n\n### volumes\n\nThere are 3 kinds of \"paths\" used in this setup:\n\n- absolute paths like **/var/run/docker.sock:...** which points to the host system internal files\n- relative paths e.g. ***./letsencrypt/certs:...** which are a handy way of storing/sharing container files with the host system\n- volumes dirs **influx-data:...** these are used for ensuring data persistence ensured by the Docker\n\n### cert files\n\nDon't worry that the cert file paths are invalid on the first run when there are no certificate files. As soon as Let's Encrypt certificate request will be fulfilled you will find appropriate certificates in the specified localizations.\n\n### REUSE_PRIVATE_KEYS\n\nThis option passed to the letsencrypt container via environment variables allows you to reuse same keys after 90 days expiry time. That's the only way to avoid manual restart of the **influx** container after certificates renewal (because of certificate file changes).\n\n## Footnotes\n\nThat's all for now. I'd be happy to answer some questions. I hope to be able to explain everything about this or similar setup.\nFor testing SSL configuration you may use https://www.ssllabs.com/ssltest (thanks to @Kjetil MjÃ¸s who remid me about this tool in one of his comments). The expected overall grade is **A+**.\n\n## Question: How to add another Grafana instance on separate (sub)domain?\n\nIt should be fairly easy, just point your new (sub)domain at your existing Docker host and add following \"section\" to the **docker-compose.yml** file:\n\n```yaml\n#... existing docker-compose.yml content omitted for brevity\n  grafana2: # just for clarification: this is a service name\n    image: grafana/grafana:5.0.0 # or probably any other version\n    container_name: grafana2\n    restart: always\n    environment:\n      - VIRTUAL_HOST=ANOTHER.DOMAIN.TEST # adjust to match your domain name\n      - VIRTUAL_PROTO=https\n      - VIRTUAL_PORT=3000\n      - LETSENCRYPT_HOST=ANOTHER.DOMAIN.TEST # adjust to match your domain name\n      - LETSENCRYPT_EMAIL=YOUR.EMAIL@ADDRESS.TEST # adjust to match your email\n\n      - GF_SERVER_CERT_FILE=/etc/letsencrypt/certs/ANOTHER.DOMAIN.TEST.crt # adjust to match your domain name\n      - GF_SERVER_CERT_KEY=/etc/letsencrypt/certs/ANOTHER.DOMAIN.TEST.key # adjust to match your domain name\n      - GF_SERVER_PROTOCOL=https\n\n      - GF_SERVER_DOMAIN=ANOTHER.DOMAIN.TEST # adjust to match your domain name\n      - GF_SECURITY_ADMIN_USER=SECURE_USERNAME # adjust to create Grafana admin account\n      - GF_SECURITY_ADMIN_PASSWORD=SECURE_PASS # adjust to set Grafana admin password\n    volumes:\n      - ./letsencrypt/certs:/etc/letsencrypt/certs:ro\n\n      - grafana2-data:/var/lib/grafana\n```\nNotable changes compared to direct \"copy/paste\" of existing **grafana** service:\n- please remember to change service name and **container_name** to make them different from existing ones (**grafana2** in this example)\n- every **YOUR.DOMAIN.TEST** is replaced with **ANOTHER.DOMAIN.TEST** (it might be **any** domain name which is pointed at your host, not necessarly a subdomain with common root domain e.g. **MYDOMAIN.TEST** will work as well)\n- as you may noticed **LETSENCRYPT_EMAIL** doesn't require any changes as you may use one email for multiple domains\n- in **volumes** section please remember to change **grafana-data** to any other volume (**grafana2-data** in my example), in other case your Grafana instances will share files (you probably don't want that)\n\nYou should also add volume mapping for a new Grafana instance at the end of **docker-compose.yml** (which was modified before) in **volumes** section append:\n```yaml\n#... existing docker-compose.yml content omitted for brevity\nvolumes:\n  #... existing volumes omitted for brevity\n  grafana2-data:\n    driver: local\n```\n\nThat's it.\nNow execute:\n```bash\ndocker-compose up -d\ndocker-compose restart\n```\nDocker should now run two independent Grafana instances on different (sub)domains.\n","excerpt":"It seems extremely easy to do if you know all required Docker containers, but it's not so obvious if you are not a fluent Docker userâ€¦","frontmatter":{"title":"Grafana and InfluxDB with Let's Encrypt SSL on Docker","slug":"grafana-with-lets-encrypt-ssl-on-docker","date":"2018-03-12T07:59:41.000Z","tags":["docker","backend"],"date_created":"2018-02-05T22:37:16.000Z","date_updated":"2018-09-15T12:47:40.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/grafanadashboard-1.png","relativePath":"posts/img/grafanadashboard-1.png","childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABRUlEQVQoz6WRS1LDMBBEfQkSWMSyZ/S3/AkJJkBx/2M1I8lOCrYsXo0002q55UZ1jFNLUJ1GJ/R9pevrPveJLYgMWsVlZtjAG1vWSnpMGl4bUEdoxuDxOniM3hVhPpjNrLYI1mIKDtfkcRHNOXqsY8DnHPG1RNymKLO6/z4PSM5kw4BFhLMYT2I6OCdGTi6Q3tbPl+VZ1k1lvxHqPuW5VEOMhrVDjr1D8vk5glJU4mSsjTA2SGQqmv0pHnBJdTp1aHLE/d36IiZZG7BL0AKxgxYz5vpmRLboCv0DklmrejHkKsjGbAewibDpCje/w03CfIOVatIFdnyT9QoTz/UyHbYfVsmpGhMXMbjI4RV++ShUs/UXXoxLX9h1d/1Ue2STGPpU4pF8GZlQKpf1o+Y+/6k7976ka+U9m8PxBU+H48bzP6jnfwBqdwGmpFoLZgAAAABJRU5ErkJggg==","aspectRatio":2,"src":"/static/0bb15c5c60bd1f1b45cf89f238d3ca40/d1858/grafanadashboard-1.png","srcSet":"/static/0bb15c5c60bd1f1b45cf89f238d3ca40/eed6b/grafanadashboard-1.png 150w,\n/static/0bb15c5c60bd1f1b45cf89f238d3ca40/44052/grafanadashboard-1.png 300w,\n/static/0bb15c5c60bd1f1b45cf89f238d3ca40/d1858/grafanadashboard-1.png 600w,\n/static/0bb15c5c60bd1f1b45cf89f238d3ca40/6b4f3/grafanadashboard-1.png 900w,\n/static/0bb15c5c60bd1f1b45cf89f238d3ca40/f5d99/grafanadashboard-1.png 1200w,\n/static/0bb15c5c60bd1f1b45cf89f238d3ca40/3419a/grafanadashboard-1.png 1840w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"9cb1ab70-4846-5ed0-acbd-fbdee9fa3f7f","html":"<p>That was the case in my recent project where a client wants to use his current hosting provider for email but generally, it was advisable to change hosting due to performance reasons.</p>\n<p>The solution is easy if you have done it at least once :)\nIt's enough to change domain <strong>A</strong> record to point the target hosting provider sever IP.</p>\n<p>Example:\nLet's say I own <strong>grzegorowski.com</strong> and my hosting provider is <strong>myprovider.test</strong> with server IP <strong>10.10.0.1</strong>, so my DNS record looks similar to:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Record Type: A\nRecord Name: grzegorowski.com\nTarget: 10.10.0.1</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>If I want to change only hosting provider to <strong>otherprovider.test</strong> with server IP <strong>10.10.5.5</strong> without changing email configuration, I will have to modify my DNS <strong>A</strong> record to:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Record Type: A\nRecord Name: grzegorowski.com\nTarget: 10.10.5.5</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Of course, in order to serve a website from <strong>otherprovider.test</strong> server I will have to prepare SOA zone in his admin panel for the delegated <strong>grzegorowski.com</strong> domain (similarly to the regular full DNS delegation).</p>\n<p>The SOA zone is generaly created by adding your target domain to the server admin panel.</p>","timeToRead":1,"rawMarkdownBody":"That was the case in my recent project where a client wants to use his current hosting provider for email but generally, it was advisable to change hosting due to performance reasons.\n\nThe solution is easy if you have done it at least once :)\nIt's enough to change domain **A** record to point the target hosting provider sever IP.\n\nExample:\nLet's say I own **grzegorowski.com** and my hosting provider is **myprovider.test** with server IP **10.10.0.1**, so my DNS record looks similar to:\n\n```\nRecord Type: A\nRecord Name: grzegorowski.com\nTarget: 10.10.0.1\n```\n\nIf I want to change only hosting provider to **otherprovider.test** with server IP **10.10.5.5** without changing email configuration, I will have to modify my DNS **A** record to:\n\n```\nRecord Type: A\nRecord Name: grzegorowski.com\nTarget: 10.10.5.5\n```\n\nOf course, in order to serve a website from **otherprovider.test** server I will have to prepare SOA zone in his admin panel for the delegated **grzegorowski.com** domain (similarly to the regular full DNS delegation).\n\nThe SOA zone is generaly created by adding your target domain to the server admin panel.\n","excerpt":"That was the case in my recent project where a client wants to use his current hosting provider for email but generally, it was advisable toâ€¦","frontmatter":{"title":"DNS configuration to delegate only website to other hosting","slug":"dns-configuration-to-delegate-only-website-to-other-hosting","date":"2018-03-11T03:01:41.000Z","tags":["hostings"],"date_created":"2018-01-24T10:14:58.000Z","date_updated":"2018-03-11T03:01:41.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/deploy.jpg","relativePath":"posts/img/deploy.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgMF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAebdRiIMyv/EABoQAAICAwAAAAAAAAAAAAAAAAABAhEhMUH/2gAIAQEAAQUCWRooide//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAARAg/9oACAEBAAY/AoC//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAExEWH/2gAIAQEAAT8hdBtOsKNdyx//2gAMAwEAAgADAAAAEK8v/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAEDAQE/EAsL/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EFy1v//EABkQAQEBAQEBAAAAAAAAAAAAAAERACFhMf/aAAgBAQABPxCOQF8wzi3LFEH1zY64k1J8uSst3//Z","aspectRatio":2,"src":"/static/d79ef96498eaf1d8c8d08209e980d3f7/0defe/deploy.jpg","srcSet":"/static/d79ef96498eaf1d8c8d08209e980d3f7/38b6a/deploy.jpg 150w,\n/static/d79ef96498eaf1d8c8d08209e980d3f7/e201c/deploy.jpg 300w,\n/static/d79ef96498eaf1d8c8d08209e980d3f7/0defe/deploy.jpg 600w,\n/static/d79ef96498eaf1d8c8d08209e980d3f7/a71f1/deploy.jpg 900w,\n/static/d79ef96498eaf1d8c8d08209e980d3f7/9f6c3/deploy.jpg 1200w,\n/static/d79ef96498eaf1d8c8d08209e980d3f7/e95fb/deploy.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"cdc50a13-0c53-5b8e-914f-ef15450e8d1e","html":"<p>How easy is adding Google Analytics support to Grafana Docker container?</p>\n<p>It's trivial.</p>\n<p>Just add an environment variable to the Grafana container:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">GF_ANALYTICS_GOOGLE_ANALYTICS_UA_ID=[YOUR_UA_ID]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where:</p>\n<ul>\n<li><code class=\"language-text\">YOUR_UA_ID</code> is your Google Analytics UA ID code e.g. UA-123123123-1</li>\n</ul>\n<p>Of course, it will require container restart.</p>\n<p><strong>NOTICE</strong></p>\n<p>If you are using Ad Block plugin (like I do) you will have to disable it for your domain in order to test Google Analytics.</p>","timeToRead":1,"rawMarkdownBody":"How easy is adding Google Analytics support to Grafana Docker container?\n\nIt's trivial.\n\nJust add an environment variable to the Grafana container:\n\n```sh\nGF_ANALYTICS_GOOGLE_ANALYTICS_UA_ID=[YOUR_UA_ID]\n```\n\nWhere:\n- `YOUR_UA_ID` is your Google Analytics UA ID code e.g. UA-123123123-1\n\nOf course, it will require container restart.\n\n**NOTICE**\n\nIf you are using Ad Block plugin (like I do) you will have to disable it for your domain in order to test Google Analytics.\n","excerpt":"How easy is adding Google Analytics support to Grafana Docker container? It's trivial. Just add an environment variable to the Grafanaâ€¦","frontmatter":{"title":"Grafana Docker container and Google Analytics","slug":"docker-grafana-google-analytics","date":"2017-12-20T12:44:47.000Z","tags":["docker","backend"],"date_created":"2017-12-20T12:39:48.000Z","date_updated":"2017-12-29T23:30:35.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/docker-containers.jpg","relativePath":"posts/img/docker-containers.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABy6TZyghP/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERECH/2gAIAQEAAQUCqRTgsZ//xAAWEQEBAQAAAAAAAAAAAAAAAAAAEQH/2gAIAQMBAT8BmI//xAAXEQADAQAAAAAAAAAAAAAAAAAAARES/9oACAECAQE/AdMrP//EABYQAAMAAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwIi/wD/xAAbEAACAgMBAAAAAAAAAAAAAAAAAREhMVFhgf/aAAgBAQABPyHEaIq4x0blrwSitEE8H//aAAwDAQACAAMAAAAQBO//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8Qiy//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/EAv/xAAbEAEAAgIDAAAAAAAAAAAAAAABABEhUTFBcf/aAAgBAQABPxAcoa1MYI+4Vki0qAhQfSNjjiKjSf/Z","aspectRatio":2,"src":"/static/519a97714c74ce11183212fe7806cb18/0defe/docker-containers.jpg","srcSet":"/static/519a97714c74ce11183212fe7806cb18/38b6a/docker-containers.jpg 150w,\n/static/519a97714c74ce11183212fe7806cb18/e201c/docker-containers.jpg 300w,\n/static/519a97714c74ce11183212fe7806cb18/0defe/docker-containers.jpg 600w,\n/static/519a97714c74ce11183212fe7806cb18/a71f1/docker-containers.jpg 900w,\n/static/519a97714c74ce11183212fe7806cb18/9f6c3/docker-containers.jpg 1200w,\n/static/519a97714c74ce11183212fe7806cb18/e95fb/docker-containers.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"764ab43a-f898-538e-a6eb-38a6e2797b46","html":"<p>Recently I came across an issue of \"live\" synchronization of my local files with a remote host. It was necessary to upload project files as they are modified.</p>\n<p>Normally it would require thousands of <code class=\"language-text\">rsync ...</code> executions but thanks to <strong>entr</strong> everything was fully automatic.</p>\n<p><strong>entr</strong> is an Open Source project which helps to detect file changes and automates script rerunning. Example:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">ag -l | entr ./sync.sh</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where:</p>\n<ul>\n<li><code class=\"language-text\">ag -l</code> lists all the files found by <a href=\"https://github.com/ggreer/the_silver_searcher\">the Silver Searcher</a> but it might be any other files listing command like <code class=\"language-text\">ls *</code></li>\n<li><code class=\"language-text\">sync.sh</code> is a custom bash script for file syncing, in my case it was <code class=\"language-text\">rsync</code> based one-liner like <code class=\"language-text\">rsync -avzh * my_vm:my_dir --exclude .git</code></li>\n</ul>\n<h2>Installation</h2>\n<p>Fortunately <strong>entr</strong> is <strong>available on Homebrew</strong>, so installation (for MacOS) is extremely easy:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">brew install entr</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>Sources</h2>\n<p><a href=\"http://entrproject.org/\">http://entrproject.org/</a> - official <strong>entr</strong> website with much more examples and documentation</p>","timeToRead":1,"rawMarkdownBody":"Recently I came across an issue of \"live\" synchronization of my local files with a remote host. It was necessary to upload project files as they are modified.\n\nNormally it would require thousands of `rsync ...` executions but thanks to **entr** everything was fully automatic.\n\n**entr** is an Open Source project which helps to detect file changes and automates script rerunning. Example:\n\n```sh\nag -l | entr ./sync.sh\n```\n\nWhere:\n\n- `ag -l` lists all the files found by [the Silver Searcher](https://github.com/ggreer/the_silver_searcher) but it might be any other files listing command like `ls *`\n- `sync.sh` is a custom bash script for file syncing, in my case it was `rsync` based one-liner like `rsync -avzh * my_vm:my_dir --exclude .git`\n\n## Installation\n\nFortunately **entr** is **available on Homebrew**, so installation (for MacOS) is extremely easy:\n\n```sh\nbrew install entr\n```\n\n## Sources\nhttp://entrproject.org/ - official **entr** website with much more examples and documentation\n","excerpt":"Recently I came across an issue of \"live\" synchronization of my local files with a remote host. It was necessary to upload project files asâ€¦","frontmatter":{"title":"Track file changes and automate script execution","slug":"execute-command-script-on-file-change","date":"2018-03-12T00:05:53.000Z","tags":["tools"],"date_created":"2017-12-14T19:34:12.000Z","date_updated":"2018-03-18T21:37:33.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/dockerized-influxdb-restore.png","relativePath":"posts/img/dockerized-influxdb-restore.png","childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABX0lEQVQoz1WReWvCQBDFc+yRY3NoDhM1Uaq1EbVQJZYipUKR0u//gV5n11rsH4+ZDbu/vHlj5dkQ81mD7mmJbrVE20wwm7Vomil2uw0Ohz0GgyE4E1BRDM8P4LocLuOmcuGDS5LwwLkHK00TVFWJdfeIj9Mrjvsdzqce/f4Z5/c3fF/O+Lp8Yrvd0CMJxoWB6V56AQTpBnTpp1YYhCjzDJN6hOm4QjMeoR7lWK8W2HZLPLQ1+sMLjsceQahIEVScIFAxpK/+gBrmkGNr3jZgLoNru3Bsh2xzcx6mEcosRUZ1MW9oigohAbOiRJQO4BNY+iHEHcw4VEoRgJuMBI3DqOqxpJSIVEjgBEkcmTF1hoMsQxhTloH650xXfbZsh1HjGQntjl0D15ds5yrHpUf0rSwK1HVlYDq/G4hxec2RGBb7JRuRMx2upE2G5FxL0KXrIgTyvEBOUN3fxPR27xbzA7KLpDXSJofxAAAAAElFTkSuQmCC","aspectRatio":2,"src":"/static/7fa76383651ee47dc9f9bae462d16217/d1858/dockerized-influxdb-restore.png","srcSet":"/static/7fa76383651ee47dc9f9bae462d16217/eed6b/dockerized-influxdb-restore.png 150w,\n/static/7fa76383651ee47dc9f9bae462d16217/44052/dockerized-influxdb-restore.png 300w,\n/static/7fa76383651ee47dc9f9bae462d16217/d1858/dockerized-influxdb-restore.png 600w,\n/static/7fa76383651ee47dc9f9bae462d16217/6b4f3/dockerized-influxdb-restore.png 900w,\n/static/7fa76383651ee47dc9f9bae462d16217/f5d99/dockerized-influxdb-restore.png 1200w,\n/static/7fa76383651ee47dc9f9bae462d16217/05be9/dockerized-influxdb-restore.png 1277w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"a265682a-ecf7-5730-93cf-fc46d042312f","html":"<p>Running InfluxDB inside Docker container is extremely easy with the official image available on Docker Hub <a href=\"https://hub.docker.com/_/influxdb/\">https://hub.docker.com/_/influxdb/</a>. Things get a little more complicated when it comes to creating and restoring Dockerized database.</p>\n<p>This was tested with <strong>InfluxDB 1.3</strong> and Docker <strong>17.11</strong> on Ubuntu <strong>16.04</strong>, of course it should work regardless of you OS or Docker version.</p>\n<h2>Creating InfluxDB backup from a running Docker container</h2>\n<p>This is a simple scenario in which we have a running Docker container with InfluxDB inside. Our task is to perform a backup of a selected database.</p>\n<h3>Get container ID</h3>\n<p>First of all you should get an ID from a running InfluxDB container. You may check it with a <code class=\"language-text\">docker ps</code> command (CONTAINER ID is the first column):</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">CONTAINER ID        IMAGE          COMMAND             CREATED             STATUS            PORTS                              NAMES\ne94f5db005a2        influx1.3      &quot;/entrypoint.sh&quot;    3 hours ago         Up About an hour    8083/tcp, 0.0.0.0:8086-&gt;8086/tcp   influx_1</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h3>Create a backup</h3>\n<p>It's easy, just execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">docker exec -it e94f5 influxd backup -database mydb_to_backup dirname</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where:</p>\n<ul>\n<li><strong>e94f5</strong> - is your InfluxDb container ID</li>\n<li><strong>mydb<em>to</em>backup</strong> - is a name of database you want to backup</li>\n<li><strong>dirname</strong> - is the name of internal container folder where DB backup will be placed (just make sure it's an empty directory, it will be used in the next command)</li>\n</ul>\n<p>Then copy backup files to local directory with:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">docker cp e94f5:dirname local_backup</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Here:</p>\n<ul>\n<li><strong>e94f5</strong> - is your container ID</li>\n<li><strong>dirname</strong> - is you container directory with backup files</li>\n<li><strong>local_backup</strong> - is your folder path on the local machine</li>\n</ul>\n<p>After executing this two commands you should have all backup files inside <strong>local_backup</strong> folder. Now it's time to restore this backup to the other InfluxDB container (which may be placed on the other host e.g. some VM on Azure or AWS).</p>\n<h2>Restore backup on Dockerized InfluxDB</h2>\n<p>Let's get to the restoring process which is a little more complicated than the backup. I assume that you already know how to get the ID of the target container with another InfluxDB. The overall recipe for the restoring is to create a temporary container which won't use Influx as an entrypoint (detailed process is described below).</p>\n<p>First of all, you have to stop the container with InfluxDB. This is important to ensure correct database restoration process (it might be possible in future to restore database on a running container but it's not possible now):</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">docker stop e94f5</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Of course, you should replace <code class=\"language-text\">e94f5</code> with your <strong>CONTAINER_ID</strong> first few characters.</p>\n<p>Now it's time for magic. You have to create new Influx container which will not run Influx as a root process. Here is the command to do this:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">docker run --rm \\\n --entrypoint /bin/bash \\\n -v influx_data_dir:/var/lib/influxdb \\\n -v local_backup:/backups \\\n influxdb:1.3 \\\n -c &quot;influxd restore -metadir /var/lib/influxdb/meta -datadir /var/lib/influxdb/data -database [DB_NAME] /backups/[BACKUP_DIR_NAME]&quot;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Where:</p>\n<ul>\n<li><strong>influx_data_dir</strong> - is the directory which is used by your stopped Influx container to store DB info</li>\n<li><strong>local_backup</strong> - is the directory with DB backup</li>\n<li><strong>db_name</strong> - is name of the restored DB</li>\n<li><strong>backup_dir_name</strong> - is name of database backup folder inside <strong>local_backup</strong> directory</li>\n</ul>\n<p>Wait a few moments (or longer), some restoring messages should be visible in the output.\nThen your database is restored you may start you stopped Influx container:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">docker start e94f5</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Everything should be fine. Your database should be available, which you may check via Influx CLI.</p>\n<h2>Notes</h2>\n<p>Some caveats encountered during the work with Docker backup/restore process.</p>\n<h3>Usage with Docker Volumes</h3>\n<p>In case of using Docker Volumes make sure that volume name specified for <strong>/var/lib/influxdb</strong> is correct. The easiest way to discover Volume name used by a running container is executing:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">docker inspect e94f5 | grep volumes</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where:</p>\n<ul>\n<li><strong>e94f5</strong> - is your primary/running Influx container ID</li>\n</ul>\n<p>Here is the example output:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token string\">\"Source\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/var/lib/docker/volumes/my_influx-data/_data\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Which means that your data volume name is <strong>my_influx-data</strong>.</p>\n<h2>Sources</h2>\n<p>Places where I've found informations which help me write this tutorial:</p>\n<ul>\n<li><a href=\"https://docs.influxdata.com/influxdb/v1.3/administration/backup_and_restore/\">Official docs</a></li>\n<li><a href=\"https://community.influxdata.com/t/backup-and-restore-influxdb-inside-docker/1636\">Community forum</a></li>\n<li><a href=\"https://github.com/influxdata/influxdb/issues/8551\">Github issue</a></li>\n<li><a href=\"https://gist.github.com/mark-rushakoff/36b4491f97b8781198da36752ecd949b\">Gist</a> - many thanks for that</li>\n</ul>","timeToRead":4,"rawMarkdownBody":"Running InfluxDB inside Docker container is extremely easy with the official image available on Docker Hub https://hub.docker.com/_/influxdb/. Things get a little more complicated when it comes to creating and restoring Dockerized database.\n\nThis was tested with **InfluxDB 1.3** and Docker **17.11** on Ubuntu **16.04**, of course it should work regardless of you OS or Docker version.\n\n## Creating InfluxDB backup from a running Docker container\nThis is a simple scenario in which we have a running Docker container with InfluxDB inside. Our task is to perform a backup of a selected database.\n\n### Get container ID\nFirst of all you should get an ID from a running InfluxDB container. You may check it with a `docker ps` command (CONTAINER ID is the first column):\n```sh\nCONTAINER ID        IMAGE          COMMAND             CREATED             STATUS            PORTS                              NAMES\ne94f5db005a2        influx1.3      \"/entrypoint.sh\"    3 hours ago         Up About an hour    8083/tcp, 0.0.0.0:8086->8086/tcp   influx_1\n```\n\n### Create a backup\nIt's easy, just execute:\n```sh\ndocker exec -it e94f5 influxd backup -database mydb_to_backup dirname\n```\nWhere:\n\n- **e94f5** - is your InfluxDb container ID\n- **mydb_to_backup** - is a name of database you want to backup\n- **dirname** - is the name of internal container folder where DB backup will be placed (just make sure it's an empty directory, it will be used in the next command)\n\nThen copy backup files to local directory with:\n```sh\ndocker cp e94f5:dirname local_backup\n```\nHere:\n\n- **e94f5** - is your container ID\n- **dirname** - is you container directory with backup files\n- **local_backup** - is your folder path on the local machine\n\nAfter executing this two commands you should have all backup files inside **local_backup** folder. Now it's time to restore this backup to the other InfluxDB container (which may be placed on the other host e.g. some VM on Azure or AWS).\n\n## Restore backup on Dockerized InfluxDB\nLet's get to the restoring process which is a little more complicated than the backup. I assume that you already know how to get the ID of the target container with another InfluxDB. The overall recipe for the restoring is to create a temporary container which won't use Influx as an entrypoint (detailed process is described below).\n\nFirst of all, you have to stop the container with InfluxDB. This is important to ensure correct database restoration process (it might be possible in future to restore database on a running container but it's not possible now):\n```sh\ndocker stop e94f5\n```\nOf course, you should replace `e94f5` with your **CONTAINER_ID** first few characters.\n\nNow it's time for magic. You have to create new Influx container which will not run Influx as a root process. Here is the command to do this:\n\n```sh\ndocker run --rm \\\n --entrypoint /bin/bash \\\n -v influx_data_dir:/var/lib/influxdb \\\n -v local_backup:/backups \\\n influxdb:1.3 \\\n -c \"influxd restore -metadir /var/lib/influxdb/meta -datadir /var/lib/influxdb/data -database [DB_NAME] /backups/[BACKUP_DIR_NAME]\"\n```\nWhere:\n\n- **influx\\_data\\_dir** - is the directory which is used by your stopped Influx container to store DB info\n- **local_backup** - is the directory with DB backup\n- **db_name** - is name of the restored DB\n- **backup\\_dir\\_name** - is name of database backup folder inside **local_backup** directory\n\nWait a few moments (or longer), some restoring messages should be visible in the output.\nThen your database is restored you may start you stopped Influx container:\n\n```sh\ndocker start e94f5\n```\n\nEverything should be fine. Your database should be available, which you may check via Influx CLI.\n\n## Notes\nSome caveats encountered during the work with Docker backup/restore process.\n\n### Usage with Docker Volumes\nIn case of using Docker Volumes make sure that volume name specified for **/var/lib/influxdb** is correct. The easiest way to discover Volume name used by a running container is executing:\n```sh\ndocker inspect e94f5 | grep volumes\n```\nWhere:\n\n- **e94f5** - is your primary/running Influx container ID\n\nHere is the example output:\n```js\n\"Source\": \"/var/lib/docker/volumes/my_influx-data/_data\"\n```\nWhich means that your data volume name is **my_influx-data**.\n\n## Sources\nPlaces where I've found informations which help me write this tutorial:\n\n- [Official docs](https://docs.influxdata.com/influxdb/v1.3/administration/backup_and_restore/)\n- [Community forum](https://community.influxdata.com/t/backup-and-restore-influxdb-inside-docker/1636)\n- [Github issue](https://github.com/influxdata/influxdb/issues/8551)\n- [Gist](https://gist.github.com/mark-rushakoff/36b4491f97b8781198da36752ecd949b) - many thanks for that\n","excerpt":"Running InfluxDB inside Docker container is extremely easy with the official image available on Docker Hub https://hub.docker.com/_/influxdbâ€¦","frontmatter":{"title":"How to backup and restore InfluxDB which runs inside Docker container","slug":"how-to-backup-and-restore-influxdb-which-runs-inside-docker-container","date":"2017-11-16T17:22:22.000Z","tags":["docker","backend"],"date_created":"2017-11-16T15:13:50.000Z","date_updated":"2017-12-07T21:24:24.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/dockerized-influxdb-restore.png","relativePath":"posts/img/dockerized-influxdb-restore.png","childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABX0lEQVQoz1WReWvCQBDFc+yRY3NoDhM1Uaq1EbVQJZYipUKR0u//gV5n11rsH4+ZDbu/vHlj5dkQ81mD7mmJbrVE20wwm7Vomil2uw0Ohz0GgyE4E1BRDM8P4LocLuOmcuGDS5LwwLkHK00TVFWJdfeIj9Mrjvsdzqce/f4Z5/c3fF/O+Lp8Yrvd0CMJxoWB6V56AQTpBnTpp1YYhCjzDJN6hOm4QjMeoR7lWK8W2HZLPLQ1+sMLjsceQahIEVScIFAxpK/+gBrmkGNr3jZgLoNru3Bsh2xzcx6mEcosRUZ1MW9oigohAbOiRJQO4BNY+iHEHcw4VEoRgJuMBI3DqOqxpJSIVEjgBEkcmTF1hoMsQxhTloH650xXfbZsh1HjGQntjl0D15ds5yrHpUf0rSwK1HVlYDq/G4hxec2RGBb7JRuRMx2upE2G5FxL0KXrIgTyvEBOUN3fxPR27xbzA7KLpDXSJofxAAAAAElFTkSuQmCC","aspectRatio":2,"src":"/static/7fa76383651ee47dc9f9bae462d16217/d1858/dockerized-influxdb-restore.png","srcSet":"/static/7fa76383651ee47dc9f9bae462d16217/eed6b/dockerized-influxdb-restore.png 150w,\n/static/7fa76383651ee47dc9f9bae462d16217/44052/dockerized-influxdb-restore.png 300w,\n/static/7fa76383651ee47dc9f9bae462d16217/d1858/dockerized-influxdb-restore.png 600w,\n/static/7fa76383651ee47dc9f9bae462d16217/6b4f3/dockerized-influxdb-restore.png 900w,\n/static/7fa76383651ee47dc9f9bae462d16217/f5d99/dockerized-influxdb-restore.png 1200w,\n/static/7fa76383651ee47dc9f9bae462d16217/05be9/dockerized-influxdb-restore.png 1277w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"c1c44400-f632-54e6-97ce-b41fe089ba8c","html":"<p>Use <code class=\"language-text\">rvictl</code> and Wireshark.</p>\n<p>In order to user <strong>rvictl</strong> you have to have <strong>latest Xcode installed</strong> and launched at least once (during first run Xcode downloads some additional tools, one of them is <strong>rvictl</strong>).</p>\n<p>When <strong>rvictl</strong> command is available in terminal check your device UUID (in <strong>Xcode > Window > Devices and Simulators</strong>)</p>\n<p>Then execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">rvictl -s <span class=\"token punctuation\">[</span>UUID<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Now you should have <strong>rvi0</strong> interface available.</p>\n<p>Just use Wireshark on that interface, it will show all packages sent and received by your iPhone.</p>","timeToRead":1,"rawMarkdownBody":"Use `rvictl` and Wireshark.\n\nIn order to user **rvictl** you have to have **latest Xcode installed** and launched at least once (during first run Xcode downloads some additional tools, one of them is **rvictl**).\n\nWhen **rvictl** command is available in terminal check your device UUID (in **Xcode > Window > Devices and Simulators**)\n\nThen execute:\n\n```bash\nrvictl -s [UUID]\n```\n\nNow you should have **rvi0** interface available.\n\nJust use Wireshark on that interface, it will show all packages sent and received by your iPhone.\n","excerpt":"Use  and Wireshark. In order to user rvictl you have to have latest Xcode installed and launched at least once (during first run Xcodeâ€¦","frontmatter":{"title":"Monitor iPhone network traffic with Wireshark","slug":"monitor-iphone-internet-traffic-with-wireshark","date":"2018-04-02T23:11:34.000Z","tags":["tools","ios","mac"],"date_created":"2017-10-24T04:27:29.000Z","date_updated":"2018-04-02T23:11:34.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/iphone-wireshark-network-monitoring.jpg","relativePath":"posts/img/iphone-wireshark-network-monitoring.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHDOihgV//EABcQAAMBAAAAAAAAAAAAAAAAAAABESD/2gAIAQEAAQUCFbj/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAXEAEAAwAAAAAAAAAAAAAAAAABABEg/9oACAEBAAE/IY0rz//aAAwDAQACAAMAAAAQDA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEBAAEFAAAAAAAAAAAAAAABABARITFBgf/aAAgBAQABPxCYSgOwlrdRz7j/2Q==","aspectRatio":2,"src":"/static/330a5a87a193a3a4da73ef3753394aa0/0defe/iphone-wireshark-network-monitoring.jpg","srcSet":"/static/330a5a87a193a3a4da73ef3753394aa0/38b6a/iphone-wireshark-network-monitoring.jpg 150w,\n/static/330a5a87a193a3a4da73ef3753394aa0/e201c/iphone-wireshark-network-monitoring.jpg 300w,\n/static/330a5a87a193a3a4da73ef3753394aa0/0defe/iphone-wireshark-network-monitoring.jpg 600w,\n/static/330a5a87a193a3a4da73ef3753394aa0/a71f1/iphone-wireshark-network-monitoring.jpg 900w,\n/static/330a5a87a193a3a4da73ef3753394aa0/9f6c3/iphone-wireshark-network-monitoring.jpg 1200w,\n/static/330a5a87a193a3a4da73ef3753394aa0/fe13a/iphone-wireshark-network-monitoring.jpg 1276w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"481b783d-1627-5da9-bebd-434d85d05582","html":"<p>Adding WPML support to PostType Switcher plugin is easy. My solution is based on <a href=\"https://wordpress.org/support/topic/simple-hack-to-add-wpml-support/\">https://wordpress.org/support/topic/simple-hack-to-add-wpml-support/</a> posts.</p>\n<h3>Open Post Type Switcher plugin PHP file</h3>\n<p>It is located at <strong>wp-content/plugins/post-type-switcher/post-type-switcher.php</strong></p>\n<h3>Find lines</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">// Update post type\n$data[&#39;post_type&#39;] = $post_type;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h3>Add following code above them</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">// Update WPML translations as well\nglobal $wpdb, $sitepress;\ninclude_once( WP_PLUGIN_DIR . &#39;/sitepress-multilingual-cms/inc/wpml-api.php&#39; );\n\n$post_trid = apply_filters( &#39;wpml_element_trid&#39;, NULL, $postarr[&#39;ID&#39;], &#39;post_&#39; . $data[&#39;post_type&#39;] );\n$translations = apply_filters( &#39;wpml_get_element_translations&#39;, NULL, $post_trid, &#39;post_&#39; . $data[&#39;post_type&#39;] );\n\nif( is_array( $translations ) &amp;&amp; !empty( $translations ) &amp;&amp; function_exists(&#39;icl_object_id&#39;) ) {\n  foreach( $translations as $translation ){\n    $elem_id = $translation-&gt;element_id;\n\n    // skip currently switched element\n    if ( $elem_id == $postarr[&#39;ID&#39;] ) continue;\n\n    // Set the new post type.\n    set_post_type( $elem_id, $post_type );\n\n  }\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>After applying described changes your Post Type Switcher plugin will be compatible with WPML. Now each time you change a post type (eg. from <strong>post</strong> to <strong>page</strong>) all translations will be moved as well.</p>","timeToRead":1,"rawMarkdownBody":"Adding WPML support to PostType Switcher plugin is easy. My solution is based on https://wordpress.org/support/topic/simple-hack-to-add-wpml-support/ posts.\n\n### Open Post Type Switcher plugin PHP file\nIt is located at **wp-content/plugins/post-type-switcher/post-type-switcher.php**\n### Find lines\n```\n// Update post type\n$data['post_type'] = $post_type;\n```\n### Add following code above them\n```\n// Update WPML translations as well\nglobal $wpdb, $sitepress;\ninclude_once( WP_PLUGIN_DIR . '/sitepress-multilingual-cms/inc/wpml-api.php' );\n\n$post_trid = apply_filters( 'wpml_element_trid', NULL, $postarr['ID'], 'post_' . $data['post_type'] );\n$translations = apply_filters( 'wpml_get_element_translations', NULL, $post_trid, 'post_' . $data['post_type'] );\n\nif( is_array( $translations ) && !empty( $translations ) && function_exists('icl_object_id') ) {\n  foreach( $translations as $translation ){\n    $elem_id = $translation->element_id;\n\n    // skip currently switched element\n    if ( $elem_id == $postarr['ID'] ) continue;\n\n    // Set the new post type.\n    set_post_type( $elem_id, $post_type );\n\n  }\n}\n```\n\nAfter applying described changes your Post Type Switcher plugin will be compatible with WPML. Now each time you change a post type (eg. from **post** to **page**) all translations will be moved as well.\n","excerpt":"Adding WPML support to PostType Switcher plugin is easy. My solution is based on https://wordpress.org/support/topic/simple-hack-to-add-wpmlâ€¦","frontmatter":{"title":"Wordpress WMPL Post Type Switcher support","slug":"wordpress-wmpl-post-type-switcher-support","date":"2017-10-05T19:28:00.000Z","tags":["wordpress","wordpress-plugins","php"],"date_created":"2017-10-05T19:28:03.000Z","date_updated":"2017-10-05T19:40:21.000Z","author":"jan","feature_image":null}}},{"node":{"id":"2083517f-801e-5901-81f3-6891c8f433f7","html":"<p>Adding translations to the current Roots Sage version (which is 9.0.0-beta.4) is not as easy and standard as it was in previous versions.</p>\n<p>First of all, you have to configure your Poedit editor in order to support Blade templates. Described configuration is taken from <a href=\"https://discourse.roots.io/t/localization-of-blade-templates/9331/6#post_6\">the official forum</a>:</p>\n<ol>\n<li>Open <strong>Poedit</strong></li>\n<li>Go to <strong>Preferences -> Extractors</strong></li>\n<li>Add a new Extractor with following settings:\nLanguage: <strong>Blade</strong>\nExtension: <strong>*.scout.php, *.blade.php</strong>\nParser command: <strong>xgettext --language=Python --add-comments=TRANSLATORS --force-po -o %o %C %K %F</strong>\nAn item in keyword list: <strong>-k%k</strong>\nAn item in input files list: <strong>%f</strong>\nSource code charset: <strong>--from-code=%c</strong></li>\n<li>Click Ok</li>\n</ol>\n<p>Now when your Poedit is ready to handle Blade template files go to the <strong>Sources paths</strong> setup (it's in <strong>Catalogue -> Properties</strong> menu).</p>\n<p>It's important to set theme <strong>resources/</strong> subdirectory as a root and then exclude <strong>assets/</strong> subdirectory.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d7f654f45c4465cf5693a3b1785ca98e/b2091/poedit_sage_source_paths.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.1796875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACBUlEQVQ4y6WU247aMBCGedWqr9OLXlTqvkHblao+QFfbi1U5x4FAssCSE8Q5kAQSYNUiIf7OGFhRtRLQWvoyke38sWd+uxJFEWazGZIkwXQ6xWQygZQS/mSKJArwMCzwsVXisyhxq5X4ahaIQ4kgCBT8TRTFSoO1KvzwfV8NWKaJfr+PR8uEYfTgjCx8aaV4e5fh5luGd/c5PtRSjEcDmDT30bLUfM/z1CIYJajrAvV6A5rQIIROUUdbE2i2BcyuhkG3CUOrwRR1GKKBWqOJTtdAIENMAkm7msJ13VNBHdVqFSb90XV9tJ8khJ1AdxI0xzHFFI2nGG3qa40TtKmvQ2MaIQjLluh0uiTs7wUNw8BwOEIcx4jCEDKMEFI/x9N3FQ+cjkv6hvOpVsiP1WoFbrvdToFLwTECm81GCSvB9Xr9IriP13AiKP8i+C+cFbym/SEYHhKapimyLHsx+bVwcVVRQqrSYEBGJYPuqz1UnnIc5yp+82GvZ0DTNNi2rf62XC5RFAXKsjzLcV6e5wfb0JaPOfyftt1u97bhHHL+WJRXxrAvz3GcVy7pfbVGPl/QUTxsmQ83XxCXwjcSXyae5yMMfCTSU6QxCXLOsixVq7wEzpW66sgZi3mOnjfH99ECVULYGSpsE7bLJbBgQQVIkhi242LzXOD9wwqvPv3A69ufeHO3xC9DPfRbaxyYNQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Wordpress Sage Poedit setup\"\n        title=\"Wordpress Sage Poedit setup\"\n        src=\"/static/d7f654f45c4465cf5693a3b1785ca98e/a3419/poedit_sage_source_paths.png\"\n        srcset=\"/static/d7f654f45c4465cf5693a3b1785ca98e/a1986/poedit_sage_source_paths.png 210w,\n/static/d7f654f45c4465cf5693a3b1785ca98e/ad7fb/poedit_sage_source_paths.png 420w,\n/static/d7f654f45c4465cf5693a3b1785ca98e/a3419/poedit_sage_source_paths.png 840w,\n/static/d7f654f45c4465cf5693a3b1785ca98e/b2091/poedit_sage_source_paths.png 1024w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>In order to avoid <strong>non ASCII</strong> error message please setup <strong>Source code charset</strong> as <strong>UTF-8</strong> (it's inside <strong>Translation properties</strong> tab).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bdaf451297436baff812810480a06503/01175/poedit_non_ascii_fix.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.14872798434443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAAC7klEQVQ4y21UyW7TUBTttyLxMezYILGgW6qqiC2qRItatXGmOk3i2PEUz2M8J5UqNod7X3AURBcnx+8+57xzh+ezJEmQZRmulxUuJw2+yw2upge+mLSYWiXS0EMYRfA8F9ttjjiOEAYBojBEEPhgjW2ek06KM14EtPlVKvHprsWXhwaf72qcP9T4eNvgZlnA1DWoaxMrdY04SWHZG6iaDm1tQFmpcFwfXhAjipOD4Gw2w3w6gL4YYyUPYKsytOchHFODHZVw0gYWsRWW0L2cYpWIm0Ehnp24Qpi3cMO/Dh3HgWHaMKwNTMvGkzyDNBxBIUcr3YbtRdjWO6RFg6zsCO0ROSEuOipTjY1PDuM4hu/7Im2GZVmYTqeQJIlS0rG2XLiuQ3WKkaYJUq45MdcxikIkxFmW42aewg/jg6DneQIsvFwsIMsynmcylpqF6ycf0mCA29tfGNAh9/f3eHx8xHA0EocyW7aNJHDAWkeHvWhInYuooz1HYQBVXUFRVsQqlsslFvMFddmnzmbCbUruoygW3f5H8JT7EvBIlWWJqqoEN02DmuBFGZyA6h8mgiMSS9L0f4f8bJo0IqsVbEqFY/ZmI2rLqZmmQWsHqhNBsQmbA/+QAzE6xxr2jjhNTdMwmUyg67pI3XFcIbghYcMwENCh+12LXddiT2jbFt8mFdxekIV4FodDCePxWGBExWZh3mOnuqGTO0vEPNdD23WU/kGsajpcjGge/ZOm8CyyAwYL8Jqdu6573OuZY31GDN8P8Lz26XqeCIqOnmA+n4v06roWjTgFx07RMKri0GX+4RMVRRFjwSnxaIzopnANO0ptv99jt9v9B4534nmPqqYb099lTo1ruFgshZj8JIvbwo3gUXkL7Kwg7uoSLy1xlaPMSZDnbLvdihd41hh9KkVRiDnskdKc8btsgstU0KdMcbaQ9AJDo8TcKXGW03eM/8gvvgXe68Fr7mpON4Q/Yb9fWpwPdnh3+Yr3V6/48HOPP78t0Ke6wXdoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Poedit non ASCII bug fix\"\n        title=\"Poedit non ASCII bug fix\"\n        src=\"/static/bdaf451297436baff812810480a06503/a3419/poedit_non_ascii_fix.png\"\n        srcset=\"/static/bdaf451297436baff812810480a06503/a1986/poedit_non_ascii_fix.png 210w,\n/static/bdaf451297436baff812810480a06503/ad7fb/poedit_non_ascii_fix.png 420w,\n/static/bdaf451297436baff812810480a06503/a3419/poedit_non_ascii_fix.png 840w,\n/static/bdaf451297436baff812810480a06503/01175/poedit_non_ascii_fix.png 1022w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>And last but not least. Your <strong>lang/</strong> subdirectory where all translation files lives should also be placed inside <strong>resources/</strong> directory. Here is how your folder structure may look like:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 190px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e5df8fe17bf1d5faea1fa36e44269142/d4db8/sage_translations_files.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.05263157894737%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABpklEQVQoz41S2W7bMBDUawNEou1CNylSpGRRio64TlokUeL8QfP/HzNdsk3RAjn8MNgVuRzN7G4wzTN0XSPjMXTHodoSdVei0jkqk0PtS0jKG5WAsQ222+2HCMZpgtEau5ihGQQMoR0rSCIrqxS6F+jo28gE0TmEQgh8ubiAtT2SOAbXmVcnCDWpc1FXsVe32XyOoCa7jJKmaVEUGdpJktIK3azIOkd/rWDb3P99t9t9iqBpGmRZhnlZYIyG6STsZND0Na4GBSU43RcoyxKccx8/QmCMQZwkRDhDSYX9VGP+3mJ52OPHXYs0/ookTZESnAIX8zx/F4GU0nsPw/B3vAyRJgWWeUFZlES6otGK2lHg7v4enFQwxt4fiiN8LXAKHHFnLQ6HA2zXoe8HvwX7tsXj6UQuKkRR5OvfHMq/hA6MRdQLjonWqSAL3463niSj3J8V+fkKHcLwEvvO+sduA8ZxgtY1rZXFw7pC0GDYH4VnEbrcNXcYBhyuybbtfP/cFoxXI2Ql/lo+i9AVcy6wro94+fmC09MThr7H6fkZN8fjfz18C78AVjo8yRJY0AMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Sage translations files structure\"\n        title=\"Sage translations files structure\"\n        src=\"/static/e5df8fe17bf1d5faea1fa36e44269142/d4db8/sage_translations_files.png\"\n        srcset=\"/static/e5df8fe17bf1d5faea1fa36e44269142/d4db8/sage_translations_files.png 190w\"\n        sizes=\"(max-width: 190px) 100vw, 190px\"\n      />\n  </a>\n    </span></p>\n<p>One more thing is placing the following code inside <strong>functions.php</strong> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'after_setup_theme'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Community translations can be found at https://github.com/roots/sage-translations</span>\n    <span class=\"token function\">load_theme_textdomain</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'sage'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">get_template_directory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">'/lang'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>This code will tell the Wordpress where it should look for the translations files.</p>\n<p>That's it. If you place your Poedit generated translations inside <strong>resources/langs</strong> folder it should work as usual.</p>","timeToRead":2,"rawMarkdownBody":"Adding translations to the current Roots Sage version (which is 9.0.0-beta.4) is not as easy and standard as it was in previous versions.\n\nFirst of all, you have to configure your Poedit editor in order to support Blade templates. Described configuration is taken from [the official forum](https://discourse.roots.io/t/localization-of-blade-templates/9331/6#post_6):\n\n1. Open **Poedit**\n2. Go to **Preferences -> Extractors**\n3. Add a new Extractor with following settings:\nLanguage: **Blade**\nExtension: ***.scout.php, *.blade.php**\nParser command: **xgettext --language=Python --add-comments=TRANSLATORS --force-po -o %o %C %K %F**\nAn item in keyword list: **-k%k**\nAn item in input files list: **%f**\nSource code charset: **--from-code=%c**\n4. Click Ok\n\nNow when your Poedit is ready to handle Blade template files go to the **Sources paths** setup (it's in **Catalogue -> Properties** menu).\n\nIt's important to set theme **resources/** subdirectory as a root and then exclude **assets/** subdirectory.\n\n![Wordpress Sage Poedit setup](img/poedit_sage_source_paths.png)\n\nIn order to avoid **non ASCII** error message please setup **Source code charset** as **UTF-8** (it's inside **Translation properties** tab).\n\n![Poedit non ASCII bug fix](img/poedit_non_ascii_fix.png)\n\nAnd last but not least. Your **lang/** subdirectory where all translation files lives should also be placed inside **resources/** directory. Here is how your folder structure may look like:\n\n![Sage translations files structure](img/sage_translations_files.png)\n\nOne more thing is placing the following code inside **functions.php** file:\n\n```php\nadd_action('after_setup_theme', function () {\n    // Community translations can be found at https://github.com/roots/sage-translations\n    load_theme_textdomain('sage', get_template_directory() . '/lang');\n});\n```\n\nThis code will tell the Wordpress where it should look for the translations files.\n\nThat's it. If you place your Poedit generated translations inside **resources/langs** folder it should work as usual.\n","excerpt":"Adding translations to the current Roots Sage version (which is 9.0.0-beta.4) is not as easy and standard as it was in previous versionsâ€¦","frontmatter":{"title":"Wordpress Roots Sage 9 translations","slug":"wordpress-roots-sage-9-translations","date":"2017-08-31T01:26:13.000Z","tags":["wordpress"],"date_created":"2017-08-31T00:57:15.000Z","date_updated":"2017-09-22T22:17:04.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/letters.jpg","relativePath":"posts/img/letters.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBP/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB40mboH//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAUQEQEWH/2gAIAQEAAT8htELph//aAAwDAQACAAMAAAAQ2O//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEBAQADAQAAAAAAAAAAAAABEQBBUZGx/9oACAEBAAE/EAAzDU5Zlr1d9B5iy2b/2Q==","aspectRatio":2,"src":"/static/07579ef4c70caa9b105d77ba1fcee8ad/0defe/letters.jpg","srcSet":"/static/07579ef4c70caa9b105d77ba1fcee8ad/38b6a/letters.jpg 150w,\n/static/07579ef4c70caa9b105d77ba1fcee8ad/e201c/letters.jpg 300w,\n/static/07579ef4c70caa9b105d77ba1fcee8ad/0defe/letters.jpg 600w,\n/static/07579ef4c70caa9b105d77ba1fcee8ad/a71f1/letters.jpg 900w,\n/static/07579ef4c70caa9b105d77ba1fcee8ad/9f6c3/letters.jpg 1200w,\n/static/07579ef4c70caa9b105d77ba1fcee8ad/e95fb/letters.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"4b837472-80d8-5b4a-8b2b-42bdc49759e9","html":"<p>During assets compilation with <code class=\"language-text\">yarn start</code>, <code class=\"language-text\">yarn build</code> or <code class=\"language-text\">npm run build</code> you may run into this error:</p>\n<blockquote>\n<p>error Command failed with exit code 2</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/64fbac9ad943023d0f6992db47c5d848/ec8f0/command-failed-with-exit-code-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.00505902192243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAABYlAAAWJQFJUiTwAAABEUlEQVQY0zWPTXaDIBSFs40OOq6i8iMgEIv8ijHBk2MHaRfTVXTFxZz2Du7gcb/3uCfx/TPuX9GaaTLe+23b7vd7ztu+7znnx+PzY9+31xcFKi6lkpIQUlVV89Tptq4pJe98DGHgA0KIUloSxTk7RA71RZwfg6exEjtgUIPqrW5h03SNUGK9rZhgY4y1LoRwWRZIIOpRizrn3LKkdb1qrQEAB4wYopqJJNVNqavijtOBXpZUapSEkoobLjfFAh/HMcaglIQQ/sMCU0vLW28p0X1xzIk1RgpR13X5JtOMzwM1tGDTpBllXdv+dX7XPObZZ28WY5MpbtwUvJ9jxAhhhDHHZOzLjVL7fC4bJOw68IR/AdlnT9x/m5o9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sage error command failed with exit code 2\"\n        title=\"sage error command failed with exit code 2\"\n        src=\"/static/64fbac9ad943023d0f6992db47c5d848/a3419/command-failed-with-exit-code-2.png\"\n        srcset=\"/static/64fbac9ad943023d0f6992db47c5d848/a1986/command-failed-with-exit-code-2.png 210w,\n/static/64fbac9ad943023d0f6992db47c5d848/ad7fb/command-failed-with-exit-code-2.png 420w,\n/static/64fbac9ad943023d0f6992db47c5d848/a3419/command-failed-with-exit-code-2.png 840w,\n/static/64fbac9ad943023d0f6992db47c5d848/ec8f0/command-failed-with-exit-code-2.png 1186w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<h2>Workaround</h2>\n<p>In order to fix it try to open the website and check browser console. There should be some JS/CSS error listed (marked with red color).\nThe message should be descriptive enough to give you an idea about possible solutions.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/08e3f4ffbfe7a6a92a82c35f69e01b50/8637f/browser-console-error-message.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.15384615384616%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAABYlAAAWJQFJUiTwAAABOUlEQVQY0y2OC2+CMBSF+f9/y71MnJuiTFFepbUILbRQ5THHWZvt5svJl5uTm+txfik4p5QyxoQQaZpQmueEKKW6rq2ltMumaax3blwa09kl59wrrsKYfhi/x+lx78dK1ObW98Nk/XYfpGwapZVqh2FyjC6n6dG2RuvOi+M9zQ/XItaaW5qaKZsNE5J2phpGDUxtW5YVsQhBRUVsx5gK6L0i2haxL1k4yGyQZKzzqc7vRTSJFLdqtqW7KJMg3a/T4IOGfnTcxqFfsgiPzvvZ+PNqPQcHbHy8fyI8gXFHQpBkoBfrM8lnQuecWe940RB6K0rYt1GWCAIcvnA+4xQijnA8IAxxvUIrCOEKNqV0WVX/WFfKw9sbFgs8WZ7w+orlEus1VivnL8/Y7ZCliM7uaJb9MSfxTCm0/gW2doGUysGrMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sage error in developer console\"\n        title=\"sage error in developer console\"\n        src=\"/static/08e3f4ffbfe7a6a92a82c35f69e01b50/a3419/browser-console-error-message.png\"\n        srcset=\"/static/08e3f4ffbfe7a6a92a82c35f69e01b50/a1986/browser-console-error-message.png 210w,\n/static/08e3f4ffbfe7a6a92a82c35f69e01b50/ad7fb/browser-console-error-message.png 420w,\n/static/08e3f4ffbfe7a6a92a82c35f69e01b50/a3419/browser-console-error-message.png 840w,\n/static/08e3f4ffbfe7a6a92a82c35f69e01b50/4d498/browser-console-error-message.png 1260w,\n/static/08e3f4ffbfe7a6a92a82c35f69e01b50/8637f/browser-console-error-message.png 1300w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>Unfortunately, such errors may also occur during the <code class=\"language-text\">yarn start</code> or <code class=\"language-text\">npm start</code> command execution and you will not get <strong>any message</strong>. So if your theme doesn't work after <code class=\"language-text\">yarn start</code> you should execute <code class=\"language-text\">yarn build</code> in order to look for (building) errors.</p>\n<p>It is also a good idea to run <code class=\"language-text\">yarn lint</code> sometimes in order to avoid linting error messages during assets building.</p>\n<p>Above instructions are valid for <strong>Sage 9.0.0-beta.4</strong>, but other 9.x versions would probably behave in a similar way.</p>\n<h2>Fix</h2>\n<p>In order to get error reporting back to the console edit <strong>resources/assets/build/webpack.config.js</strong> file and change (the ellipsis <strong>...</strong> stands for code which shouldn't be modified):</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> webpackConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n  stats<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n    errors<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    errorDetails<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n<span class=\"token operator\">...</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>to</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> webpackConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n  stats<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n    errors<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    errorDetails<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token operator\">...</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>As a result you will get a full error message similar to this:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/95518503c0ed38493c283e7802d2b893/502ef/sage_assets_errors_reporting_ok.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.66576086956522%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABYlAAAWJQFJUiTwAAABWklEQVQoz41R207DMAzt59DGbu63ppfRrhvbNIkn/v9TcNINhpAY1lF0kvjEx04V3j9i6sZxmOd5WZZpNw1S9ClxzpumYX9GJSzY2eikYghSSTUpFDylBADsWVTQYpqd73UfgzbaLtYa6ayt6/q5WFgRV+dH26dOaWVnq7SwWdz8QzxqvTo5mJQGcqEXWwOQcMPLnTyCXt1QjYH3BIdecc3Bu9ZLcIIZAUT8tuaTG6Fz2TLVMtGyau/wEvEY8BjhLeIpwiXh3mesHg8hY3E4O3x1+XBHAxbAkdE8K6pGytHgZOkaKGNx0KnvskHmbAJlCmSKM1NI7pkjkHIwee0N9JreRi+Z5tmbzqkZqmwpvtpmW+VDrgyThdHCUEjSENWt7EaoZwL+/Ptq7+Ga8NLBucv+TxHPXUEhdHUtIyALHH991ezFYTBrp1+jChKpGQIvyFMtbok3d6uP8QlqNopkRuyftAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sage assets building error message\"\n        title=\"sage assets building error message\"\n        src=\"/static/95518503c0ed38493c283e7802d2b893/a3419/sage_assets_errors_reporting_ok.png\"\n        srcset=\"/static/95518503c0ed38493c283e7802d2b893/a1986/sage_assets_errors_reporting_ok.png 210w,\n/static/95518503c0ed38493c283e7802d2b893/ad7fb/sage_assets_errors_reporting_ok.png 420w,\n/static/95518503c0ed38493c283e7802d2b893/a3419/sage_assets_errors_reporting_ok.png 840w,\n/static/95518503c0ed38493c283e7802d2b893/4d498/sage_assets_errors_reporting_ok.png 1260w,\n/static/95518503c0ed38493c283e7802d2b893/70b58/sage_assets_errors_reporting_ok.png 1680w,\n/static/95518503c0ed38493c283e7802d2b893/502ef/sage_assets_errors_reporting_ok.png 2944w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<h3>Hint</h3>\n<p>In my case, this error was caused by something which is stored inside <strong>.cache-loader</strong> directory which is placed directly inside your Sage theme directory. The solution was easy, just delete the <strong>.cache-loader</strong> dir.</p>\n<h3>Sources</h3>\n<p><a href=\"https://discourse.roots.io/t/yarn-build-error-exit-code-2/10225/3\">https://discourse.roots.io/t/yarn-build-error-exit-code-2/10225/3</a>\n<a href=\"https://discourse.roots.io/t/command-line-lint-errors-gone-in-beta-4/10227?u=40q\">https://discourse.roots.io/t/command-line-lint-errors-gone-in-beta-4/10227?u=40q</a></p>","timeToRead":2,"rawMarkdownBody":"During assets compilation with `yarn start`, `yarn build` or `npm run build` you may run into this error:\n\n> error Command failed with exit code 2\n\n![sage error command failed with exit code 2](img/command-failed-with-exit-code-2.png)\n\n## Workaround\n\nIn order to fix it try to open the website and check browser console. There should be some JS/CSS error listed (marked with red color).\nThe message should be descriptive enough to give you an idea about possible solutions.\n\n![sage error in developer console](img/browser-console-error-message.png)\n\nUnfortunately, such errors may also occur during the `yarn start` or `npm start` command execution and you will not get **any message**. So if your theme doesn't work after `yarn start` you should execute `yarn build` in order to look for (building) errors.\n\nIt is also a good idea to run `yarn lint` sometimes in order to avoid linting error messages during assets building.\n\nAbove instructions are valid for **Sage 9.0.0-beta.4**, but other 9.x versions would probably behave in a similar way.\n\n## Fix\n\nIn order to get error reporting back to the console edit **resources/assets/build/webpack.config.js** file and change (the ellipsis **...** stands for code which shouldn't be modified):\n\n```js\nlet webpackConfig = {\n  ...\n  stats: {\n    ...\n    errors: false,\n    errorDetails: false,\n...\n```\nto\n```js\nlet webpackConfig = {\n  ...\n  stats: {\n    ...\n    errors: true,\n    errorDetails: true,\n...\n```\nAs a result you will get a full error message similar to this:\n\n![sage assets building error message](img/sage_assets_errors_reporting_ok.png)\n\n### Hint\n\nIn my case, this error was caused by something which is stored inside **.cache-loader** directory which is placed directly inside your Sage theme directory. The solution was easy, just delete the **.cache-loader** dir.\n\n### Sources\n\nhttps://discourse.roots.io/t/yarn-build-error-exit-code-2/10225/3\nhttps://discourse.roots.io/t/command-line-lint-errors-gone-in-beta-4/10227?u=40q\n","excerpt":"During assets compilation with ,  or  you may run into this error: error Command failed with exit code 2  Workaround In order to fix it tryâ€¦","frontmatter":{"title":"Roots Sage 9.0.0 - error Command failed with exit code 2","slug":"wordpress-roots-sage-9-0-0","date":"2017-08-24T02:05:40.000Z","tags":["wordpress"],"date_created":"2017-08-24T01:53:35.000Z","date_updated":"2018-01-28T11:19:15.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/sage_assets_errors_reporting.jpg","relativePath":"posts/img/sage_assets_errors_reporting.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAcSEBX//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAE/IX//2gAMAwEAAgADAAAAEP8A3//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EIf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCn/8QAFxABAQEBAAAAAAAAAAAAAAAAAQARcf/aAAgBAQABPxBeyO2X/9k=","aspectRatio":2,"src":"/static/90a2aa5953a511a05142d0b453a3e842/0defe/sage_assets_errors_reporting.jpg","srcSet":"/static/90a2aa5953a511a05142d0b453a3e842/38b6a/sage_assets_errors_reporting.jpg 150w,\n/static/90a2aa5953a511a05142d0b453a3e842/e201c/sage_assets_errors_reporting.jpg 300w,\n/static/90a2aa5953a511a05142d0b453a3e842/0defe/sage_assets_errors_reporting.jpg 600w,\n/static/90a2aa5953a511a05142d0b453a3e842/a71f1/sage_assets_errors_reporting.jpg 900w,\n/static/90a2aa5953a511a05142d0b453a3e842/9f6c3/sage_assets_errors_reporting.jpg 1200w,\n/static/90a2aa5953a511a05142d0b453a3e842/e95fb/sage_assets_errors_reporting.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"f39c6f63-ec4a-58cd-a807-731410ae2a4c","html":"<p>In PHP there is no option to provide default values for an associative array as an argument.</p>\n<p>E.g. (is not possible)</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$args</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'first'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'second'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'third'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// some PHP code</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>In order to solve that issue one may use <code class=\"language-text\">array_merge</code> <a href=\"http://php.net/manual/en/function.array-merge.php\">function</a>.</p>\n<p>Example code:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$args</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_merge</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'first'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'second'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'third'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token variable\">$args</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// some PHP code</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>In the example above <code class=\"language-text\">$args</code> variable will have default values for <code class=\"language-text\">first</code>, <code class=\"language-text\">second</code> and <code class=\"language-text\">third</code> key if there is no value provided.</p>","timeToRead":1,"rawMarkdownBody":"In PHP there is no option to provide default values for an associative array as an argument.\n\nE.g. (is not possible)\n\n```php\nfunction test($args = array('first' => 1, 'second' => 2, 'third' => 3)) {\n  // some PHP code\n}\n```\n\nIn order to solve that issue one may use `array_merge` [function](http://php.net/manual/en/function.array-merge.php).\n\nExample code:\n\n```php\nfunction test($args) {\n  $args = array_merge(\n    array('first' => 1, 'second' => 2, 'third' => 3),\n    $args\n  );\n\n  // some PHP code\n}\n```\n\nIn the example above `$args` variable will have default values for `first`, `second` and `third` key if there is no value provided.\n","excerpt":"In PHP there is no option to provide default values for an associative array as an argument. E.g. (is not possible) In order to solve thatâ€¦","frontmatter":{"title":"PHP default values with array_merge","slug":"php-default-values-with-array_merge","date":"2017-08-17T17:49:15.000Z","tags":["php"],"date_created":"2017-08-17T17:36:01.000Z","date_updated":"2017-09-22T22:21:01.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/keyboard-computer-keys-white-1.jpg","relativePath":"posts/img/keyboard-computer-keys-white-1.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAcqoQD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAWEAEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQEAAT8htVj/2gAMAwEAAgADAAAAEPPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBABAQADAAAAAAAAAAAAAAAAAQARcYH/2gAIAQEAAT8Q2WD2C3//2Q==","aspectRatio":2,"src":"/static/017519d052ae68534bf9fb91c225dd8c/0defe/keyboard-computer-keys-white-1.jpg","srcSet":"/static/017519d052ae68534bf9fb91c225dd8c/38b6a/keyboard-computer-keys-white-1.jpg 150w,\n/static/017519d052ae68534bf9fb91c225dd8c/e201c/keyboard-computer-keys-white-1.jpg 300w,\n/static/017519d052ae68534bf9fb91c225dd8c/0defe/keyboard-computer-keys-white-1.jpg 600w,\n/static/017519d052ae68534bf9fb91c225dd8c/a71f1/keyboard-computer-keys-white-1.jpg 900w,\n/static/017519d052ae68534bf9fb91c225dd8c/9f6c3/keyboard-computer-keys-white-1.jpg 1200w,\n/static/017519d052ae68534bf9fb91c225dd8c/e95fb/keyboard-computer-keys-white-1.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"d3742e3d-7aac-5362-950c-76803516a646","html":"<p>If you are making larger Wordpress site at some point you will definitely come across custom rewrite rules configuration.</p>\n<h2>The tools (plugins)</h2>\n<p>I would suggest <a href=\"https://wordpress.org/plugins/monkeyman-rewrite-analyzer/\">Rewrite Analyzer</a> as it shows matched URL parts which is very convenient for debugging.</p>\n<h2>Prioritize pagination over Custom Post Type (CPT) slug</h2>\n<p>So you want to have clean URL structure for your CPT archive, so the list page has the same URL as single CPT pages <strong>slug</strong> prefix.</p>\n<p>Here is the URLs structure I'm talking about:</p>\n<ul>\n<li><code class=\"language-text\">/career</code> - page with CPT archive</li>\n<li><code class=\"language-text\">/career/page/2</code> - second page of CPT archive</li>\n<li><code class=\"language-text\">/career/some-position-offer</code> - single CPT page</li>\n</ul>\n<p>Such URL structure requires defining a custom rewrite rule.</p>\n<p>Out of the box Wordpress fail to route to the <code class=\"language-text\">/career/page/2</code>, because before looking for the second page it will try to find CPT (named <code class=\"language-text\">career</code> in this example) with <code class=\"language-text\">page/2</code> slug. As a result the visitor will go to the 404 page instead of the second page for the Post archive.</p>\n<p>It's quite easy to solve with <code class=\"language-text\">add_rewrite_rule</code> function. Write following PHP code into your theme/plugin <code class=\"language-text\">functions.php</code> file (or anywhere else where you store custom PHP code for Wordpress):</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">// functions.php</span>\n<span class=\"token comment\">// prioritetize pagination over displaying custom post type content</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'init'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">add_rewrite_rule</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'(.?.+?)/page/?([0-9]{1,})/?$'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'index.php?pagename=$matches[1]&amp;paged=$matches[2]'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'top'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>If you do that the Wordpress will try to find next page before it tries to find the CPT single page.</p>\n<p>For more info about <code class=\"language-text\">add_rewrite_rule</code> check out the official documentation <a href=\"https://developer.wordpress.org/reference/functions/add_rewrite_rule/\">https://developer.wordpress.org/reference/functions/add<em>rewrite</em>rule/</a>.</p>\n<h2>Restricting selected slugs in Wordpress</h2>\n<p>Sometimes, especially when you start messing with the default URL structure there might be a necessity of restricting some slugs. Here is an example which will show how to prevent Post slug collisions with the existing Categories slugs <code class=\"language-text\">functions.php</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">// functions.php</span>\n<span class=\"token comment\">// Prevent category - post slug collisions</span>\n<span class=\"token comment\">// Restrict selected slugs for posts</span>\n<span class=\"token function\">add_filter</span><span class=\"token punctuation\">(</span> <span class=\"token single-quoted-string string\">'wp_unique_post_slug'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$slug</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$post_ID</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$post_status</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$post_type</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token single-quoted-string string\">'post'</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$post_type</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$categories</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_categories</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$categories</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token variable\">$c</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">slug</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$categories</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$slug</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$categories</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token variable\">$slug</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">'-'</span> <span class=\"token punctuation\">.</span> <span class=\"token variable\">$post_ID</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$slug</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>This code will append <code class=\"language-text\">-[post_ID]</code> to the end of the Post slug if it happens to be same as on of the slugs for existing categories.</p>\n<p>All examples are written for PHP >= 5.4.</p>\n<h2>Issues</h2>\n<p>Problems with pagination, rewrite rules and generally URL structure.</p>\n<ol>\n<li>Don't name query variable same as existing taxonomy slug. So if you have taxonomy with slug <code class=\"language-text\">company</code> avoid using <code class=\"language-text\">?company=xyz</code> as a query variable.</li>\n<li>If you want to change number of <code class=\"language-text\">posts_per_page</code> on default Wordpress post list page you should change this number not only in <code class=\"language-text\">query_args</code> array but also in Wordpress settings. In other case (if you change just <code class=\"language-text\">query_args</code>) you will get into troubles with pagination.</li>\n</ol>","timeToRead":2,"rawMarkdownBody":"If you are making larger Wordpress site at some point you will definitely come across custom rewrite rules configuration.\n\n## The tools (plugins)\n\nI would suggest [Rewrite Analyzer](https://wordpress.org/plugins/monkeyman-rewrite-analyzer/) as it shows matched URL parts which is very convenient for debugging.\n\n## Prioritize pagination over Custom Post Type (CPT) slug\n\nSo you want to have clean URL structure for your CPT archive, so the list page has the same URL as single CPT pages **slug** prefix.\n\nHere is the URLs structure I'm talking about:\n\n- `/career` - page with CPT archive\n- `/career/page/2` - second page of CPT archive\n- `/career/some-position-offer` - single CPT page\n\nSuch URL structure requires defining a custom rewrite rule.\n\nOut of the box Wordpress fail to route to the `/career/page/2`, because before looking for the second page it will try to find CPT (named `career` in this example) with `page/2` slug. As a result the visitor will go to the 404 page instead of the second page for the Post archive.\n\nIt's quite easy to solve with `add_rewrite_rule` function. Write following PHP code into your theme/plugin `functions.php` file (or anywhere else where you store custom PHP code for Wordpress):\n\n```php\n// functions.php\n// prioritetize pagination over displaying custom post type content\nadd_action('init', function() {\n  add_rewrite_rule('(.?.+?)/page/?([0-9]{1,})/?$', 'index.php?pagename=$matches[1]&paged=$matches[2]', 'top');\n});\n```\n\nIf you do that the Wordpress will try to find next page before it tries to find the CPT single page.\n\nFor more info about `add_rewrite_rule` check out the official documentation [https://developer.wordpress.org/reference/functions/add_rewrite_rule/](https://developer.wordpress.org/reference/functions/add_rewrite_rule/).\n\n## Restricting selected slugs in Wordpress\n\nSometimes, especially when you start messing with the default URL structure there might be a necessity of restricting some slugs. Here is an example which will show how to prevent Post slug collisions with the existing Categories slugs `functions.php`:\n\n```php\n// functions.php\n// Prevent category - post slug collisions\n// Restrict selected slugs for posts\nadd_filter( 'wp_unique_post_slug', function( $slug, $post_ID, $post_status, $post_type ) {\n  if ( 'post' == $post_type ) {\n    $categories = get_categories();\n    $categories = array_map(function($c) { return $c->slug; }, $categories);\n\n    if ( in_array($slug, $categories) ) {\n      return $slug . '-' . $post_ID;\n    }\n  }\n  return $slug;\n}, 10, 4 );\n```\n\nThis code will append `-[post_ID]` to the end of the Post slug if it happens to be same as on of the slugs for existing categories.\n\nAll examples are written for PHP >= 5.4.\n\n## Issues\n\nProblems with pagination, rewrite rules and generally URL structure.\n\n1. Don't name query variable same as existing taxonomy slug. So if you have taxonomy with slug `company` avoid using `?company=xyz` as a query variable.\n2. If you want to change number of `posts_per_page` on default Wordpress post list page you should change this number not only in `query_args` array but also in Wordpress settings. In other case (if you change just `query_args`) you will get into troubles with pagination.\n","excerpt":"If you are making larger Wordpress site at some point you will definitely come across custom rewrite rules configuration. The tools (pluginsâ€¦","frontmatter":{"title":"Wordpress rewrite rules and pagination","slug":"wordpress-rewrite-rules","date":"2017-07-17T16:54:23.000Z","tags":["wordpress"],"date_created":"2017-07-15T15:13:43.000Z","date_updated":"2017-08-30T02:21:57.000Z","author":"jan","feature_image":null}}},{"node":{"id":"b212dc3a-21d2-5a8b-a0c1-6dc1e813cf24","html":"<p>If you use Meteor you have to come across the <a href=\"https://github.com/aldeed/node-simple-schema\">node-simple-schema</a> formerly known as <code class=\"language-text\">meteor-simple-schema</code>. This is definitely a great package which eases data validation a lot by allowing you to define some schema for your MongoDB (which is schema-less DB).\nWhereas creating a schema for your custom data type is easy (just follow the <code class=\"language-text\">node-simple-schema</code> docs), integration with external packages may require some knowledge. As an example I will describe the process of writing a basic schema for the Accounts Meteor functionality and the <a href=\"https://docs.meteor.com/api/passwords.html\">accounts-password</a> package.</p>\n<h2>Educated guesses</h2>\n<p>There is no official documentation about Meteor Accounts and <code class=\"language-text\">node-simple-schema</code> integration, so (probably) the only way is to make some educated guesses about the internal structure of <code class=\"language-text\">Meteor.users</code> collection. The first place to look at is <a href=\"http://docs.meteor.com/api/accounts.html#Meteor-users\">http://docs.meteor.com/api/accounts.html#Meteor-users</a> (here is the relevant code):</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  _id<span class=\"token punctuation\">:</span> <span class=\"token string\">'QwkSmTCZiw5KDx3L6'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// Meteor.userId()</span>\n  username<span class=\"token punctuation\">:</span> <span class=\"token string\">'cool_kid_13'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Unique name</span>\n  emails<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// Each email address can only belong to one user.</span>\n    <span class=\"token punctuation\">{</span> address<span class=\"token punctuation\">:</span> <span class=\"token string\">'cool@example.com'</span><span class=\"token punctuation\">,</span> verified<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> address<span class=\"token punctuation\">:</span> <span class=\"token string\">'another@different.com'</span><span class=\"token punctuation\">,</span> verified<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  createdAt<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Wed Aug 21 2013 15:16:52 GMT-0700 (PDT)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  profile<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// The profile is writable by the user by default.</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Joe Schmoe'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  services<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    facebook<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      id<span class=\"token punctuation\">:</span> <span class=\"token string\">'709050'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Facebook ID</span>\n      accessToken<span class=\"token punctuation\">:</span> <span class=\"token string\">'AAACCgdX7G2...AbV9AZDZD'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    resume<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      loginTokens<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span> token<span class=\"token punctuation\">:</span> <span class=\"token string\">'97e8c205-c7e4-47c9-9bea-8e2ccc0694cd'</span><span class=\"token punctuation\">,</span>\n          when<span class=\"token punctuation\">:</span> <span class=\"token number\">1349761684048</span> <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>After reading this short example you may have a general idea about the structure of data stored inside <code class=\"language-text\">users</code> collection. Based on that knowledge let's write some <code class=\"language-text\">SimpleSchema</code> related code:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> SimpleSchema <span class=\"token keyword\">from</span> <span class=\"token string\">'simpl-schema'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Tracker <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'meteor/tracker'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> User <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleSchema</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  username<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> String<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Username\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  services<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> Object<span class=\"token punctuation\">,</span> blackbox<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  emails<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> Array<span class=\"token punctuation\">,</span> optional<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  createdAt<span class=\"token punctuation\">:</span> Date<span class=\"token punctuation\">,</span>\n  profile<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> Object<span class=\"token punctuation\">,</span> blackbox<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> optional<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> tracker<span class=\"token punctuation\">:</span> Tracker <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> User <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>This seems to be the minimal working schema example for the Meteor <code class=\"language-text\">users</code> collection. As far as I know the <code class=\"language-text\">_id</code> field doesn't require to be defined inside SimpleSchema.</p>\n<h2>Adding accounts-password validation</h2>\n<p>If you are using <code class=\"language-text\">accounts-password</code> package (like I do) you may also specify the exact <code class=\"language-text\">services.password</code> keys for password type validation. Here is how it may look:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> SimpleSchema <span class=\"token keyword\">from</span> <span class=\"token string\">'simpl-schema'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Tracker <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'meteor/tracker'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> User <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleSchema</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  username<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> String<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Username\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  services<span class=\"token punctuation\">:</span> Object<span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'services.password'</span><span class=\"token punctuation\">:</span> Object<span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'services.password.bcrypt'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> String<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Password\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'services.resume'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> Object<span class=\"token punctuation\">,</span> blackbox<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> optional<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  emails<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> Array<span class=\"token punctuation\">,</span> optional<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  createdAt<span class=\"token punctuation\">:</span> Date<span class=\"token punctuation\">,</span>\n  profile<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> Object<span class=\"token punctuation\">,</span> blackbox<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> optional<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> tracker<span class=\"token punctuation\">:</span> Tracker <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> User <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The above example assumes that you are using only <code class=\"language-text\">password</code> package for other packages (e.g. <code class=\"language-text\">accounts-facebook</code>) you will have to specify correct <code class=\"language-text\">services.[package-name]</code> keys (e.g. <code class=\"language-text\">services.facebook.id</code>, <code class=\"language-text\">services.facebook.accessToken</code>).\nAnother thing worth noting is the <code class=\"language-text\">services.resume</code> key which is required in order to login user properly, because the data about existing sessions is stored inside <code class=\"language-text\">resume</code> object.</p>\n<p>In order to check if your schema works correctly you may execute a command like:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">Accounts<span class=\"token punctuation\">.</span><span class=\"token function\">createUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> password<span class=\"token punctuation\">:</span> <span class=\"token string\">'some_password'</span><span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">:</span> <span class=\"token string\">'test123'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>From the Meteor interactive shell, you can open it when the meteor server is running with <code class=\"language-text\">meteor shell</code> command.</p>\n<h2>Conclusion</h2>\n<p>It's fairly easy to validate existing/external package data with <code class=\"language-text\">node-simple-schema</code> if only you know the internal structure of the validated data. If you are adding the validation to the existing app you may find it useful to check the database first with <code class=\"language-text\">meteor mongo</code> and <code class=\"language-text\">db.[your_collection].find()</code> to ensure that the collection structure matches your expectations.</p>","timeToRead":3,"rawMarkdownBody":"If you use Meteor you have to come across the [node-simple-schema](https://github.com/aldeed/node-simple-schema) formerly known as `meteor-simple-schema`. This is definitely a great package which eases data validation a lot by allowing you to define some schema for your MongoDB (which is schema-less DB).\nWhereas creating a schema for your custom data type is easy (just follow the `node-simple-schema` docs), integration with external packages may require some knowledge. As an example I will describe the process of writing a basic schema for the Accounts Meteor functionality and the [accounts-password](https://docs.meteor.com/api/passwords.html) package.\n\n## Educated guesses\n\nThere is no official documentation about Meteor Accounts and `node-simple-schema` integration, so (probably) the only way is to make some educated guesses about the internal structure of `Meteor.users` collection. The first place to look at is http://docs.meteor.com/api/accounts.html#Meteor-users (here is the relevant code):\n\n```javascript\n{\n  _id: 'QwkSmTCZiw5KDx3L6',  // Meteor.userId()\n  username: 'cool_kid_13', // Unique name\n  emails: [\n    // Each email address can only belong to one user.\n    { address: 'cool@example.com', verified: true },\n    { address: 'another@different.com', verified: false }\n  ],\n  createdAt: new Date('Wed Aug 21 2013 15:16:52 GMT-0700 (PDT)'),\n  profile: {\n    // The profile is writable by the user by default.\n    name: 'Joe Schmoe'\n  },\n  services: {\n    facebook: {\n      id: '709050', // Facebook ID\n      accessToken: 'AAACCgdX7G2...AbV9AZDZD'\n    },\n    resume: {\n      loginTokens: [\n        { token: '97e8c205-c7e4-47c9-9bea-8e2ccc0694cd',\n          when: 1349761684048 }\n      ]\n    }\n  }\n}\n```\n\nAfter reading this short example you may have a general idea about the structure of data stored inside `users` collection. Based on that knowledge let's write some `SimpleSchema` related code:\n\n```javascript\nimport SimpleSchema from 'simpl-schema';\nimport { Tracker } from 'meteor/tracker';\n\nconst User = new SimpleSchema({\n  username: { type: String, label: \"Username\" },\n  services: { type: Object, blackbox: true },\n  emails: { type: Array, optional: true },\n  createdAt: Date,\n  profile: { type: Object, blackbox: true, optional: true },\n}, { tracker: Tracker });\n\nexport { User };\n```\n\nThis seems to be the minimal working schema example for the Meteor `users` collection. As far as I know the `_id` field doesn't require to be defined inside SimpleSchema.\n\n## Adding accounts-password validation\n\nIf you are using `accounts-password` package (like I do) you may also specify the exact `services.password` keys for password type validation. Here is how it may look:\n\n```javascript\nimport SimpleSchema from 'simpl-schema';\nimport { Tracker } from 'meteor/tracker';\n\nconst User = new SimpleSchema({\n  username: { type: String, label: \"Username\" },\n  services: Object,\n  'services.password': Object,\n  'services.password.bcrypt': { type: String, label: \"Password\" },\n  'services.resume': { type: Object, blackbox: true, optional: true },\n  emails: { type: Array, optional: true },\n  createdAt: Date,\n  profile: { type: Object, blackbox: true, optional: true },\n}, { tracker: Tracker });\n\nexport { User };\n```\n\nThe above example assumes that you are using only `password` package for other packages (e.g. `accounts-facebook`) you will have to specify correct `services.[package-name]` keys (e.g. `services.facebook.id`, `services.facebook.accessToken`).\nAnother thing worth noting is the `services.resume` key which is required in order to login user properly, because the data about existing sessions is stored inside `resume` object.\n\nIn order to check if your schema works correctly you may execute a command like:\n```javascript\nAccounts.createUser({ password: 'some_password', username: 'test123' })\n```\nFrom the Meteor interactive shell, you can open it when the meteor server is running with `meteor shell` command.\n\n## Conclusion\n\nIt's fairly easy to validate existing/external package data with `node-simple-schema` if only you know the internal structure of the validated data. If you are adding the validation to the existing app you may find it useful to check the database first with `meteor mongo` and `db.[your_collection].find()` to ensure that the collection structure matches your expectations.\n","excerpt":"If you use Meteor you have to come across the node-simple-schema formerly known as . This is definitely a great package which eases dataâ€¦","frontmatter":{"title":"Meteor node-simple-schema and Meteor.users collection","slug":"meteor-node-simple-schema-and-meteor-users-collection","date":"2017-07-14T15:41:45.000Z","tags":["meteor"],"date_created":"2017-07-14T15:00:18.000Z","date_updated":"2017-07-14T15:48:52.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/pexels-photo-30257.jpg","relativePath":"posts/img/pexels-photo-30257.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAACAf/aAAwDAQACEAMQAAABRopKeguQ/wD/xAAaEAADAAMBAAAAAAAAAAAAAAAAAQIDERMS/9oACAEBAAEFAnhZxo8CqjpZtn//xAAXEQEAAwAAAAAAAAAAAAAAAAAAAREh/9oACAEDAQE/Abhj/8QAFhEBAQEAAAAAAAAAAAAAAAAAABES/9oACAECAQE/AdK//8QAGRAAAgMBAAAAAAAAAAAAAAAAADEBEDKR/9oACAEBAAY/AkKtSanoz//EABsQAQACAgMAAAAAAAAAAAAAAAEAIRAxQYGR/9oACAEBAAE/IadogbxQwTQd4Mpy9n//2gAMAwEAAgADAAAAEBD/AP/EABcRAAMBAAAAAAAAAAAAAAAAAAARQVH/2gAIAQMBAT8QbB4P/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAERQXH/2gAIAQIBAT8Qk6MH/8QAHBABAQEAAQUAAAAAAAAAAAAAAREAYSFBUXHR/9oACAEBAAE/EBA6k7GuGPmaYTH30TwrGby+5SqvK3//2Q==","aspectRatio":2,"src":"/static/ded1ba9ed1686c5cfe854b1b68d9b14b/0defe/pexels-photo-30257.jpg","srcSet":"/static/ded1ba9ed1686c5cfe854b1b68d9b14b/38b6a/pexels-photo-30257.jpg 150w,\n/static/ded1ba9ed1686c5cfe854b1b68d9b14b/e201c/pexels-photo-30257.jpg 300w,\n/static/ded1ba9ed1686c5cfe854b1b68d9b14b/0defe/pexels-photo-30257.jpg 600w,\n/static/ded1ba9ed1686c5cfe854b1b68d9b14b/a71f1/pexels-photo-30257.jpg 900w,\n/static/ded1ba9ed1686c5cfe854b1b68d9b14b/9f6c3/pexels-photo-30257.jpg 1200w,\n/static/ded1ba9ed1686c5cfe854b1b68d9b14b/e95fb/pexels-photo-30257.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"0965ca1b-2faf-59b0-a24e-ddf4fe81c1e3","html":"<p>Docker is a great tool but unfortunately when you have a separate container for each web project you may start having issues with the debugger path mappings. In this short article, I will describe how to setup Vdebug which is a Vim DBGP debugger to work with multiple Docker containers. I'm not sure but maybe it will be also somehow useful for other debuggers/setups.</p>\n<p>The solution described below assumes that you have a <code class=\"language-text\">docker-compose.yml</code> file in the directory which is mapped as your web root folder in the Docker container. If you don't have such configuration you may place e.g. empty <code class=\"language-text\">.projectroot</code> file but it will be less convenient as it will require remembering about this additional step.</p>\n<h2>Docker with Vdebug</h2>\n<p>When you use Docker each project has same web server root path which is something like <code class=\"language-text\">/app</code> or <code class=\"language-text\">/var/www</code> or something similar. In my case, it is <code class=\"language-text\">/app</code> for every container I've run via Docker.</p>\n<p>This is a problem for the debugger because it doesn't know how to map remote file paths to your local file system during the debug process. If you are using Vim with Vdebug you may setup a custom <code class=\"language-text\">path_maps</code> option, but it is impossible to map multiple local paths to one remote path <code class=\"language-text\">/app</code> (which is the case with a Docker containers) e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"vim\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-vim line-numbers\"><code class=\"language-vim\"><span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vdebug_options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'path_maps'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'/app'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/Users/username/projects/myproject1'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'/app'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/Users/username/projects/myproject2'</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>This problem is described here on the <a href=\"https://github.com/joonty/vdebug/issues/197\">Github issue</a>.</p>\n<p>As for now, the only solution seems to be changing the paths mapping during the start of the Vim editor. In order to achieve full automation of this process, you will have to install another Vim plugin which is <a href=\"https://github.com/dbakker/vim-projectroot\">vim-projectroot</a>.</p>\n<p>After a <strong>vim-projectroot</strong> installation put the following line inside your <code class=\"language-text\">.vimrc</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"vim\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-vim line-numbers\"><code class=\"language-vim\"><span class=\"token comment\">\" PROJECTROOT</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>rootmarkers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'.projectroot'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'docker-compose.yml'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.git'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.hg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.svn'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.bzr'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'_darcs'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'build.xml'</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>This way your project root will be automatically discovered by your <code class=\"language-text\">docker-compose.yml</code> file location (or any other file on the list).</p>\n<p>Now it's time to setup the automatic Vdebug <code class=\"language-text\">path_maps</code>. In your <code class=\"language-text\">.vimrc</code> add following lines:</p>\n<div class=\"gatsby-highlight\" data-language=\"vim\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-vim line-numbers\"><code class=\"language-vim\"><span class=\"token keyword\">function</span><span class=\"token operator\">!</span> <span class=\"token function\">SetupDebug</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vdebug_options<span class=\"token punctuation\">[</span><span class=\"token string\">'path_maps'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'/app'</span><span class=\"token punctuation\">:</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token string\">'projectroot#get'</span><span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">:</span><span class=\"token number\">000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">\" Hack to override vdebug options</span>\n  <span class=\"token keyword\">source</span> ~<span class=\"token operator\">/</span><span class=\"token operator\">.</span><span class=\"token keyword\">vim</span><span class=\"token operator\">/</span>bundle<span class=\"token operator\">/</span>vdebug<span class=\"token operator\">/</span>plugin<span class=\"token operator\">/</span>vdebug<span class=\"token operator\">.</span><span class=\"token keyword\">vim</span>\n<span class=\"token keyword\">endfunction</span>\n<span class=\"token builtin\">autocmd</span> VimEnter <span class=\"token operator\">*</span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token function\">SetupDebug</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>A short description of the code above.\nIt will execute <code class=\"language-text\">SetupDebug()</code> function each time you open a Vim editor (check the <a href=\"http://vimdoc.sourceforge.net/htmldoc/autocmd.html\">VimEnter event</a>). Thanks to the installed <strong>vim-projectroot</strong> plugin the editor can \"guess\" what is your current project root path and adjust <code class=\"language-text\">vdebug_options</code> accordingly.\nThe example above assumes that your Docker container web server points at <code class=\"language-text\">/app</code> folder and that you have a <code class=\"language-text\">docker-compose.yml</code> file in your local filesystem application root folder.</p>\n<p>Now each time you open a new Vim editor it will reassign <code class=\"language-text\">path_maps</code> option to match your current project root with the Docker web server root.</p>\n<h2>Example</h2>\n<p>Provided that your <code class=\"language-text\">docker-compose.yml</code> file is inside <code class=\"language-text\">/Users/username/projects/myproject</code> folder and your Docker container maps this folder to the <code class=\"language-text\">/app</code> directory e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-docker line-numbers\"><code class=\"language-docker\">version<span class=\"token punctuation\">:</span> <span class=\"token string\">'2'</span>\nservices<span class=\"token punctuation\">:</span>\n  your_container_name<span class=\"token punctuation\">:</span>\n    volumes<span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> $PWD<span class=\"token punctuation\">:</span>/app</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>When you start the Vim in any of the <code class=\"language-text\">/Users/username/projects/myproject</code> subdirectories your <code class=\"language-text\">path_maps</code> will become:</p>\n<div class=\"gatsby-highlight\" data-language=\"vim\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-vim line-numbers\"><code class=\"language-vim\"><span class=\"token string\">'/app'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/Users/username/projects/myproject'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>This should result in correct path mappings inside Vdebug debugger.</p>\n<h2>Hints</h2>\n<p>You may check current Vdebug options values by executing in the Vim command line:</p>\n<div class=\"gatsby-highlight\" data-language=\"vim\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-vim line-numbers\"><code class=\"language-vim\"><span class=\"token punctuation\">:</span>echo g<span class=\"token punctuation\">:</span>vdebug_options</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>If you are having some more troubles with the Docker + Vdebug setup feel free to leave a comment below.</p>","timeToRead":3,"rawMarkdownBody":"Docker is a great tool but unfortunately when you have a separate container for each web project you may start having issues with the debugger path mappings. In this short article, I will describe how to setup Vdebug which is a Vim DBGP debugger to work with multiple Docker containers. I'm not sure but maybe it will be also somehow useful for other debuggers/setups.\n\nThe solution described below assumes that you have a `docker-compose.yml` file in the directory which is mapped as your web root folder in the Docker container. If you don't have such configuration you may place e.g. empty `.projectroot` file but it will be less convenient as it will require remembering about this additional step.\n\n## Docker with Vdebug\n\nWhen you use Docker each project has same web server root path which is something like `/app` or `/var/www` or something similar. In my case, it is `/app` for every container I've run via Docker.\n\nThis is a problem for the debugger because it doesn't know how to map remote file paths to your local file system during the debug process. If you are using Vim with Vdebug you may setup a custom `path_maps` option, but it is impossible to map multiple local paths to one remote path `/app` (which is the case with a Docker containers) e.g.\n\n```vim\nlet g:vdebug_options = {\n  'path_maps': {\n    '/app': '/Users/username/projects/myproject1',\n    '/app': '/Users/username/projects/myproject2'\n  }\n}\n```\n\nThis problem is described here on the [Github issue](https://github.com/joonty/vdebug/issues/197).\n\nAs for now, the only solution seems to be changing the paths mapping during the start of the Vim editor. In order to achieve full automation of this process, you will have to install another Vim plugin which is [vim-projectroot](https://github.com/dbakker/vim-projectroot).\n\nAfter a **vim-projectroot** installation put the following line inside your `.vimrc` file:\n\n```vim\n\" PROJECTROOT\nlet g:rootmarkers = ['.projectroot', 'docker-compose.yml', '.git', '.hg', '.svn', '.bzr','_darcs','build.xml']\n```\n\nThis way your project root will be automatically discovered by your `docker-compose.yml` file location (or any other file on the list).\n\nNow it's time to setup the automatic Vdebug `path_maps`. In your `.vimrc` add following lines:\n```vim\nfunction! SetupDebug()\n  let g:vdebug_options['path_maps'] = {'/app': call('projectroot#get', a:000)}\n  \" Hack to override vdebug options\n  source ~/.vim/bundle/vdebug/plugin/vdebug.vim\nendfunction\nautocmd VimEnter * :call SetupDebug()\n```\n\nA short description of the code above.\nIt will execute `SetupDebug()` function each time you open a Vim editor (check the [VimEnter event](http://vimdoc.sourceforge.net/htmldoc/autocmd.html)). Thanks to the installed **vim-projectroot** plugin the editor can \"guess\" what is your current project root path and adjust `vdebug_options` accordingly.\nThe example above assumes that your Docker container web server points at `/app` folder and that you have a `docker-compose.yml` file in your local filesystem application root folder.\n\nNow each time you open a new Vim editor it will reassign `path_maps` option to match your current project root with the Docker web server root.\n\n## Example\n\nProvided that your `docker-compose.yml` file is inside `/Users/username/projects/myproject` folder and your Docker container maps this folder to the `/app` directory e.g.\n```docker\nversion: '2'\nservices:\n  your_container_name:\n    volumes:\n      - $PWD:/app\n```\nWhen you start the Vim in any of the `/Users/username/projects/myproject` subdirectories your `path_maps` will become:\n```vim\n'/app': '/Users/username/projects/myproject'\n```\nThis should result in correct path mappings inside Vdebug debugger.\n\n## Hints\n\nYou may check current Vdebug options values by executing in the Vim command line:\n```vim\n:echo g:vdebug_options\n```\n\nIf you are having some more troubles with the Docker + Vdebug setup feel free to leave a comment below.\n","excerpt":"Docker is a great tool but unfortunately when you have a separate container for each web project you may start having issues with theâ€¦","frontmatter":{"title":"Docker and Vdebug for PHP debugging","slug":"docker-and-vdebug-for-php-debugging","date":"2017-06-17T17:05:00.000Z","tags":["vim","tools"],"date_created":"2017-06-17T17:05:16.000Z","date_updated":"2017-06-22T12:13:11.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/docker-vdebug-php.jpg","relativePath":"posts/img/docker-vdebug-php.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAQX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHmMm0qEB//xAAYEAADAQEAAAAAAAAAAAAAAAAAAREQEv/aAAgBAQABBQJFylOmf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAQEBAAMAAAAAAAAAAAAAAAABEUFhgf/aAAgBAQABPyGrOE28aSnY/9oADAMBAAIAAwAAABDo7//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAwEBAAAAAAAAAAAAAAEAESFBYTFx/9oACAEBAAE/EN7CbhmHYv8AW/sBkoTkKY//2Q==","aspectRatio":2,"src":"/static/e290ab098016c57b70497edcee4bbdf2/0defe/docker-vdebug-php.jpg","srcSet":"/static/e290ab098016c57b70497edcee4bbdf2/38b6a/docker-vdebug-php.jpg 150w,\n/static/e290ab098016c57b70497edcee4bbdf2/e201c/docker-vdebug-php.jpg 300w,\n/static/e290ab098016c57b70497edcee4bbdf2/0defe/docker-vdebug-php.jpg 600w,\n/static/e290ab098016c57b70497edcee4bbdf2/a71f1/docker-vdebug-php.jpg 900w,\n/static/e290ab098016c57b70497edcee4bbdf2/9f6c3/docker-vdebug-php.jpg 1200w,\n/static/e290ab098016c57b70497edcee4bbdf2/818dd/docker-vdebug-php.jpg 1281w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"27c12608-1b30-55cc-9ab7-ab38ec05c7a7","html":"<p>Here is a list of popular pages which offers free images. By free images I mean <a href=\"https://creativecommons.org/share-your-work/public-domain/cc0/\">CC0</a> (or similar) licensed pictures which may be used (and modified) for commercial projects without any attribution related restrictions.\nI decided to list only those services which have some kind of search available because without that feature it's nearly impossible to find something that you want.</p>\n<h2>The free image sources list</h2>\n<ul>\n<li><a href=\"https://unsplash.com/\">https://unsplash.com/</a></li>\n<li><a href=\"https://www.pexels.com/\">https://www.pexels.com/</a></li>\n<li><a href=\"http://www.publicdomainpictures.net/\">http://www.publicdomainpictures.net/</a></li>\n</ul>","timeToRead":1,"rawMarkdownBody":"Here is a list of popular pages which offers free images. By free images I mean [CC0](https://creativecommons.org/share-your-work/public-domain/cc0/) (or similar) licensed pictures which may be used (and modified) for commercial projects without any attribution related restrictions.\nI decided to list only those services which have some kind of search available because without that feature it's nearly impossible to find something that you want.\n\n## The free image sources list\n\n- https://unsplash.com/\n- https://www.pexels.com/\n- http://www.publicdomainpictures.net/\n\n","excerpt":"Here is a list of popular pages which offers free images. By free images I mean CC0 (or similar) licensed pictures which may be used (andâ€¦","frontmatter":{"title":"Free image sources for commercial and non-commercial use","slug":"free-image-sources","date":"2017-06-11T12:00:33.000Z","tags":["tools","frontend"],"date_created":"2017-06-11T11:49:28.000Z","date_updated":"2017-06-11T12:40:34.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/pexels-photo-297977.jpeg","relativePath":"posts/img/pexels-photo-297977.jpeg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAACBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAE7uDstMKT/xAAaEAEAAgMBAAAAAAAAAAAAAAABAAIDEBIh/9oACAEBAAEFAsTLAlvEZ3bX/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8Bqv/EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/Aar/xAAYEAACAwAAAAAAAAAAAAAAAAAQMQABof/aAAgBAQAGPwJR4XY//8QAGhABAQEBAAMAAAAAAAAAAAAAAQARMSGhsf/aAAgBAQABPyFOvpeONZhTSY5KZ9pdb//aAAwDAQACAAMAAAAQWC//xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QDkf/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8QtNP/xAAaEAEBAQEAAwAAAAAAAAAAAAABEQAxIUFx/9oACAEBAAE/EEFEGMrWrQ4MjggRO4GpPjMw3wL76wpV6u//2Q==","aspectRatio":2,"src":"/static/1fd12a79df57531454d29417b9762f36/0defe/pexels-photo-297977.jpg","srcSet":"/static/1fd12a79df57531454d29417b9762f36/38b6a/pexels-photo-297977.jpg 150w,\n/static/1fd12a79df57531454d29417b9762f36/e201c/pexels-photo-297977.jpg 300w,\n/static/1fd12a79df57531454d29417b9762f36/0defe/pexels-photo-297977.jpg 600w,\n/static/1fd12a79df57531454d29417b9762f36/a71f1/pexels-photo-297977.jpg 900w,\n/static/1fd12a79df57531454d29417b9762f36/9f6c3/pexels-photo-297977.jpg 1200w,\n/static/1fd12a79df57531454d29417b9762f36/e95fb/pexels-photo-297977.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"29adc514-9b5b-54ac-bf55-476941335cbf","html":"<p>Writing and using custom Capistrano tasks is very easy and automating your deployment process may save you a lot of time and troubles. Here is a brief description of the creation process with a simple example at the end.</p>\n<h2>Define your custom Capistrano tasks</h2>\n<p>The best place to store your custom tasks is the default <code class=\"language-text\">lib/capistrano/tasks/</code> directory where each task should have its own file. Task filename doesn't matter because by default Capistrano loads all files from the <code class=\"language-text\">lib/capistrano/tasks/</code> directory.</p>\n<blockquote>\n<p>Loading custom tasks should be handled by the default <code class=\"language-text\">Capfile</code> in the last line:</p>\n</blockquote>\n<blockquote>\n<p><code class=\"language-text\">Dir.glob(&quot;lib/capistrano/tasks/*.rake&quot;).each { |r| import r }</code></p>\n</blockquote>\n<p>As you may noticed the task files should have a <code class=\"language-text\">.rake</code> extension (<strong>not</strong> <code class=\"language-text\">.rb</code>).</p>\n<h2>Use your custom task in deployment process</h2>\n<p>After defining the task you may use it as a standalone Capistrano command e.g.</p>\n<p><em>run from console</em></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">cap staging git:push</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>or add it to the deployment flow e.g.</p>\n<p><em>config/deploy.rb</em></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">before <span class=\"token symbol\">:deploy</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'git:push'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>If you want to extend your deployment flow you should check the official Capistrano docs about <a href=\"http://capistranorb.com/documentation/getting-started/flow/\">the Flow</a> where you can find detailed description of available hooks. Each hook may be used with <code class=\"language-text\">before</code> or <code class=\"language-text\">after</code> keyword.</p>\n<h2>Example Capistrano custom task: git push</h2>\n<p>This will be an example of a custom Capistrano task which will push your latest commits to the remote Git repository before the Capistrano deployment. In order to make it work properly, you should setup the <code class=\"language-text\">git remote origin</code> (which you probably have if you use the Capistrano).</p>\n<h3>Create the task file</h3>\n<p>As I mentioned earlier it might be named as you wish, but I would suggest giving meaningful names to ease the maintenance. A filename which is the same as the namespace seems to be a fine idea.</p>\n<p><em>lib/capistrano/tasks/git.rake</em></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">namespace <span class=\"token symbol\">:git</span> <span class=\"token keyword\">do</span>\n  desc <span class=\"token string\">'Pushing new commits to the remote repository'</span>\n  task <span class=\"token symbol\">:push</span> <span class=\"token keyword\">do</span>\n    on roles<span class=\"token punctuation\">(</span><span class=\"token symbol\">:all</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n      run_locally <span class=\"token keyword\">do</span>\n        execute <span class=\"token string\">\"git push\"</span>\n      <span class=\"token keyword\">end</span>\n    <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Instructions used in this example:</p>\n<ul>\n<li><strong>namespace</strong> - will be used for referencing the task (<code class=\"language-text\">:git</code> is probably not the best choice as it may collide with some existing namespace)</li>\n<li><strong>desc</strong> - is the task description which will be displayed after executing <code class=\"language-text\">cap -T</code></li>\n<li><strong>task</strong> - name of the task</li>\n<li><strong>roles</strong> - used for limiting the execution only to the given <strong>roles</strong> (check the <a href=\"http://capistranorb.com/documentation/advanced-features/role-filtering/\">role filtering</a>)</li>\n<li><strong>run_locally</strong> - forces local execution, without that block the command defined after <strong>execute</strong> will be executed remotely on the deployment server</li>\n<li><strong>execute</strong> - execute given command \"from the console\"</li>\n</ul>\n<h3>Add task to your deployment flow</h3>\n<p>Append the following line to your <em>config/deploy.rb</em> file:</p>\n<p><em>run from console</em></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">before <span class=\"token symbol\">:deploy</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'git:push'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>Test the custom Capistrano task</h3>\n<p>In order to test your task, you may execute new command directly from the console. In this case it would be:</p>\n<p><em>run from console</em></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">cap staging git:push</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where <strong>staging</strong> is your environment name, which of course doesn't matter in that example, but may be important for other tasks e.g. if the task restarts your app.</p>\n<p>Finally try to start your deployment process with a regular command.</p>\n<p><em>run from console</em></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">cap staging deploy</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>You should see the following message at the beginning of your deploy log output:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 834px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dc2737d530501f787bbab915a173bd42/50412/capistrano_custom_deployment_task.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.26139088729017%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAwUlEQVQY042QWbaEIAxEXY4ydKOgBAXCoNDt/hfU+NjAq498VO6pDMN1ZutRrEbBruBgnDP6Xw2UEq0B3Z7dEg5Zg5QzJ4Qy9oS0yjnv6J/zhPcuZ2wYx1Fv2ltrj72cuV5njME7l2K8rhMRnXOIPqem6KytpaD3jVFKDtM0gdEGYCKkWff9rbXobY0p3N9P44yBT60BvZSyYaW0Q5MQ72ft98xtmNX6Aid8Xo6w7Di3ClYAbDk98zva1X9C2uqU/gBkkT69Fh7keAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Capistrano custom deployment task\"\n        title=\"Capistrano custom deployment task\"\n        src=\"/static/dc2737d530501f787bbab915a173bd42/50412/capistrano_custom_deployment_task.png\"\n        srcset=\"/static/dc2737d530501f787bbab915a173bd42/a1986/capistrano_custom_deployment_task.png 210w,\n/static/dc2737d530501f787bbab915a173bd42/ad7fb/capistrano_custom_deployment_task.png 420w,\n/static/dc2737d530501f787bbab915a173bd42/50412/capistrano_custom_deployment_task.png 834w\"\n        sizes=\"(max-width: 834px) 100vw, 834px\"\n      />\n  </a>\n    </span></p>\n<p>Which means that your remote git repository was updated before starting any other Capistrano deployment related operations (which is generally a useful feature).</p>\n<p>For more info check the <a href=\"http://capistranorb.com/\">Official Capistrano docs</a>.</p>","timeToRead":3,"rawMarkdownBody":"Writing and using custom Capistrano tasks is very easy and automating your deployment process may save you a lot of time and troubles. Here is a brief description of the creation process with a simple example at the end.\n\n## Define your custom Capistrano tasks\n\nThe best place to store your custom tasks is the default `lib/capistrano/tasks/` directory where each task should have its own file. Task filename doesn't matter because by default Capistrano loads all files from the `lib/capistrano/tasks/` directory.\n\n> Loading custom tasks should be handled by the default `Capfile` in the last line:\n\n>`Dir.glob(\"lib/capistrano/tasks/*.rake\").each { |r| import r }`\n\nAs you may noticed the task files should have a `.rake` extension (**not** `.rb`).\n\n## Use your custom task in deployment process\n\nAfter defining the task you may use it as a standalone Capistrano command e.g.\n\n*run from console*\n```bash\ncap staging git:push\n```\nor add it to the deployment flow e.g.\n\n*config/deploy.rb*\n```ruby\nbefore :deploy, 'git:push'\n```\nIf you want to extend your deployment flow you should check the official Capistrano docs about [the Flow](http://capistranorb.com/documentation/getting-started/flow/) where you can find detailed description of available hooks. Each hook may be used with `before` or `after` keyword.\n\n## Example Capistrano custom task: git push\nThis will be an example of a custom Capistrano task which will push your latest commits to the remote Git repository before the Capistrano deployment. In order to make it work properly, you should setup the `git remote origin` (which you probably have if you use the Capistrano).\n\n### Create the task file\nAs I mentioned earlier it might be named as you wish, but I would suggest giving meaningful names to ease the maintenance. A filename which is the same as the namespace seems to be a fine idea.\n\n*lib/capistrano/tasks/git.rake*\n```ruby\nnamespace :git do\n  desc 'Pushing new commits to the remote repository'\n  task :push do\n    on roles(:all) do\n      run_locally do\n        execute \"git push\"\n      end\n    end\n  end\nend\n```\n\nInstructions used in this example:\n\n- **namespace** - will be used for referencing the task (`:git` is probably not the best choice as it may collide with some existing namespace)\n- **desc** - is the task description which will be displayed after executing `cap -T`\n- **task** - name of the task\n- **roles** - used for limiting the execution only to the given **roles** (check the [role filtering](http://capistranorb.com/documentation/advanced-features/role-filtering/))\n- **run_locally** - forces local execution, without that block the command defined after **execute** will be executed remotely on the deployment server\n- **execute** - execute given command \"from the console\"\n\n### Add task to your deployment flow\nAppend the following line to your *config/deploy.rb* file:\n\n*run from console*\n```ruby\nbefore :deploy, 'git:push'\n```\n\n### Test the custom Capistrano task\nIn order to test your task, you may execute new command directly from the console. In this case it would be:\n\n*run from console*\n```bash\ncap staging git:push\n```\n\nWhere **staging** is your environment name, which of course doesn't matter in that example, but may be important for other tasks e.g. if the task restarts your app.\n\nFinally try to start your deployment process with a regular command.\n\n*run from console*\n```bash\ncap staging deploy\n```\n\nYou should see the following message at the beginning of your deploy log output:\n\n![Capistrano custom deployment task](img/capistrano_custom_deployment_task.png)\n\nWhich means that your remote git repository was updated before starting any other Capistrano deployment related operations (which is generally a useful feature).\n\n\nFor more info check the [Official Capistrano docs](http://capistranorb.com/).\n","excerpt":"Writing and using custom Capistrano tasks is very easy and automating your deployment process may save you a lot of time and troubles. Hereâ€¦","frontmatter":{"title":"Ruby on Rails custom Capistrano tasks","slug":"ruby-on-rails-custom-capistrano-tasks","date":"2017-06-10T13:15:00.000Z","tags":["ruby","rails","tools","capistrano"],"date_created":"2017-06-10T13:15:15.000Z","date_updated":"2017-06-10T14:32:58.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/deploy.jpg","relativePath":"posts/img/deploy.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgMF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAebdRiIMyv/EABoQAAICAwAAAAAAAAAAAAAAAAABAhEhMUH/2gAIAQEAAQUCWRooide//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAARAg/9oACAEBAAY/AoC//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAExEWH/2gAIAQEAAT8hdBtOsKNdyx//2gAMAwEAAgADAAAAEK8v/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAEDAQE/EAsL/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EFy1v//EABkQAQEBAQEBAAAAAAAAAAAAAAERACFhMf/aAAgBAQABPxCOQF8wzi3LFEH1zY64k1J8uSst3//Z","aspectRatio":2,"src":"/static/d79ef96498eaf1d8c8d08209e980d3f7/0defe/deploy.jpg","srcSet":"/static/d79ef96498eaf1d8c8d08209e980d3f7/38b6a/deploy.jpg 150w,\n/static/d79ef96498eaf1d8c8d08209e980d3f7/e201c/deploy.jpg 300w,\n/static/d79ef96498eaf1d8c8d08209e980d3f7/0defe/deploy.jpg 600w,\n/static/d79ef96498eaf1d8c8d08209e980d3f7/a71f1/deploy.jpg 900w,\n/static/d79ef96498eaf1d8c8d08209e980d3f7/9f6c3/deploy.jpg 1200w,\n/static/d79ef96498eaf1d8c8d08209e980d3f7/e95fb/deploy.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"7913e2db-b198-50b7-bdf4-17e802afd5dd","html":"<p>After spending a nearly whole day fighting with Xdebug setup I think it is a right moment to write some complete Xdebug guide.</p>\n<p>In this article I will describe the following setup:</p>\n<ul>\n<li>Docker for Mac</li>\n<li>PHP with Xdebug (a Docker container)</li>\n<li>Vim</li>\n<li>vdebug (Vim PHP debugging plugin)</li>\n</ul>\n<p>I think/hope that even if you use a slightly different configuration you may find a couple of useful hints in this text.</p>\n<h2>The Docker container</h2>\n<p>First of all, let's get some Xdebug ready container. I've used <a href=\"https://github.com/webdevops/php-docker-boilerplate\">php-docker-boilerplate</a> by WEBDEVOPS which has some documentation and it is preconfigured to run a PHP server with everything else you may need for a modern web development process.</p>\n<blockquote>\n<p>No matter which Docker container you will use there is <strong>no need to publish/expose</strong> any additional port for Xdebug!</p>\n</blockquote>\n<p><strong>Don't write</strong> something like:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">docker run -p 9000:9000 your_xdebug_server_image</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Why?\nBecause Xdebug (which is running on your container/server) <strong>doesn't</strong> listen on that port, it just sends some data to that port (to your computer on which you are working). So there is no need to publish it, your computer will never try to connect to the Xdebug via 9000 port.</p>\n<p>While not beeing a Xdebug nor DBGP protocol expert I see this architecture/communication as follows:</p>\n<ol>\n<li>You start DBGP session in your debugger (Vim or some IDE like PHPStorm)</li>\n<li>Your local computer starts listening on 9000 port (by default)</li>\n<li>You run PHP script or make a request to a website</li>\n<li>The server tries to connect to your debugger via DBGP protocol</li>\n<li>The server checks a configuration of the Xdebug to find out the connection details</li>\n<li>Based on that configuration The server tries to connect with Your local computer on the given IP and port number</li>\n<li>If The server manages to connect with the debugger (the debugger is listening on given IP and port number) it stops script execution</li>\n<li>Debugger takes the control over code execution</li>\n<li>Depending on user action, debugger sends back some instructions to the Xdebug on the same port on which Xdebug connects with the debugger</li>\n<li>Everything is working as expected</li>\n</ol>\n<h2>The Xdebug configuration</h2>\n<p>Normally you would define the configuration inside <code class=\"language-text\">php.ini</code> file (e.g. <code class=\"language-text\">/etc/php/7.0/fpm/php.ini</code> or similar). But for the container which I am using it is located inside <code class=\"language-text\">./etc/php/development.ini</code> (path relative to the <code class=\"language-text\">docker-compose.yml</code> location). So here is the Xdebug configuration:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">; XDebug\nxdebug.remote_host             = 10.254.254.254\nxdebug.remote_autostart        = 1\nxdebug.remote_enable           = 1\nxdebug.remote_port             = 9000\nxdebug.default_enable          = 1\nxdebug.remote_connect_back     = 0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>It is the configuration specific for the <strong>Docker for Mac</strong>. Normally you may define <code class=\"language-text\">xdebug.remote_connect_back = 1</code>, so the <code class=\"language-text\">xdebug.remote_host</code> is not required (which is much more convenient). Unfortunatelly Docker for Mac (due to OS X limitations) has to have <code class=\"language-text\">xdebug.remote_host</code> defined and the <code class=\"language-text\">remote_connect_back</code> <a href=\"https://forums.docker.com/t/ip-address-for-xdebug/10460\">is not supported</a>.</p>\n<p>What is more OS X limitations forces defining a static <code class=\"language-text\">remote_host</code> IP address and the only way to get such address is creating a loopback address alias with <code class=\"language-text\">ifconfig</code> like so:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">ifconfig</span> lo0 <span class=\"token builtin class-name\">alias</span> <span class=\"token number\">10.254</span>.254.254</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Of course it might be any IP, but be careful to not to shadow some existing server e.g. <code class=\"language-text\">8.8.8.8</code> is a Google DNS. Anyway <code class=\"language-text\">10.254.254.254</code> seems to be a safe bet (widely used across the Docker community) so I would advise you not to change it without any good reason.</p>\n<blockquote>\n<p>For automatic IP setup on each system startup check <a href=\"https://gist.github.com/ralphschindler/535dc5916ccbd06f53c1b0ee5a868c93\">this gist</a></p>\n</blockquote>\n<p>Another important line is <code class=\"language-text\">xdebug.remote_enable = 1</code> which is responsible for Xdebug remote debugging.</p>\n<h2>The debugger configuration</h2>\n<p>In this example I will be configuring <code class=\"language-text\">vdebug</code> Vim plugin (which is a simple DBGP capable debugger), but similar configuration should be available in any other debugger (e.g. PHPStorm).\nFirst of all your debugger should listen / wait for connection on selected port (which is <strong>9000</strong> by default) and secondly it should listen on the interface connected with Docker (or any interface if it is possible).\nIn case of Vim vdebug above considerations are traslated to the:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">let g:vdebug_options = {\n      \\ &#39;port&#39; : 9005,\n      \\ &#39;server&#39; : &#39;&#39;,\n      \\ &#39;path_maps&#39;: {\n        \\ &#39;/app/web/&#39;: &#39;/Users/jmarceli/Work/wordpress/my_site/web/&#39;\n      \\ }\n      \\}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Which should be appended to the <code class=\"language-text\">~/.vimrc</code> file.</p>\n<p><code class=\"language-text\">path_maps</code> is a useful option which lets you view your remote files mapped on the local path so you can view and edit them while still working inside the debugger view. Probably some similar option is available in any other decent debugger.\nIn case of Vim there is one small problem. You may have multiple projects with the same path on a server but different paths in the local environment. This issue is discussed on the <a href=\"https://github.com/joonty/vdebug/issues/197\">official Github repo</a> where you may find some useful comments related to the automatic changing the root dir.</p>\n<h2>Test</h2>\n<p>That's all now you should be able to run your PHP code with the debugger attached to the selected line.</p>\n<h2>Troubleshooting</h2>\n<p>When everything goes well this section is not important, but as always you may run into some problems (like I do). Here is how to test and check everything in this setup.</p>\n<h3>Check the debugger</h3>\n<p>For troubleshooting, I would advise using <code class=\"language-text\">nmap</code> (for your Linux based containers):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">apt-get</span> update\n<span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> nmap\nnmap -p <span class=\"token number\">9000</span> <span class=\"token number\">10.254</span>.254.254</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>After executing that command from your Docker container with Xdebug enabled PHP server the debugger (on your computer) should/may exit (like my <code class=\"language-text\">vdebug</code> does), which means that it receives some message. This behavior will confirm that port number <code class=\"language-text\">9000</code> and IP address <code class=\"language-text\">10.254.254.254</code> are correct choice and should be used in Xdebug configuration.</p>\n<h3>Look for port open for listening</h3>\n<p>Another test which may be executed is port scanning either with default Mac Newtork Utility Port Scan or using <code class=\"language-text\">netstat</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">netstat</span> -atn <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token number\">9000</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>The desired result after running the debugger is some output from <code class=\"language-text\">netstat</code> which will confirm that the debugger is listening on 9000 port. Here is an example.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 652px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2418192cd496da32f46e0a8cc945d24c/39973/netstat_xdebug.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.484662576687114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABgklEQVQY02VRy44TMRCcf4kyr4ydsT1jT2yPPa9kEiEklgsceAguCGlv3OBTuEaLopDMJnvIkV+jliuW3Cq3uquq28Hl6fbzz+N0u12nx8vlcj6fT6fTNE1P1+uvh4f9fv/7v3M4HI7HI8qC9v0X8fojEbLgrBCikrLvOpbnAJSQ+XyeZVkcR3EUJXEchiGgNYaQbDabBfXbz/TuHVOrgnPBeVUpV9eVqpxDVGmacsYEF4yxsigEZ8igWSkFlsDfvaHDC8p4vqQQlGVptLHagMIajVKQKimRR0Q3pdRo7WwNomB4+Uq4dkEpHozlztrNMMD5uFmv+x50Vuu+axvvxvXQek8I2W3H3XbL8mUgP9yzT99K61VZVFKtqqq2FqLrvoNyHMf5cikwD2fPN88zkiklMRGlJOi7JoH9MFwsFlgJ/MFwbdCovXOoBmi8R7JvW1db2B7HDcTBGPj778XXH9J1WpZ6taqNaZsG1btxhH6aJvzfqvARzzMXIokTyAJHUfQX1VaESyVzKkUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"netstat Xdebug session\"\n        title=\"netstat Xdebug session\"\n        src=\"/static/2418192cd496da32f46e0a8cc945d24c/39973/netstat_xdebug.png\"\n        srcset=\"/static/2418192cd496da32f46e0a8cc945d24c/a1986/netstat_xdebug.png 210w,\n/static/2418192cd496da32f46e0a8cc945d24c/ad7fb/netstat_xdebug.png 420w,\n/static/2418192cd496da32f46e0a8cc945d24c/39973/netstat_xdebug.png 652w\"\n        sizes=\"(max-width: 652px) 100vw, 652px\"\n      />\n  </a>\n    </span></p>\n<p>In the picture you may see that after first execution debugger was listening on 9005 port, then Xdebug connection was made and finally debugging session has been finished.</p>\n<h3>Change a default Xdebug port</h3>\n<p>One more thing is using a custom port for Xdebug. As you may noticed in previous example I'm not using default <strong>9000</strong> port but <strong>9005</strong> instead. This is just a precaution made because of reported issues with 9000 port which is sometimes used by other applications (e.g. php-fpm).</p>\n<h2>Useful links</h2>\n<p><a href=\"https://docs.docker.com/docker-for-mac/networking/#per-container-ip-addressing-is-not-possible\">https://docs.docker.com/docker-for-mac/networking/#per-container-ip-addressing-is-not-possible</a> - Official Docker for Mac documentation</p>","timeToRead":5,"rawMarkdownBody":"After spending a nearly whole day fighting with Xdebug setup I think it is a right moment to write some complete Xdebug guide.\n\nIn this article I will describe the following setup:\n\n- Docker for Mac\n- PHP with Xdebug (a Docker container)\n- Vim\n- vdebug (Vim PHP debugging plugin)\n\nI think/hope that even if you use a slightly different configuration you may find a couple of useful hints in this text.\n\n## The Docker container\nFirst of all, let's get some Xdebug ready container. I've used [php-docker-boilerplate](https://github.com/webdevops/php-docker-boilerplate) by WEBDEVOPS which has some documentation and it is preconfigured to run a PHP server with everything else you may need for a modern web development process.\n\n> No matter which Docker container you will use there is **no need to publish/expose** any additional port for Xdebug!\n\n**Don't write** something like:\n```\ndocker run -p 9000:9000 your_xdebug_server_image\n```\n\nWhy?\nBecause Xdebug (which is running on your container/server) **doesn't** listen on that port, it just sends some data to that port (to your computer on which you are working). So there is no need to publish it, your computer will never try to connect to the Xdebug via 9000 port.\n\n\n\nWhile not beeing a Xdebug nor DBGP protocol expert I see this architecture/communication as follows:\n1. You start DBGP session in your debugger (Vim or some IDE like PHPStorm)\n2. Your local computer starts listening on 9000 port (by default)\n3. You run PHP script or make a request to a website\n4. The server tries to connect to your debugger via DBGP protocol\n5. The server checks a configuration of the Xdebug to find out the connection details\n6. Based on that configuration The server tries to connect with Your local computer on the given IP and port number\n7. If The server manages to connect with the debugger (the debugger is listening on given IP and port number) it stops script execution\n8. Debugger takes the control over code execution\n9. Depending on user action, debugger sends back some instructions to the Xdebug on the same port on which Xdebug connects with the debugger\n10. Everything is working as expected\n\n\n## The Xdebug configuration\n\nNormally you would define the configuration inside `php.ini` file (e.g. `/etc/php/7.0/fpm/php.ini` or similar). But for the container which I am using it is located inside `./etc/php/development.ini` (path relative to the `docker-compose.yml` location). So here is the Xdebug configuration:\n```\n; XDebug\nxdebug.remote_host             = 10.254.254.254\nxdebug.remote_autostart        = 1\nxdebug.remote_enable           = 1\nxdebug.remote_port             = 9000\nxdebug.default_enable          = 1\nxdebug.remote_connect_back     = 0\n```\n\nIt is the configuration specific for the **Docker for Mac**. Normally you may define `xdebug.remote_connect_back = 1`, so the `xdebug.remote_host` is not required (which is much more convenient). Unfortunatelly Docker for Mac (due to OS X limitations) has to have `xdebug.remote_host` defined and the `remote_connect_back` [is not supported](https://forums.docker.com/t/ip-address-for-xdebug/10460).\n\nWhat is more OS X limitations forces defining a static `remote_host` IP address and the only way to get such address is creating a loopback address alias with `ifconfig` like so:\n```bash\nsudo ifconfig lo0 alias 10.254.254.254\n```\nOf course it might be any IP, but be careful to not to shadow some existing server e.g. `8.8.8.8` is a Google DNS. Anyway `10.254.254.254` seems to be a safe bet (widely used across the Docker community) so I would advise you not to change it without any good reason.\n\n> For automatic IP setup on each system startup check [this gist](https://gist.github.com/ralphschindler/535dc5916ccbd06f53c1b0ee5a868c93)\n\nAnother important line is `xdebug.remote_enable = 1` which is responsible for Xdebug remote debugging.\n\n\n## The debugger configuration\n\nIn this example I will be configuring `vdebug` Vim plugin (which is a simple DBGP capable debugger), but similar configuration should be available in any other debugger (e.g. PHPStorm).\nFirst of all your debugger should listen / wait for connection on selected port (which is **9000** by default) and secondly it should listen on the interface connected with Docker (or any interface if it is possible).\nIn case of Vim vdebug above considerations are traslated to the:\n```\nlet g:vdebug_options = {\n      \\ 'port' : 9005,\n      \\ 'server' : '',\n      \\ 'path_maps': {\n        \\ '/app/web/': '/Users/jmarceli/Work/wordpress/my_site/web/'\n      \\ }\n      \\}\n```\nWhich should be appended to the `~/.vimrc` file.\n\n`path_maps` is a useful option which lets you view your remote files mapped on the local path so you can view and edit them while still working inside the debugger view. Probably some similar option is available in any other decent debugger.\nIn case of Vim there is one small problem. You may have multiple projects with the same path on a server but different paths in the local environment. This issue is discussed on the [official Github repo](https://github.com/joonty/vdebug/issues/197) where you may find some useful comments related to the automatic changing the root dir.\n\n## Test\n\nThat's all now you should be able to run your PHP code with the debugger attached to the selected line.\n\n\n## Troubleshooting\n\nWhen everything goes well this section is not important, but as always you may run into some problems (like I do). Here is how to test and check everything in this setup.\n\n### Check the debugger\n\nFor troubleshooting, I would advise using `nmap` (for your Linux based containers):\n\n```bash\napt-get update\napt-get install nmap\nnmap -p 9000 10.254.254.254\n```\n\nAfter executing that command from your Docker container with Xdebug enabled PHP server the debugger (on your computer) should/may exit (like my `vdebug` does), which means that it receives some message. This behavior will confirm that port number `9000` and IP address `10.254.254.254` are correct choice and should be used in Xdebug configuration.\n\n### Look for port open for listening\n\nAnother test which may be executed is port scanning either with default Mac Newtork Utility Port Scan or using `netstat`:\n```bash\nnetstat -atn | grep 9000\n```\n\nThe desired result after running the debugger is some output from `netstat` which will confirm that the debugger is listening on 9000 port. Here is an example.\n\n![netstat Xdebug session](img/netstat_xdebug.png)\n\nIn the picture you may see that after first execution debugger was listening on 9005 port, then Xdebug connection was made and finally debugging session has been finished.\n\n### Change a default Xdebug port\n\nOne more thing is using a custom port for Xdebug. As you may noticed in previous example I'm not using default **9000** port but **9005** instead. This is just a precaution made because of reported issues with 9000 port which is sometimes used by other applications (e.g. php-fpm).\n\n## Useful links\n\nhttps://docs.docker.com/docker-for-mac/networking/#per-container-ip-addressing-is-not-possible - Official Docker for Mac documentation\n","excerpt":"After spending a nearly whole day fighting with Xdebug setup I think it is a right moment to write some complete Xdebug guide. In thisâ€¦","frontmatter":{"title":"Docker with Xdebug a final guide with troubleshooting tips","slug":"docker-with-xdebug-and-vdebug","date":"2017-06-02T02:04:17.000Z","tags":["vim","mac","tools","docker"],"date_created":"2017-06-01T22:40:40.000Z","date_updated":"2017-06-11T13:04:03.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/docker-xdebug-final-setup-1.jpg","relativePath":"posts/img/docker-xdebug-final-setup-1.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAcKhBH//xAAWEAEBAQAAAAAAAAAAAAAAAAARABD/2gAIAQEAAQUCxb//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAYEAEBAAMAAAAAAAAAAAAAAAABACFhcf/aAAgBAQABPyHKcjUqf//aAAwDAQACAAMAAAAQ8+//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxAn/8QAGRABAAMBAQAAAAAAAAAAAAAAAQARIUFR/9oACAEBAAE/EFALgyKtVJGruueT/9k=","aspectRatio":2,"src":"/static/6706b1cf9b413f711fb88e2c6d0901c8/0defe/docker-xdebug-final-setup-1.jpg","srcSet":"/static/6706b1cf9b413f711fb88e2c6d0901c8/38b6a/docker-xdebug-final-setup-1.jpg 150w,\n/static/6706b1cf9b413f711fb88e2c6d0901c8/e201c/docker-xdebug-final-setup-1.jpg 300w,\n/static/6706b1cf9b413f711fb88e2c6d0901c8/0defe/docker-xdebug-final-setup-1.jpg 600w,\n/static/6706b1cf9b413f711fb88e2c6d0901c8/a71f1/docker-xdebug-final-setup-1.jpg 900w,\n/static/6706b1cf9b413f711fb88e2c6d0901c8/9f6c3/docker-xdebug-final-setup-1.jpg 1200w,\n/static/6706b1cf9b413f711fb88e2c6d0901c8/e95fb/docker-xdebug-final-setup-1.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"3c3d6be1-324b-5344-be75-0e151a5c38ae","html":"<p>This will be a set of questions and answers related to the Docker usage under OS X.</p>\n<h2>Where are my Docker files? They are supposed to be inside <code class=\"language-text\">/var/lib/Docker</code> but there is no such directory.</h2>\n<p>That's right Docker for Mac store all the data inside Virtual Machine which is located inside <code class=\"language-text\">/Users/username/Library/Containers/com.docker.docker</code></p>\n<h2>The size of <code class=\"language-text\">/Users/username/Library/Containers/com.docker.docker/Data</code> directory is enormous 16GB+.</h2>\n<p>This is the normal behaviour because Docker for Mac doesn't implement TRIM to free unused space. You may find more details on <a href=\"https://github.com/docker/for-mac/issues/371\">Github</a>. As for now the only working solution for me was resetting Docker (which means removing all images, containers and volumes).</p>\n<h2>Persistence in Docker for Mac.</h2>\n<p>You probably shouldn't use recommended Volumes API because it will store all your data inside Docker VM instead of your local file system. It means that when you make Docker reset (e.g. to free some space) you will loose your \"persisted\" data. As for now I think that the best (safest) option is staying with Data Volume Containers. As they will be normally backed up by your Time Machine backups.</p>\n<h2>Docker is running slow (extremely slow) on OS X.</h2>\n<p>Add following line to the <code class=\"language-text\">/etc/hosts</code> file.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token number\">127.0</span>.0.1\tlocalunixsocket.local</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>More details can be found in <a href=\"https://github.com/docker/for-mac/issues/1557\">this Github issue</a>.</p>","timeToRead":1,"rawMarkdownBody":"This will be a set of questions and answers related to the Docker usage under OS X.\n\n## Where are my Docker files? They are supposed to be inside `/var/lib/Docker` but there is no such directory.\nThat's right Docker for Mac store all the data inside Virtual Machine which is located inside `/Users/username/Library/Containers/com.docker.docker`\n\n## The size of `/Users/username/Library/Containers/com.docker.docker/Data` directory is enormous 16GB+.\nThis is the normal behaviour because Docker for Mac doesn't implement TRIM to free unused space. You may find more details on [Github](https://github.com/docker/for-mac/issues/371). As for now the only working solution for me was resetting Docker (which means removing all images, containers and volumes).\n\n## Persistence in Docker for Mac.\nYou probably shouldn't use recommended Volumes API because it will store all your data inside Docker VM instead of your local file system. It means that when you make Docker reset (e.g. to free some space) you will loose your \"persisted\" data. As for now I think that the best (safest) option is staying with Data Volume Containers. As they will be normally backed up by your Time Machine backups.\n\n## Docker is running slow (extremely slow) on OS X.\nAdd following line to the `/etc/hosts` file.\n\n```bash\n127.0.0.1\tlocalunixsocket.local\n```\n\nMore details can be found in [this Github issue](https://github.com/docker/for-mac/issues/1557).\n","excerpt":"This will be a set of questions and answers related to the Docker usage under OS X. Where are my Docker files? They are supposed to beâ€¦","frontmatter":{"title":"Docker for Mac OS X","slug":"docker-for-mac-os-x","date":"2017-06-06T20:09:10.000Z","tags":["docker","tools"],"date_created":"2017-05-30T21:51:40.000Z","date_updated":"2017-06-11T12:53:10.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/containers-2.jpg","relativePath":"posts/img/containers-2.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEA//EABUBAQEAAAAAAAAAAAAAAAAAAAME/9oADAMBAAIQAxAAAAHFLYiRBRp//8QAGBAAAgMAAAAAAAAAAAAAAAAAAAIgITL/2gAIAQEAAQUCuD7P/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAEDERL/2gAIAQMBAT8BlWUWf//EABcRAAMBAAAAAAAAAAAAAAAAAAACEQH/2gAIAQIBAT8BR7pT/8QAFhAAAwAAAAAAAAAAAAAAAAAAARAg/9oACAEBAAY/AoK//8QAHRABAAEDBQAAAAAAAAAAAAAAAQAQEaExQVFhcf/aAAgBAQABPyEO00W7iFjcnPkzKf/aAAwDAQACAAMAAAAQF9//xAAYEQACAwAAAAAAAAAAAAAAAAAAARFhcf/aAAgBAwEBPxCFdmT/xAAWEQEBAQAAAAAAAAAAAAAAAAARAAH/2gAIAQIBAT8Q2Alf/8QAHhABAAIBBAMAAAAAAAAAAAAAAQAhERAxQXGh0fD/2gAIAQEAAT8Qy6MumKBAc7PtFkq+6jTyo+NCW5//2Q==","aspectRatio":2,"src":"/static/c6e7d75622fede19febb6db085c60a73/0defe/containers-2.jpg","srcSet":"/static/c6e7d75622fede19febb6db085c60a73/38b6a/containers-2.jpg 150w,\n/static/c6e7d75622fede19febb6db085c60a73/e201c/containers-2.jpg 300w,\n/static/c6e7d75622fede19febb6db085c60a73/0defe/containers-2.jpg 600w,\n/static/c6e7d75622fede19febb6db085c60a73/a71f1/containers-2.jpg 900w,\n/static/c6e7d75622fede19febb6db085c60a73/9f6c3/containers-2.jpg 1200w,\n/static/c6e7d75622fede19febb6db085c60a73/e95fb/containers-2.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"76dc6fe1-80b8-5f48-a831-7edd0e967446","html":"<p>Setting up a custom domain name for a local development may be really useful especially when you want to test multisite setup (e.g. for Wordpress multisite site). In the tutorial below I will show how to point all <code class=\"language-text\">*.dev</code> addresses back to your localhost (or any other IP e.g. Vagrant host or Docker container).</p>\n<p>Install Dnsmasq. On OS X it is available via <a href=\"https://brew.sh/\">homebrew</a> package manager.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">brew up\nbrew <span class=\"token function\">install</span> dnsmasq</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<blockquote>\n<p>For Ubuntu you may install dnsmasq via <code class=\"language-text\">sudo apt-get install dnsmasq</code> (<a href=\"https://help.ubuntu.com/community/Dnsmasq\">official docs</a>)</p>\n</blockquote>\n<p>Then you should be able to configure address redirections in the <strong>Dnsmasq</strong> config file (<code class=\"language-text\">/usr/local/etc/dnsmasq.conf</code> on OS X) e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token assign-left variable\">address</span><span class=\"token operator\">=</span>/.dev/127.0.0.1</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Above instructions will redirect every <code class=\"language-text\">*.dev</code> address to the localhost, which may be useful if you are using localhost as a development server or a Docker with 80 port bound to your localhost.</p>\n<blockquote>\n<p>In case you are using Vagrant you would probably write something like this in your dnsmasq config (if you Vagrant host is available on <code class=\"language-text\">192.168.50.4</code> IP address).</p>\n</blockquote>\n<blockquote>\n<p><code class=\"language-text\">address=/.dev/192.168.50.4</code></p>\n</blockquote>\n<p>Next thing to do after adjusting Dnsmasq config file is restarting the Dnsmasq service.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> launchctl stop homebrew.mxcl.dnsmasq\n<span class=\"token function\">sudo</span> launchctl start homebrew.mxcl.dnsmasq</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Now when you enter any address which ends with <code class=\"language-text\">.dev</code> to the browser you will see the content of your localhost/Docker container/Vagrant host. For example if this site would be developed with that approach I would probably have a local development copy under the <code class=\"language-text\">http://grzegorowski.dev</code> address.</p>","timeToRead":1,"rawMarkdownBody":"Setting up a custom domain name for a local development may be really useful especially when you want to test multisite setup (e.g. for Wordpress multisite site). In the tutorial below I will show how to point all `*.dev` addresses back to your localhost (or any other IP e.g. Vagrant host or Docker container).\n\nInstall Dnsmasq. On OS X it is available via [homebrew](https://brew.sh/) package manager.\n\n```bash\nbrew up\nbrew install dnsmasq\n```\n> For Ubuntu you may install dnsmasq via `sudo apt-get install dnsmasq` ([official docs](https://help.ubuntu.com/community/Dnsmasq))\n\nThen you should be able to configure address redirections in the **Dnsmasq** config file (`/usr/local/etc/dnsmasq.conf` on OS X) e.g.\n\n```bash\naddress=/.dev/127.0.0.1\n```\n\nAbove instructions will redirect every `*.dev` address to the localhost, which may be useful if you are using localhost as a development server or a Docker with 80 port bound to your localhost.\n\n>In case you are using Vagrant you would probably write something like this in your dnsmasq config (if you Vagrant host is available on `192.168.50.4` IP address).\n\n>`address=/.dev/192.168.50.4`\n\nNext thing to do after adjusting Dnsmasq config file is restarting the Dnsmasq service.\n\n```bash\nsudo launchctl stop homebrew.mxcl.dnsmasq\nsudo launchctl start homebrew.mxcl.dnsmasq\n```\n\nNow when you enter any address which ends with `.dev` to the browser you will see the content of your localhost/Docker container/Vagrant host. For example if this site would be developed with that approach I would probably have a local development copy under the `http://grzegorowski.dev` address.\n","excerpt":"Setting up a custom domain name for a local development may be really useful especially when you want to test multisite setup (e.g. forâ€¦","frontmatter":{"title":"DNSmasq for custom development domain name","slug":"how-to-use-custom-domain-names-with-localhost-vagrant-docker-dnsmasq","date":"2017-06-17T16:45:00.000Z","tags":["tools","docker"],"date_created":"2017-05-30T10:01:29.000Z","date_updated":"2017-06-17T17:03:45.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/dnsmasq-custom-local-domain.jpg","relativePath":"posts/img/dnsmasq-custom-local-domain.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHkVQ0o/8QAGBABAQEBAQAAAAAAAAAAAAAAAAECITH/2gAIAQEAAQUCdXNqs+v/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwEn/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8BZ//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAQEBAQEBAAAAAAAAAAAAAAERAEEQIf/aAAgBAQABPyFoprAX7mLHcL3Gnz//2gAMAwEAAgADAAAAEBg//8QAFhEAAwAAAAAAAAAAAAAAAAAAARAR/9oACAEDAQE/EKC//8QAFhEAAwAAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/ECq//8QAGhABAQEBAAMAAAAAAAAAAAAAAREAITFBcf/aAAgBAQABPxCwrB5OYQEDh3ur3inHUiqm/MdXquDf/9k=","aspectRatio":2,"src":"/static/9d35c0153499047c6f60de1dead84d58/0defe/dnsmasq-custom-local-domain.jpg","srcSet":"/static/9d35c0153499047c6f60de1dead84d58/38b6a/dnsmasq-custom-local-domain.jpg 150w,\n/static/9d35c0153499047c6f60de1dead84d58/e201c/dnsmasq-custom-local-domain.jpg 300w,\n/static/9d35c0153499047c6f60de1dead84d58/0defe/dnsmasq-custom-local-domain.jpg 600w,\n/static/9d35c0153499047c6f60de1dead84d58/a71f1/dnsmasq-custom-local-domain.jpg 900w,\n/static/9d35c0153499047c6f60de1dead84d58/9f6c3/dnsmasq-custom-local-domain.jpg 1200w,\n/static/9d35c0153499047c6f60de1dead84d58/e95fb/dnsmasq-custom-local-domain.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"2271b7e9-82fe-556f-bddf-c482a1434801","html":"<p>Using registers in Vim is like having a [large] number of clipboards where you can copy and paste from whenever you want.\nHere is how to use that feature.</p>\n<p>Just prepend <code class=\"language-text\">&quot;[register_name]</code> to your regular copy/paste command. A <code class=\"language-text\">register_name</code> could be anything (any letter or number).</p>\n<p>Examples:</p>\n<ul>\n<li>Vim copy current line to the register <code class=\"language-text\">w</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"vim\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-vim line-numbers\"><code class=\"language-vim\"><span class=\"token comment\">\"wyy</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li>Vim paste from <code class=\"language-text\">w</code> register</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"vim\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-vim line-numbers\"><code class=\"language-vim\"><span class=\"token comment\">\"wp</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li>\n<p>Vim copy selection to the register <code class=\"language-text\">w</code>. First select some text in e.g. visual mode.</p>\n<div class=\"gatsby-highlight\" data-language=\"vim\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-vim line-numbers\"><code class=\"language-vim\"><span class=\"token comment\">\"wy</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n</ul>","timeToRead":1,"rawMarkdownBody":"Using registers in Vim is like having a [large] number of clipboards where you can copy and paste from whenever you want.\nHere is how to use that feature.\n\nJust prepend `\"[register_name]` to your regular copy/paste command. A `register_name` could be anything (any letter or number).\n\nExamples:\n\n* Vim copy current line to the register `w`\n\n```vim\n\"wyy\n```\n\n* Vim paste from `w` register\n\n```vim\n\"wp\n```\n\n* Vim copy selection to the register `w`. First select some text in e.g. visual mode.\n```vim\n\"wy\n```\n","excerpt":"Using registers in Vim is like having a large number of clipboards where you can copy and paste from whenever you want.\nHere is how to useâ€¦","frontmatter":{"title":"Vim registers - how to use Vim multiple clipboards feature","slug":"vim-using-registers","date":"2017-05-28T18:21:20.000Z","tags":["tools","vim"],"date_created":"2017-05-28T18:13:40.000Z","date_updated":"2017-10-15T13:58:04.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/keyboard-computer-keys-white-1.jpg","relativePath":"posts/img/keyboard-computer-keys-white-1.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAcqoQD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAWEAEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQEAAT8htVj/2gAMAwEAAgADAAAAEPPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBABAQADAAAAAAAAAAAAAAAAAQARcYH/2gAIAQEAAT8Q2WD2C3//2Q==","aspectRatio":2,"src":"/static/017519d052ae68534bf9fb91c225dd8c/0defe/keyboard-computer-keys-white-1.jpg","srcSet":"/static/017519d052ae68534bf9fb91c225dd8c/38b6a/keyboard-computer-keys-white-1.jpg 150w,\n/static/017519d052ae68534bf9fb91c225dd8c/e201c/keyboard-computer-keys-white-1.jpg 300w,\n/static/017519d052ae68534bf9fb91c225dd8c/0defe/keyboard-computer-keys-white-1.jpg 600w,\n/static/017519d052ae68534bf9fb91c225dd8c/a71f1/keyboard-computer-keys-white-1.jpg 900w,\n/static/017519d052ae68534bf9fb91c225dd8c/9f6c3/keyboard-computer-keys-white-1.jpg 1200w,\n/static/017519d052ae68534bf9fb91c225dd8c/e95fb/keyboard-computer-keys-white-1.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"7f78522b-6782-5b06-883d-92abdef6306b","html":"<p>In order to check your current DNS records, you may use this tool <a href=\"https://www.samdns.com/\">https://www.samdns.com/</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d08d6478e1b0f50b7e32bc2f5504c981/c0d13/dns_records_checking_tool.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.85416666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAACPUlEQVQoz41S3W/SUBTnD5hvPmx7m9mbvvkfmJj4qC/+H348zKnDLG6LY+AEKQyKGywTIsZFnWPCwAQnwcSPF7P4kcnAAu1tC+29rMXSgaeFLSvuYb+enp776/mde+7NsZ0/PXzlwqWLl68Ojp4dGj03MDgyMDRyavjMScxG04tPo89W4quRaDy0HHVRARcVdD72O91+p8dvBB6Lzbl9h2brdDpNVeUREkWRSPU2xjohnZPBEOc/fZmam7dPO66NTdwct98Yt1+/fc8TeBKJPXe4qTv3H9yanJmYdtydmh2bnPm2/R0kmtbSdd0QY0IqlSrHIZZFpT/M70KBYcqCILIshxAPv8Ajnq/V6kDuKYplZ6jRbrf7WtJM9JGQBskWMXQSDK9EYvF5X9DpXXjoC866qXAs/nojBVf4aCHk8gaAhLt0uH2/dgrdKj1xYbe0kcq8z+WT6XcQJJLpxNvNj5+/ZrdybxLJFy/X4quv1tZT2Q/5bC7P8bxF/H/PgH0Tx/KWtplKJZ3dSmxm1lNdSx/6A7LLZOAgVZaz7Lz94yec2UsvUWChsJdeBKPoMBVaArLH0714p1C0iFutFiF4D15JIpKMZUxkmWCZmIEMpGz8VRqNlqbp+9bbVlRF4AVIwxjLJswAd3HwxY0GVCBqs2kRq6rKMAxsCYX/9qN5dAFKWFvEsIaSpWKRrbIwTNAFQsicJwEGXjRcDQC+Xq8fLy7uFsvlMstxoOF5HnFIgAfGEgZTrEmSBEpIOyr+BxWzDxTp4NVIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"DNS records checking tool\"\n        title=\"DNS records checking tool\"\n        src=\"/static/d08d6478e1b0f50b7e32bc2f5504c981/a3419/dns_records_checking_tool.png\"\n        srcset=\"/static/d08d6478e1b0f50b7e32bc2f5504c981/a1986/dns_records_checking_tool.png 210w,\n/static/d08d6478e1b0f50b7e32bc2f5504c981/ad7fb/dns_records_checking_tool.png 420w,\n/static/d08d6478e1b0f50b7e32bc2f5504c981/a3419/dns_records_checking_tool.png 840w,\n/static/d08d6478e1b0f50b7e32bc2f5504c981/c0d13/dns_records_checking_tool.png 960w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>It allows you to specify DNS server, so you don't need to wait for the DNS propagation or clearing any cache.</p>\n<p>It is especially useful if you are unsure how does your provider DNS panel work and to check if all the records you have edited/added are correct.</p>\n<p>If you don't know your provider DNS server IP address use a command line utility like <code class=\"language-text\">ping</code> or just paste DNS domain name inside \"DNS Lookup\" Domain field. In this example I'm looking for the IP of the <code class=\"language-text\">dns1.mydevil.net</code> DNS server.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 359px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ed0465179dba58b70c550fe1f3db2657/f69a5/dns_find_ip.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.01114206128133%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABd0lEQVQoz5VPTUsCURSdfbsWWrQKUoMg9QdEyyDaSO6qRUTLNm2CJApUUEPKRe5a9CsCE0vHmaF/EGWrUGnmvTfvafMlzkz3KWXRqsPlcd6959wPIX1+Ubi8yhZLhVL5LFc8TudS6Xwqk5+8nOS+SP4kWzg6zZSvbzzPE9aSW8md/cT23u7B4erG5vT80uxiPBiJBsPRQDgWDMdmInF4gxEegVA0EFqemltYWU84g4FQqdbqonxXrT3UG42m3JQUSVJk5VGSlUZTuq+Lt5WqKMpiU+FlWXluvUI8vbQGYFZVFWmIIKxjrGkawZgg1KOsx8EIJhrSGKVAdIJN48P3Pd/3DcPgkzvdLujB1n7rEC4gGGHXdYfDoe04mqqapolGfdudzruGbIuD6Do3U0qhbBgmpBzHgZaWacHfsscyDnMEIDxlQ09Hp4ybYblJzbbBzLk5Mtm/8J0AM2WM39zv9+0fQ35i3PEvQM/XdgYC3Ekp+3cw5nruJ/J8tNT1dRyTAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Looking for DNS IP address\"\n        title=\"Looking for DNS IP address\"\n        src=\"/static/ed0465179dba58b70c550fe1f3db2657/f69a5/dns_find_ip.png\"\n        srcset=\"/static/ed0465179dba58b70c550fe1f3db2657/a1986/dns_find_ip.png 210w,\n/static/ed0465179dba58b70c550fe1f3db2657/f69a5/dns_find_ip.png 359w\"\n        sizes=\"(max-width: 359px) 100vw, 359px\"\n      />\n  </a>\n    </span></p>\n<p>Then click \"Go\". As a result you will find A record for your DNS domain name which is an IP address you are looking for.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 684px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ea20681c1e552a512b76d7fa93b19a14/e4bfe/dns_lookup_result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.526315789473685%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABLElEQVQY032QO0/DMBSF/ftYWiYEBQnKgFi6IMQES/8TA+J/QPP0I07txnb8atpEqsRN1a4cHR1/vvKRroz2McqfX1PXTZa1SrkQnPf/Gh4E68N226HPr+/50+Ltffm8eJlc309nc/Dl7HF6O8IpZyee3DyAAS6u7l4/lsg6x9di0yghN6zi9VpUnFPKCGVwgQEMYcJYRVklpNTGNEo3Sq2FRN77ptngssQYG63zLEtWCedcg5QyxjDG0jSFjlIQprVt13WHwyHELdLapGl2VI4xgSMZtSKYkJIQWCDPoS0wFoTUBa6K0lo7DINzHgGlq4RCsygqjMssl3XNKIUypBBi33VD30P2u91ogL6HsvcBxRiN0q2QLSTsqZRV2oHO3+tD8CEeHc48QmvtH0R9YUhghesNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"DNS server IP address\"\n        title=\"DNS server IP address\"\n        src=\"/static/ea20681c1e552a512b76d7fa93b19a14/e4bfe/dns_lookup_result.png\"\n        srcset=\"/static/ea20681c1e552a512b76d7fa93b19a14/a1986/dns_lookup_result.png 210w,\n/static/ea20681c1e552a512b76d7fa93b19a14/ad7fb/dns_lookup_result.png 420w,\n/static/ea20681c1e552a512b76d7fa93b19a14/e4bfe/dns_lookup_result.png 684w\"\n        sizes=\"(max-width: 684px) 100vw, 684px\"\n      />\n  </a>\n    </span></p>\n<h3>An example check for CNAME record.</h3>\n<p>Enter the DNS record you are looking for, select its type and fill the DNS IP address (your provider DNS).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 356px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7114d20c8281a4f919774487118f8c42/e7e33/dns_cname_checking.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.258426966292134%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABz0lEQVQoz42QTWsTURSG5we4FNS6cSlUXYkfv0HcuRBxFRRBSzcFbRS0RUGom/4Kdy7cijRVO8kkTSGt1oYSq6htyXzdO5PJZCZJfTwzhdQuFC88vO89nPPO3GNMP51jZm6e4jPRF/Pcn33OvQePmZh+8n8UZ5h8OMudqUcsN9YwrtwocP3WBNcKd7k9VeTqzQJHT5/n5LnLnDh7acSYkNXG/rhnemz8AsfHL3Lk1BlevnqN8ba0yAezykLpHaXF9yyVLcpWjWp1mVqtTq2+gmlZmJUabxakd6lMxapTrlQxzTLrG02+fv/BZmuL3baN4boOvuehfY9Qq9wr30eJBkoRaE0YBuI1juOgpabFZ32dQDMcDMjO3t6QsNPBcGyF5wbSoHEdhd32ct3ZsQmCmPauQxQlRNK81fpCs7nJz+3tPPib/FmSJPR6PbrdLkoHGG1nhbZr4vgWtmfhKVG3Qpw26PVXhQZxsk4cd/PhRIbjOM5DMrJamqa514EEeuozOlwl6HwSXSOMPqJEe2lTwjI2xLdkIJbhdD90pMkoMPtIHpgkA3k/sgtheKD9/gGD/i/R/l8ZyB6z4P0n2zauLNg5hJvXDuP/E9t16UQRvwEUZ2DuiJSPIAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"DNS CNAME check\"\n        title=\"DNS CNAME check\"\n        src=\"/static/7114d20c8281a4f919774487118f8c42/e7e33/dns_cname_checking.png\"\n        srcset=\"/static/7114d20c8281a4f919774487118f8c42/a1986/dns_cname_checking.png 210w,\n/static/7114d20c8281a4f919774487118f8c42/e7e33/dns_cname_checking.png 356w\"\n        sizes=\"(max-width: 356px) 100vw, 356px\"\n      />\n  </a>\n    </span></p>\n<p>Here is how results may look like. In case of the CNAME record in the <strong>Answer</strong> column you will see the domain which is pointed by your source domain.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 683px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7a343cc53b9a445dee422c8f0b37ed09/54ee7/dns_cname_check_results.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.11420204978038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABRUlEQVQoz5WRP1eDMBTF+YRandU6aNXBwcGjo5tfTo8utEJBQkhr+Q8FQqHD9SW0p4uLwz0v7yX3l3sSw317h3BceB+f8L49MLEA4wIs+J84+frtFsb1/SOeXl5x9/CMo7MrjMY3GF1MdroZ+j9mJ+NDPT6f4PTylqBLGFEcI89zFGWJjGqaZljTuiiozzIkSaql+pLmuT6TIo4Tva8kpURVVej6HkYYhlitVjBNE0IIMifwGYNlWXBdF5xzMseYzWbwfR9RFGlo13XYbDZaPYEagqpqBARZ/Czhk1EslhrueR7mc0eDGfMRBAG4z3UV9F4qoXqvPVDB67oegNZ0CsecwrVtrS9ac0rG6IMcx9FJbXs+pAsjtG2rpSB7KVDdNAOwWVeo6ca6XJNK6L4oIOmAJKOU7VB3oJYSte1htp9XKiGl/gXfG+3PI58/1QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"DNS CNAME check result\"\n        title=\"DNS CNAME check result\"\n        src=\"/static/7a343cc53b9a445dee422c8f0b37ed09/54ee7/dns_cname_check_results.png\"\n        srcset=\"/static/7a343cc53b9a445dee422c8f0b37ed09/a1986/dns_cname_check_results.png 210w,\n/static/7a343cc53b9a445dee422c8f0b37ed09/ad7fb/dns_cname_check_results.png 420w,\n/static/7a343cc53b9a445dee422c8f0b37ed09/54ee7/dns_cname_check_results.png 683w\"\n        sizes=\"(max-width: 683px) 100vw, 683px\"\n      />\n  </a>\n    </span></p>\n<h3>CNAME configuration example</h3>\n<p>Adding a subdomain CNAME record to the DNS is just adding a record to your main domain DNS records list. For example, if you want to add a CNAME record which will point <code class=\"language-text\">blog.grzegorowski.com</code> to some other domain (let say <code class=\"language-text\">example.domain.com</code>) you would probably add the following line to the main domain records list:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/729420d5b38e50ad43a6e3275a15d05d/66b04/cname_record.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 5.448354143019296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAARklEQVQI1x2LyQmAAAwELVewLbEfxRL8JZDjk+Ozah4Dy7CzRAREBJmJqpptZujucT+qOhARmBnuPt/82gYg14l7W/EcO14mwUr7bq+qcwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CNAME record\"\n        title=\"CNAME record\"\n        src=\"/static/729420d5b38e50ad43a6e3275a15d05d/a3419/cname_record.png\"\n        srcset=\"/static/729420d5b38e50ad43a6e3275a15d05d/a1986/cname_record.png 210w,\n/static/729420d5b38e50ad43a6e3275a15d05d/ad7fb/cname_record.png 420w,\n/static/729420d5b38e50ad43a6e3275a15d05d/a3419/cname_record.png 840w,\n/static/729420d5b38e50ad43a6e3275a15d05d/66b04/cname_record.png 881w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>All your domain DNS records may look as follows:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f2dc2ac0b1502543f8575c548881cafe/4dfe1/cname_record_domain_records_list.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.841628959276015%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbklEQVQoz2VS20rDQBDdnxYspSIIvohv+gXSi4ggPui3NKlJG0k1wVyayzabZLOe3WlKtOdh2J2cmXNmNmxvwLmOeZ4LUXPOsywrigKHsiwLg7qumxOwIAjCMEySBMVt20opEf9RcZVDgGaY7KeHEKIzaHsopYisTtDhk1IMjXcGdIBDRNiGF9hGxJWMHFpK2ex5bC0j12UQhGFhgBqMDQJZpaYwFcdxVVWaUVV11+1s25qM/PmUgZoboEX3F1RA29JWATMC36yt8Wi7mDEwoihC7+OGAaNRkX98gvmhcrZaWZOxP5/pmRMDVILRz6V3jgyeKk1TdKEkslgV//Sc25vv1xcGS6kByR4fCQfMgiQV46p3gahU4Tr25cX2caGVMwOIQHn4vPST0BYP/1JZ1p0qnI/l+Zk/fdDK8AwGUTEXOUcxKUOWrIGDKFpZbtar66uv5yf9VCDRM9LayTPlAbKNvmS7gW3Pc+/vgve3X1KUqFdMPMA0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CNAME record - domain DNS records list\"\n        title=\"CNAME record - domain DNS records list\"\n        src=\"/static/f2dc2ac0b1502543f8575c548881cafe/a3419/cname_record_domain_records_list.png\"\n        srcset=\"/static/f2dc2ac0b1502543f8575c548881cafe/a1986/cname_record_domain_records_list.png 210w,\n/static/f2dc2ac0b1502543f8575c548881cafe/ad7fb/cname_record_domain_records_list.png 420w,\n/static/f2dc2ac0b1502543f8575c548881cafe/a3419/cname_record_domain_records_list.png 840w,\n/static/f2dc2ac0b1502543f8575c548881cafe/4dfe1/cname_record_domain_records_list.png 884w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>This example is from my current hosting provider (Mydevil.net), but depending on the provider configuration you may need to end <strong>Target</strong> domain with a dot e.g. <code class=\"language-text\">example.domain.com.</code>.</p>","timeToRead":2,"rawMarkdownBody":"In order to check your current DNS records, you may use this tool https://www.samdns.com/\n\n![DNS records checking tool](img/dns_records_checking_tool.png)\n\nIt allows you to specify DNS server, so you don't need to wait for the DNS propagation or clearing any cache.\n\nIt is especially useful if you are unsure how does your provider DNS panel work and to check if all the records you have edited/added are correct.\n\nIf you don't know your provider DNS server IP address use a command line utility like `ping` or just paste DNS domain name inside \"DNS Lookup\" Domain field. In this example I'm looking for the IP of the `dns1.mydevil.net` DNS server.\n\n![Looking for DNS IP address](img/dns_find_ip.png)\n\nThen click \"Go\". As a result you will find A record for your DNS domain name which is an IP address you are looking for.\n\n![DNS server IP address](img/dns_lookup_result.png)\n\n### An example check for CNAME record.\n\nEnter the DNS record you are looking for, select its type and fill the DNS IP address (your provider DNS).\n\n![DNS CNAME check](img/dns_cname_checking.png)\n\nHere is how results may look like. In case of the CNAME record in the **Answer** column you will see the domain which is pointed by your source domain.\n\n![DNS CNAME check result](img/dns_cname_check_results.png)\n\n### CNAME configuration example\nAdding a subdomain CNAME record to the DNS is just adding a record to your main domain DNS records list. For example, if you want to add a CNAME record which will point `blog.grzegorowski.com` to some other domain (let say `example.domain.com`) you would probably add the following line to the main domain records list:\n\n![CNAME record](img/cname_record.png)\n\nAll your domain DNS records may look as follows:\n\n![CNAME record - domain DNS records list](img/cname_record_domain_records_list.png)\n\nThis example is from my current hosting provider (Mydevil.net), but depending on the provider configuration you may need to end **Target** domain with a dot e.g. `example.domain.com.`.\n","excerpt":"In order to check your current DNS records, you may use this tool https://www.samdns.com/  It allows you to specify DNS server, so you don'tâ€¦","frontmatter":{"title":"Adding a CNAME record to the DNS","slug":"adding-a-cname-record-to-dns","date":"2017-05-23T18:17:21.000Z","tags":["tools","hostings","backend"],"date_created":"2017-05-23T18:09:33.000Z","date_updated":"2017-05-28T19:00:00.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/pexels-photo-325223.jpg","relativePath":"posts/img/pexels-photo-325223.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeTKTRI//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAFBEP/aAAgBAQABBQIo8n//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAAAASD/2gAIAQEABj8CHP8A/8QAGRABAQEBAQEAAAAAAAAAAAAAAQAxIXGh/9oACAEBAAE/IXSPpDy0Rr7Dxf/aAAwDAQACAAMAAAAQMM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAeEAACAQQDAQAAAAAAAAAAAAAAATERIbHBQVFhgf/aAAgBAQABPxB4PdF6ErfRQSY6oZ2R3NxyhjbVxtn/2Q==","aspectRatio":2,"src":"/static/0404da2e5353a9f888240717b221dbd0/0defe/pexels-photo-325223.jpg","srcSet":"/static/0404da2e5353a9f888240717b221dbd0/38b6a/pexels-photo-325223.jpg 150w,\n/static/0404da2e5353a9f888240717b221dbd0/e201c/pexels-photo-325223.jpg 300w,\n/static/0404da2e5353a9f888240717b221dbd0/0defe/pexels-photo-325223.jpg 600w,\n/static/0404da2e5353a9f888240717b221dbd0/a71f1/pexels-photo-325223.jpg 900w,\n/static/0404da2e5353a9f888240717b221dbd0/9f6c3/pexels-photo-325223.jpg 1200w,\n/static/0404da2e5353a9f888240717b221dbd0/e95fb/pexels-photo-325223.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"e494bcf3-3c90-5ae7-a935-6c59a9940f79","html":"<p>Recently I've tried to install the newest iOS 10.3.1 update on my iPhone. Unfortunately, instead of a successful installation, I was getting <strong>Unable to Verify Update</strong> error message.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 503px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/85fb6df0ec301e07f6f009ac0257bdc6/6b741/unable_to_verify_update.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 133.00198807157057%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsSAAALEgHS3X78AAAEYElEQVRIx51VW08bVxDen5YqSvsS9TWl+QVtXwJFgLmDscEXsHe96wugSqlCVYLU9AWkFrC5mEqgFrAI5U5iA6GQCwFfdo1tvs6MMU0plVBW+jSzc+bMmZnznXMUp1eHg+DqK8Pj06HrBnp63Ojo6ITT2U26S9DV5UBnpx0ulxuBgH4jlDaXjtYeHU3dOmwOHXZ3AIZhyMSamm9RV1eP2tpatLS0orq6Bo8eVaOpqQmaFrgRit+nQvWr0Px+Qlnv6/NDVQOUaZBWNQhBctZFZ5umGeSjwuf7LxQe6K2gV7101ETKWK//RlTGr0MxjCCMYFD6FgyGoFMfVFWT9FmyXXxuCSUQCOCrr7/BgwdfoMFmo9V7YbM1oL29Ha2trbSIgf7+fkQikVtBcXZ3496nn+HOnU9Q9eVDSrtPgjmdTni9XoRCIYTD4VtDYVrcv/857t69h6qqh1SmSrRwCTioz+eTDNmZM6jImyABue5uytJu74LH4/2XQ6XUDzO4/n99IelhV1cX3G63ZOTxeIiDnUTqDrE7HA6RPMatsNvtkgDb2traRLIvV8QJKJqmobGxEc3NzeLAkxoaGojILSLr6upE53EbbVpljDesvr5ebJUE/MRlyZCDcGZjY2OYmJhALBbDzMwMpqamRJ+cnCRZ1lnyGIPt7M9959PDJ0zRdV1W53Tz+Twsy8LBwQGSySRSqRSOj49xdHSE/f190Rl7e3vyn81mwd/09LQwQkrmZnLZIyMjSKfTODw8lNXHx8cRjUYxPz+PhYUF0VnGZ+NXY7u7u7i4uMDc3JxkJwE5Q4fDiSdPhpDOZLDy/DlWV1extr6O7e1tLC0tYWtrGxubm0gkElheTmBtbR0rKytYXFyERVWNjo5K2wYHB8sBm2z1CBOBszkLydQeTd7COuHFyxQSNHFmdhaLy8uCtY1N/Lm+gc3tHWwRCoWi9JJLHhgYoF02wmiwE3m/H0Y6ZxIsZM08slYeufw5Ts4y2H6RxM7LPbw5OSVbERnzvAzyLZYuEI/PgTdXSg6FI/D4Dfzw9JkESmfNK5wRZFKxIMialtjOKuOZLCgeZqkC3mkJKCwPBfHzs5+Qowk504QpMg+TsjzNWljezyNBOM1YxIK8+JnEhixVxB8HZA7KSeEeMkkfP35MgUzkcjmRhbyFUsEiKll4fZrHq5NyILYVzi2hF/vyF4/HJUMJyNvt9fZiePipOGSIWybJoxMTe29NHJJk/S/CuzMTr97R/3tTFq3wkGnGtxTfTArfzm53H4aGfkSpVJImAxfYeQv8lgL+OAAW9oHfSW69oWySwMZriE+xWJKA0egUUc9FZdObwm9HgG7mEN3a47/+gik6XhOTUUzHopiJlWVFjxGZp2JlTE7+g8HB767eIcUIReBSI3CrYdg9AXpG6XEiCmg3IHBNr4BL7e+/vLGNYBgufxhejRGBatA9eMvr/sOLNRS6vLH9fk1K1i6h0j/3le0fA+X/nsOPxd9gS0xC5kSvFQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"iOS 10.3.1 Unable to Verify Update error\"\n        title=\"iOS 10.3.1 Unable to Verify Update error\"\n        src=\"/static/85fb6df0ec301e07f6f009ac0257bdc6/6b741/unable_to_verify_update.png\"\n        srcset=\"/static/85fb6df0ec301e07f6f009ac0257bdc6/a1986/unable_to_verify_update.png 210w,\n/static/85fb6df0ec301e07f6f009ac0257bdc6/ad7fb/unable_to_verify_update.png 420w,\n/static/85fb6df0ec301e07f6f009ac0257bdc6/6b741/unable_to_verify_update.png 503w\"\n        sizes=\"(max-width: 503px) 100vw, 503px\"\n      />\n  </a>\n    </span></p>\n<p>After spending some time looking for the solution on the internet I've decided to take the simplest step, restarting the device.</p>\n<p>Guess what. After:</p>\n<blockquote>\n<p>turning it off and on again</p>\n</blockquote>\n<p>and clicking <strong>Install Now</strong> button update starts downloading itself and then a normal update process has begun.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 511px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8d10f88d62e366a29b38df1a8f099b49/ffa94/ios_update_screen.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 176.90802348336595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAjCAIAAAAblL1PAAAACXBIWXMAAAsSAAALEgHS3X78AAAAqElEQVRIx2NgGAWjYAABExMTIyMjydqAeoA6IQxyNANJRUVFHh4ekjVzcnLq6Oh0dXWZm5uTYD/EtZMmTfr///+PHz9mzJgBFyTWwTt27PgPBj09PSRoZmZmBpLZ2dkQzRcuXGBlZSUt5NjZ2T09Pf38/LS1tckMc2KBkpKSgYGBrq6uHgwYgoG+vj5QXEVFBRhn/Pz8vLy8WFwBSRV4wGh+GwWjgPYAAOfaKWtCcOIcAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"iOS 10.3.1 update process\"\n        title=\"iOS 10.3.1 update process\"\n        src=\"/static/8d10f88d62e366a29b38df1a8f099b49/ffa94/ios_update_screen.png\"\n        srcset=\"/static/8d10f88d62e366a29b38df1a8f099b49/a1986/ios_update_screen.png 210w,\n/static/8d10f88d62e366a29b38df1a8f099b49/ad7fb/ios_update_screen.png 420w,\n/static/8d10f88d62e366a29b38df1a8f099b49/ffa94/ios_update_screen.png 511w\"\n        sizes=\"(max-width: 511px) 100vw, 511px\"\n      />\n  </a>\n    </span></p>\n<p>I hope it will help someone to solve a similar issue.</p>","timeToRead":1,"rawMarkdownBody":"Recently I've tried to install the newest iOS 10.3.1 update on my iPhone. Unfortunately, instead of a successful installation, I was getting **Unable to Verify Update** error message.\n\n![iOS 10.3.1 Unable to Verify Update error](img/unable_to_verify_update.png)\n\nAfter spending some time looking for the solution on the internet I've decided to take the simplest step, restarting the device.\n\nGuess what. After:\n\n> turning it off and on again\n\nand clicking **Install Now** button update starts downloading itself and then a normal update process has begun.\n\n![iOS 10.3.1 update process](img/ios_update_screen.png)\n\nI hope it will help someone to solve a similar issue.\n","excerpt":"Recently I've tried to install the newest iOS 10.3.1 update on my iPhone. Unfortunately, instead of a successful installation, I was gettingâ€¦","frontmatter":{"title":"iPhone 6s iOS 10.3.1 Unable to Verify Update","slug":"iphone-6s-ios-10-3-1-update-failed","date":"2017-05-12T10:30:35.000Z","tags":["ios"],"date_created":"2017-05-12T10:13:07.000Z","date_updated":"2017-05-12T10:31:55.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/unable_to_verify_update_error.png","relativePath":"posts/img/unable_to_verify_update_error.png","childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABg0lEQVQoz21S25aCMAz0FxUF1HPW+4NQaMulF39+NklB1j0+DGnodDpJuiqKAuv1GofDAcYYQdd1H+j7XvAtt9bieDxis9lgv99jVZYlttstLpcLQggYxxFKKTyfT4l8QdM0qOsautXQWsua95xziDHi8XiAjYkgfzi5Xq9C4ANMrmslQoz5n2pUihPYHZu43W7I8zwJslhGds/nswjOIk3boiVUVUV5WrOz2Z1SyTULcnVc5SRYUv0ZTicS9AFdPwj6gTGi1QYVHazIsbHdv/1BBO/3+1JyWe6x2RY4X25w3EPvRdhNcXSe4DCMTtbyz088ykOIn4JzD7kP3kchJbEFLODfl3wixCT47iFPmRMeCttnkg9JgOPoAiod0Ni0XvaIR9z4TTDLMmmslzKcxEAH4h+ECTGmyJzEm0vOl6HsdotDvj3GAN0lV4yWoEyA7VNuB+KE5Pb1elG77jTlHVhrleeFJD8/J3nUM0w3ojEJ2tK0KRqbct5zE48r4hfCGqz1C8xl8Of2x4cEAAAAAElFTkSuQmCC","aspectRatio":2,"src":"/static/6ceb95e0d68314f7b304a7df39a62786/ddade/unable_to_verify_update_error.png","srcSet":"/static/6ceb95e0d68314f7b304a7df39a62786/eed6b/unable_to_verify_update_error.png 150w,\n/static/6ceb95e0d68314f7b304a7df39a62786/44052/unable_to_verify_update_error.png 300w,\n/static/6ceb95e0d68314f7b304a7df39a62786/ddade/unable_to_verify_update_error.png 495w","sizes":"(max-width: 495px) 100vw, 495px"}}}}}},{"node":{"id":"9f574e8e-c81f-576f-878b-60f7d2fb1e06","html":"<p>Recently minimal system requirements of the new <a href=\"https://www.sketchapp.com/updates/#version-42\">Sketch App 42</a> forces me to make an OS X upgrade. It turns out that upgrading to the <strong>not most recent OS X</strong> version is quite complicated.</p>\n<p>When there is newer OS X available (e.g. Sierra) there is <strong>no way</strong> to download the previous version (e.g. El Capitan) from App Store. The only way is to find someone who has already downloaded required OS version. Such person will have an appropriate download link available inside <em>Purchased</em> tab in the App Store. You will have to copy the .app from him to your desktop (e.g. by using a pendrive).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fb6f8c2baf0ddc22d258857f5b548eec/a364f/screen-shot-2017-05-06-at-19.48.31.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIFAQT/xAAVAQEBAAAAAAAAAAAAAAAAAAACA//aAAwDAQACEAMQAAABozebClEKD//EABkQAAMBAQEAAAAAAAAAAAAAAAABAgMREv/aAAgBAQABBQK68j06PSy31yM//8QAFhEAAwAAAAAAAAAAAAAAAAAAAQIQ/9oACAEDAQE/AS0//8QAFhEAAwAAAAAAAAAAAAAAAAAAAQIQ/9oACAECAQE/AQs//8QAGRAAAgMBAAAAAAAAAAAAAAAAARAAAhEh/9oACAEBAAY/Ath6VbX/AP/EABoQAQADAAMAAAAAAAAAAAAAAAEAESFBgeH/2gAIAQEAAT8hqqSiXPAEsZR1GQlpy+Js3cmp/9oADAMBAAIAAwAAABDv3//EABcRAQEBAQAAAAAAAAAAAAAAAAEAETH/2gAIAQMBAT8QXha3/8QAFxEAAwEAAAAAAAAAAAAAAAAAARARMf/aAAgBAgEBPxCelf/EABsQAAMBAAMBAAAAAAAAAAAAAAERIQAxQYGR/9oACAEBAAE/EEvBOd4ZJgXQIH9eskI8A4bino/GicsxZb51ATSu9//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"El Capitan icon on desktop\"\n        title=\"El Capitan icon on desktop\"\n        src=\"/static/fb6f8c2baf0ddc22d258857f5b548eec/21664/screen-shot-2017-05-06-at-19.48.31.jpg\"\n        srcset=\"/static/fb6f8c2baf0ddc22d258857f5b548eec/5dfd4/screen-shot-2017-05-06-at-19.48.31.jpg 210w,\n/static/fb6f8c2baf0ddc22d258857f5b548eec/54bd9/screen-shot-2017-05-06-at-19.48.31.jpg 420w,\n/static/fb6f8c2baf0ddc22d258857f5b548eec/21664/screen-shot-2017-05-06-at-19.48.31.jpg 840w,\n/static/fb6f8c2baf0ddc22d258857f5b548eec/32af8/screen-shot-2017-05-06-at-19.48.31.jpg 1260w,\n/static/fb6f8c2baf0ddc22d258857f5b548eec/5bc48/screen-shot-2017-05-06-at-19.48.31.jpg 1680w,\n/static/fb6f8c2baf0ddc22d258857f5b548eec/a364f/screen-shot-2017-05-06-at-19.48.31.jpg 1900w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>When you have an .app file on your desktop just double click it and follow the installation instructions. The name \"installation\" may mislead you because the application will perform an upgrade of your current system, not a clean install (which is what I was looking for).</p>\n<p>During the system upgrade you won't loose your data, although a backup copy with a Time Machine is always a good idea - you should have it.</p>\n<p>After a couple of minutes (in my case about 40 minutes) you will be able to login to the upgraded OS.</p>\n<p>This may be obvious for you but I wasn't sure about my every day <strong>CLI tools</strong> such as <strong>RVM, NPM, Meteor</strong> and others. The good news is that <strong>everything works as expected</strong> after OS upgrade. There was <strong>no need of reinstallation or reconfiguration</strong>.</p>\n<p>The system upgrade from Yosemite to El Capitan (in my case) doesn't cause any additional/unexpected work which is something that I was worried about.</p>","timeToRead":1,"rawMarkdownBody":"Recently minimal system requirements of the new [Sketch App 42](https://www.sketchapp.com/updates/#version-42) forces me to make an OS X upgrade. It turns out that upgrading to the **not most recent OS X** version is quite complicated.\n\nWhen there is newer OS X available (e.g. Sierra) there is **no way** to download the previous version (e.g. El Capitan) from App Store. The only way is to find someone who has already downloaded required OS version. Such person will have an appropriate download link available inside *Purchased* tab in the App Store. You will have to copy the .app from him to your desktop (e.g. by using a pendrive).\n\n![El Capitan icon on desktop](img/screen-shot-2017-05-06-at-19.48.31.jpg)\n\nWhen you have an .app file on your desktop just double click it and follow the installation instructions. The name \"installation\" may mislead you because the application will perform an upgrade of your current system, not a clean install (which is what I was looking for).\n\nDuring the system upgrade you won't loose your data, although a backup copy with a Time Machine is always a good idea - you should have it.\n\nAfter a couple of minutes (in my case about 40 minutes) you will be able to login to the upgraded OS.\n\nThis may be obvious for you but I wasn't sure about my every day **CLI tools** such as **RVM, NPM, Meteor** and others. The good news is that **everything works as expected** after OS upgrade. There was **no need of reinstallation or reconfiguration**.\n\nThe system upgrade from Yosemite to El Capitan (in my case) doesn't cause any additional/unexpected work which is something that I was worried about.\n","excerpt":"Recently minimal system requirements of the new Sketch App 42 forces me to make an OS X upgrade. It turns out that upgrading to the not mostâ€¦","frontmatter":{"title":"Mac OS X upgrade - is it safe for your tools","slug":"mac-os-x-upgrade-is-it-safe-for-your-tools","date":"2017-05-06T22:00:09.000Z","tags":["mac"],"date_created":"2017-05-06T21:25:15.000Z","date_updated":"2017-05-06T22:00:09.000Z","author":"jan","feature_image":null}}},{"node":{"id":"cb01fee1-4918-5169-bc5b-be4693525f20","html":"<p>Don't ask me why I've made this post...</p>\n<p>If you accidentally delete half of your projects I hope you have a recent backup available. Even if that's the case the graphical interface of Time Machine seems to be very limited. There is no easy way to tell which files are missing.</p>\n<blockquote>\n<p>Use the CLI Luke!</p>\n</blockquote>\n<p>So the CLI you say. OK.\nTime Machine has a CLI command <code class=\"language-text\">tmutils</code> which is really handy if only you know how to use it.</p>\n<p>Example.\nYou deleted some of your files from <code class=\"language-text\">/Users/someone/files</code> directory (I'm glad it's not a root directory).</p>\n<p>So you will need to execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">tmutil listbackups</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>to get backups list. Something like this will be an output:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token punctuation\">..</span>.\n/Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2016-11-10-211600\n/Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2016-11-19-195117\n/Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2016-11-26-173122</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Looks easy, the last part is a date and a time. Pick one of them which suits you best.</p>\n<p>Then execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">tmutil compare -D <span class=\"token number\">1</span> /Users/someone/files /Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2016-11-26-173122/Macintosh<span class=\"token punctuation\">\\</span> HD/Users/someone/files</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where:</p>\n<ul>\n<li><code class=\"language-text\">-D 1</code> - means comparing only one level deep</li>\n<li><code class=\"language-text\">/Users/someone/files</code> - is a directory which you want to compare</li>\n<li><code class=\"language-text\">Macintosh\\ HD/</code> - is the name of your hard drive (probably same as in this example)</li>\n<li><code class=\"language-text\">/Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2016-11-26-173122</code> - is the name/path of choosen backup</li>\n</ul>\n<p>Then you will get a list which looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token operator\">!</span>         <span class=\"token punctuation\">(</span>mtime<span class=\"token punctuation\">)</span>               /Users/someone/files\n- <span class=\"token number\">4</span>.3M                          /Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2017-04-23-133603/Macintosh HD/Users/someone/files/file_name\n+ <span class=\"token number\">58</span>.0M                         /Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2017-04-23-133603/Macintosh HD/Users/someone/files/file_name\n<span class=\"token operator\">!</span> 377B    <span class=\"token punctuation\">(</span>size, mtime<span class=\"token punctuation\">)</span>         /Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2017-04-23-133603/Macintosh HD/Users/someone/files/file.name\n\n-------------------------------------\nAdded:         <span class=\"token number\">215</span>.9M\nRemoved:       <span class=\"token number\">3</span>.8G\nChanged:       <span class=\"token number\">14</span>.4K</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Where:</p>\n<ul>\n<li><code class=\"language-text\">-</code> means that file/folder was removed</li>\n<li><code class=\"language-text\">+</code> means that file/folder was added</li>\n<li><code class=\"language-text\">!</code> means that size has changed</li>\n</ul>\n<p>That's it. Now you should know what to restore.</p>\n<p><strong>Sources</strong></p>\n<p><a href=\"https://ss64.com/osx/tmutil.html\">https://ss64.com/osx/tmutil.html</a>\n<a href=\"https://apple.stackexchange.com/questions/19453/how-is-it-possible-to-compare-files-on-your-hard-drive-with-those-in-your-time\">https://apple.stackexchange.com/questions/19453/how-is-it-possible-to-compare-files-on-your-hard-drive-with-those-in-your-time</a></p>","timeToRead":2,"rawMarkdownBody":"Don't ask me why I've made this post...\n\nIf you accidentally delete half of your projects I hope you have a recent backup available. Even if that's the case the graphical interface of Time Machine seems to be very limited. There is no easy way to tell which files are missing.\n\n> Use the CLI Luke!\n\nSo the CLI you say. OK.\nTime Machine has a CLI command `tmutils` which is really handy if only you know how to use it.\n\nExample.\nYou deleted some of your files from `/Users/someone/files` directory (I'm glad it's not a root directory).\n\nSo you will need to execute:\n```bash\ntmutil listbackups\n```\nto get backups list. Something like this will be an output:\n```bash\n...\n/Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2016-11-10-211600\n/Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2016-11-19-195117\n/Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2016-11-26-173122\n```\nLooks easy, the last part is a date and a time. Pick one of them which suits you best.\n\nThen execute:\n```bash\ntmutil compare -D 1 /Users/someone/files /Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2016-11-26-173122/Macintosh\\ HD/Users/someone/files\n```\nWhere:\n\n- `-D 1` - means comparing only one level deep\n- `/Users/someone/files` - is a directory which you want to compare\n- `Macintosh\\ HD/` - is the name of your hard drive (probably same as in this example)\n- `/Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2016-11-26-173122` - is the name/path of choosen backup\n\nThen you will get a list which looks like this:\n```bash\n!         (mtime)               /Users/someone/files\n- 4.3M                          /Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2017-04-23-133603/Macintosh HD/Users/someone/files/file_name\n+ 58.0M                         /Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2017-04-23-133603/Macintosh HD/Users/someone/files/file_name\n! 377B    (size, mtime)         /Volumes/DISKNAME/Backups.backupdb/COMPUTER_NAME/2017-04-23-133603/Macintosh HD/Users/someone/files/file.name\n\n-------------------------------------\nAdded:         215.9M\nRemoved:       3.8G\nChanged:       14.4K\n```\nWhere:\n\n- `-` means that file/folder was removed\n- `+` means that file/folder was added\n- `!` means that size has changed\n\nThat's it. Now you should know what to restore.\n\n\n**Sources**\n\nhttps://ss64.com/osx/tmutil.html\nhttps://apple.stackexchange.com/questions/19453/how-is-it-possible-to-compare-files-on-your-hard-drive-with-those-in-your-time\n","excerpt":"Don't ask me why I've made this post... If you accidentally delete half of your projects I hope you have a recent backup available. Even ifâ€¦","frontmatter":{"title":"How to restore selected files from Time Machine backup","slug":"time-machine-restore-backup","date":"2017-05-06T22:05:45.000Z","tags":["mac","tools"],"date_created":"2017-04-28T18:33:01.000Z","date_updated":"2017-05-07T11:57:44.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/pexels-photo-121734.jpeg","relativePath":"posts/img/pexels-photo-121734.jpeg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAByyFjDCUr/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAECERL/2gAIAQEAAQUClIwck0O2dH//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwFH/8QAFhAAAwAAAAAAAAAAAAAAAAAAECBB/9oACAEBAAY/AhE//8QAFxABAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAQABPyGWXdg3hEgEq//aAAwDAQACAAMAAAAQ79//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QQtL/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxCKf//EAB4QAQACAgEFAAAAAAAAAAAAAAEAESFRMUFhcYGh/9oACAEBAAE/EDogdlmIYHW278agWIDZApl4ii8+5ayfZ//Z","aspectRatio":2,"src":"/static/6824b1abd124ffba79dd4ff14b1e51e2/0defe/pexels-photo-121734.jpg","srcSet":"/static/6824b1abd124ffba79dd4ff14b1e51e2/38b6a/pexels-photo-121734.jpg 150w,\n/static/6824b1abd124ffba79dd4ff14b1e51e2/e201c/pexels-photo-121734.jpg 300w,\n/static/6824b1abd124ffba79dd4ff14b1e51e2/0defe/pexels-photo-121734.jpg 600w,\n/static/6824b1abd124ffba79dd4ff14b1e51e2/a71f1/pexels-photo-121734.jpg 900w,\n/static/6824b1abd124ffba79dd4ff14b1e51e2/9f6c3/pexels-photo-121734.jpg 1200w,\n/static/6824b1abd124ffba79dd4ff14b1e51e2/e95fb/pexels-photo-121734.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"ca4853f1-d3ba-5c81-9673-9e0de188ddbf","html":"<p>The most useful feature of the ACF Wordpress plugin is its PHP API. Unfortunately, it is not fully documented on the official <a href=\"https://www.advancedcustomfields.com/resources/register-fields-via-php/\">page</a>.</p>\n<p>Here are the missing fields:</p>\n<h2>ACF Repeater field</h2>\n<p>Code example.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n  <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_reference_section'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Some label'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'reference_section'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'repeater'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'layout'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'table'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// also 'block' and 'row' are available</span>\n  <span class=\"token single-quoted-string string\">'required'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'min'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'button_label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Add another attachment'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'sub_fields'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n      <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_reference_name'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Name'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'reference_name'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'text'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n      <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_reference_value'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Value'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'reference_value'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'text'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>ACF Date Picker field</h2>\n<p>Code example:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">  <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_578f5d95e81fa'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'test'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'datatest'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'date_picker'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'instructions'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'required'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'conditional_logic'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'wrapper'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token single-quoted-string string\">'width'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'class'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'display_format'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'d/m/Y'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'return_format'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'d/m/Y'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'first_day'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 1 - monday</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>ACF Google Maps field</h2>\n<p>Code example:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_position'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Position on the map'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'position'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'google_map'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'required'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'center_lat'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">50.3091691</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'center_lng'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">19.2547187</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'zoom'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'height'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">400</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>// TODO: add some comments and improve this documentation</strong></p>\n<h2>hide_on_screen</h2>\n<p>Hide on screen is an ACF field group option which allows hiding selected admin page elements when the group is active (current page matches group <code class=\"language-text\">location</code> parameter). Here is the list of available <code class=\"language-text\">hide_on_screen</code> values. You may provide one or more value as an array.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token function\">acf_add_local_field_group</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token comment\">//... (other options)</span>\n  <span class=\"token single-quoted-string string\">'hide_on_screen'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'permalink'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'the_content'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'excerpt'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'custom_fields'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'discussion'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'comments'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'revisions'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'slug'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'author'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'format'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'page_attributes'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'featured_image'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'categories'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'tags'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'send-trackbacks'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","timeToRead":1,"rawMarkdownBody":"The most useful feature of the ACF Wordpress plugin is its PHP API. Unfortunately, it is not fully documented on the official [page](https://www.advancedcustomfields.com/resources/register-fields-via-php/).\n\nHere are the missing fields:\n\n## ACF Repeater field\n\nCode example.\n\n```php\narray(\n  'key' => 'field_reference_section',\n  'label' => 'Some label',\n  'name' => 'reference_section',\n  'type' => 'repeater',\n  'layout' => 'table', // also 'block' and 'row' are available\n  'required' => 1,\n  'min' => 1,\n  'button_label' => 'Add another attachment',\n  'sub_fields' => array(\n    array(\n      'key' => 'field_reference_name',\n      'label' => 'Name',\n      'name' => 'reference_name',\n      'type' => 'text',\n    ),\n    array(\n      'key' => 'field_reference_value',\n      'label' => 'Value',\n      'name' => 'reference_value',\n      'type' => 'text',\n    )\n  )\n)\n```\n\n## ACF Date Picker field\n\nCode example:\n\n```php\n  array (\n    'key' => 'field_578f5d95e81fa',\n    'label' => 'test',\n    'name' => 'datatest',\n    'type' => 'date_picker',\n    'instructions' => '',\n    'required' => 0,\n    'conditional_logic' => 0,\n    'wrapper' => array (\n      'width' => '',\n      'class' => '',\n      'id' => '',\n    ),\n    'display_format' => 'd/m/Y',\n    'return_format' => 'd/m/Y',\n    'first_day' => 1, // 1 - monday\n  ),\n```\n\n## ACF Google Maps field\n\nCode example:\n\n```php\narray (\n  'key' => 'field_position',\n  'label' => 'Position on the map',\n  'name' => 'position',\n  'type' => 'google_map',\n  'required' => 1,\n  'center_lat' => 50.3091691,\n  'center_lng' => 19.2547187,\n  'zoom' => 11,\n  'height' => 400\n),\n```\n**// TODO: add some comments and improve this documentation**\n\n## hide\\_on\\_screen\n\nHide on screen is an ACF field group option which allows hiding selected admin page elements when the group is active (current page matches group `location` parameter). Here is the list of available `hide_on_screen` values. You may provide one or more value as an array.\n\n```php\nacf_add_local_field_group(array (\n  //... (other options)\n  'hide_on_screen' => array (\n    'permalink',\n    'the_content',\n    'excerpt',\n    'custom_fields',\n    'discussion',\n    'comments',\n    'revisions',\n    'slug',\n    'author',\n    'format',\n    'page_attributes',\n    'featured_image',\n    'categories',\n    'tags',\n    'send-trackbacks',\n  ),\n));\n```\n","excerpt":"The most useful feature of the ACF Wordpress plugin is its PHP API. Unfortunately, it is not fully documented on the official page. Here areâ€¦","frontmatter":{"title":"ACF PHP API the missing docs","slug":"acf-php-api-the-missing-docs","date":"2017-05-08T13:28:50.000Z","tags":["wordpress","acf"],"date_created":"2017-04-27T12:05:05.000Z","date_updated":"2017-08-18T13:09:10.000Z","author":"jan","feature_image":null}}},{"node":{"id":"f8272b2c-cbe5-52d0-801f-53c7a2b12444","html":"<p>ActiveSupport <code class=\"language-text\">number_to_currency</code> helper method may be extremely useful if you deal with prices/wages inside your app. By default <code class=\"language-text\">number_to_currency</code> uses your current locale default settings which are OK in most cases but sometimes you may want to change them.</p>\n<p>In my case, I have to always display trailing zeros for each price. By default <code class=\"language-text\">number_to_currency</code> doesn't display them at least for a locale which I was using.</p>\n<p>I found an option called <code class=\"language-text\">strip_insignificant_zeros</code>, which is/was <strong>not documented</strong> in the official <code class=\"language-text\">number_to_currency</code> <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html\">docs</a>. Setting it to <code class=\"language-text\">true</code> for each <code class=\"language-text\">number_to_currency</code> execution seems like a bad idea (not DRY at all).</p>\n<p>Fortunately, you may define global locale default options inside your e.g. <strong>config/locales/en.yml</strong> like so:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">en</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">currency</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">format</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">strip_insignificant_zeros</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The same format might be used for other <code class=\"language-text\">number_to_currency</code> options e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">en</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">currency</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">format</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">delimiter</span><span class=\"token punctuation\">:</span> <span class=\"token string\">' '</span>\n        <span class=\"token key atrule\">format</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'%n %u'</span>\n        <span class=\"token key atrule\">precision</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n        <span class=\"token key atrule\">separator</span><span class=\"token punctuation\">:</span> <span class=\"token string\">','</span>\n        <span class=\"token key atrule\">strip_insignificant_zeros</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n        <span class=\"token key atrule\">unit</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'PLN'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>One more hint about <code class=\"language-text\">number_to_currency</code> usage is using:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token constant\">ActiveSupport</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">NumberHelper</span><span class=\"token punctuation\">.</span>number_to_currency<span class=\"token punctuation\">(</span><span class=\"token number\">123.12</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>if you need to use it outside the View.</p>\n<p>Some other places where people talk about this:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/23781427/activeadmin-number-to-currency-helper\">https://stackoverflow.com/questions/23781427/activeadmin-number-to-currency-helper</a></li>\n<li><a href=\"https://apidock.com/rails/ActionView/Helpers/NumberHelper/number_to_currency\">https://apidock.com/rails/ActionView/Helpers/NumberHelper/number<em>to</em>currency</a></li>\n<li><a href=\"https://stackoverflow.com/questions/7237592/number-to-currency-locale-converting\">https://stackoverflow.com/questions/7237592/number-to-currency-locale-converting</a></li>\n</ul>","timeToRead":1,"rawMarkdownBody":"ActiveSupport `number_to_currency` helper method may be extremely useful if you deal with prices/wages inside your app. By default `number_to_currency` uses your current locale default settings which are OK in most cases but sometimes you may want to change them.\n\nIn my case, I have to always display trailing zeros for each price. By default `number_to_currency` doesn't display them at least for a locale which I was using.\n\nI found an option called `strip_insignificant_zeros`, which is/was **not documented** in the official `number_to_currency` [docs](http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html). Setting it to `true` for each `number_to_currency` execution seems like a bad idea (not DRY at all).\n\nFortunately, you may define global locale default options inside your e.g. **config/locales/en.yml** like so:\n```yaml\nen:\n  number:\n    currency:\n      format:\n        strip_insignificant_zeros: false\n```\n\nThe same format might be used for other `number_to_currency` options e.g.\n```yaml\nen:\n  number:\n    currency:\n      format:\n        delimiter: ' '\n        format: '%n %u'\n        precision: 2\n        separator: ','\n        strip_insignificant_zeros: false\n        unit: 'PLN'\n```\n\nOne more hint about `number_to_currency` usage is using:\n```ruby\nActiveSupport::NumberHelper.number_to_currency(123.12)\n```\nif you need to use it outside the View.\n\nSome other places where people talk about this:\n\n- [https://stackoverflow.com/questions/23781427/activeadmin-number-to-currency-helper](https://stackoverflow.com/questions/23781427/activeadmin-number-to-currency-helper)\n- [https://apidock.com/rails/ActionView/Helpers/NumberHelper/number_to_currency](https://apidock.com/rails/ActionView/Helpers/NumberHelper/number_to_currency)\n- [https://stackoverflow.com/questions/7237592/number-to-currency-locale-converting](https://stackoverflow.com/questions/7237592/number-to-currency-locale-converting)\n","excerpt":"ActiveSupport  helper method may be extremely useful if you deal with prices/wages inside your app. By default  uses your current localeâ€¦","frontmatter":{"title":"Rails number_to_currency change locale defaults","slug":"rails-number_to_currency-change-locale-defaults","date":"2017-04-22T00:23:01.000Z","tags":[],"date_created":"2017-04-22T00:09:25.000Z","date_updated":"2018-01-15T23:54:45.000Z","author":"jan","feature_image":null}}},{"node":{"id":"c8df4ea9-af87-5b5e-ad59-1030b09c1950","html":"<p>Getting a list of all ACF fields may be useful e.g. if you want the user to select one of them as a data source. In my case, I needed that list to provide a choices list for an ACF select field.</p>\n<p>This is an easy task if you know where to look :)</p>\n<h2>Getting a list of all ACF fields (example)</h2>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$options</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$field_groups</span> <span class=\"token operator\">=</span> <span class=\"token function\">acf_get_field_groups</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$field_groups</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$group</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// DO NOT USE here: $fields = acf_get_fields($group['key']);</span>\n  <span class=\"token comment\">// because it causes repeater field bugs and returns \"trashed\" fields</span>\n  <span class=\"token variable\">$fields</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_posts</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'posts_per_page'</span>   <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'post_type'</span>        <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'acf-field'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'orderby'</span>          <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'menu_order'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'order'</span>            <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'ASC'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'suppress_filters'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token boolean constant\">true</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// DO NOT allow WPML to modify the query</span>\n    <span class=\"token single-quoted-string string\">'post_parent'</span>      <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$group</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'ID'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'post_status'</span>      <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'any'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'update_post_meta_cache'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token boolean constant\">false</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$fields</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$field</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$options</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$field</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">post_name</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$field</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">post_title</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>As a result in the <code class=\"language-text\">$options</code> variable, you will have an associative array of all the fields, labels keyed by the field name.</p>\n<h2>More details</h2>\n<p>In the above example, <code class=\"language-text\">$field_groups</code> variable is an array with all field groups. Here is the output of a <code class=\"language-text\">var_dump($fied_groups)</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n  <span class=\"token number\">0</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n    <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span>\n      <span class=\"token single-quoted-string string\">'ID'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> int <span class=\"token number\">1747</span>\n      <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> string <span class=\"token single-quoted-string string\">'group_58f769278b155'</span> <span class=\"token punctuation\">(</span>length<span class=\"token operator\">=</span><span class=\"token number\">19</span><span class=\"token punctuation\">)</span>\n      <span class=\"token single-quoted-string string\">'title'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> string <span class=\"token single-quoted-string string\">'Some title'</span> <span class=\"token punctuation\">(</span>length<span class=\"token operator\">=</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>\n      <span class=\"token single-quoted-string string\">'fields'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n        <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">empty</span>\n      <span class=\"token single-quoted-string string\">'location'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n        <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n          <span class=\"token number\">0</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n            <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n              <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n      <span class=\"token single-quoted-string string\">'menu_order'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> int <span class=\"token number\">0</span>\n      <span class=\"token single-quoted-string string\">'position'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> string <span class=\"token single-quoted-string string\">'normal'</span> <span class=\"token punctuation\">(</span>length<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\n      <span class=\"token single-quoted-string string\">'style'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> string <span class=\"token single-quoted-string string\">'default'</span> <span class=\"token punctuation\">(</span>length<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\n      <span class=\"token single-quoted-string string\">'label_placement'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> string <span class=\"token single-quoted-string string\">'top'</span> <span class=\"token punctuation\">(</span>length<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n      <span class=\"token single-quoted-string string\">'instruction_placement'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> string <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token punctuation\">(</span>length<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n      <span class=\"token single-quoted-string string\">'hide_on_screen'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> string <span class=\"token single-quoted-string string\">''</span> <span class=\"token punctuation\">(</span>length<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n      <span class=\"token single-quoted-string string\">'active'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> int <span class=\"token number\">1</span>\n      <span class=\"token single-quoted-string string\">'description'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> string <span class=\"token single-quoted-string string\">''</span> <span class=\"token punctuation\">(</span>length<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token number\">1</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>If you want to get only fields which are defined by user/admin via the ACF editor you may filter all the field groups by <code class=\"language-text\">ID</code>. Groups created with <a href=\"https://www.advancedcustomfields.com/resources/register-fields-via-php/\">ACF PHP API</a> will have <code class=\"language-text\">ID = 0</code>.</p>","timeToRead":1,"rawMarkdownBody":"Getting a list of all ACF fields may be useful e.g. if you want the user to select one of them as a data source. In my case, I needed that list to provide a choices list for an ACF select field.\n\nThis is an easy task if you know where to look :)\n\n## Getting a list of all ACF fields (example)\n```php\n$options = array();\n\n$field_groups = acf_get_field_groups();\nforeach ( $field_groups as $group ) {\n  // DO NOT USE here: $fields = acf_get_fields($group['key']);\n  // because it causes repeater field bugs and returns \"trashed\" fields\n  $fields = get_posts(array(\n    'posts_per_page'   => -1,\n    'post_type'        => 'acf-field',\n    'orderby'          => 'menu_order',\n    'order'            => 'ASC',\n    'suppress_filters' => true, // DO NOT allow WPML to modify the query\n    'post_parent'      => $group['ID'],\n    'post_status'      => 'any',\n    'update_post_meta_cache' => false\n  ));\n  foreach ( $fields as $field ) {\n    $options[$field->post_name] = $field->post_title;\n  }\n}\n```\n\nAs a result in the `$options` variable, you will have an associative array of all the fields, labels keyed by the field name.\n\n## More details\nIn the above example, `$field_groups` variable is an array with all field groups. Here is the output of a `var_dump($fied_groups)`:\n```php\narray (size=3)\n  0 =>\n    array (size=13)\n      'ID' => int 1747\n      'key' => string 'group_58f769278b155' (length=19)\n      'title' => string 'Some title' (length=11)\n      'fields' =>\n        array (size=0)\n          empty\n      'location' =>\n        array (size=1)\n          0 =>\n            array (size=1)\n              ...\n      'menu_order' => int 0\n      'position' => string 'normal' (length=6)\n      'style' => string 'default' (length=7)\n      'label_placement' => string 'top' (length=3)\n      'instruction_placement' => string 'label' (length=5)\n      'hide_on_screen' => string '' (length=0)\n      'active' => int 1\n      'description' => string '' (length=0)\n  1 => ...\n```\nIf you want to get only fields which are defined by user/admin via the ACF editor you may filter all the field groups by `ID`. Groups created with [ACF PHP API](https://www.advancedcustomfields.com/resources/register-fields-via-php/) will have `ID = 0`.\n","excerpt":"Getting a list of all ACF fields may be useful e.g. if you want the user to select one of them as a data source. In my case, I needed thatâ€¦","frontmatter":{"title":"How to get list of all ACF fields?","slug":"how-to-get-list-of-all-acf-fields","date":"2017-04-19T21:59:51.000Z","tags":["wordpress","acf"],"date_created":"2017-04-19T21:47:43.000Z","date_updated":"2017-10-17T02:13:16.000Z","author":"jan","feature_image":null}}},{"node":{"id":"62642ee7-ebd5-5003-ad1e-9aa79cd81479","html":"<p>I had a few cases when clients report an \"HTTP error\" during photo upload. Which looks similar to this:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 771px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e1d25b68e79aa30fcd0811c56d2c93a2/1c775/wordpress-photo-http-error.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.24124513618677%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAAAa0lEQVQY053P3QqDMAwF4Lz/EyqtN+22KmmWn111VwZFkIFg90HgBAKHQIwxhDAMY07ZzLQHsGpr7fsXEBE99dnmav1t9pFOzLwH0E5EhIgV0QNYj4/Zm2VKj1QWfwnoUGulG/zs+SplXjyvdNKK0u9nGnMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Wordpress photo upload HTTP error\"\n        title=\"Wordpress photo upload HTTP error\"\n        src=\"/static/e1d25b68e79aa30fcd0811c56d2c93a2/1c775/wordpress-photo-http-error.png\"\n        srcset=\"/static/e1d25b68e79aa30fcd0811c56d2c93a2/a1986/wordpress-photo-http-error.png 210w,\n/static/e1d25b68e79aa30fcd0811c56d2c93a2/ad7fb/wordpress-photo-http-error.png 420w,\n/static/e1d25b68e79aa30fcd0811c56d2c93a2/1c775/wordpress-photo-http-error.png 771w\"\n        sizes=\"(max-width: 771px) 100vw, 771px\"\n      />\n  </a>\n    </span></p>\n<p>In all these cases the problem was caused by the thumbnail generation Wordpress script.</p>\n<p>First of all check you theme thumbnail sizes if you use a custom theme. Chances are that some of the \"non-cropped\" image sizes are too big to be generated in a reasonable time or memory limit (these resources may unexpectedly end WP thumbnail generation script which is a direct cause of \"HTTP error\").\nThe easiest way is installing <a href=\"https://wordpress.org/plugins/simple-image-sizes/\">Simple Image Sizes</a> plugin and checking <em>Settings > Media</em> menu tab. Look for thumbnail sizes that are not cropped and/or has very large dimensions restrictions e.g. <strong>1920 x 9999 non-cropped</strong> is a good candidate.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/511cb1bb136adf55a80f1a6899430563/41412/too-large-image-thumbnail.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.601650412603151%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAAsSAAALEgHS3X78AAAANklEQVQI1x2KyQ0AMQjE0n+jyywwHKKAoPhlWT7fo6rcHUCQqgoIyf/R3RGxcWZWRGQ3M8vMC5VYN2A2Uz9jAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"HTTP error too large thumbnail\"\n        title=\"HTTP error too large thumbnail\"\n        src=\"/static/511cb1bb136adf55a80f1a6899430563/a3419/too-large-image-thumbnail.png\"\n        srcset=\"/static/511cb1bb136adf55a80f1a6899430563/a1986/too-large-image-thumbnail.png 210w,\n/static/511cb1bb136adf55a80f1a6899430563/ad7fb/too-large-image-thumbnail.png 420w,\n/static/511cb1bb136adf55a80f1a6899430563/a3419/too-large-image-thumbnail.png 840w,\n/static/511cb1bb136adf55a80f1a6899430563/4d498/too-large-image-thumbnail.png 1260w,\n/static/511cb1bb136adf55a80f1a6899430563/41412/too-large-image-thumbnail.png 1333w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>The reason is that if you upload narrow but tall image e.g 500x1500 this thumbnail size will have to generate enormously large photo.</p>\n<p>The other possible reason for \"HTTP error\" is too many image thumbnails that are generated by Wordpress, so the script doesn't manage to generate all of them before it hits PHP timeout.</p>\n<p>A third possible cause of \"HTTP error\" (probably most common) is your client uploading photos <strong>directly from a camera</strong>. This might be hard to solve as you generally don't want to tell your clients that image preprocessing is required before using them on the website (clients doesn't like to do anything more than drag and drop photos).\nFortunately, there is <a href=\"https://wordpress.org/plugins/imsanity/\">Imsanity</a> plugin which seems to be solving this issue. It resizes <strong>original</strong> images after file upload. Based on my recent experience with \"HTTP error\" I believe that this conversion takes place <strong>before thumbnails generation</strong> as installing Imsanity solves \"HTTP error\" caused by a large uploaded photo resolution.</p>","timeToRead":1,"rawMarkdownBody":"I had a few cases when clients report an \"HTTP error\" during photo upload. Which looks similar to this:\n\n![Wordpress photo upload HTTP error](img/wordpress-photo-http-error.png)\n\nIn all these cases the problem was caused by the thumbnail generation Wordpress script.\n\nFirst of all check you theme thumbnail sizes if you use a custom theme. Chances are that some of the \"non-cropped\" image sizes are too big to be generated in a reasonable time or memory limit (these resources may unexpectedly end WP thumbnail generation script which is a direct cause of \"HTTP error\").\nThe easiest way is installing [Simple Image Sizes](https://wordpress.org/plugins/simple-image-sizes/) plugin and checking *Settings > Media* menu tab. Look for thumbnail sizes that are not cropped and/or has very large dimensions restrictions e.g. **1920 x 9999 non-cropped** is a good candidate.\n\n![HTTP error too large thumbnail](img/too-large-image-thumbnail.png)\n\nThe reason is that if you upload narrow but tall image e.g 500x1500 this thumbnail size will have to generate enormously large photo.\n\nThe other possible reason for \"HTTP error\" is too many image thumbnails that are generated by Wordpress, so the script doesn't manage to generate all of them before it hits PHP timeout.\n\nA third possible cause of \"HTTP error\" (probably most common) is your client uploading photos **directly from a camera**. This might be hard to solve as you generally don't want to tell your clients that image preprocessing is required before using them on the website (clients doesn't like to do anything more than drag and drop photos).\nFortunately, there is [Imsanity](https://wordpress.org/plugins/imsanity/) plugin which seems to be solving this issue. It resizes **original** images after file upload. Based on my recent experience with \"HTTP error\" I believe that this conversion takes place **before thumbnails generation** as installing Imsanity solves \"HTTP error\" caused by a large uploaded photo resolution.\n","excerpt":"I had a few cases when clients report an \"HTTP error\" during photo upload. Which looks similar to this:  In all these cases the problem wasâ€¦","frontmatter":{"title":"Wordpress HTTP error when uploading a photo","slug":"wordpress-http-error-when-uploading-photo","date":"2017-04-14T16:25:00.000Z","tags":["wordpress"],"date_created":"2017-04-16T15:49:22.000Z","date_updated":"2017-04-16T16:32:44.000Z","author":"jan","feature_image":null}}},{"node":{"id":"93c12ca9-664d-5f01-9e85-4084c87e79f5","html":"<p>Opening PDFs directly on the web page was one of the requirements for my recent project. The obvious choice was to use the PDF.js library but using it directly is not as easy as I expect. You have to ensure separate page for PDF viewing and a lot of additional assets.\nFortunately, there is a gem (as usually) which does all of this for you. A <a href=\"https://github.com/senny/pdfjs_viewer-rails\">pdfjs_viewer-rails</a> works as a mountable rails engine so you don't need to worry about anything. Here is the setup process.</p>\n<h2>Add gem to the project</h2>\n<p>Modify your <code class=\"language-text\">Gemfile</code> file, add the following line:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">gem <span class=\"token string\">'pdfjs_viewer-rails'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Then add necessary routes inside <code class=\"language-text\">config/routes.rb</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">mount <span class=\"token constant\">PdfjsViewer</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Rails</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Engine</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">\"/pdfjs\"</span><span class=\"token punctuation\">,</span> as<span class=\"token punctuation\">:</span> <span class=\"token string\">'pdfjs'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Put that line anywhere between</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token constant\">Rails</span><span class=\"token punctuation\">.</span>application<span class=\"token punctuation\">.</span>routes<span class=\"token punctuation\">.</span>draw <span class=\"token keyword\">do</span>\n  <span class=\"token comment\"># e.g. here</span>\n<span class=\"token keyword\">end</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>lines.</p>\n<p>If you want to have an <code class=\"language-text\">&lt;iframe&gt;</code> with PDF.js preview just add the following lines to one of you view files e.g. <code class=\"language-text\">app/views/layouts/application.html.erb</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n  &lt;iframe src=\"&lt;%= link_to \"display using the full viewer\", pdfjs.full_path(file: \"/sample.pdf\") %>\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>iframe</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>","timeToRead":1,"rawMarkdownBody":"Opening PDFs directly on the web page was one of the requirements for my recent project. The obvious choice was to use the PDF.js library but using it directly is not as easy as I expect. You have to ensure separate page for PDF viewing and a lot of additional assets.\nFortunately, there is a gem (as usually) which does all of this for you. A [pdfjs_viewer-rails](https://github.com/senny/pdfjs_viewer-rails) works as a mountable rails engine so you don't need to worry about anything. Here is the setup process.\n\n## Add gem to the project\n\nModify your `Gemfile` file, add the following line:\n```ruby\ngem 'pdfjs_viewer-rails'\n```\n\nThen add necessary routes inside `config/routes.rb`:\n```ruby\nmount PdfjsViewer::Rails::Engine => \"/pdfjs\", as: 'pdfjs'\n```\nPut that line anywhere between\n```ruby\nRails.application.routes.draw do\n  # e.g. here\nend\n```\nlines.\n\nIf you want to have an `<iframe>` with PDF.js preview just add the following lines to one of you view files e.g. `app/views/layouts/application.html.erb`:\n```html\n<body>\n  <iframe src=\"<%= link_to \"display using the full viewer\", pdfjs.full_path(file: \"/sample.pdf\") %>\"></iframe>\n</body>\n```\n","excerpt":"Opening PDFs directly on the web page was one of the requirements for my recent project. The obvious choice was to use the PDF.js libraryâ€¦","frontmatter":{"title":"Rails 5 with PDF.js","slug":"rails-5-with-pdf-js","date":"2017-05-30T06:07:04.000Z","tags":["rails","ruby"],"date_created":"2017-04-16T02:49:13.000Z","date_updated":"2018-03-19T02:01:16.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1504355080015-bba52674577b.jpg","relativePath":"posts/img/photo-1504355080015-bba52674577b.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAeABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAUBAgQD/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABdCqBqKQrOgM53D//xAAZEAEAAwEBAAAAAAAAAAAAAAAAAhETIRD/2gAIAQEAAQUC0g0g0gta/OusmTJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGxAAAgMBAQEAAAAAAAAAAAAAAAECMTKSQUL/2gAIAQEABj8C0jSNI3I0zci4lxPktclrk85P/8QAIBAAAgEEAQUAAAAAAAAAAAAAAAHwESGR8eFRYXGBwf/aAAgBAQABPyHdG6N0JHeGBKn8+CTRetYZFdbwU5F3T7JEJUKeuA//2gAMAwEAAgADAAAAEBMAAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB4QAQACAgEFAAAAAAAAAAAAAAEAESExURBBgZGh/9oACAEBAAE/EOilW6WFLUcUwZR6O6mhg9LORCBoa+zlcHRKpnzBIXcekNh//9k=","aspectRatio":2,"src":"/static/a949d10626d8190ada00f7a5298b9b09/0defe/photo-1504355080015-bba52674577b.jpg","srcSet":"/static/a949d10626d8190ada00f7a5298b9b09/38b6a/photo-1504355080015-bba52674577b.jpg 150w,\n/static/a949d10626d8190ada00f7a5298b9b09/e201c/photo-1504355080015-bba52674577b.jpg 300w,\n/static/a949d10626d8190ada00f7a5298b9b09/0defe/photo-1504355080015-bba52674577b.jpg 600w,\n/static/a949d10626d8190ada00f7a5298b9b09/a71f1/photo-1504355080015-bba52674577b.jpg 900w,\n/static/a949d10626d8190ada00f7a5298b9b09/8d595/photo-1504355080015-bba52674577b.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"8f6e258b-ae4e-5e08-ae5c-eaa31ae0658f","html":"<p>A list of Vim regex examples which might be useful for code/text refactoring.</p>\n<h2>Not something (excluding some character)</h2>\n<p>The regex below will match every non-space character and replace it with nothing (so it will be removed).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">s/<span class=\"token punctuation\">[</span>^ <span class=\"token punctuation\">]</span>*//c</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Example line:\n<code class=\"language-text\">2017-0-05 13:05:15</code> will become <code class=\"language-text\">13:05:15</code></p>\n<p>Explanation:\nFrom the beginning of the line all non-space characters will be removed. Because there is no <code class=\"language-text\">g</code> (global) modifier the replacement process will stop after first encountered space.</p>","timeToRead":1,"rawMarkdownBody":"A list of Vim regex examples which might be useful for code/text refactoring.\n\n## Not something (excluding some character)\nThe regex below will match every non-space character and replace it with nothing (so it will be removed).\n\n```bash\ns/[^ ]*//c\n```\n\nExample line:\n`2017-0-05 13:05:15` will become ` 13:05:15`\n\nExplanation:\nFrom the beginning of the line all non-space characters will be removed. Because there is no `g` (global) modifier the replacement process will stop after first encountered space.\n","excerpt":"A list of Vim regex examples which might be useful for code/text refactoring. Not something (excluding some character) The regex below willâ€¦","frontmatter":{"title":"Vim regex examples","slug":"vim-regex-examples","date":"2018-03-20T02:10:00.000Z","tags":["vim","tools"],"date_created":"2017-04-15T20:14:45.000Z","date_updated":"2018-05-07T02:17:02.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1461749280684-dccba630e2f6.jpg","relativePath":"posts/img/photo-1461749280684-dccba630e2f6.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMCBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHhlXBIJ//EABgQAQADAQAAAAAAAAAAAAAAAAEAAhAz/9oACAEBAAEFAmOPSzn/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAADAQAAAAAAAAAAAAAAAAAAASAx/9oACAEBAAY/AmZP/8QAGhABAAIDAQAAAAAAAAAAAAAAAQAhEBExcf/aAAgBAQABPyEA90zyMd7jUTW5/9oADAMBAAIAAwAAABCQ/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxBX/8QAHBABAAICAwEAAAAAAAAAAAAAAQARITFBcZGh/9oACAEBAAE/EDNcmgIUBq/WdvsDQIEt8lLRziUy11P/2Q==","aspectRatio":2,"src":"/static/a07172f405ab381f96419ffb1fcbf1c9/0defe/photo-1461749280684-dccba630e2f6.jpg","srcSet":"/static/a07172f405ab381f96419ffb1fcbf1c9/38b6a/photo-1461749280684-dccba630e2f6.jpg 150w,\n/static/a07172f405ab381f96419ffb1fcbf1c9/e201c/photo-1461749280684-dccba630e2f6.jpg 300w,\n/static/a07172f405ab381f96419ffb1fcbf1c9/0defe/photo-1461749280684-dccba630e2f6.jpg 600w,\n/static/a07172f405ab381f96419ffb1fcbf1c9/a71f1/photo-1461749280684-dccba630e2f6.jpg 900w,\n/static/a07172f405ab381f96419ffb1fcbf1c9/8d595/photo-1461749280684-dccba630e2f6.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"b3187c05-9000-5548-9551-f9ac45b68604","html":"<p>This is a list of Bash commands that I frequently use with a short explanation. It may help you in everyday usage of your Unix based system. Tested on OS X but should also work on Ubuntu and others.</p>\n<h2>Listing files/folders sorted by time</h2>\n<p>When you need to find most recently edited file/folder in a directory this will be a useful command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">ls</span> -t</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Command details:</p>\n<ul>\n<li><code class=\"language-text\">ls</code> List directory contents</li>\n<li><code class=\"language-text\">-t</code> Sort by time modified (most recently modified first) before sorting the operands by lexicographical order</li>\n</ul>\n<hr>\n<h2>Rename files and folders recursively with find</h2>\n<p>The command is pretty simple:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">find</span> <span class=\"token builtin class-name\">.</span> -name some_name -execdir <span class=\"token function\">mv</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> other_name <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>It will rename all <code class=\"language-text\">some_name.*</code> files and <code class=\"language-text\">some_name</code> directories to <code class=\"language-text\">other_name</code> recursively.</p>\n<p>Command details:</p>\n<ul>\n<li><code class=\"language-text\">find</code> Walks a file hierarchy</li>\n<li><code class=\"language-text\">.</code> Path where to start searching for files</li>\n<li><code class=\"language-text\">-name some_name</code> Name of the files and/or directories which will be renamed</li>\n<li><code class=\"language-text\">-execdir mv {} other_name \\;</code> Command to execute for each file found where:</li>\n<li><code class=\"language-text\">mv</code> Move file</li>\n<li><code class=\"language-text\">{}</code> Current file name</li>\n<li><code class=\"language-text\">other_name</code> New file name</li>\n<li><code class=\"language-text\">\\;</code> Command termination</li>\n</ul>\n<hr>\n<h2>Rename multiple files inside folder with rename</h2>\n<p>For example changing a file extension in the current directory might look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">rename</span> <span class=\"token string\">'s/.js/.jsx/g'</span> *</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Command details:</p>\n<ul>\n<li><code class=\"language-text\">rename</code> Renames multiple files</li>\n<li><code class=\"language-text\">&#39;s/.js/.jsx/g&#39;</code> Regexp which will be applied to the name of every file</li>\n<li><code class=\"language-text\">*</code> Path for the modified files e.g. <code class=\"language-text\">imports/client/components</code></li>\n</ul>\n<hr>\n<h2>List sizes of all folders inside a directory</h2>\n<p>This is very useful if you want to find largest directories:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">du -sh *</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Command details:</p>\n<ul>\n<li><code class=\"language-text\">du</code> Display disk usage statistics</li>\n<li><code class=\"language-text\">-s</code> Display a summary for each specified file. (Equivalent to -d 0)</li>\n<li><code class=\"language-text\">-h</code> \"Human-readable\" output. Use unit suffixes: Byte, Kilobyte, Megabyte, Gigabyte, Terabyte and Petabyte.</li>\n<li><code class=\"language-text\">*</code> Path for the files to list</li>\n</ul>\n<p><strong>NOTE</strong>: If you want to sort that list by size you may use:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">du -sh * | sort -h</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Where <code class=\"language-text\">-h</code> in sort referes to the:</p>\n<blockquote>\n<p>-h --human-numeric-sort compare human readable numbers (e.g., 2K 1G)</p>\n</blockquote>\n<p>On OS X you will have to install <code class=\"language-text\">coreutils</code> package (it is as easy as typing <code class=\"language-text\">brew install coreutils</code>). If you don't use <a href=\"https://brew.sh/\">Homebrew</a> you should definitely start using it.\nFor Mac OS X the command will look as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">du -sh * | gsort -h</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","timeToRead":2,"rawMarkdownBody":"This is a list of Bash commands that I frequently use with a short explanation. It may help you in everyday usage of your Unix based system. Tested on OS X but should also work on Ubuntu and others.\n\n## Listing files/folders sorted by time\nWhen you need to find most recently edited file/folder in a directory this will be a useful command:\n\n```bash\nls -t\n```\nCommand details:\n\n- `ls` List directory contents\n- `-t` Sort by time modified (most recently modified first) before sorting the operands by lexicographical order\n\n---\n\n## Rename files and folders recursively with find\nThe command is pretty simple:\n```bash\nfind . -name some_name -execdir mv {} other_name \\;\n```\nIt will rename all `some_name.*` files and `some_name` directories to `other_name` recursively.\n\nCommand details:\n\n- `find` Walks a file hierarchy\n- `.` Path where to start searching for files\n- `-name some_name` Name of the files and/or directories which will be renamed\n- `-execdir mv {} other_name \\;` Command to execute for each file found where:\n - `mv` Move file\n - `{}` Current file name\n - `other_name` New file name\n - `\\;` Command termination\n\n---\n\n## Rename multiple files inside folder with rename\nFor example changing a file extension in the current directory might look like this:\n```bash\nrename 's/.js/.jsx/g' *\n```\nCommand details:\n\n- `rename` Renames multiple files\n- `'s/.js/.jsx/g'` Regexp which will be applied to the name of every file\n- `*` Path for the modified files e.g. `imports/client/components`\n\n---\n\n## List sizes of all folders inside a directory\nThis is very useful if you want to find largest directories:\n```sh\ndu -sh *\n```\nCommand details:\n\n- `du` Display disk usage statistics\n- `-s` Display a summary for each specified file. (Equivalent to -d 0)\n- `-h` \"Human-readable\" output. Use unit suffixes: Byte, Kilobyte, Megabyte, Gigabyte, Terabyte and Petabyte.\n- `*` Path for the files to list\n\n**NOTE**: If you want to sort that list by size you may use:\n```\ndu -sh * | sort -h\n```\nWhere `-h` in sort referes to the:\n\n> -h --human-numeric-sort compare human readable numbers (e.g., 2K 1G)\n\nOn OS X you will have to install `coreutils` package (it is as easy as typing `brew install coreutils`). If you don't use [Homebrew](https://brew.sh/) you should definitely start using it.\nFor Mac OS X the command will look as follows:\n```sh\ndu -sh * | gsort -h\n```\n","excerpt":"This is a list of Bash commands that I frequently use with a short explanation. It may help you in everyday usage of your Unix based systemâ€¦","frontmatter":{"title":"Useful Bash commands","slug":"useful-bash-commands","date":"2017-06-28T11:40:53.000Z","tags":["tools"],"date_created":"2017-04-11T12:25:28.000Z","date_updated":"2017-11-20T21:40:07.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/pexels-photo-30193.jpg","relativePath":"posts/img/pexels-photo-30193.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMFAQb/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAABUyVqdGSAv//EABoQAAIDAQEAAAAAAAAAAAAAAAECAAMREyH/2gAIAQEAAQUCNioUv96KYzbAcObP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAwEBAAAAAAAAAAAAAAAAACExEBH/2gAIAQEABj8CjHvSn//EABwQAQADAAIDAAAAAAAAAAAAAAEAETEhQVFhkf/aAAgBAQABPyFq1B9YR7OmbLYzt29matncrnxP/9oADAMBAAIAAwAAABCAP//EABYRAQEBAAAAAAAAAAAAAAAAAAARIf/aAAgBAwEBPxCNf//EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAgEBPxBkf//EABwQAQEBAAIDAQAAAAAAAAAAAAERADFBIVFhcf/aAAgBAQABPxBbEyAcn31hQosVLojkHTk0ap7aihTv8wrJfKKG/9k=","aspectRatio":2,"src":"/static/d3d6984921ff1430d261ef8d028ee01a/0defe/pexels-photo-30193.jpg","srcSet":"/static/d3d6984921ff1430d261ef8d028ee01a/38b6a/pexels-photo-30193.jpg 150w,\n/static/d3d6984921ff1430d261ef8d028ee01a/e201c/pexels-photo-30193.jpg 300w,\n/static/d3d6984921ff1430d261ef8d028ee01a/0defe/pexels-photo-30193.jpg 600w,\n/static/d3d6984921ff1430d261ef8d028ee01a/a71f1/pexels-photo-30193.jpg 900w,\n/static/d3d6984921ff1430d261ef8d028ee01a/9f6c3/pexels-photo-30193.jpg 1200w,\n/static/d3d6984921ff1430d261ef8d028ee01a/e95fb/pexels-photo-30193.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"ca6bdb5d-c371-5adb-9b8e-8ad0f56e4bd4","html":"<p>During my recent project development, I came across a problem of generating PDFs. Fortunately, there is a nice gem for creating PDF documents with Ruby which is named <a href=\"https://github.com/prawnpdf/prawn\">Prawn</a>. In a few lines below, I would like to explain how to use it with Rails 5. This will be just a minimal example with <strong>Hello World!</strong> document as a result.</p>\n<h2>1. Install Prawn gem:</h2>\n<p>Please check out what is the current gem version on <a href=\"https://rubygems.org/gems/prawn\">RubyGems.org</a> or <a href=\"https://github.com/prawnpdf/prawn/releases\">Github</a> and add similar line to your <code class=\"language-text\">Gemfile</code>:</p>\n<p><span class=\"filepath\"><strong>Gemfile</strong></span></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">gem <span class=\"token string\">'prawn'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'~>2.2.0'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>2. Extend one of your actions</h2>\n<p>Add <code class=\"language-text\">format.pdf</code> to one of your controllers. In my case it was <code class=\"language-text\">export_controller</code> but the name is irrelevant here. Just pick one of the actions e.g. <code class=\"language-text\">show</code> and inside <code class=\"language-text\">respond_to do |format|</code> block generate a PDF. Example:</p>\n<p><span class=\"filepath\"><strong>app/controllers/export_controller.rb</strong></span></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ExportController</span> <span class=\"token operator\">&lt;</span> <span class=\"token constant\">ApplicationController</span>\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">show</span></span>\n    respond_to <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>format<span class=\"token operator\">|</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">/</span> some other formats like<span class=\"token punctuation\">:</span> format<span class=\"token punctuation\">.</span>html <span class=\"token punctuation\">{</span> render <span class=\"token symbol\">:show</span> <span class=\"token punctuation\">}</span>\n\n      format<span class=\"token punctuation\">.</span>pdf <span class=\"token keyword\">do</span>\n        pdf <span class=\"token operator\">=</span> <span class=\"token constant\">Prawn</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Document</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span>\n        <span class=\"token class-name\">pdf<span class=\"token punctuation\">.</span>text</span> <span class=\"token string\">\"Hellow World!\"</span>\n        send_data pdf<span class=\"token punctuation\">.</span>render<span class=\"token punctuation\">,</span>\n          filename<span class=\"token punctuation\">:</span> <span class=\"token string\">\"export.pdf\"</span><span class=\"token punctuation\">,</span>\n          type<span class=\"token punctuation\">:</span> <span class=\"token string\">'application/pdf'</span><span class=\"token punctuation\">,</span>\n          disposition<span class=\"token punctuation\">:</span> <span class=\"token string\">'inline'</span>\n      <span class=\"token keyword\">end</span>\n    <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>That's it. Now when you visit correct URL with <code class=\"language-text\">.pdf</code> at the end you will see (or download) generated PDF file. In my case the URL in question is <code class=\"language-text\">http://localhost:3000/export/show.pdf</code>.</p>\n<p>But there is more!</p>\n<h2>3. PDF development</h2>\n<p>During the development, it is nice to have an easy way to preview the changes that you made. If you are using Google Chrome browser (as I do) you may notice that instead of opening PDFs inline the files are immediately downloaded. This is very inconvenient behavior if you are constantly changing your code and try to preview those changes.\nLuckily, the solution is quite easy, just install a PDF preview plugin/extension. I choose <a href=\"https://chrome.google.com/webstore/detail/pdf-viewer/oemmndcbldboiebfnladdacbdfmadadm?hl=en\">PDF Viewer</a> but you can install any other if you want. The point is that you should now be able to go to <code class=\"language-text\">http://localhost:3000/export/show.pdf</code> and view the PDF inline (as defined by the <code class=\"language-text\">disposition</code> in the example code) and refresh this preview just by hitting <em>cmd+r</em> (or <em>F5</em> on Windows).\nThis will be a huge improvement comparing to the downloading a file and then opening it.</p>\n<h2>4. PDF class</h2>\n<p>Code provided in step <strong>2.</strong> as a minimal example suffers from combining a controller code with an actual PDF document generation which will become an issue when the code for generating PDF grows. Here is one of the possible solutions.</p>\n<p>Create a separate class.</p>\n<p><span class=\"filepath\"><strong>app/pdfs/export_pdf.rb</strong></span></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ExportPdf</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> `include` instead of subclassing <span class=\"token constant\">Prawn</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Document</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> as advised by the official manual\n  include <span class=\"token constant\">Prawn</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">View</span>\n\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">initialize</span></span>\n    content\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">content</span></span>\n    text <span class=\"token string\">\"Hello World!\"</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> here comes more code <span class=\"token keyword\">for</span> generating <span class=\"token constant\">PDF</span> content\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Use this class inside your controller</p>\n<p><span class=\"filepath\"><strong>app/controllers/export_controller.rb</strong></span></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ExportController</span> <span class=\"token operator\">&lt;</span> <span class=\"token constant\">ApplicationController</span>\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">show</span></span>\n    respond_to <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>format<span class=\"token operator\">|</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">/</span> some other formats like<span class=\"token punctuation\">:</span> format<span class=\"token punctuation\">.</span>html <span class=\"token punctuation\">{</span> render <span class=\"token symbol\">:show</span> <span class=\"token punctuation\">}</span>\n\n      format<span class=\"token punctuation\">.</span>pdf <span class=\"token keyword\">do</span>\n        pdf <span class=\"token operator\">=</span> <span class=\"token constant\">ExportPdf</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span>\n        <span class=\"token class-name\">send_data</span> pdf<span class=\"token punctuation\">.</span>render<span class=\"token punctuation\">,</span>\n          filename<span class=\"token punctuation\">:</span> <span class=\"token string\">\"export.pdf\"</span><span class=\"token punctuation\">,</span>\n          type<span class=\"token punctuation\">:</span> <span class=\"token string\">'application/pdf'</span><span class=\"token punctuation\">,</span>\n          disposition<span class=\"token punctuation\">:</span> <span class=\"token string\">'inline'</span>\n      <span class=\"token keyword\">end</span>\n    <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>NOTE</strong>: There is no need to change anything more to autoload <code class=\"language-text\">app/pdfs/</code> classes. Just restart your development Rails server after adding <code class=\"language-text\">app/pdfs/export_pdf.rb</code> file. The folder will be autodetected and all the classes autoloaded.</p>\n<h2>5. Custom Google Font with Prawn gem</h2>\n<p>At some point you will probably want to have a custom font for PDFs generated by your application. It's quite easy if you know how to do that.</p>\n<p>First of all download font that you want to use from <a href=\"https://fonts.google.com/\">Google Fonts</a> for example <a href=\"https://fonts.google.com/specimen/Noto+Sans\">NotoSans</a>. Then extract downloaded zip file to the Rails vendor directory <span class=\"filepath\"><strong>vendor/assets/fonts/</strong></span>  so the file paths for the font files will be e.g. <span class=\"filepath\"><strong>vendor/assets/fonts/NotoSans-Regular.ttf</strong></span>, <span class=\"filepath\"><strong>vendor/assets/fonts/NotoSans-Italic.ttf</strong></span> etc.</p>\n<p>Now you should tell Prawn that you want to use selected custom font. Your code should look as follows if you use a separate class for PDF generation as described in <a href=\"#4pdfclass\">#4</a> (added lines/methods has some comments):</p>\n<p><span class=\"filepath\"><strong>app/pdfs/export_pdf.rb</strong></span></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ExportPdf</span>\n  include <span class=\"token constant\">Prawn</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">View</span>\n\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">initialize</span></span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n    font_setup <span class=\"token comment\"># this is a new line</span>\n    content\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token comment\"># This is the new method with font declaration</span>\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">font_setup</span></span>\n    font_families<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token string\">\"NotoSans\"</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token symbol\">:normal</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">\"vendor/assets/fonts/NotoSans-Regular.ttf\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token symbol\">:italic</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">\"vendor/assets/fonts/NotoSans-Italic.ttf\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token symbol\">:bold</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">\"vendor/assets/fonts/NotoSans-Bold.ttf\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    font <span class=\"token string\">\"NotoSans\"</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">content</span></span>\n    text <span class=\"token string\">\"Hello World!\"</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now you should have a custom font for your PDF. Here is the result:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.44529262086514%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAAAcUlEQVQY02Nwd3cvLCzs6enp7u5ubm5uggEgu6Ojo6+vr7W1tbERLtzU2NgIVFxcXOzi4sJgbm5+8ODB////v3795s/fv/8JgT9//gDJtWvXGhoaMlhaWh44cADI//bt219SNBsZGSE0Q0TppNnY2BgA0bHyCeakE6cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Prawn PDF Google Fonts NotoSans\"\n        title=\"Prawn PDF Google Fonts NotoSans\"\n        src=\"/static/1864caa493049683501e1bf10a6bf65d/a3419/prawn-pdf-custom-font-1.png\"\n        srcset=\"/static/1864caa493049683501e1bf10a6bf65d/a1986/prawn-pdf-custom-font-1.png 210w,\n/static/1864caa493049683501e1bf10a6bf65d/ad7fb/prawn-pdf-custom-font-1.png 420w,\n/static/1864caa493049683501e1bf10a6bf65d/a3419/prawn-pdf-custom-font-1.png 840w,\n/static/1864caa493049683501e1bf10a6bf65d/f1a60/prawn-pdf-custom-font-1.png 1179w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n    </span>\nand another with a <a href=\"https://fonts.google.com/specimen/Lobster\">Lobster</a> font (to show the difference):\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.59983150800337%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAAAfklEQVQY06WNPQoDIRCFPZLYqaXgpbyLGEVB0UNpvSlszYoZFvKz3YZ8xTDvzXsMEkIopUopMUbn3O2FtdZ7D34IwRjz9mGHpNZaSokwxjnntda23dcF5pwwW2uUUkQISSmB7r0/xti/mAf7mTEGhGutnPNPGQ4/ff6rzBh7ArVv+Y1aJc7fAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Prawn PDF custom font\"\n        title=\"Prawn PDF custom font\"\n        src=\"/static/bb9ca4135781a818209bcf59711c90b8/a3419/prawn-pdf-custom-lobster-font-1.png\"\n        srcset=\"/static/bb9ca4135781a818209bcf59711c90b8/a1986/prawn-pdf-custom-lobster-font-1.png 210w,\n/static/bb9ca4135781a818209bcf59711c90b8/ad7fb/prawn-pdf-custom-lobster-font-1.png 420w,\n/static/bb9ca4135781a818209bcf59711c90b8/a3419/prawn-pdf-custom-lobster-font-1.png 840w,\n/static/bb9ca4135781a818209bcf59711c90b8/07dbe/prawn-pdf-custom-lobster-font-1.png 1187w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n    </span></p>\n<p>Of course, this method will work for any kind of custom font if you have appropriate <strong>.ttf</strong> files.</p>\n<h2>Hints</h2>\n<p>In order to get document width (inner width without margins) use:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">bounds<span class=\"token punctuation\">.</span>width</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>This will work <strong>inside</strong> class which includes <strong>Prawn::View</strong>.</p>\n<h2>Issues encountered</h2>\n<p>Some of the errors which I have to solve during the <strong>prawn gem</strong> usage:</p>\n<ul>\n<li>\n<p><em>Prawn::Errors::IncompatibleStringEncoding</em></p>\n<p>It turns out that using LatinExtended charset letters like Ä™, Ä… and others requires using a custom font as described in <a href=\"#5customgooglefontwithprawngem\">#5</a></p>\n</li>\n</ul>\n<p>For more info about Prawn gem capabilities please refer to the official documentation <a href=\"http://prawnpdf.org/api-docs/2.0/\">http://prawnpdf.org/api-docs/2.0/</a> and especially to the manual <a href=\"http://prawnpdf.org/manual.pdf\">http://prawnpdf.org/manual.pdf</a> where all methods are described with examples.</p>\n<hr>\n<p>Sources:</p>\n<ul>\n<li><a href=\"https://rubyplus.com/articles/3891-PDFs-with-Prawn-in-Rails-5\">https://rubyplus.com/articles/3891-PDFs-with-Prawn-in-Rails-5</a></li>\n<li><a href=\"http://railscasts.com/episodes/153-pdfs-with-prawn?view=asciicast\">http://railscasts.com/episodes/153-pdfs-with-prawn?view=asciicast</a></li>\n<li><a href=\"https://www.sitepoint.com/pdf-generation-rails/\">https://www.sitepoint.com/pdf-generation-rails/</a></li>\n</ul>","timeToRead":5,"rawMarkdownBody":"During my recent project development, I came across a problem of generating PDFs. Fortunately, there is a nice gem for creating PDF documents with Ruby which is named [Prawn](https://github.com/prawnpdf/prawn). In a few lines below, I would like to explain how to use it with Rails 5. This will be just a minimal example with **Hello World!** document as a result.\n\n## 1. Install Prawn gem:\nPlease check out what is the current gem version on [RubyGems.org](https://rubygems.org/gems/prawn) or [Github](https://github.com/prawnpdf/prawn/releases) and add similar line to your `Gemfile`:\n\n\n<span class=\"filepath\">**Gemfile**</span>\n```ruby\ngem 'prawn', '~>2.2.0'\n```\n\n## 2. Extend one of your actions\nAdd `format.pdf` to one of your controllers. In my case it was `export_controller` but the name is irrelevant here. Just pick one of the actions e.g. `show` and inside `respond_to do |format|` block generate a PDF. Example:\n\n<span class=\"filepath\">**app/controllers/export_controller.rb**</span>\n```ruby\nclass ExportController < ApplicationController\n  def show\n    respond_to do |format|\n      // some other formats like: format.html { render :show }\n\n      format.pdf do\n        pdf = Prawn::Document.new\n        pdf.text \"Hellow World!\"\n        send_data pdf.render,\n          filename: \"export.pdf\",\n          type: 'application/pdf',\n          disposition: 'inline'\n      end\n    end\n  end\nend\n```\nThat's it. Now when you visit correct URL with `.pdf` at the end you will see (or download) generated PDF file. In my case the URL in question is `http://localhost:3000/export/show.pdf`.\n\nBut there is more!\n\n## 3. PDF development\nDuring the development, it is nice to have an easy way to preview the changes that you made. If you are using Google Chrome browser (as I do) you may notice that instead of opening PDFs inline the files are immediately downloaded. This is very inconvenient behavior if you are constantly changing your code and try to preview those changes.\nLuckily, the solution is quite easy, just install a PDF preview plugin/extension. I choose [PDF Viewer](https://chrome.google.com/webstore/detail/pdf-viewer/oemmndcbldboiebfnladdacbdfmadadm?hl=en) but you can install any other if you want. The point is that you should now be able to go to `http://localhost:3000/export/show.pdf` and view the PDF inline (as defined by the `disposition` in the example code) and refresh this preview just by hitting *cmd+r* (or *F5* on Windows).\nThis will be a huge improvement comparing to the downloading a file and then opening it.\n\n## 4. PDF class\nCode provided in step **2.** as a minimal example suffers from combining a controller code with an actual PDF document generation which will become an issue when the code for generating PDF grows. Here is one of the possible solutions.\n\nCreate a separate class.\n\n<span class=\"filepath\">**app/pdfs/export_pdf.rb**</span>\n\n```ruby\nclass ExportPdf\n  // `include` instead of subclassing Prawn::Document\n  // as advised by the official manual\n  include Prawn::View\n\n  def initialize\n    content\n  end\n\n  def content\n    text \"Hello World!\"\n    // here comes more code for generating PDF content\n    // ...\n  end\nend\n```\n\nUse this class inside your controller\n\n<span class=\"filepath\">**app/controllers/export_controller.rb**</span>\n```ruby\nclass ExportController < ApplicationController\n  def show\n    respond_to do |format|\n      // some other formats like: format.html { render :show }\n\n      format.pdf do\n        pdf = ExportPdf.new\n        send_data pdf.render,\n          filename: \"export.pdf\",\n          type: 'application/pdf',\n          disposition: 'inline'\n      end\n    end\n  end\nend\n```\n\n**NOTE**: There is no need to change anything more to autoload `app/pdfs/` classes. Just restart your development Rails server after adding `app/pdfs/export_pdf.rb` file. The folder will be autodetected and all the classes autoloaded.\n\n## 5. Custom Google Font with Prawn gem\nAt some point you will probably want to have a custom font for PDFs generated by your application. It's quite easy if you know how to do that.\n\nFirst of all download font that you want to use from [Google Fonts](https://fonts.google.com/) for example [NotoSans](https://fonts.google.com/specimen/Noto+Sans). Then extract downloaded zip file to the Rails vendor directory <span class=\"filepath\">**vendor/assets/fonts/**</span>  so the file paths for the font files will be e.g. <span class=\"filepath\">**vendor/assets/fonts/NotoSans-Regular.ttf**</span>, <span class=\"filepath\">**vendor/assets/fonts/NotoSans-Italic.ttf**</span> etc.\n\nNow you should tell Prawn that you want to use selected custom font. Your code should look as follows if you use a separate class for PDF generation as described in [#4](#4pdfclass) (added lines/methods has some comments):\n\n<span class=\"filepath\">**app/pdfs/export_pdf.rb**</span>\n```ruby\nclass ExportPdf\n  include Prawn::View\n\n  def initialize(data)\n    font_setup # this is a new line\n    content\n  end\n\n  # This is the new method with font declaration\n  def font_setup\n    font_families.update(\"NotoSans\" => {\n      :normal => \"vendor/assets/fonts/NotoSans-Regular.ttf\",\n      :italic => \"vendor/assets/fonts/NotoSans-Italic.ttf\",\n      :bold => \"vendor/assets/fonts/NotoSans-Bold.ttf\",\n    })\n    font \"NotoSans\"\n  end\n\n  def content\n    text \"Hello World!\"\n  end\nend\n```\n\nNow you should have a custom font for your PDF. Here is the result:\n![Prawn PDF Google Fonts NotoSans](img/prawn-pdf-custom-font-1.png)\nand another with a [Lobster](https://fonts.google.com/specimen/Lobster) font (to show the difference):\n![Prawn PDF custom font](img/prawn-pdf-custom-lobster-font-1.png)\n\nOf course, this method will work for any kind of custom font if you have appropriate **.ttf** files.\n\n## Hints\nIn order to get document width (inner width without margins) use:\n```ruby\nbounds.width\n```\nThis will work **inside** class which includes **Prawn::View**.\n\n## Issues encountered\nSome of the errors which I have to solve during the **prawn gem** usage:\n\n- *Prawn::Errors::IncompatibleStringEncoding*\n\n  It turns out that using LatinExtended charset letters like Ä™, Ä… and others requires using a custom font as described in [#5](#5customgooglefontwithprawngem)\n\n\nFor more info about Prawn gem capabilities please refer to the official documentation http://prawnpdf.org/api-docs/2.0/ and especially to the manual http://prawnpdf.org/manual.pdf where all methods are described with examples.\n\n---\nSources:\n\n- https://rubyplus.com/articles/3891-PDFs-with-Prawn-in-Rails-5\n- http://railscasts.com/episodes/153-pdfs-with-prawn?view=asciicast\n- https://www.sitepoint.com/pdf-generation-rails/\n","excerpt":"During my recent project development, I came across a problem of generating PDFs. Fortunately, there is a nice gem for creating PDFâ€¦","frontmatter":{"title":"Generate PDF with Prawn gem in Rails 5 application","slug":"using-prawn-gem-for-generating-pdfs-in-rails-5","date":"2017-04-05T17:38:51.000Z","tags":["rails","ruby"],"date_created":"2017-04-05T15:56:08.000Z","date_updated":"2018-09-15T19:13:14.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1532377606-cdcdb6bd7f08.jpg","relativePath":"posts/img/photo-1532377606-cdcdb6bd7f08.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABQABAv/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAFLs3RSFl//xAAbEAACAgMBAAAAAAAAAAAAAAAAAgEhAxESMv/aAAgBAQABBQJslq1bgb1J1J//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwFH/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8BV//EABkQAAIDAQAAAAAAAAAAAAAAAAABAhAhEf/aAAgBAQAGPwLiZtRrEj//xAAZEAACAwEAAAAAAAAAAAAAAAAAARExYSH/2gAIAQEAAT8hWoxPR7rk2O8pOVSGx0NP/9oADAMBAAIAAwAAABA0D//EABYRAQEBAAAAAAAAAAAAAAAAABEBEP/aAAgBAwEBPxBgGP/EABYRAQEBAAAAAAAAAAAAAAAAAAEREP/aAAgBAgEBPxAEbc//xAAbEAEAAwADAQAAAAAAAAAAAAABABFRITFhQf/aAAgBAQABPxA0nb7PNgZr+EezXJ5IVIF7V3LMtJGSEcan/9k=","aspectRatio":2,"src":"/static/631ebc9752855580b7da983e498fa674/0defe/photo-1532377606-cdcdb6bd7f08.jpg","srcSet":"/static/631ebc9752855580b7da983e498fa674/38b6a/photo-1532377606-cdcdb6bd7f08.jpg 150w,\n/static/631ebc9752855580b7da983e498fa674/e201c/photo-1532377606-cdcdb6bd7f08.jpg 300w,\n/static/631ebc9752855580b7da983e498fa674/0defe/photo-1532377606-cdcdb6bd7f08.jpg 600w,\n/static/631ebc9752855580b7da983e498fa674/a71f1/photo-1532377606-cdcdb6bd7f08.jpg 900w,\n/static/631ebc9752855580b7da983e498fa674/8d595/photo-1532377606-cdcdb6bd7f08.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"7e5d546d-2e87-5c57-bb35-b5a1557cd577","html":"<p>This is a list of useful Wordpress plugins which I use in my projects. Each plugin will have a short description in which I would try to justify its usage. I'm writing from a developer point of view so if you are a regular Wordpress user some of the plugins mentioned below may not be useful for you.</p>\n<h2>clean-image-filenames</h2>\n<p><a href=\"https://wordpress.org/plugins/clean-image-filenames/\">https://wordpress.org/plugins/clean-image-filenames/</a></p>\n<p>This will enforce correct file names, without any weird language specific letters. This is the problem especially for the Safari PDFs which seems to be broken when the filename contains any letters like Ä…, Ä™, and others. What is more, this plugin will also take care of white spaces in a filename and normalize letters to make all of them lowercase.</p>\n<p>Just don't forget to enable it for <strong>All file types</strong>:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d669e1abc7849224d692375abda0922b/d2551/clean-image-filenames-settings-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.845007451564832%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAAAmklEQVQY03WQwQ6DIBBE+f/fK5iKEFqQlYpWELh3MS1e6sseJrMDGSB9z5V6CCE558MgLEDOeW+k/S8p1QW5UXrvOWMd3sJop5Ty3rvXyTzP7idOx7l1XcnXdc5aixYAaG3GA3TGKi2OMQYsNK2fGs8RyjpMt6o5Jf/ehJT4hmmaSinpglobE35ZYowhhHiwhSBl/QIsgol4zQcr7hHuVO/yNgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"clean image filenames settings 1\"\n        title=\"clean image filenames settings 1\"\n        src=\"/static/d669e1abc7849224d692375abda0922b/a3419/clean-image-filenames-settings-1.png\"\n        srcset=\"/static/d669e1abc7849224d692375abda0922b/a1986/clean-image-filenames-settings-1.png 210w,\n/static/d669e1abc7849224d692375abda0922b/ad7fb/clean-image-filenames-settings-1.png 420w,\n/static/d669e1abc7849224d692375abda0922b/a3419/clean-image-filenames-settings-1.png 840w,\n/static/d669e1abc7849224d692375abda0922b/4d498/clean-image-filenames-settings-1.png 1260w,\n/static/d669e1abc7849224d692375abda0922b/d2551/clean-image-filenames-settings-1.png 1342w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p><strong>NOTE</strong> The configuration is placed inside <em>Settings > Media</em> tab which might be not so obvious.</p>\n<p>Switching from the default <strong>Images only</strong> to <strong>All file types</strong> is one of the first things I do when starting a new Wordpress project.\nClean Images Filenames plugin supports running from <em>mu-plugins/</em> folder which is also a useful feature as it saves a few moments required for manual activation.</p>\n<h2>fly-dynamic-image-resizer</h2>\n<p><a href=\"https://wordpress.org/plugins/fly-dynamic-image-resizer/\">https://wordpress.org/plugins/fly-dynamic-image-resizer/</a></p>\n<p>One of my recent findings. A very handy plugin if your theme should support a wide range of image sizes e.g. for nice theme responsiveness. Of course, it is only useful if you are developing your own custom theme.</p>\n<p>Fly Dynamic Image Resizer will also run smoothly from <em>mu-plugins/</em> directory.</p>\n<h2>svg-support</h2>\n<p><a href=\"https://wordpress.org/plugins/svg-support/\">https://wordpress.org/plugins/svg-support/</a></p>\n<p>This is perfect plugin if you want to upload SVGs to the gallery and use it in your posts. What is more, by adding <code class=\"language-text\">style-svg</code> CSS class to the <code class=\"language-text\">&lt;img&gt;</code> element you may dynamically inline SVGs in a custom theme. The main advantage of this feature is the ability to style such inlined SVG with the CSS, so it's possible to apply CSS transitions to the SVG image!</p>\n<h2>advanced-custom-fields (advanced-custom-fields-pro)</h2>\n<p><a href=\"https://wordpress.org/plugins/advanced-custom-fields/\">https://wordpress.org/plugins/advanced-custom-fields/</a></p>\n<p>My favorite \"custom fields\" plugin especially thanks to the great documentation and nice <a href=\"https://www.advancedcustomfields.com/resources/register-fields-via-php/\">PHP API</a> which allows defining fields directly in code (without clicking and wasting time in admin panel). The PRO version, which is not free, is even more awesome, because of the new field types provided (IMO worth every penny).</p>\n<p>TO BE CONTINUE...</p>\n<p>TODO: check the <a href=\"https://wordpress.org/plugins/wp-smushit/\">https://wordpress.org/plugins/wp-smushit/</a> (mixed feelings because the images after optimization has slightly different colors than before)</p>\n<p>GTmetrix service shows great improvement in \"Optimize images\" statistics from F(15) to A(96). So this plugin might be a nice option for sites where image colors are not so important.</p>\n<p>TODO: check the <a href=\"https://www.gravityhelp.com/documentation/article/api-functions\">https://www.gravityhelp.com/documentation/article/api-functions</a> and find out if Gravityforms has a decent PHP API (like ACF)</p>","timeToRead":2,"rawMarkdownBody":"This is a list of useful Wordpress plugins which I use in my projects. Each plugin will have a short description in which I would try to justify its usage. I'm writing from a developer point of view so if you are a regular Wordpress user some of the plugins mentioned below may not be useful for you.\n\n\n## clean-image-filenames\nhttps://wordpress.org/plugins/clean-image-filenames/\n\nThis will enforce correct file names, without any weird language specific letters. This is the problem especially for the Safari PDFs which seems to be broken when the filename contains any letters like Ä…, Ä™, and others. What is more, this plugin will also take care of white spaces in a filename and normalize letters to make all of them lowercase.\n\nJust don't forget to enable it for **All file types**:\n![](img/clean-image-filenames-settings-1.png)\n\n**NOTE** The configuration is placed inside *Settings > Media* tab which might be not so obvious.\n\nSwitching from the default **Images only** to **All file types** is one of the first things I do when starting a new Wordpress project.\nClean Images Filenames plugin supports running from *mu-plugins/* folder which is also a useful feature as it saves a few moments required for manual activation.\n\n\n## fly-dynamic-image-resizer\nhttps://wordpress.org/plugins/fly-dynamic-image-resizer/\n\nOne of my recent findings. A very handy plugin if your theme should support a wide range of image sizes e.g. for nice theme responsiveness. Of course, it is only useful if you are developing your own custom theme.\n\nFly Dynamic Image Resizer will also run smoothly from *mu-plugins/* directory.\n\n\n## svg-support\nhttps://wordpress.org/plugins/svg-support/\n\nThis is perfect plugin if you want to upload SVGs to the gallery and use it in your posts. What is more, by adding `style-svg` CSS class to the `<img>` element you may dynamically inline SVGs in a custom theme. The main advantage of this feature is the ability to style such inlined SVG with the CSS, so it's possible to apply CSS transitions to the SVG image!\n\n\n## advanced-custom-fields (advanced-custom-fields-pro)\nhttps://wordpress.org/plugins/advanced-custom-fields/\n\nMy favorite \"custom fields\" plugin especially thanks to the great documentation and nice [PHP API](https://www.advancedcustomfields.com/resources/register-fields-via-php/) which allows defining fields directly in code (without clicking and wasting time in admin panel). The PRO version, which is not free, is even more awesome, because of the new field types provided (IMO worth every penny).\n\n\n\nTO BE CONTINUE...\n\nTODO: check the https://wordpress.org/plugins/wp-smushit/ (mixed feelings because the images after optimization has slightly different colors than before)\n\nGTmetrix service shows great improvement in \"Optimize images\" statistics from F(15) to A(96). So this plugin might be a nice option for sites where image colors are not so important.\n\n\nTODO: check the https://www.gravityhelp.com/documentation/article/api-functions and find out if Gravityforms has a decent PHP API (like ACF)\n","excerpt":"This is a list of useful Wordpress plugins which I use in my projects. Each plugin will have a short description in which I would try toâ€¦","frontmatter":{"title":"Wordpress plugins","slug":"wordpress-plugins","date":"2017-04-05T02:45:24.000Z","tags":["wordpress","wordpress-plugins"],"date_created":"2017-04-05T01:41:37.000Z","date_updated":"2017-08-21T14:32:40.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/cable-541068_1280.jpg","relativePath":"posts/img/cable-541068_1280.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABz5Cgf//EABcQAAMBAAAAAAAAAAAAAAAAAAABMRH/2gAIAQEAAQUCcph//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFRABAQAAAAAAAAAAAAAAAAAAECH/2gAIAQEABj8Cj//EABgQAAIDAAAAAAAAAAAAAAAAAAARYYGx/9oACAEBAAE/IXkHbBD/2gAMAwEAAgADAAAAEHfP/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/EI1//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAQEBAAMAAAAAAAAAAAAAAREhADFBUf/aAAgBAQABPxDUzGl98IGSCl8uIaC/U7//2Q==","aspectRatio":2,"src":"/static/3fb1cc3eece05d91c38f7adcc1e21ed5/0defe/cable-541068_1280.jpg","srcSet":"/static/3fb1cc3eece05d91c38f7adcc1e21ed5/38b6a/cable-541068_1280.jpg 150w,\n/static/3fb1cc3eece05d91c38f7adcc1e21ed5/e201c/cable-541068_1280.jpg 300w,\n/static/3fb1cc3eece05d91c38f7adcc1e21ed5/0defe/cable-541068_1280.jpg 600w,\n/static/3fb1cc3eece05d91c38f7adcc1e21ed5/a71f1/cable-541068_1280.jpg 900w,\n/static/3fb1cc3eece05d91c38f7adcc1e21ed5/9f6c3/cable-541068_1280.jpg 1200w,\n/static/3fb1cc3eece05d91c38f7adcc1e21ed5/e95fb/cable-541068_1280.jpg 1280w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"07c06091-35f0-5ee8-a554-205f1980c147","html":"<p>ScrollMagic is a great JS library which makes you page look lively. Here is how I manage to integrate it with my Webpack based build process.</p>\n<p>For starters, install the ScrollMagic and GSAP via npm:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev scrollmagic gsap</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Adjust Webpack config (<code class=\"language-text\">webpack.config.js</code>) by adding:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  resolve<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    alias<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"TweenLite\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gsap/src/uncompressed/TweenLite.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TweenMax\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gsap/src/uncompressed/TweenMax.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TimelineLite\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gsap/src/uncompressed/TimelineLite.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TimelineMax\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gsap/src/uncompressed/TimelineMax.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"ScrollMagic\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'scrollmagic/scrollmagic/uncompressed/ScrollMagic.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"animation.gsap\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'scrollmagic/scrollmagic/uncompressed/plugins/animation.gsap.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"debug.addIndicators\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'scrollmagic/scrollmagic/uncompressed/plugins/debug.addIndicators.js'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Then in your JS file use the following sample code, this is the file where you write all JS for your site e.g. <code class=\"language-text\">assets/js/custom.js</code> (name and path depends on your Webpack config):</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> ScrollMagic <span class=\"token keyword\">from</span> <span class=\"token string\">'scrollmagic/scrollmagic/uncompressed/ScrollMagic'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'scrollmagic/scrollmagic/uncompressed/plugins/animation.gsap'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'scrollmagic/scrollmagic/uncompressed/plugins/debug.addIndicators'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> TweenMax <span class=\"token keyword\">from</span> <span class=\"token string\">'gsap/src/uncompressed/TweenMax'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> TimelineMax <span class=\"token keyword\">from</span> <span class=\"token string\">'gsap/src/uncompressed/TimelineMax'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// init controller</span>\n<span class=\"token keyword\">const</span> controller <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ScrollMagic<span class=\"token punctuation\">.</span>Controller</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// build scene</span>\n<span class=\"token keyword\">const</span> scene <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ScrollMagic<span class=\"token punctuation\">.</span>Scene</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          triggerElement<span class=\"token punctuation\">:</span> <span class=\"token string\">\"main.content\"</span><span class=\"token punctuation\">,</span> duration<span class=\"token punctuation\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span> offset<span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">100</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">setTween</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".post-title\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>scale<span class=\"token punctuation\">:</span> <span class=\"token number\">2.5</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// trigger a TweenMax.to tween</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">addIndicators</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"2 (duration: 300)\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// add indicators (requires plugin)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">addTo</span><span class=\"token punctuation\">(</span>controller<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>NOTE</strong>: If you want to use minified version (and you probably should in production) replace all <em>uncompressed</em> with <em>minified</em> and add <em>.min</em> extensions to the file names. You should replace file paths in both places: JS file (e.g. <code class=\"language-text\">assets/js/custom.js</code>) and Webpack configuration (<code class=\"language-text\">webpack.config.js</code>).</p>\n<p>If you use compressed version in you JS file and uncompressed inside Webpack config you will end up with the following error (or similar):</p>\n<p><code class=\"language-text\">Error: Cannot resolve module &#39;TweenMax&#39;</code> or <code class=\"language-text\">Error: Cannot resolve module &#39;TimelineMax&#39;</code>.</p>\n<p>Examples for minified version:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  resolve<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    alias<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"TweenLite\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gsap/src/minified/TweenLite.min.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TweenMax\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gsap/src/minified/TweenMax.min.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TimelineLite\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gsap/src/minified/TimelineLite.min.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TimelineMax\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gsap/src/minified/TimelineMax.min.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"ScrollMagic\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'scrollmagic/scrollmagic/minified/ScrollMagic.min.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"animation.gsap\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'scrollmagic/scrollmagic/minified/plugins/animation.gsap.min.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"debug.addIndicators\"</span><span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'scrollmagic/scrollmagic/minified/plugins/debug.addIndicators.min.js'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>and</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> ScrollMagic <span class=\"token keyword\">from</span> <span class=\"token string\">'scrollmagic/scrollmagic/minified/ScrollMagic.min'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'scrollmagic/scrollmagic/minified/plugins/animation.gsap.min'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'scrollmagic/scrollmagic/minified/plugins/debug.addIndicators.min'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> TweenMax <span class=\"token keyword\">from</span> <span class=\"token string\">'gsap/src/minified/TweenMax.min'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> TimelineMax <span class=\"token keyword\">from</span> <span class=\"token string\">'gsap/src/minified/TimelineMax.min'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// remaining JS code...</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Sources</h2>\n<p><a href=\"https://github.com/janpaepke/ScrollMagic/wiki/Getting-Started-:-Using-AMD\">https://github.com/janpaepke/ScrollMagic/wiki/Getting-Started-:-Using-AMD</a></p>","timeToRead":2,"rawMarkdownBody":"ScrollMagic is a great JS library which makes you page look lively. Here is how I manage to integrate it with my Webpack based build process.\n\nFor starters, install the ScrollMagic and GSAP via npm:\n\n```bash\nnpm install --save-dev scrollmagic gsap\n```\n\nAdjust Webpack config (`webpack.config.js`) by adding:\n\n```javascript\n  resolve: {\n    alias: {\n        \"TweenLite\": path.resolve('node_modules', 'gsap/src/uncompressed/TweenLite.js'),\n        \"TweenMax\": path.resolve('node_modules', 'gsap/src/uncompressed/TweenMax.js'),\n        \"TimelineLite\": path.resolve('node_modules', 'gsap/src/uncompressed/TimelineLite.js'),\n        \"TimelineMax\": path.resolve('node_modules', 'gsap/src/uncompressed/TimelineMax.js'),\n        \"ScrollMagic\": path.resolve('node_modules', 'scrollmagic/scrollmagic/uncompressed/ScrollMagic.js'),\n        \"animation.gsap\": path.resolve('node_modules', 'scrollmagic/scrollmagic/uncompressed/plugins/animation.gsap.js'),\n        \"debug.addIndicators\": path.resolve('node_modules', 'scrollmagic/scrollmagic/uncompressed/plugins/debug.addIndicators.js')\n    },\n  },\n```\n\nThen in your JS file use the following sample code, this is the file where you write all JS for your site e.g. `assets/js/custom.js` (name and path depends on your Webpack config):\n\n```javascript\nimport ScrollMagic from 'scrollmagic/scrollmagic/uncompressed/ScrollMagic';\nimport 'scrollmagic/scrollmagic/uncompressed/plugins/animation.gsap';\nimport 'scrollmagic/scrollmagic/uncompressed/plugins/debug.addIndicators';\nimport TweenMax from 'gsap/src/uncompressed/TweenMax';\nimport TimelineMax from 'gsap/src/uncompressed/TimelineMax';\n\n// init controller\nconst controller = new ScrollMagic.Controller();\n\n// build scene\nconst scene = new ScrollMagic.Scene({\n          triggerElement: \"main.content\", duration: 300, offset: -100\n        })\n        .setTween(\".post-title\", 0.5, {scale: 2.5}) // trigger a TweenMax.to tween\n        .addIndicators({name: \"2 (duration: 300)\"}) // add indicators (requires plugin)\n        .addTo(controller);\n```\n\n**NOTE**: If you want to use minified version (and you probably should in production) replace all *uncompressed* with *minified* and add *.min* extensions to the file names. You should replace file paths in both places: JS file (e.g. `assets/js/custom.js`) and Webpack configuration (`webpack.config.js`).\n\nIf you use compressed version in you JS file and uncompressed inside Webpack config you will end up with the following error (or similar):\n\n`Error: Cannot resolve module 'TweenMax'` or `Error: Cannot resolve module 'TimelineMax'`.\n\nExamples for minified version:\n```javascript\n  resolve: {\n    alias: {\n        \"TweenLite\": path.resolve('node_modules', 'gsap/src/minified/TweenLite.min.js'),\n        \"TweenMax\": path.resolve('node_modules', 'gsap/src/minified/TweenMax.min.js'),\n        \"TimelineLite\": path.resolve('node_modules', 'gsap/src/minified/TimelineLite.min.js'),\n        \"TimelineMax\": path.resolve('node_modules', 'gsap/src/minified/TimelineMax.min.js'),\n        \"ScrollMagic\": path.resolve('node_modules', 'scrollmagic/scrollmagic/minified/ScrollMagic.min.js'),\n        \"animation.gsap\": path.resolve('node_modules', 'scrollmagic/scrollmagic/minified/plugins/animation.gsap.min.js'),\n        \"debug.addIndicators\": path.resolve('node_modules', 'scrollmagic/scrollmagic/minified/plugins/debug.addIndicators.min.js')\n    },\n  },\n```\n\nand\n\n```javascript\nimport ScrollMagic from 'scrollmagic/scrollmagic/minified/ScrollMagic.min';\nimport 'scrollmagic/scrollmagic/minified/plugins/animation.gsap.min';\nimport 'scrollmagic/scrollmagic/minified/plugins/debug.addIndicators.min';\nimport TweenMax from 'gsap/src/minified/TweenMax.min';\nimport TimelineMax from 'gsap/src/minified/TimelineMax.min';\n\n// remaining JS code...\n```\n\n## Sources\n\nhttps://github.com/janpaepke/ScrollMagic/wiki/Getting-Started-:-Using-AMD\n","excerpt":"ScrollMagic is a great JS library which makes you page look lively. Here is how I manage to integrate it with my Webpack based build processâ€¦","frontmatter":{"title":"ScrollMagic setup for Webpack (a CommonJS setup)","slug":"scrollmagic-setup-for-webpack-commonjs","date":"2017-05-12T12:49:51.000Z","tags":["javascript","webpack"],"date_created":"2017-04-04T05:00:53.000Z","date_updated":"2018-12-13T18:51:42.000Z","author":"jan","feature_image":null}}},{"node":{"id":"590bac45-042d-539a-bb17-38e3aa148dda","html":"<p>While defining custom errors is described in <a href=\"http://dry-rb.org/gems/dry-validation/error-messages/\">the official documentation</a> I had a few issues. Here are my findings.</p>\n<p>First of all <code class=\"language-text\">i18n</code> integration and custom messages requires you to restart the dev server <strong>it's important</strong>. You should do a restart after making any changes in the <code class=\"language-text\">yaml</code> file. It seems that <code class=\"language-text\">dry-validation</code> caches somehow all the error messages, which is quite annoying if you are unsure how to properly structure your translations file.</p>\n<p>Combining namespaces and i18n is not as straight forward as you may expect. Here is the example:</p>\n<p><strong>Yaml file with translations</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">pl</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">errors</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># default messages for this locale</span>\n    <span class=\"token key atrule\">filled?</span><span class=\"token punctuation\">:</span> This field shouldn't be blank\n    <span class=\"token key atrule\">str?</span><span class=\"token punctuation\">:</span> Something about the string requirement\n\n    <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># namespaced messages</span>\n      <span class=\"token key atrule\">note</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># namespace name</span>\n        <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">content</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># checked field name</span>\n            <span class=\"token key atrule\">filled?</span><span class=\"token punctuation\">:</span> Namespaced message</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>Code which uses this translations</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">schema <span class=\"token operator\">=</span> <span class=\"token constant\">Dry</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Validation</span><span class=\"token punctuation\">.</span><span class=\"token constant\">Form</span> <span class=\"token keyword\">do</span>\n  configure <span class=\"token punctuation\">{</span>\n    config<span class=\"token punctuation\">.</span>namespace <span class=\"token operator\">=</span> <span class=\"token symbol\">:note</span>\n    config<span class=\"token punctuation\">.</span>messages <span class=\"token operator\">=</span> <span class=\"token symbol\">:i18n</span>\n  <span class=\"token punctuation\">}</span>\n  required<span class=\"token punctuation\">(</span><span class=\"token symbol\">:content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>filled<span class=\"token punctuation\">(</span><span class=\"token symbol\">:str?</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span>\n\nschema<span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>to_unsafe_h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">(</span>locale<span class=\"token punctuation\">:</span> <span class=\"token constant\">I18n</span><span class=\"token punctuation\">.</span>default_locale<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># expected result: {:content => [\"Namespaced message\"]}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>While using <code class=\"language-text\">i18n</code> integration with a Rails application there is <strong>no need to provide</strong> custom <code class=\"language-text\">yaml</code> file path with:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">schema = Dry::Validation.Form do\n  configure { config.messages_file = &#39;/path/to/my/errors.yml&#39; }\nend</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>The custom error messages will be loaded like any other translations from your <code class=\"language-text\">config/locales/[any-name].yml</code> file.</p>\n<h2>Disclaimer</h2>\n<p>These are just my findings during integration with existing Rails App I may be mistaken at some points (or maybe even all of them). So be careful if you try to follow this path.</p>","timeToRead":1,"rawMarkdownBody":"While defining custom errors is described in [the official documentation](http://dry-rb.org/gems/dry-validation/error-messages/) I had a few issues. Here are my findings.\n\nFirst of all `i18n` integration and custom messages requires you to restart the dev server **it's important**. You should do a restart after making any changes in the `yaml` file. It seems that `dry-validation` caches somehow all the error messages, which is quite annoying if you are unsure how to properly structure your translations file.\n\nCombining namespaces and i18n is not as straight forward as you may expect. Here is the example:\n\n**Yaml file with translations**\n```yaml\npl:\n  errors:\n    # default messages for this locale\n    filled?: This field shouldn't be blank\n    str?: Something about the string requirement\n\n    rules:\n      # namespaced messages\n      note: # namespace name\n        rules:\n          content: # checked field name\n            filled?: Namespaced message\n```\n\n**Code which uses this translations**\n```ruby\nschema = Dry::Validation.Form do\n  configure {\n    config.namespace = :note\n    config.messages = :i18n\n  }\n  required(:content).filled(:str?)\nend\n\nschema.call(params.to_unsafe_h).messages(locale: I18n.default_locale)\n# expected result: {:content => [\"Namespaced message\"]}\n```\n\nWhile using `i18n` integration with a Rails application there is **no need to provide** custom `yaml` file path with:\n```\nschema = Dry::Validation.Form do\n  configure { config.messages_file = '/path/to/my/errors.yml' }\nend\n```\nThe custom error messages will be loaded like any other translations from your `config/locales/[any-name].yml` file.\n\n\n## Disclaimer\n\nThese are just my findings during integration with existing Rails App I may be mistaken at some points (or maybe even all of them). So be careful if you try to follow this path.\n","excerpt":"While defining custom errors is described in the official documentation I had a few issues. Here are my findings. First of all  integrationâ€¦","frontmatter":{"title":"Dry-validation custom error messages","slug":"dry-validation-custom-error-messages","date":"2017-04-07T03:30:00.000Z","tags":["ruby","rails"],"date_created":"2017-03-30T22:59:16.000Z","date_updated":"2018-11-08T00:31:46.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/pexels-photo-210585-1.jpeg","relativePath":"posts/img/pexels-photo-210585-1.jpeg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAEDBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAG3cEBP/8QAGRAAAQUAAAAAAAAAAAAAAAAAAgEDBBAR/9oACAEBAAEFAm46AW1//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAQUAAAAAAAAAAAAAAAAAAgABEBEx/9oACAEBAAY/ArEyZZH/xAAWEAEBAQAAAAAAAAAAAAAAAAAAEXH/2gAIAQEAAT8hwOFUr//aAAwDAQACAAMAAAAQ9B//xAAWEQADAAAAAAAAAAAAAAAAAAABECH/2gAIAQMBAT8QNX//xAAVEQEBAAAAAAAAAAAAAAAAAAAREP/aAAgBAgEBPxAJ/8QAGhABAQACAwAAAAAAAAAAAAAAAREAUSFBcf/aAAgBAQABPxAud74tNOz3EoqbpMTc/9k=","aspectRatio":2,"src":"/static/f091aaf7345a39273b2b03c22e3eb5c8/0defe/pexels-photo-210585-1.jpg","srcSet":"/static/f091aaf7345a39273b2b03c22e3eb5c8/38b6a/pexels-photo-210585-1.jpg 150w,\n/static/f091aaf7345a39273b2b03c22e3eb5c8/e201c/pexels-photo-210585-1.jpg 300w,\n/static/f091aaf7345a39273b2b03c22e3eb5c8/0defe/pexels-photo-210585-1.jpg 600w,\n/static/f091aaf7345a39273b2b03c22e3eb5c8/a71f1/pexels-photo-210585-1.jpg 900w,\n/static/f091aaf7345a39273b2b03c22e3eb5c8/9f6c3/pexels-photo-210585-1.jpg 1200w,\n/static/f091aaf7345a39273b2b03c22e3eb5c8/028b9/pexels-photo-210585-1.jpg 1279w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"4ae40b8e-1d15-5b05-ac93-f6e1365d3691","html":"<p>Running any kind of code related blog on the Ghost platform would eventually require adding some syntax highlighting to your code snippets. The easiest solution is usin <a href=\"http://prismjs.com/\">Prism.js</a> library and the quickest way to do that is linking it directly from CDN.</p>\n<p>Let's find some resources and link them to the blog!</p>\n<p>Everything should be put in fields inside <em>Code Injection</em> menu tab:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/282cbeefb5836b333e7666e643bf04b1/ebca9/ghost-prism-code-highlighting.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.6215644820296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAB9klEQVQ4y5VUy27bMBDU//9Ff6PnFr30GLRoiwa2Y+tpS6IepCiKnM5SViO0CZAQGCxJ7Q6Hy10lD9++43B8ghpGaK2R5wXSLEOrFN46fAA+fO3x8ceIZNQG02RhpgmTtRj6Hn0/kNxgnucId7d7WPpOZorWMj5vNFrtkGRFCc0PmptRYZohu6QoaNOnMy7nM9LLZbVElqY4n064Xa/oVIe+6zBShO47+IWEeVlhJGEECS8MVnRavIdbFjhLRcbCuWVd3xFeuX5S85SRAX28+sTctVCqh2kVbNvCVjdMRQVbN+ua/rau4XhooICZcQvnnnM5JCmKnHmQfK35cM4hhHumqQRUGjfEbmuxolLAdZAY2RPCh0OJX8WIn4Rc27k5fghvwH4EOZRIvjx2+Pw44NNvvq7eEd4dNvsv9t83RIWKOVucxWzXspGS2Ajfi0go15QHEXVSj8+EeNf4SziQTEjFWpZICP5/hXhNlX+G988KN1LpjrIs2TUmJn1hkKej5wt6me/w4iPJo+wJjTGo2AENa3CoW0xNA3O9oS9Yi6zDqZW9dd+xO6QOI8YR4Z6qZOuS7crdOOBWd9BpBbDNIK15YxEXxbrOciKLCGxP2Q+HIwIPe4HQomVPXmsFnVVrkBBeVbQQgjxHyFYL/plQ0e94QmhWwj9zaZAhaQpcogAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Ghost code highlighting with Prismjs from CDN\"\n        title=\"Ghost code highlighting with Prismjs from CDN\"\n        src=\"/static/282cbeefb5836b333e7666e643bf04b1/a3419/ghost-prism-code-highlighting.png\"\n        srcset=\"/static/282cbeefb5836b333e7666e643bf04b1/a1986/ghost-prism-code-highlighting.png 210w,\n/static/282cbeefb5836b333e7666e643bf04b1/ad7fb/ghost-prism-code-highlighting.png 420w,\n/static/282cbeefb5836b333e7666e643bf04b1/a3419/ghost-prism-code-highlighting.png 840w,\n/static/282cbeefb5836b333e7666e643bf04b1/ebca9/ghost-prism-code-highlighting.png 946w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p>CSS should be places inside <em>Blog Header</em> field:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/themes/prism.min.css<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>JS should be places inside <em>Blog Footer</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Now when core files are in place you should think for a while about languages that are going to be used. Language-specific files should be placed in the <em>Blog Footer</em> section of your <em>Code Injection</em> tab below the Prism.js core.\nIn this example I will add <em>PHP</em>, <em>CSS</em>, <em>HTML</em> and <em>JS</em> support:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-php.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-css.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-html.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-js.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>As you may noticed the CDN path for every language is generic, so you should be able to just guess it if you need some more urls. Just to make sure you may also check official CDN files list at <a href=\"https://cdnjs.com/libraries/prism\">https://cdnjs.com/libraries/prism</a></p>\n<p><strong>NOTE</strong>: In the examples above I've used <strong>Prism.js 1.6.0</strong> version but chances are that when you are reading this post there is already a newer version. Check out Prism.js site to make sure you are using most recent release.</p>\n<p>Of course in order to trigger correct syntax highlighting you have to define language used in the sample by appending its name after code block marks. As an example, in order to trigger Javascript highlighting you should write your code inside:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">```javascript\n// here is your JS code\n```</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>As a result of all the efforts, you should see nicely highlighted code. Here is an example from one of my posts:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 731px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/380c78053459d4247ba2f2648134600a/2fe3c/ghost-code-highlighting-example.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.63064295485636%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAABlklEQVQoz5WT3W7bMAyF8/7vtiFJl2VJU8eOZVnWP0VS9u5GN1ixpd2AAse+kT8d8pDe8Fx9KSmnBFgQCjoiWLgutc7MS+WZ6QMRLnPdYMrq0rqh7/TzYM7a7I09hdj50MSonNGYI5f0III4U9lQKcG5mJNNPqyKdhqmsTNadJu0KiucH0SQxHwDiH2nhpe2OTWqV9NktVL97SaPVv00qpLCGyD6C167Cn5qr+rl7M24GButHWK2IRLAT2kPsSJULAujiKkwgfBz5Y10T1JZztH5ybY+9WQMqwEnY11j7LNz1+R1NoNqr21zwXEsgy7RldGusAQAkAYbfPAzwVwK5yQ3YgkSCGIgSSgFiD4HxzlSipRjBXiFIaFz1jSjeR7HS68P0epyU6Q0jUbeYC2vla/iV609V7o7Zwju8LQ9Hnb77Zfj993UdeHUyY3iw+LzO6fHtO+w1LPffj0enr7ttpfzj3BT8aoY8/shvYMhyTxEdwfpkEGO/0n+CfNKrpsA//n6Y5ixvK3Bp2GZtSxAJfyUxFL+nF82GQ/5E9Q0lQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ghost code highlighting example\"\n        title=\"ghost code highlighting example\"\n        src=\"/static/380c78053459d4247ba2f2648134600a/2fe3c/ghost-code-highlighting-example.png\"\n        srcset=\"/static/380c78053459d4247ba2f2648134600a/a1986/ghost-code-highlighting-example.png 210w,\n/static/380c78053459d4247ba2f2648134600a/ad7fb/ghost-code-highlighting-example.png 420w,\n/static/380c78053459d4247ba2f2648134600a/2fe3c/ghost-code-highlighting-example.png 731w\"\n        sizes=\"(max-width: 731px) 100vw, 731px\"\n      />\n  </a>\n    </span></p>","timeToRead":2,"rawMarkdownBody":"Running any kind of code related blog on the Ghost platform would eventually require adding some syntax highlighting to your code snippets. The easiest solution is usin [Prism.js](http://prismjs.com/) library and the quickest way to do that is linking it directly from CDN.\n\nLet's find some resources and link them to the blog!\n\nEverything should be put in fields inside *Code Injection* menu tab:\n![Ghost code highlighting with Prismjs from CDN](img/ghost-prism-code-highlighting.png)\n\nCSS should be places inside *Blog Header* field:\n```html\n<link href=\"//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/themes/prism.min.css\" rel=\"stylesheet\" />\n```\n\nJS should be places inside *Blog Footer*:\n```html\n<script type=\"text/javascript\" src=\"//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js\"></script>\n```\n\nNow when core files are in place you should think for a while about languages that are going to be used. Language-specific files should be placed in the *Blog Footer* section of your *Code Injection* tab below the Prism.js core.\nIn this example I will add *PHP*, *CSS*, *HTML* and *JS* support:\n```html\n<script type=\"text/javascript\" src=\"//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-php.min.js\"></script>\n<script type=\"text/javascript\" src=\"//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-css.min.js\"></script>\n<script type=\"text/javascript\" src=\"//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-html.min.js\"></script>\n<script type=\"text/javascript\" src=\"//cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-js.min.js\"></script>\n```\nAs you may noticed the CDN path for every language is generic, so you should be able to just guess it if you need some more urls. Just to make sure you may also check official CDN files list at https://cdnjs.com/libraries/prism\n\n**NOTE**: In the examples above I've used **Prism.js 1.6.0** version but chances are that when you are reading this post there is already a newer version. Check out Prism.js site to make sure you are using most recent release.\n\nOf course in order to trigger correct syntax highlighting you have to define language used in the sample by appending its name after code block marks. As an example, in order to trigger Javascript highlighting you should write your code inside:\n\n    ```javascript\n    // here is your JS code\n    ```\n\nAs a result of all the efforts, you should see nicely highlighted code. Here is an example from one of my posts:\n\n![](img/ghost-code-highlighting-example.png)\n","excerpt":"Running any kind of code related blog on the Ghost platform would eventually require adding some syntax highlighting to your code snippetsâ€¦","frontmatter":{"title":"Adding code highlighting to Ghost blog","slug":"adding-code-highlighting-to-ghost-blog","date":"2017-03-23T11:03:34.000Z","tags":["ghost-tag"],"date_created":"2017-03-23T10:48:25.000Z","date_updated":"2019-03-30T21:50:42.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/pexels-photo-360591.jpg","relativePath":"posts/img/pexels-photo-360591.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABwAQH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEREP/aAAgBAQABPyFFuf/aAAwDAQACAAMAAAAQcA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAACAwAAAAAAAAAAAAAAAAABEQAQUf/aAAgBAQABPxAk4cK//9k=","aspectRatio":2,"src":"/static/89b273ed66cafe875c8f52984092ebcb/0defe/pexels-photo-360591.jpg","srcSet":"/static/89b273ed66cafe875c8f52984092ebcb/38b6a/pexels-photo-360591.jpg 150w,\n/static/89b273ed66cafe875c8f52984092ebcb/e201c/pexels-photo-360591.jpg 300w,\n/static/89b273ed66cafe875c8f52984092ebcb/0defe/pexels-photo-360591.jpg 600w,\n/static/89b273ed66cafe875c8f52984092ebcb/a71f1/pexels-photo-360591.jpg 900w,\n/static/89b273ed66cafe875c8f52984092ebcb/9f6c3/pexels-photo-360591.jpg 1200w,\n/static/89b273ed66cafe875c8f52984092ebcb/028b9/pexels-photo-360591.jpg 1279w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"ede55965-6fdf-5621-8d26-6707f86755cb","html":"<p>Standard Wordpress thumbnail input may be replaced with an <a href=\"https://www.advancedcustomfields.com/resources/image/\">ACF image field</a> which is far more flexible/customizable.\nIn order to do that you just have to give it a name of <code class=\"language-text\">_thumbnail_id</code>. I'm not sure if it is possible with a visual editor (because I don't use it), but for sure you can do that using <a href=\"https://www.advancedcustomfields.com/resources/register-fields-via-php/\">ACF PHP API</a>. Here is the code which will generate a field for thumbnail image selection:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n  <span class=\"token single-quoted-string string\">'key'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'field_thumbnail_id'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'_thumbnail_id'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'type'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'image'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'label'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Custom thumbnail input'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'instructions'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Some more instructions below the label'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token single-quoted-string string\">'return_format'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Of course all other image field settings might be used here e.g. <code class=\"language-text\">min_width</code>, <code class=\"language-text\">min_height</code>, <code class=\"language-text\">max_size</code> etc. For more info please refer to the official image field documentation at <a href=\"https://www.advancedcustomfields.com/resources/register-fields-via-php/\">https://www.advancedcustomfields.com/resources/register-fields-via-php/</a>.</p>\n<p>Here is a complete example of a thumbnail field replaced by ACF image field for a <em>Post</em> content type.</p>\n<p>TODO: add example</p>","timeToRead":1,"rawMarkdownBody":"Standard Wordpress thumbnail input may be replaced with an [ACF image field](https://www.advancedcustomfields.com/resources/image/) which is far more flexible/customizable.\nIn order to do that you just have to give it a name of `_thumbnail_id`. I'm not sure if it is possible with a visual editor (because I don't use it), but for sure you can do that using [ACF PHP API](https://www.advancedcustomfields.com/resources/register-fields-via-php/). Here is the code which will generate a field for thumbnail image selection:\n\n```php\narray(\n  'key' => 'field_thumbnail_id',\n  'name' => '_thumbnail_id',\n  'type' => 'image',\n  'label' => 'Custom thumbnail input',\n  'instructions' => 'Some more instructions below the label',\n  'return_format' => 'id',\n),\n```\n\nOf course all other image field settings might be used here e.g. `min_width`, `min_height`, `max_size` etc. For more info please refer to the official image field documentation at https://www.advancedcustomfields.com/resources/register-fields-via-php/.\n\nHere is a complete example of a thumbnail field replaced by ACF image field for a *Post* content type.\n\nTODO: add example\n","excerpt":"Standard Wordpress thumbnail input may be replaced with an ACF image field which is far more flexible/customizable.\nIn order to do that youâ€¦","frontmatter":{"title":"Use ACF image field as thumbnail input","slug":"use-acf-image-field-as-thumbnail-input","date":"2017-03-23T09:23:36.000Z","tags":["wordpress","acf"],"date_created":"2017-03-23T09:13:43.000Z","date_updated":"2017-03-23T09:25:05.000Z","author":"jan","feature_image":null}}},{"node":{"id":"506207fd-ad93-5550-979e-c44522e452f7","html":"<p>Sometimes your website may need inner scrolling for an element with overflowing content. In most cases using simple:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-css line-numbers\"><code class=\"language-css\"><span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> scroll<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>is not enough to achieve the desired result (nice scrollbars for HTML element e.g. <code class=\"language-text\">&lt;div&gt;</code>).</p>\n<p>Styling scrollbars for overflowing content is a nightmare using pure CSS techniques (if you want a decent browser support). The only reasonable solution seems to be a solid JS library. Fortunately, there is one available as a <a href=\"https://github.com/noraesae/perfect-scrollbar\">perfect-scrollbar</a> Github project.</p>\n<p>With this awesome library, all you need to do is just initialize it with a wrapper selector for your overflowing content.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.wrapper'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">perfectScrollbar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><code class=\"language-text\">.wrapper</code> is an element which width or height is smaller than its content and it should have following styles applied (if you don't want to use default <code class=\"language-text\">perfect-scrollbar</code> css):</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-css line-numbers\"><code class=\"language-css\"><span class=\"token selector\">.wrapper</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The examples provided in the docs should be just enough to get you started, so I won't rewrite them here.</p>\n<h2>A use case</h2>\n<p>Here is how it looks on one of my recent projects (real usage example). The website was a simple long page with one horizontally scrolled section which was expanded on mobile to one long column:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> $ <span class=\"token keyword\">from</span> <span class=\"token string\">'jquery'</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'perfect-scrollbar/jquery'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>$<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HorizontalSection</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ready <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>resize <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">resize</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ready<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// initialize after document is ready</span>\n  <span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$element <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.Days-wrapper'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">resize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>resize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">resize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// handles scrollbars after resizing screen</span>\n  <span class=\"token function\">resize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'touchevents'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">width</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">540</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// disable for small mobile screens</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$element<span class=\"token punctuation\">.</span><span class=\"token function\">perfectScrollbar</span><span class=\"token punctuation\">(</span><span class=\"token string\">'destroy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$element<span class=\"token punctuation\">.</span><span class=\"token function\">hasClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ps-container'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// is already initialized</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$element<span class=\"token punctuation\">.</span><span class=\"token function\">perfectScrollbar</span><span class=\"token punctuation\">(</span><span class=\"token string\">'update'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// initialize</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// initialize scrollbars</span>\n  <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$element<span class=\"token punctuation\">.</span><span class=\"token function\">perfectScrollbar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      suppressScrollY<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>As you may see for smaller screens where horizontal scrolling is not used I've disabled the perfect-scrollbar because it may prevent the user from scrolling vertically (in some edge cases).</p>","timeToRead":1,"rawMarkdownBody":"Sometimes your website may need inner scrolling for an element with overflowing content. In most cases using simple:\n\n```css\noverflow: scroll;\n```\n\nis not enough to achieve the desired result (nice scrollbars for HTML element e.g. `<div>`).\n\nStyling scrollbars for overflowing content is a nightmare using pure CSS techniques (if you want a decent browser support). The only reasonable solution seems to be a solid JS library. Fortunately, there is one available as a [perfect-scrollbar](https://github.com/noraesae/perfect-scrollbar) Github project.\n\nWith this awesome library, all you need to do is just initialize it with a wrapper selector for your overflowing content.\n\n```javascript\n$('.wrapper').perfectScrollbar();\n```\n\n`.wrapper` is an element which width or height is smaller than its content and it should have following styles applied (if you don't want to use default `perfect-scrollbar` css):\n\n```css\n.wrapper {\n  overflow: hidden;\n  position: relative;\n}\n```\n\nThe examples provided in the docs should be just enough to get you started, so I won't rewrite them here.\n\n## A use case\n\nHere is how it looks on one of my recent projects (real usage example). The website was a simple long page with one horizontally scrolled section which was expanded on mobile to one long column:\n\n```javascript\nimport $ from 'jquery';\nrequire('perfect-scrollbar/jquery')($);\n\nexport default class HorizontalSection {\n  constructor() {\n    this.ready = this.ready.bind(this);\n    this.resize = this.resize.bind(this);\n\n    $(document).ready(this.ready);\n  }\n\n  // initialize after document is ready\n  ready() {\n    this.$element = $('.Days-wrapper');\n\n    $(window).resize(this.resize);\n\n    this.resize();\n  }\n\n  // handles scrollbars after resizing screen\n  resize() {\n    if ( $('html').hasClass('touchevents') && $(window).width() < 540 ) {\n      // disable for small mobile screens\n      this.$element.perfectScrollbar('destroy');\n      return;\n    }\n\n    if ( this.$element.hasClass('ps-container') ) {\n      // is already initialized\n      this.$element.perfectScrollbar('update');\n    } else {\n      // initialize\n      this.init();\n    }\n  }\n\n  // initialize scrollbars\n  init() {\n    this.$element.perfectScrollbar({\n      suppressScrollY: true\n    });\n  }\n}\n\n```\n\nAs you may see for smaller screens where horizontal scrolling is not used I've disabled the perfect-scrollbar because it may prevent the user from scrolling vertically (in some edge cases).\n","excerpt":"Sometimes your website may need inner scrolling for an element with overflowing content. In most cases using simple: is not enough toâ€¦","frontmatter":{"title":"Custom scrollbars for HTML elements","slug":"custom-scrollbars-for-html-elements","date":"2017-03-20T22:34:00.000Z","tags":["javascript","frontend","github-libraries"],"date_created":"2017-03-20T21:43:13.000Z","date_updated":"2017-03-30T16:57:43.000Z","author":"jan","feature_image":null}}},{"node":{"id":"7fee25bf-dd48-56f2-86e2-793b9dbf4d80","html":"<p>This will be a list of some most useful Mac Apps which I've installed recently.</p>\n<h2>ImageOptim</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 198px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dad123ada75287f75cf2925ae736e1fe/fbe57/image-optim.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.292929292929294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB2wWD/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAIRAf/aAAgBAQABBQKMRjKf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBABAAMBAAAAAAAAAAAAAAAAAAEiMTL/2gAIAQEABj8Cmzpr/8QAGxAAAgEFAAAAAAAAAAAAAAAAAAEhEVFhgaH/2gAIAQEAAT8hSsriC9yIimrR/9oADAMBAAIAAwAAABAAD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAAICAwAAAAAAAAAAAAAAAAFRABEhQXH/2gAIAQEAAT8QOEdhIUDw8ykX3hP/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ImageOptim\"\n        title=\"ImageOptim\"\n        src=\"/static/dad123ada75287f75cf2925ae736e1fe/fbe57/image-optim.jpg\"\n        srcset=\"/static/dad123ada75287f75cf2925ae736e1fe/fbe57/image-optim.jpg 198w\"\n        sizes=\"(max-width: 198px) 100vw, 198px\"\n      />\n  </a>\n    </span></p>\n<p>Handy small App which compresses image files (e.g. makes cool progressive JPEGs). See <a href=\"https://imageoptim.com\">https://imageoptim.com</a> for more info.</p>","timeToRead":1,"rawMarkdownBody":"This will be a list of some most useful Mac Apps which I've installed recently.\n\n## ImageOptim\n\n![ImageOptim](img/image-optim.jpg)\n\nHandy small App which compresses image files (e.g. makes cool progressive JPEGs). See https://imageoptim.com for more info.\n","excerpt":"This will be a list of some most useful Mac Apps which I've installed recently. ImageOptim  Handy small App which compresses image files (eâ€¦","frontmatter":{"title":"Useful OS X Apps","slug":"useful-os-x-apps","date":"2017-03-19T03:01:57.000Z","tags":["mac"],"date_created":"2017-03-19T02:52:18.000Z","date_updated":"2017-03-19T03:04:22.000Z","author":"jan","feature_image":null}}},{"node":{"id":"49e255c2-cdb2-5db7-bd69-adfd3b5cf834","html":"<p>Default screenshots location on Macs is your Desktop which is not very convenient. After a few months, it will look (probably always) like one big mess with a lot of random files scattered around. Wouldn't be great to store all your screenshots in one place?</p>\n<h2>Custom location</h2>\n<p>In order to adjust screenshot location follow these steps:</p>\n<ol>\n<li>Open terminal</li>\n<li>\n<p>Execute (you may adjust location by changing the last part with path <code class=\"language-text\">~/Documents/Screenshots</code> to fit your needs):</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">defaults write com.apple.screencapture location ~/Documents/Screenshots</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>There is one catch. Target directory <strong>has to</strong> exist before executing that command, this is an advice from my personal experience.</p>\n</li>\n<li>\n<p>Execute to apply changes:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">killall SystemUIServer</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n<li>It's done</li>\n</ol>\n<h2>Custom format</h2>\n<p>A custom file format can be set in a way similar to a <a href=\"#customlocation\">custom location</a>, just in step <code class=\"language-text\">2</code> execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">defaults write com.apple.screencapture type jpg</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>You may adjust <code class=\"language-text\">type jpg</code> to suit your needs here is a list of available values: <code class=\"language-text\">jpg</code>, <code class=\"language-text\">gif</code>, <code class=\"language-text\">pdf</code>, <code class=\"language-text\">png</code>, <code class=\"language-text\">tiff</code>.</p>","timeToRead":1,"rawMarkdownBody":"Default screenshots location on Macs is your Desktop which is not very convenient. After a few months, it will look (probably always) like one big mess with a lot of random files scattered around. Wouldn't be great to store all your screenshots in one place?\n\n## Custom location\nIn order to adjust screenshot location follow these steps:\n\n1. Open terminal\n2. Execute (you may adjust location by changing the last part with path `~/Documents/Screenshots` to fit your needs):\n\n        defaults write com.apple.screencapture location ~/Documents/Screenshots\n  There is one catch. Target directory **has to** exist before executing that command, this is an advice from my personal experience.\n\n3. Execute to apply changes:\n\n        killall SystemUIServer\n\n4. It's done\n\n## Custom format\n\nA custom file format can be set in a way similar to a [custom location](#customlocation), just in step `2` execute:\n\n    defaults write com.apple.screencapture type jpg\n\nYou may adjust `type jpg` to suit your needs here is a list of available values: `jpg`, `gif`, `pdf`, `png`, `tiff`.\n","excerpt":"Default screenshots location on Macs is your Desktop which is not very convenient. After a few months, it will look (probably always) likeâ€¦","frontmatter":{"title":"Custom Mac OS X screenshots location and format","slug":"custom-mac-os-x-screenshots-location","date":"2017-03-19T02:42:08.000Z","tags":["mac"],"date_created":"2017-03-19T02:39:20.000Z","date_updated":"2017-03-19T03:14:40.000Z","author":"jan","feature_image":null}}},{"node":{"id":"06dc09a2-7ea5-545f-9f15-184ab9eaef3e","html":"<p>WordPress is an obvious choice if you want to write your own online blog. It is especially true if you are a WordPress developer which happens to be my case. Why would anyone bother to choose something else?</p>\n<blockquote>\n<p>[deprecation warning] This article was written for Ghost 0.x which is now considered to be a LTS version. For new blogs consider using Ghost 1.x.</p>\n</blockquote>\n<p>Playing with new technologies is one of my favorite leisure activities so I decided to check out Ghost a modern solution for simple blogging websites. Here are some of my findings and impressions.</p>\n<h2>Installation</h2>\n<p>In my opinion the only problem with Ghost installation is finding a suitable hosting provider. Nodejs support on a common shared hosting platforms in my country is still hard to get. Fortunately, my favorite one supports Nodejs out of the box and it is really easy to use. Just <a href=\"http://ghost.grzegorowski.com/setup-ghost-blog-on-mydevil-net/\">\"copy and paste\" Ghost files</a> according to the official documentation, comparing to the WordPress installation it doesn't seem to be much harder. After the installation process just access <code class=\"language-text\">http://yourdomain.com/ghost</code> URL and create an admin account. I was afraid that Nodejs app setup will be much more complicated.</p>\n<h2>Admin panel</h2>\n<p>The admin panel of a Ghost, in my opinion, is extremely simple thanks to the fact that this is only a blogging platform and it doesn't try to be anything more. I doubt if anyone could have any problems with it.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 752px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/19df3b577465a5bf1f57ac6e681ba9dd/1c0cc/screen-shot-2017-03-18-at-23.16.26.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.91489361702128%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABWUlEQVQoz5WTT0+EMBDF+f4fw4PZg16MZ2M0xqPGmOheVFyQhVLYAv0DpfucdiVRs6u7k7y0KclvZt4M0dHxDBeXV3iLF8jyAlIbSKWQJAkYY1iv1zgkouubWzw9z1FWFVjJCahh+h5d10ER2AMPUWRHh05K9IPF6FyA+QqX2RItQX0cBGRVjdf4Hf7slEErNcEH5HmOvChCgnEc4SjZfwpATq0ukjRUpY2B0hvgQOoJ1tObB+7t4UcpkLAVykaDCQXeGrJAIU1TGkyKklchs4fu1fLpfY3zB44TOmd3AmePAtJYtE1DMI6KOqjrOmhqa5ecI2DOV5i/xMgrASEN6laFAe2KbWs0vYUKRdMizTIUrKSpSvLQ0CAGaPLSy5CH031bhe4L5v32vkeMPIoXCXi9ogkrmrSmDzZ4Zq39ob+qc26zCZEHFbTQmqryf4kHTquyC/Bdv234BCJyWIK/hdj4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Ghost admin panel view\"\n        title=\"Ghost admin panel view\"\n        src=\"/static/19df3b577465a5bf1f57ac6e681ba9dd/1c0cc/screen-shot-2017-03-18-at-23.16.26.png\"\n        srcset=\"/static/19df3b577465a5bf1f57ac6e681ba9dd/a1986/screen-shot-2017-03-18-at-23.16.26.png 210w,\n/static/19df3b577465a5bf1f57ac6e681ba9dd/ad7fb/screen-shot-2017-03-18-at-23.16.26.png 420w,\n/static/19df3b577465a5bf1f57ac6e681ba9dd/1c0cc/screen-shot-2017-03-18-at-23.16.26.png 752w\"\n        sizes=\"(max-width: 752px) 100vw, 752px\"\n      />\n  </a>\n    </span></p>\n<h2>Editor</h2>\n<p>The only thing that might be confusing for non-technical users is the Editor. It is quite intuitive and has a cool feature of live preview but I'm afraid that for MS Word users Markdown concept might not be so obvious. I should probably check it with some of my clients.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4663be80ea2c5b49db9ea2df0af4eccc/cacec/screen-shot-2017-03-18-at-23.22.15.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.61852433281005%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABYUlEQVQoz4VRy26DMBD0//9L/6BSe06jVOJYqSI0PGyIwWDeSZnOOklPlYo02rWxxzOz6vnlFZ/xEa3vYesGcRxDa4NjkqDrOvz3bff6US14inooIWm9x7ysGMYRja3R1DfU1uJcVXCNC+uR/6dp4pp3XIuOkL5rb33rOihTWdRcjPNCRR5FlkEXBQxR5DmyU4o8zbifh8u+dijiLxTcy+/QaQ6dnGDLCqo8WzgSPQhLY1DxR2VKGK1hz2dWw2qxrit6nmnYt84FiDqp4qbmvip4USCELX/qvOChLli8WbvbHYaQleRq+KjYl16wLMtvpkqLGubWTzNG5jPPM2bW7+v1zyEkHNZu94YoirDf73E4vCOl7W3bsJJYid1+nIJC50RhHqxWZRmylAgaDk4sieWFD3pRRjeeTmQY0jueEaiBygYSPhT2nLgnBlqUXhRf1kt4XVSI9Ud2gZTkAolHnP0ALHBhMPEeqX4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screen shot 2017 03 18 at 23 22 15\"\n        title=\"screen shot 2017 03 18 at 23 22 15\"\n        src=\"/static/4663be80ea2c5b49db9ea2df0af4eccc/a3419/screen-shot-2017-03-18-at-23.22.15.png\"\n        srcset=\"/static/4663be80ea2c5b49db9ea2df0af4eccc/a1986/screen-shot-2017-03-18-at-23.22.15.png 210w,\n/static/4663be80ea2c5b49db9ea2df0af4eccc/ad7fb/screen-shot-2017-03-18-at-23.22.15.png 420w,\n/static/4663be80ea2c5b49db9ea2df0af4eccc/a3419/screen-shot-2017-03-18-at-23.22.15.png 840w,\n/static/4663be80ea2c5b49db9ea2df0af4eccc/4d498/screen-shot-2017-03-18-at-23.22.15.png 1260w,\n/static/4663be80ea2c5b49db9ea2df0af4eccc/cacec/screen-shot-2017-03-18-at-23.22.15.png 1274w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<p><strong>UPDATE</strong> Regarding GitHub <a href=\"https://github.com/TryGhost/Ghost/issues/7429\">issue</a> that I found it seems that the Ghost v1.0 should be shipped with a brand new editor based on <a href=\"https://github.com/bustlelabs/mobiledoc-kit\">mobiledoc kit</a>, which might be a smart move.</p>\n<h2>Pros and cons</h2>\n<p>Standard section for every review-like content :)</p>\n<p>On the plus side I would mention following points:</p>\n<ul>\n<li>fast &#x26; lightweight (works great on mobile and desktop)</li>\n<li>easy to use</li>\n<li>writing post with your mobile phone (or any other touch device) is not a nightmare (if you like writing in Markdown)</li>\n</ul>\n<p>But there are some downsides:</p>\n<ul>\n<li>images are not auto compressed/resized so you have to be careful when uploading them (a photo from your camera without any preprocessing would be a disaster regarding its usual weight)</li>\n<li>mixing markdown with regular HTML is buggy so don't expect going out of Markdown limitations</li>\n<li>assets are not minified, probably using a good theme would solve that one, but the default theme \"casper\" serves raw JS and CSS which is kind of bandwidth waste</li>\n</ul>\n<h2>Why I choose Ghost</h2>\n<p>All in all, I think that Wordpress gives me a lot more power over every aspect of the system, plenty of plugins for every occasion and is much more \"complete\", but running a blog on Ghost just gives \"more fun\". I mean writing in Markdown is easy, I'm a <em>Vim</em> enthusiast so I don't like leaving my keyboard home row to do some styling. Ghost speed gives me an illusion of using a native App (which is really nice), while limited options are \"just enough\" to get the job done if we are talking about running a blog.</p>","timeToRead":3,"rawMarkdownBody":"WordPress is an obvious choice if you want to write your own online blog. It is especially true if you are a WordPress developer which happens to be my case. Why would anyone bother to choose something else?\n\n> [deprecation warning] This article was written for Ghost 0.x which is now considered to be a LTS version. For new blogs consider using Ghost 1.x.\n\nPlaying with new technologies is one of my favorite leisure activities so I decided to check out Ghost a modern solution for simple blogging websites. Here are some of my findings and impressions.\n\n## Installation\nIn my opinion the only problem with Ghost installation is finding a suitable hosting provider. Nodejs support on a common shared hosting platforms in my country is still hard to get. Fortunately, my favorite one supports Nodejs out of the box and it is really easy to use. Just [\"copy and paste\" Ghost files](http://ghost.grzegorowski.com/setup-ghost-blog-on-mydevil-net/) according to the official documentation, comparing to the WordPress installation it doesn't seem to be much harder. After the installation process just access `http://yourdomain.com/ghost` URL and create an admin account. I was afraid that Nodejs app setup will be much more complicated.\n\n## Admin panel\nThe admin panel of a Ghost, in my opinion, is extremely simple thanks to the fact that this is only a blogging platform and it doesn't try to be anything more. I doubt if anyone could have any problems with it.\n![Ghost admin panel view](img/screen-shot-2017-03-18-at-23.16.26.png)\n\n## Editor\nThe only thing that might be confusing for non-technical users is the Editor. It is quite intuitive and has a cool feature of live preview but I'm afraid that for MS Word users Markdown concept might not be so obvious. I should probably check it with some of my clients.\n\n![](img/screen-shot-2017-03-18-at-23.22.15.png)\n\n**UPDATE** Regarding GitHub [issue](https://github.com/TryGhost/Ghost/issues/7429) that I found it seems that the Ghost v1.0 should be shipped with a brand new editor based on [mobiledoc kit](https://github.com/bustlelabs/mobiledoc-kit), which might be a smart move.\n\n## Pros and cons\nStandard section for every review-like content :)\n\nOn the plus side I would mention following points:\n\n- fast & lightweight (works great on mobile and desktop)\n- easy to use\n- writing post with your mobile phone (or any other touch device) is not a nightmare (if you like writing in Markdown)\n\nBut there are some downsides:\n\n- images are not auto compressed/resized so you have to be careful when uploading them (a photo from your camera without any preprocessing would be a disaster regarding its usual weight)\n- mixing markdown with regular HTML is buggy so don't expect going out of Markdown limitations\n- assets are not minified, probably using a good theme would solve that one, but the default theme \"casper\" serves raw JS and CSS which is kind of bandwidth waste\n\n## Why I choose Ghost\n\nAll in all, I think that Wordpress gives me a lot more power over every aspect of the system, plenty of plugins for every occasion and is much more \"complete\", but running a blog on Ghost just gives \"more fun\". I mean writing in Markdown is easy, I'm a *Vim* enthusiast so I don't like leaving my keyboard home row to do some styling. Ghost speed gives me an illusion of using a native App (which is really nice), while limited options are \"just enough\" to get the job done if we are talking about running a blog.\n","excerpt":"WordPress is an obvious choice if you want to write your own online blog. It is especially true if you are a WordPress developer whichâ€¦","frontmatter":{"title":"Hands on Ghost","slug":"hands-on-ghost","date":"2017-03-19T06:10:39.000Z","tags":["ghost-tag"],"date_created":"2017-03-19T01:36:35.000Z","date_updated":"2018-03-18T21:35:30.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1505599950318-db5a5093ce0c.jpg","relativePath":"posts/img/photo-1505599950318-db5a5093ce0c.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAcU6i5JHw//EABoQAQEAAgMAAAAAAAAAAAAAAAECAAMEERP/2gAIAQEAAQUCOLNaa0MUmD0VtXPVz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABwQAAICAgMAAAAAAAAAAAAAAAECABARMSEyQf/aAAgBAQAGPwJWDc41Ap9rqJoV/8QAHBABAQEAAQUAAAAAAAAAAAAAAREAMSFBYXGR/9oACAEBAAE/IVjWVrvnJK4NwDjmcN4yF63reA+b/9oADAMBAAIAAwAAABAjD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAAIDAAMBAAAAAAAAAAAAAAERACExYZGh0f/aAAgBAQABPxAbMqFEiLvKdRtaQHS1xKs8iF6QKrvUcaWFa8hCgFgLHyf/2Q==","aspectRatio":2,"src":"/static/1e2b1d0ed1cd8bc2dd0ac9d937cd079c/0defe/photo-1505599950318-db5a5093ce0c.jpg","srcSet":"/static/1e2b1d0ed1cd8bc2dd0ac9d937cd079c/38b6a/photo-1505599950318-db5a5093ce0c.jpg 150w,\n/static/1e2b1d0ed1cd8bc2dd0ac9d937cd079c/e201c/photo-1505599950318-db5a5093ce0c.jpg 300w,\n/static/1e2b1d0ed1cd8bc2dd0ac9d937cd079c/0defe/photo-1505599950318-db5a5093ce0c.jpg 600w,\n/static/1e2b1d0ed1cd8bc2dd0ac9d937cd079c/a71f1/photo-1505599950318-db5a5093ce0c.jpg 900w,\n/static/1e2b1d0ed1cd8bc2dd0ac9d937cd079c/8d595/photo-1505599950318-db5a5093ce0c.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"497eb0f8-e15d-503f-b8c3-c012d66cc6be","html":"<p>Ghost is an awesome blogging platform, but there is one \"problem\", it is written in Nodejs which is not so widely supported (as PHP) among a shared hosting platforms. Here is how to setup <strong>Ghost</strong> blog (and probably any other Node.js app) if you are on <strong>mydevil.net</strong>.</p>\n<ol>\n<li>Log in to an admin interface and create a new website in <em>WWW websites</em> menu.</li>\n<li><em>Website type</em> select Node.js</li>\n<li><em>Node.js binary</em> select one which suits your needs (in the time of writing it is <code class=\"language-text\">4.7.2</code>)</li>\n<li>click <em>+Add</em> button</li>\n</ol>\n<p> <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fe9d7677046f81ff52f11ba87cadbe29/8c098/mydevil-ghost-setup.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.85450346420323%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABf0lEQVQoz3VSSVLEMAzM///AJ3gAB44UR04cqAJMJpM4tmNn34RbiTPxUKiqS16kdktW4uqGgK7rIgzDQNM0MbAex9H7ke/6vt/9QN2x7jk2ueYlZbmkylpPXPOlUtpD8d45R23bcgIQ9k2ziai9b3bg0USkGX2JC8lSkdKG1RRFQeL7m7IsozRNaZ5ngq3runuK9sGwT0zlvLo6KjtY7RUCeBkKlmWh1QMejwSAKCARWUHpVfqElksB4U3JyskLBy/UTQuZfiI7zP58jYiCJcpUBIDwrBC+LEt+BH27XFLus3WoyPGZRd+9PwtIpDIEWFcfCmEIzPOcS0aiEIKklBvJTlRVFSMiLMqNUBt7/Nx9s0GKXwe03iYA5MYY7m8gOxSayv5RiJkCEX4d54UnOI8M7rAGYaTwJ5N0LZSfse72KXeEPH96U9Sc5g738BFhqSsCzgrvS3750PT8JqjtevrPQg6XrH3JIDsTbiOzBT2+ftLD0zvNyxr1635s4H8BEgWkAaF9DA8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mydevil.net new ghost based website\"\n        title=\"mydevil.net new ghost based website\"\n        src=\"/static/fe9d7677046f81ff52f11ba87cadbe29/a3419/mydevil-ghost-setup.png\"\n        srcset=\"/static/fe9d7677046f81ff52f11ba87cadbe29/a1986/mydevil-ghost-setup.png 210w,\n/static/fe9d7677046f81ff52f11ba87cadbe29/ad7fb/mydevil-ghost-setup.png 420w,\n/static/fe9d7677046f81ff52f11ba87cadbe29/a3419/mydevil-ghost-setup.png 840w,\n/static/fe9d7677046f81ff52f11ba87cadbe29/8c098/mydevil-ghost-setup.png 866w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n  </a>\n    </span></p>\n<ol start=\"2\">\n<li>\n<p>Upload Ghost files to the <code class=\"language-text\">public_nodejs/ghost</code> directory inside your domain folder (you will have to create <code class=\"language-text\">ghost</code> subfolder) and install Ghost there. During installation process follow the official documentation <a href=\"http://support.ghost.org/installing-ghost-linux/\">Installing Ghost on Linux</a>. A full path for your <code class=\"language-text\">ghost</code> directory would usually look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">/home/[username]/domains/[yourdomain.com]/public_nodejs/ghost</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n</ol>\n<p>  Creating <code class=\"language-text\">ghost</code> subfolder is optional and I've done it just in order to keep <code class=\"language-text\">public_nodejs</code> folder clean. By default, it contains <code class=\"language-text\">public</code> and <code class=\"language-text\">tmp</code> subfolders which I didn't touch.</p>\n<ol start=\"3\">\n<li>\n<p>The only <em>tricky</em> step is to create entry \"script\" for your blogging app. According to the official <a href=\"https://wiki.mydevil.net/Nodejs\">mydevil docs</a> about Nodejs apps it is enough to create simple <code class=\"language-text\">app.js</code> file directly inside <code class=\"language-text\">public_nodejs</code> directory. This file should be an entry point for running your app, so in this case <code class=\"language-text\">app.js</code> may have only one line:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">require(&#39;./ghost/index.js&#39;); // provided that you install Ghost in a `ghost` subdirectory</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n<li>That's it. The work is done. Now access <code class=\"language-text\">http://yourdomain.com/ghost</code> to setup your admin account.</li>\n</ol>","timeToRead":1,"rawMarkdownBody":"Ghost is an awesome blogging platform, but there is one \"problem\", it is written in Nodejs which is not so widely supported (as PHP) among a shared hosting platforms. Here is how to setup **Ghost** blog (and probably any other Node.js app) if you are on **mydevil.net**.\n\n\n1. Log in to an admin interface and create a new website in *WWW websites* menu.\n - *Website type* select Node.js\n - *Node.js binary* select one which suits your needs (in the time of writing it is `4.7.2`)\n - click *+Add* button\n\n ![mydevil.net new ghost based website](img/mydevil-ghost-setup.png)\n\n2. Upload Ghost files to the `public_nodejs/ghost` directory inside your domain folder (you will have to create `ghost` subfolder) and install Ghost there. During installation process follow the official documentation [Installing Ghost on Linux](http://support.ghost.org/installing-ghost-linux/). A full path for your `ghost` directory would usually look like this:\n\n        /home/[username]/domains/[yourdomain.com]/public_nodejs/ghost\n\n  Creating `ghost` subfolder is optional and I've done it just in order to keep `public_nodejs` folder clean. By default, it contains `public` and `tmp` subfolders which I didn't touch.\n\n3. The only *tricky* step is to create entry \"script\" for your blogging app. According to the official [mydevil docs](https://wiki.mydevil.net/Nodejs) about Nodejs apps it is enough to create simple `app.js` file directly inside `public_nodejs` directory. This file should be an entry point for running your app, so in this case `app.js` may have only one line:\n\n        require('./ghost/index.js'); // provided that you install Ghost in a `ghost` subdirectory\n\n\n4. That's it. The work is done. Now access `http://yourdomain.com/ghost` to setup your admin account.\n\n","excerpt":"Ghost is an awesome blogging platform, but there is one \"problem\", it is written in Nodejs which is not so widely supported (as PHP) among aâ€¦","frontmatter":{"title":"Setup Ghost blog on Mydevil.net","slug":"setup-ghost-blog-on-mydevil-net","date":"2017-03-19T02:08:16.000Z","tags":["ghost-tag","hostings"],"date_created":"2017-03-19T00:31:29.000Z","date_updated":"2017-03-19T02:33:51.000Z","author":"jan","feature_image":null}}},{"node":{"id":"472a91a1-8651-5ec4-8fd3-47f8de6298af","html":"<p>Ensuring good responsive images support in Wordpress can be a quite complicated task. When you try to provide dedicated image size for each supported device your images directory will become far larger than the necessary minimum because of generating even unused images by the default <code class=\"language-text\">add_image_size()</code> function.</p>\n<p>The solution of that problem wasn't an easy one, until now!</p>\n<p>Thanks to the <a href=\"https://wordpress.org/plugins/fly-dynamic-image-resizer/\">Fly Dynamic Image Resizer</a> by <a href=\"http://www.junaidbhura.com/\">Junaid Bhura</a> there is now an option to generate only necessary image sizes \"on the fly\". You will never need to regenerate thumbnails again and what's more important WordPress <code class=\"language-text\">upload/</code> directory will stay as small as possible.</p>\n<p>Fly Dynamic Image Resizer is, of course, a developer plugin so in order to use it your active theme <strong>have to use</strong> <code class=\"language-text\">fly_</code> prefixed functions instead of their <code class=\"language-text\">wp_</code> counterparts. Having said so it's not that hard to convert existing theme to use Fly Dynamic Image Resizer simple <em>find &#x26; replace</em> will be a helpful tool. The only thing you should take care about is checking the replaced functions results. Fly functions will produce slightly different results e.g. <code class=\"language-text\">fly_get_attachment_image_src</code> outputs an associative array with different keys than the default <code class=\"language-text\">wp_get_attachment_image_src</code>.</p>\n<p>One of the biggest advantages of this plugin is a fact that it is available on Github <a href=\"https://github.com/junaidbhura/fly-dynamic-image-resizer\">https://github.com/junaidbhura/fly-dynamic-image-resizer</a>, so you can fork it, report issues and get a quick response from the author.</p>\n<h2>Examples</h2>\n<h3>Default Wordpress</h3>\n<p>(probably) your theme configuration:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token function\">add_image_size</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'my-custom-size'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>template:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token variable\">$image</span> <span class=\"token operator\">=</span> <span class=\"token function\">wp_get_attachment_image_src</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$img_id</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'my-custom-size'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$image</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$image</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$image</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h3>Wordpress with Fly Dynamic Image Resizer</h3>\n<p>no need for any configuration/initialization!\ntemplate:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token variable\">$image</span> <span class=\"token operator\">=</span> <span class=\"token function\">wp_get_attachment_image_src</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$img_id</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$image</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'src'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$image</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'width'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$image</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'height'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>In case of <code class=\"language-text\">wp_get_attachment_image</code> there is also approperiate <code class=\"language-text\">fly_</code> helper function which will produce <code class=\"language-text\">&lt;img&gt;</code> tag:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token function\">fly_get_attachment_image</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$img_id</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>These were just examples. I encourage you to read official documentation on Github (<a href=\"https://github.com/junaidbhura/fly-dynamic-image-resizer\">https://github.com/junaidbhura/fly-dynamic-image-resizer</a>) which is really easy to use and provides a comprehensive description of all plugin capabilities.</p>\n<h2>.svg support</h2>\n<p>Fly Dynamic Image Resizer doesn't work with <code class=\"language-text\">.svg</code> images (so as the Wordpress without any plugins). If you would like to support them just check for the empty result and replace it with the default Wordpress functions providing <code class=\"language-text\">full</code> as the desired image size.</p>\n<p>Here is an example of my custom helper function which falls back to the default Wordpress <code class=\"language-text\">.svg</code> handling if image happens to be a <code class=\"language-text\">.svg</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n * Gets a dynamically generated image URL from the Fly Images with SVG fallback.\n *\n * @param  integer  $attachment_id\n * @param  mixed    $size\n * @param  boolean  $crop\n * @return array\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">get_image_src</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$attachment_id</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$size</span> <span class=\"token operator\">=</span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$crop</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$img</span> <span class=\"token operator\">=</span> <span class=\"token function\">fly_get_attachment_image_src</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$attachment_id</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$size</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$crop</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$img</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$img</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Something went wrong (this might be a .svg image)</span>\n  <span class=\"token variable\">$img</span> <span class=\"token operator\">=</span> <span class=\"token function\">wp_get_attachment_image_src</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$attachment_id</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'full'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span> <span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$img</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n      <span class=\"token single-quoted-string string\">'src'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$img</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'width'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$size</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token single-quoted-string string\">'height'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$size</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Totally wrong (there is no 'full' image)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Use it exactly the same as the <code class=\"language-text\">fly_get_attachment_image_src</code> you will just get <code class=\"language-text\">svg</code> support. Here is an example:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token variable\">$img</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_src</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$attachment_id</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$img</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'src'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>The .svg image<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h2>responsive background</h2>\n<p>Providing good responsive background images (with various sizes) is complicated because it requires generating <em>CSS</em> code out of <em>PHP</em> (also there is no option to minify this or merge with the rest of your <em>CSS</em>). As far as I know there is no option to generate responsive background images in any other way. In order to ease this process I made a custom function (which is of course based on Fly Dynamic Image Resizer plugin):</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n * Returns style string with media queries background-image for various screen sizes\n * @param string  $css_selector - Unique CSS selector for element with background image\n * @param array $sizes  - Array with media query and screen/image dimensions\n *  $sizes = [\n *    [\n *      'id' - (int) Attachment image ID\n *      'media' - (string) media query argument e.g. 'min-width'\n *      'w' - (int) image width\n *      'h' - (int) image height (default: 0)\n *      'crop' - (bool) crop image? (default: false)\n *    ], ...\n *  ]\n *  e.g.\n *  ```\n *  array(\n *    array('id' => 123, 'media' => 'min-width: 1280px', 'w' => 1280, 'h' => 600),\n *    array('id' => 22, 'w' => 375, 'h' => 667, 'crop' => true)\n *  )\n *  ```\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">bgImage</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$css_selector</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sizes</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$style</span> <span class=\"token operator\">=</span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span> <span class=\"token variable\">$sizes</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$size</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// set default values</span>\n    <span class=\"token variable\">$size</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_merge</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span> <span class=\"token single-quoted-string string\">'h'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'crop'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token boolean constant\">false</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$size</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token variable\">$img</span> <span class=\"token operator\">=</span> <span class=\"token function\">fly_get_attachment_image_src</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$size</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$size</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'w'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$size</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'h'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$size</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'crop'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// conditionally wrap with media query</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$size</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'media'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token variable\">$style</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">=</span> <span class=\"token variable\">$css_selector</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">'{ background-image:url('</span> <span class=\"token punctuation\">.</span> <span class=\"token variable\">$img</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'src'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">') }'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token variable\">$style</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">=</span> <span class=\"token single-quoted-string string\">'@media('</span> <span class=\"token punctuation\">.</span> <span class=\"token variable\">$size</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'media'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">') {'</span> <span class=\"token punctuation\">.</span>\n        <span class=\"token variable\">$css_selector</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">'{ background-image:url('</span> <span class=\"token punctuation\">.</span> <span class=\"token variable\">$img</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'src'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">') }'</span> <span class=\"token punctuation\">.</span>\n        <span class=\"token single-quoted-string string\">'}'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$style</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Usage is simple, just use it inside <code class=\"language-text\">wp_head</code> action like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">// add responsive background images for .full-background section</span>\n<span class=\"token function\">add_action</span><span class=\"token punctuation\">(</span> <span class=\"token single-quoted-string string\">'wp_head'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$img_id</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_post_thumbnail_id</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// or any other function that returns image ID</span>\n  <span class=\"token comment\">// do nothing if image ID is empty</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$img_id</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token variable\">$css</span> <span class=\"token operator\">=</span> <span class=\"token function\">bgImage</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'.full-background'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span> <span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$img_id</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'w'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'h'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'700'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span> <span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$img_id</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'media'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'min-width:400px'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'w'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">800</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span> <span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$img_id</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'media'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'min-width:800px'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'w'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1400</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span> <span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$img_id</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'media'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'min-width:1400px'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'w'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1920</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// print out CSS inside page header</span>\n  <span class=\"token keyword\">echo</span> <span class=\"token single-quoted-string string\">'&lt;style type=\"text/css\">'</span> <span class=\"token punctuation\">.</span> <span class=\"token variable\">$css</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">'&lt;/style>'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>As a result, you will get following CSS (this is formatted version for better readability):</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-css line-numbers\"><code class=\"language-css\"><span class=\"token selector\">.full-background</span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span><span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>http://yourdomain.com/app/uploads/fly-images/46/527528428-0x700.jpeg<span class=\"token punctuation\">)</span></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token atrule\"><span class=\"token rule\">@media</span><span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span>400px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">.full-background</span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span><span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>http://yourdomain.com/app/uploads/fly-images/46/527528428-800x0.jpeg<span class=\"token punctuation\">)</span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token atrule\"><span class=\"token rule\">@media</span><span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span>800px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">.full-background</span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span><span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>http://yourdomain.com/app/uploads/fly-images/46/527528428-1400x0.jpeg<span class=\"token punctuation\">)</span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token atrule\"><span class=\"token rule\">@media</span><span class=\"token punctuation\">(</span><span class=\"token property\">min-width</span><span class=\"token punctuation\">:</span>1400px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">.full-background</span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span><span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>http://yourdomain.com/app/uploads/fly-images/46/527528428-1920x0.jpeg<span class=\"token punctuation\">)</span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Enhanced <code class=\"language-text\">.full-background</code> element will now have four sizes of <code class=\"language-text\">background-image</code> adjusted to the supported screen sizes.</p>\n<h2>Note</h2>\n<p>I would probably try to turn these modifications into a plugin when I will have more spare time.</p>","timeToRead":5,"rawMarkdownBody":"Ensuring good responsive images support in Wordpress can be a quite complicated task. When you try to provide dedicated image size for each supported device your images directory will become far larger than the necessary minimum because of generating even unused images by the default `add_image_size()` function.\n\nThe solution of that problem wasn't an easy one, until now!\n\nThanks to the [Fly Dynamic Image Resizer](https://wordpress.org/plugins/fly-dynamic-image-resizer/) by [Junaid Bhura](http://www.junaidbhura.com/) there is now an option to generate only necessary image sizes \"on the fly\". You will never need to regenerate thumbnails again and what's more important WordPress `upload/` directory will stay as small as possible.\n\nFly Dynamic Image Resizer is, of course, a developer plugin so in order to use it your active theme **have to use** `fly_` prefixed functions instead of their `wp_` counterparts. Having said so it's not that hard to convert existing theme to use Fly Dynamic Image Resizer simple *find & replace* will be a helpful tool. The only thing you should take care about is checking the replaced functions results. Fly functions will produce slightly different results e.g. `fly_get_attachment_image_src` outputs an associative array with different keys than the default `wp_get_attachment_image_src`.\n\nOne of the biggest advantages of this plugin is a fact that it is available on Github https://github.com/junaidbhura/fly-dynamic-image-resizer, so you can fork it, report issues and get a quick response from the author.\n\n## Examples\n\n### Default Wordpress\n(probably) your theme configuration:\n```php\n<?php add_image_size('my-custom-size', array(200, 200); ?>\n```\ntemplate:\n```php\n<?php $image = wp_get_attachment_image_src($img_id, 'my-custom-size'); ?>\n<img src=\"<?= $image[0]; ?>\" width=\"<?= $image[1]; ?>\" height=\"<?= $image[2]; ?>\" />\n```\n\n### Wordpress with Fly Dynamic Image Resizer\nno need for any configuration/initialization!\ntemplate:\n\n```php\n<?php $image = wp_get_attachment_image_src($img_id, array(200, 200)); ?>\n<img src=\"<?= $image['src']; ?>\" width=\"<?= $image['width']; ?>\" height=\"<?= $image['height']; ?>\" />\n```\n\nIn case of `wp_get_attachment_image` there is also approperiate `fly_` helper function which will produce `<img>` tag:\n\n```php\n<?= fly_get_attachment_image( $img_id, array(200, 200) ); ?>\n```\n\nThese were just examples. I encourage you to read official documentation on Github (https://github.com/junaidbhura/fly-dynamic-image-resizer) which is really easy to use and provides a comprehensive description of all plugin capabilities.\n\n## .svg support\n\nFly Dynamic Image Resizer doesn't work with `.svg` images (so as the Wordpress without any plugins). If you would like to support them just check for the empty result and replace it with the default Wordpress functions providing `full` as the desired image size.\n\nHere is an example of my custom helper function which falls back to the default Wordpress `.svg` handling if image happens to be a `.svg`:\n\n```php\n/**\n * Gets a dynamically generated image URL from the Fly Images with SVG fallback.\n *\n * @param  integer  $attachment_id\n * @param  mixed    $size\n * @param  boolean  $crop\n * @return array\n */\nfunction get_image_src( $attachment_id = 0, $size = '', $crop = null ) {\n  $img = fly_get_attachment_image_src( $attachment_id, $size, $crop );\n\n  if ( !empty( $img ) ) {\n    return $img;\n  }\n\n  // Something went wrong (this might be a .svg image)\n  $img = wp_get_attachment_image_src( $attachment_id, 'full' );\n  if ( ! empty( $img ) ) {\n    return array(\n      'src' => $img[0],\n      'width' => $size[0],\n      'height' => $size[1],\n    );\n  }\n\n  // Totally wrong (there is no 'full' image)\n  return array();\n}\n```\n\nUse it exactly the same as the `fly_get_attachment_image_src` you will just get `svg` support. Here is an example:\n\n```php\n<?php $img = get_src($attachment_id, array(400, 300)); ?>\n<img src=\"<?= $img['src']; ?>\" alt=\"The .svg image\" />\n```\n\n## responsive background\nProviding good responsive background images (with various sizes) is complicated because it requires generating *CSS* code out of *PHP* (also there is no option to minify this or merge with the rest of your *CSS*). As far as I know there is no option to generate responsive background images in any other way. In order to ease this process I made a custom function (which is of course based on Fly Dynamic Image Resizer plugin):\n\n```php\n/**\n * Returns style string with media queries background-image for various screen sizes\n * @param string  $css_selector - Unique CSS selector for element with background image\n * @param array $sizes  - Array with media query and screen/image dimensions\n *  $sizes = [\n *    [\n *      'id' - (int) Attachment image ID\n *      'media' - (string) media query argument e.g. 'min-width'\n *      'w' - (int) image width\n *      'h' - (int) image height (default: 0)\n *      'crop' - (bool) crop image? (default: false)\n *    ], ...\n *  ]\n *  e.g.\n *  ```\n *  array(\n *    array('id' => 123, 'media' => 'min-width: 1280px', 'w' => 1280, 'h' => 600),\n *    array('id' => 22, 'w' => 375, 'h' => 667, 'crop' => true)\n *  )\n *  ```\n */\nfunction bgImage( $css_selector, $sizes ) {\n  $style = '';\n\n  foreach ( $sizes as $size ) {\n    // set default values\n    $size = array_merge( array( 'h' => 0, 'crop' => false ), $size );\n\n    $img = fly_get_attachment_image_src($size['id'], array( $size['w'], $size['h'] ), $size['crop'] );\n\n    // conditionally wrap with media query\n    if ( empty( $size['media'] ) ) {\n      $style .= $css_selector . '{ background-image:url(' . $img['src'] . ') }';\n    } else {\n      $style .= '@media(' . $size['media'] . ') {' .\n        $css_selector . '{ background-image:url(' . $img['src'] . ') }' .\n        '}';\n    }\n  }\n  return $style;\n}\n```\n\nUsage is simple, just use it inside `wp_head` action like this:\n\n```php\n// add responsive background images for .full-background section\nadd_action( 'wp_head', function() {\n  $img_id = get_post_thumbnail_id(); // or any other function that returns image ID\n  // do nothing if image ID is empty\n  if ( empty( $img_id ) ) return;\n\n  $css = bgImage('.full-background', array(\n    array( 'id' => $img_id, 'w' => 0, 'h' => '700' ),\n    array( 'id' => $img_id, 'media' => 'min-width:400px', 'w' => 800 ),\n    array( 'id' => $img_id, 'media' => 'min-width:800px', 'w' => 1400 ),\n    array( 'id' => $img_id, 'media' => 'min-width:1400px', 'w' => 1920 ),\n  ));\n  // print out CSS inside page header\n  echo '<style type=\"text/css\">' . $css . '</style>';\n});\n\n```\n\nAs a result, you will get following CSS (this is formatted version for better readability):\n\n```css\n.full-background{\n  background-image:url(http://yourdomain.com/app/uploads/fly-images/46/527528428-0x700.jpeg)\n}\n@media(min-width:400px) {\n  .full-background{\n    background-image:url(http://yourdomain.com/app/uploads/fly-images/46/527528428-800x0.jpeg)\n  }\n}\n@media(min-width:800px) {\n  .full-background{\n    background-image:url(http://yourdomain.com/app/uploads/fly-images/46/527528428-1400x0.jpeg)\n  }\n}\n@media(min-width:1400px) {\n  .full-background{\n    background-image:url(http://yourdomain.com/app/uploads/fly-images/46/527528428-1920x0.jpeg)\n  }\n}\n```\n\nEnhanced `.full-background` element will now have four sizes of `background-image` adjusted to the supported screen sizes.\n\n\n## Note\nI would probably try to turn these modifications into a plugin when I will have more spare time.\n","excerpt":"Ensuring good responsive images support in Wordpress can be a quite complicated task. When you try to provide dedicated image size for eachâ€¦","frontmatter":{"title":"Wordpess theme responsive images","slug":"wordpess-theme-responsive-images","date":"2017-03-28T19:04:46.000Z","tags":["wordpress","wordpress-plugins"],"date_created":"2017-03-18T19:05:47.000Z","date_updated":"2017-03-28T19:07:15.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/banner-772x250.png","relativePath":"posts/img/banner-772x250.png","childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAAAX0lEQVQY02PI3DSRbMRAgurNE9PX96Ws7iZL86YJcQubQieXJSxtI0PzxMSlbUF9RYF9RdFz6kjTnLVlcsKStpCJpUAjUtf0ZG6cQIrmzZNSV3cnr+jM3jola8skoAgAG9jGJ3ZRlZ8AAAAASUVORK5CYII=","aspectRatio":2,"src":"/static/b916a429cfd1c056ff6f3fca864ec139/d1858/banner-772x250.png","srcSet":"/static/b916a429cfd1c056ff6f3fca864ec139/eed6b/banner-772x250.png 150w,\n/static/b916a429cfd1c056ff6f3fca864ec139/44052/banner-772x250.png 300w,\n/static/b916a429cfd1c056ff6f3fca864ec139/d1858/banner-772x250.png 600w,\n/static/b916a429cfd1c056ff6f3fca864ec139/91934/banner-772x250.png 772w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}}]},"authors":{"edges":[{"node":{"id":"1","slug":"jan","name":"Jan Grzegorowski","bio":"Full-stack developer currently working with React / Java stack at Equinix","website":"","location":"","profile_image":{"relativePath":"avatar/photo-mini.jpg","childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAUEAv/EABQBAQAAAAAAAAAAAAAAAAAAAAL/2gAMAwEAAhADEAAAAa8+nhDphjnIF7Ah/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxEiMf/aAAgBAQABBQK5mUB762lg1VGvG8Udif/EABcRAQEBAQAAAAAAAAAAAAAAAAEQETH/2gAIAQMBAT8BAyHJ/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAx/9oACAECAQE/ATUav//EABsQAQACAgMAAAAAAAAAAAAAAAECEgAQESAx/9oACAEBAAY/Agh64Wbx56u//8QAHBABAAIDAAMAAAAAAAAAAAAAAQARECExgaGx/9oACAEBAAE/IRAL6t4R+NaJW948RDMDnzHpQyxFZP/aAAwDAQACAAMAAAAQD8A8/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAx/9oACAEDAQE/EGNZvP/EABYRAQEBAAAAAAAAAAAAAAAAAAEQMf/aAAgBAgEBPxBJGE//xAAcEAEBAAICAwAAAAAAAAAAAAABEQAhEDFRgcH/2gAIAQEAAT8Qfyh9bKr5wsWRAIpRh0prgVXZTPUxvgwCqwb+cGlgG6ILpxBXtz//2Q==","width":30,"height":30,"src":"/static/2b64da00e4a3f2952c8d9e3a6b631208/a6b89/photo-mini.jpg","srcSet":"/static/2b64da00e4a3f2952c8d9e3a6b631208/a6b89/photo-mini.jpg 1x,\n/static/2b64da00e4a3f2952c8d9e3a6b631208/74c3b/photo-mini.jpg 1.5x,\n/static/2b64da00e4a3f2952c8d9e3a6b631208/9c097/photo-mini.jpg 2x"}}}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":true}}}