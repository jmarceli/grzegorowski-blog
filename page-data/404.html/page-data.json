{"componentChunkName":"component---gatsby-ghost-theme-src-templates-404-js","path":"/404.html","webpackCompilationHash":"0e82b974859a298fca5a","result":{"data":{"posts":{"edges":[{"node":{"id":"72f86f5f-0345-5054-98a9-b2af241a4cc4","html":"<p>How to bind handlers in React to multiple similar elements e.g. buttons on list?\nIs it any better to use one handler and identify clicked elements (like it was in jQuery days) than binding them to each element?\nIs it an \"expensive\" operation to bind an event handler in React?</p>\n<p>TLDR; There is nearly no benefit from using only one handler bound to the parent container, but it is fairly important to avoid handler creation during rendering if you use Pure components as a children.</p>\n<h2>Overview</h2>\n<p>If you have a list of elements you may either set <code class=\"language-text\">onClick</code> property to each of rendered elements or create <code class=\"language-text\">onClick</code> handler in the parent container.\nI will try to show the difference between those two approaches.</p>\n<h2>Example</h2>\n<p>Each component is a button which shows its ID in the browser console in response to click event.</p>\n<iframe src=\"https://codesandbox.io/embed/6lo82zrlzw?fontsize=14&view=preview\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<p>In order to measure perfomance go to <a href=\"https://6lo82zrlzw.codesandbox.io/\">https://6lo82zrlzw.codesandbox.io/</a> and open Chrome DevTool Performance tab.</p>\n<h2>Description</h2>\n<p>In each case there were 1000 fairly simple React components rendered and measured.</p>\n<p>There are two types of components in this example:</p>\n<ul>\n<li>Regular - standard React.Component</li>\n<li>Pure - React.PureComponent</li>\n</ul>\n<p>And four ways of providing element context/information to event handler:</p>\n<ul>\n<li>Arrow - wrapping event handler in arrow function, data as an argument</li>\n<li>WithId - passing data through <code class=\"language-text\">data-id</code> and getting it through (<code class=\"language-text\">event.currentTarget</code>)</li>\n<li>SingleHandler - passing data through <code class=\"language-text\">data-id</code> and having one shared handler (<code class=\"language-text\">event.target</code>)</li>\n<li>MethodList - wrapping handler inside class method</li>\n</ul>\n<p>Here are the results from Google DevTools Performance tab.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 778px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b88373e4c76781a81c83f5acb465097f/e5651/react-handlers-performance.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.311053984575835%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAn0lEQVQI1x3Huw7BAABA0f4vQmIwGAxMHrsfoCltF7qgXkk3r6HaWCqqUpR2EJKW5BLbOULo++zHKsGyxW0hEq5Eoo3EfS3xNGU+O5XYkkkshbetktjK78r/sdUl3nZ+7pKYbWLXQPg8HjiDJk6/zEmrEhg1fL2EO0pxnma5zjMEkyJer8hRS+NpOcJRnkgvcJnUuU5rhOMG91mF12HIF/LWhQBS4p4tAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"react-handlers-performance\"\n        title=\"react-handlers-performance\"\n        src=\"/static/b88373e4c76781a81c83f5acb465097f/e5651/react-handlers-performance.png\"\n        srcset=\"/static/b88373e4c76781a81c83f5acb465097f/a1986/react-handlers-performance.png 210w,\n/static/b88373e4c76781a81c83f5acb465097f/ad7fb/react-handlers-performance.png 420w,\n/static/b88373e4c76781a81c83f5acb465097f/e5651/react-handlers-performance.png 778w\"\n        sizes=\"(max-width: 778px) 100vw, 778px\"\n      />\n  </a>\n    </span></p>\n<p>I've calculated average rendering time from 17 full page re-renders. Non of this re-renders was an initial render.\nNumbers from perfomance tab looks as follows (lower number is better).</p>\n<ul>\n<li>17 ms RegularArrow</li>\n<li>17 ms RegularSingleHandler</li>\n<li>18 ms RegularWithId</li>\n<li>20 ms PureSingleHandler</li>\n<li>21 ms PureWithId</li>\n<li>21 ms PureMethodList</li>\n<li><strong>64 ms</strong> RegularMethodList</li>\n<li><strong>73 ms</strong> PureArrow</li>\n</ul>\n<p>Avarage render time of each components list as a bar chart.</p>\n<p><img src=\"/bcb293b88e25de0d32ec12a704eb78b0/react-multiple-handlers.svg\" alt=\"react-multiple-handlers\">\n<small><sup>Chart rendered with <a href=\"https://www.amcharts.com/\">amCharts 4</a> library</sup></small></p>\n<p>It is not a big suprise that <strong>PureArrow</strong> component was the slowest one, as for each re-render shallow equality comparison has to be executed and in each case component has to be re-rendered due to the fact that arrow function creates new handler function during rendering.</p>\n<p>Surprising is the fact that <strong>RegularMethodList</strong> is second slowest way of event handling. I guess that that is due to the large overhead required for new component initialization, and on each re-render new component has to be created.</p>\n<p>What surprises me about this test is the fact that there is no benefit from having a single handler attached to parent component as it will be beneficial in the jQuery times.</p>\n<h2>Links</h2>\n<ul>\n<li><a href=\"https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/edit#\">https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/edit#</a> - official Google docs about data export from DevTools Performance tab</li>\n<li><a href=\"https://www.amcharts.com/\">https://www.amcharts.com/</a> - charting library used to render bar chart with rendering times</li>\n<li><a href=\"https://ymm959qlxv.codesandbox.io/\">https://ymm959qlxv.codesandbox.io/</a> - Google Chrome Performance tab visualizer app (source code: <a href=\"https://codesandbox.io/s/ymm959qlxv\">https://codesandbox.io/s/ymm959qlxv</a>)</li>\n</ul>","timeToRead":3,"excerpt":"How to bind handlers in React to multiple similar elements e.g. buttons on list?\nIs it any better to use one handler and identify clicked…","frontmatter":{"title":"React multiple event handlers performance","slug":"react-multiple-event-handlers","date":"2019-03-13T08:38:18.000Z","tags":["react","javascript","frontend"],"date_created":"2019-03-09T19:49:23.000Z","date_updated":"2019-07-13T22:58:17.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1514388479888-50b7cef280ed.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHiyWMg/8QAFxABAQEBAAAAAAAAAAAAAAAAABIBEf/aAAgBAQABBQKEuK1euv/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABUQAQEAAAAAAAAAAAAAAAAAABAx/9oACAEBAAY/Amv/xAAZEAEBAQADAAAAAAAAAAAAAAABABEhUWH/2gAIAQEAAT8hHbnEHOz2Xxil/9oADAMBAAIAAwAAABAIP//EABcRAQEBAQAAAAAAAAAAAAAAAAEAURH/2gAIAQMBAT8QDW4bf//EABcRAQADAAAAAAAAAAAAAAAAAAABESH/2gAIAQIBAT8QuWv/xAAfEAEAAgICAgMAAAAAAAAAAAABABEhMUFRgZGh0fD/2gAIAQEAAT8QSGd4KNxK7cfvs9y1SwarJ055ti7o5XlK+OJR0DNO3uf/2Q==","aspectRatio":2,"src":"/static/aad908a40e560a85f4e88a73b25c43dc/0defe/photo-1514388479888-50b7cef280ed.jpg","srcSet":"/static/aad908a40e560a85f4e88a73b25c43dc/38b6a/photo-1514388479888-50b7cef280ed.jpg 150w,\n/static/aad908a40e560a85f4e88a73b25c43dc/e201c/photo-1514388479888-50b7cef280ed.jpg 300w,\n/static/aad908a40e560a85f4e88a73b25c43dc/0defe/photo-1514388479888-50b7cef280ed.jpg 600w,\n/static/aad908a40e560a85f4e88a73b25c43dc/a71f1/photo-1514388479888-50b7cef280ed.jpg 900w,\n/static/aad908a40e560a85f4e88a73b25c43dc/8d595/photo-1514388479888-50b7cef280ed.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"7f41791b-b92c-55b9-8630-29f818f7652e","html":"<p>There are many ways to define event handlers in React. Are there any differences between them?</p>\n<p>TLDR; You should probably avoid the inline arrow functions and handlers defined in the <code class=\"language-text\">render()</code> method.</p>\n<h2>Overview</h2>\n<p>Writing React handlers is easy, just take care of \"it\" and you're good to go.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'it works'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Click me<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Are you sure?</p>\n<h2>Example</h2>\n<p>A brief example of the various handler defining methods and their impact on the re-rendering of React.PureComponent based elements.</p>\n<iframe src=\"https://codesandbox.io/embed/wom604pn85?fontsize=14\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<br/>\n<p>NOTE: You may open console in above example to see a value of <code class=\"language-text\">this</code> for each handler.</p>\n<h2>Description</h2>\n<p>In the above example, you can see five ways to write click handlers.</p>\n<h3>Handler defined outside of a component</h3>\n<p>Easy to write, but you won't be able to access <code class=\"language-text\">this</code> from within the handler, that's why most of the time it is not so useful.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleClickOutsideClass</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h3>Handler as a class method</h3>\n<p>This is probably the most \"classic\" way of handling events in React components.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token function\">handleClickMethodBound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>In most cases, you should remember to bind handler methods in the class constructor or remember that <code class=\"language-text\">this</code> will be <code class=\"language-text\">undefined</code> inside the handler.\nHere is a binding implementation example:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClickMethodBound <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleClickMethodBound</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>While it might be important for your code to bind the handler method, it's also worth knowing that binding will slow down your code, <a href=\"https://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1#e821\">a little bit, but still</a>.</p>\n<h3>Handler as a class property</h3>\n<p>The most elegant way to define event handler is through the Babel class properties.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token function-variable function\">handleClickClassProp</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>In this method you can avoid binding inside the class constructor and still keep expected <code class=\"language-text\">this</code> assignment.\nOf course you will have to use <a href=\"https://babeljs.io/docs/en/babel-plugin-proposal-class-properties\">@babel/plugin-proposal-class-properties</a> in order to make this work.\nOne more drawback of this method is a Babel transpilation result.\nClass properties are transpiled to arrow functions in the class constructor.\nIt means that you won't be able to access them from outside the class e.g. to mock/spy them in tests, or use with super in subclasses.</p>\n<h3>Handler inside render() method</h3>\n<p>In this method, a new handler function will be created on each re-render, which is probably not the desired behavior.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleClickInRender</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ... Remaining implementation</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>Handler as an inline arrow function</h3>\n<p>Arrow functions may quickly solve <code class=\"language-text\">this</code> related issues.\nThis method has similar disadvantages to the handlers defined inside <code class=\"language-text\">render()</code> method.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Click me<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>You can use the inline arrow functions to avoid binding class methods in the class constructor, but drawbacks are still the same.\nOn each render, a new handler method will be created.</p>\n<h2>Summary</h2>\n<p>As you can see it is easy to create handler function on each render, which is not necessarly something you want to do.\nIt seems that class methods with optional binding (if necessary) are still the best option to define event handlers.</p>\n<h2>Sources</h2>\n<p>Official React guide on event handling is something worth checking <a href=\"https://reactjs.org/docs/handling-events.html\">https://reactjs.org/docs/handling-events.html</a>\nDetailed analysis of class properties solution\n<a href=\"https://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1\">https://medium.com/@charpeni/arrow-functions-in-class-properties-might-not-be-as-great-as-we-think-3b3551c440b1</a>\nComparison of transpiled class properties vs class methods\nStack Overflow question: <a href=\"https://stackoverflow.com/questions/49065425/should-class-methods-be-created-with-arrow-functions\">https://stackoverflow.com/questions/49065425/should-class-methods-be-created-with-arrow-functions</a>\nDirect Babel REPL <a href=\"https://babeljs.io/repl/#?babili=false&#x26;browsers=&#x26;build=&#x26;builtIns=false&#x26;spec=false&#x26;loose=false&#x26;code_lz=MYGwhgzhAEBiD29oFMAeAXZA7AJjASsmMOgHQDC8AtgA7xbbrQDeAUNNMPROgE4CuJeLwAUNXvBoQAlC3YdoEfjWSjxkmfI7oAFgEsIpHWFwhkAIXDQAvNF0GjJnGcthSAIz24R9zRwC-rPLGphbgIrJs8oGBrKCQMAjwAEwoGNh40ITEZJS09IxywU4uVrYRNgB8RQGs_kA&#x26;debug=false&#x26;forceAllTransforms=false&#x26;shippedProposals=false&#x26;circleciRepo=&#x26;evaluate=true&#x26;fileSize=false&#x26;timeTravel=false&#x26;sourceType=module&#x26;lineWrap=false&#x26;presets=es2015%2Creact%2Cstage-0&#x26;prettier=false&#x26;targets=&#x26;version=7.3.3\">link</a></p>","timeToRead":4,"excerpt":"There are many ways to define event handlers in React. Are there any differences between them? TLDR; You should probably avoid the inline…","frontmatter":{"title":"React.PureComponent - different ways of writing event handlers","slug":"react-different-ways-of-passing-handlers-through-the-props","date":"2019-02-19T22:55:00.000Z","tags":["react","javascript","frontend"],"date_created":"2019-03-03T23:56:03.000Z","date_updated":"2019-02-24T10:36:11.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1501281668745-f7f57925c3b4.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAgP/2gAMAwEAAhADEAAAARaijRsOL//EABgQAQEBAQEAAAAAAAAAAAAAAAIBAwAT/9oACAEBAAEFAs8ZeOQR8zOmikLR66K9/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQACE//aAAgBAwEBPwE0F0L/xAAWEQEBAQAAAAAAAAAAAAAAAAABABL/2gAIAQIBAT8BSy3/xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhAhD/2gAIAQEABj8Cb6ciMdZGZ7//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhQf/aAAgBAQABPyEmER3dEa3gZTTuZClI6JHh5lKy7//aAAwDAQACAAMAAAAQQC//xAAXEQEAAwAAAAAAAAAAAAAAAAAAESFh/9oACAEDAQE/EIqmL//EABcRAAMBAAAAAAAAAAAAAAAAAAABMWH/2gAIAQIBAT8Qc4aH/8QAGRABAQADAQAAAAAAAAAAAAAAAREAITFB/9oACAEBAAE/EHHzENs5lhCE1jzb3jjRMdmbFqb2OTCoILYe5ZKiLO5//9k=","aspectRatio":2,"src":"/static/b8caf1eb71d198c481e25e4bcf14457d/0defe/photo-1501281668745-f7f57925c3b4.jpg","srcSet":"/static/b8caf1eb71d198c481e25e4bcf14457d/38b6a/photo-1501281668745-f7f57925c3b4.jpg 150w,\n/static/b8caf1eb71d198c481e25e4bcf14457d/e201c/photo-1501281668745-f7f57925c3b4.jpg 300w,\n/static/b8caf1eb71d198c481e25e4bcf14457d/0defe/photo-1501281668745-f7f57925c3b4.jpg 600w,\n/static/b8caf1eb71d198c481e25e4bcf14457d/a71f1/photo-1501281668745-f7f57925c3b4.jpg 900w,\n/static/b8caf1eb71d198c481e25e4bcf14457d/8d595/photo-1501281668745-f7f57925c3b4.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"aa89b796-9cc6-5097-88ec-76d1a6312fa6","html":"<p>Can I use the <code class=\"language-text\">children</code> property with React.PureComponent, or do I have to use only custom properties?</p>\n<p>TLDR; You can use <code class=\"language-text\">children</code> with React.PureComponent as long as you use your component carefully. It is much easier to make a \"mistake\" with <code class=\"language-text\">children</code>.</p>\n<h2>Overview</h2>\n<p>Pure Components were introduced to facilitate limiting the re-rendering after component properties/state update.\nThey do this by using a shallow equality comparison inside <code class=\"language-text\">shouldComponentUpdate()</code>, <a href=\"https://reactjs.org/docs/react-api.html#reactpurecomponent\">see the official React documentation</a>\nThis comparison is used for every property, including <code class=\"language-text\">children</code> property as well as component internal state.</p>\n<h2>Example</h2>\n<p>Here's an example with different implementations that use React.Component or React.PureComponent as a base class.</p>\n<iframe src=\"https://codesandbox.io/embed/r0k3oywn44?fontsize=14&view=preview\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<br/>\n<p>Components used in this example:</p>\n<ul>\n<li>PureWithChildren - React PureComponent, which uses the <code class=\"language-text\">children</code> property</li>\n<li>PureWithLabel - React PureComponent, which uses the <code class=\"language-text\">label</code> property</li>\n<li>RegularWithChildren - React Component, which uses the <code class=\"language-text\">children</code> property</li>\n<li>RegularWithLabel - React Component, which uses the <code class=\"language-text\">label</code> property</li>\n</ul>\n<p>Regular React.Component is re-rendered each time it receives new properties, even if they are equal to old.\nOn the other, hand React.PureComponent is re-rendered only if new properties are different from the old ones.</p>\n<h2>Description</h2>\n<p>The above example shows that using PureComponents is much easier when they have custom properties such as <code class=\"language-text\">label</code> instead of the generic <code class=\"language-text\">children</code> property.\nThis is especially important if we look at interpolated strings.\nFor the <code class=\"language-text\">label</code> property it works expected, but in the case of <code class=\"language-text\">children</code> additional renders may surprise the developer.\nThe reason for this behavior is that <code class=\"language-text\">children</code> are passed as an array while <code class=\"language-text\">label</code> is simply a string (interpolated but still a string).\nArrays are not shallow equal to each other and therefore <code class=\"language-text\">children</code> are always re-rendered despite the lack of changes.</p>\n<p>React.PureComponent can be used with the <code class=\"language-text\">children</code> property, but with caution (probably along with some type checking using Flow/Typescript/PropTypes).\nThe above example can be refactored to prevent problematic array values for <code class=\"language-text\">children</code> by adding:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">PureWithChildren<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  children<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>string\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Then the correct component usage would be:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>PureWithChildren<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">string </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>data<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>PureWithChildren<span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>Sources</h2>\n<p>Official documentation for React.PureComponent:\n<a href=\"https://reactjs.org/docs/react-api.html#reactpurecomponent\">https://reactjs.org/docs/react-api.html#reactpurecomponent</a></p>\n<p>Other interesting posts on this topic:\n<a href=\"https://blog.cloudboost.io/react-purecomponents-children-979e3da15ba8\">https://blog.cloudboost.io/react-purecomponents-children-979e3da15ba8</a>\n<a href=\"https://medium.com/@antonkorzunov/2-things-about-purecomponent-you-probable-should-know-b04844a90d4\">https://medium.com/@antonkorzunov/2-things-about-purecomponent-you-probable-should-know-b04844a90d4</a>\n<a href=\"https://blog.shakacode.com/react-purecomponent-pitfalls-d057882f4b6e\">https://blog.shakacode.com/react-purecomponent-pitfalls-d057882f4b6e</a></p>","timeToRead":2,"excerpt":"Can I use the  property with React.PureComponent, or do I have to use only custom properties? TLDR; You can use  with React.PureComponent as…","frontmatter":{"title":"React.PureComponent - children vs custom properties","slug":"react-purecomponent-children-vs-custom-properties","date":"2019-02-16T16:00:00.000Z","tags":["react","javascript","frontend"],"date_created":"2019-02-27T14:11:00.000Z","date_updated":"2019-02-23T13:04:06.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1503847752244-32e931070a43.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQID/9oADAMBAAIQAxAAAAGi3NgaOEDj/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxEQEv/aAAgBAQABBQJa9hrCguJ7abvP/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEB/9oACAEDAQE/Abiv/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEB/9oACAECAQE/Abqv/8QAGBAAAgMAAAAAAAAAAAAAAAAAADEBECH/2gAIAQEABj8CNkQ7/8QAGxAAAwACAwAAAAAAAAAAAAAAAAERECExQWH/2gAIAQEAAT8h7BYISlpTpj2Dbk28f//aAAwDAQACAAMAAAAQKw//xAAXEQADAQAAAAAAAAAAAAAAAAAAARFB/9oACAEDAQE/EHmij//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EBT/xAAcEAEAAgMAAwAAAAAAAAAAAAABESEAMVEQYXH/2gAIAQEAAT8QdFQ1eNSF8Ph11XvNlTrWRiBSzTkVWdZ8f//Z","aspectRatio":2,"src":"/static/b1dc252aafcc5edeb969febda63fd7b3/0defe/photo-1503847752244-32e931070a43.jpg","srcSet":"/static/b1dc252aafcc5edeb969febda63fd7b3/38b6a/photo-1503847752244-32e931070a43.jpg 150w,\n/static/b1dc252aafcc5edeb969febda63fd7b3/e201c/photo-1503847752244-32e931070a43.jpg 300w,\n/static/b1dc252aafcc5edeb969febda63fd7b3/0defe/photo-1503847752244-32e931070a43.jpg 600w,\n/static/b1dc252aafcc5edeb969febda63fd7b3/a71f1/photo-1503847752244-32e931070a43.jpg 900w,\n/static/b1dc252aafcc5edeb969febda63fd7b3/8d595/photo-1503847752244-32e931070a43.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"dbec8e89-2961-5b54-9686-d63c2dccf023","html":"<p>You want to check how (or if) your application works with SSL encryption without exposing it to the Internet? Use a self-signed SSL certificate with the Traefik proxy server inside the intranet (or other LAN with restricted access).</p>\n<p><strong>TLDR;</strong> Clone this repo and adjust content of <strong>traefik.toml</strong> file <a href=\"https://github.com/jmarceli/traefik-self-signed-ssl-proxy\">https://github.com/jmarceli/traefik-self-signed-ssl-proxy</a></p>\n<h2>Start</h2>\n<p><a href=\"https://docs.traefik.io/\">Traefik</a> is becoming more and more popular thanks to its configuration simplicity and rich features available out of the box. Here is how it can be used to ensure self-signed SSL certificate for selected application server.</p>\n<h3>Overview</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 751px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.05326231691078%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACKUlEQVQoz4WSaU8aURSG/fFNmvSzTZqYJq02cYnthyogRoNWizALi6AWFxRmZVERGZRtnp5hEGnSph/enDt37n3Oe+45c5ABtKl8/yXqDEcZRn6GeiNBo5mgP1BlT2cw1Mcx+PcqXe7kmAtB6li+HypYX93eUnR7nNWfOL8bcHE/RLtusK0USOQvyZptirVnCu7TWHmnR8OrzAJDdyFQkwNdYhcQPR+ycfrM5ll/HDd+Ddi+8FFMplJFR1Ww2u7fgOG3YnksKLD4s8f7aI35qMuH7SZLKfiSkxOWjzajtAF22/63w2SlxUYajk9GHOr37KcbJHNtsgVxnPVJmSFINWeBDnMvkBd3/gT+9SDLcvyO7MMdm4ZG9CZLxNBRbxsC5H/AGQWOJcHWcYW1hEfWfWDPuiZxUx5HzWrxfQLUJ+Xqs8Cw3NRE6WnJiiONkGXy2iZ2VWTr/JTYZZHDsjN1GDQjJaAAlqxOgN1+EbdjUvNMafvNeJ6CJEdGh015w0y9zlYlR7ycJ17Nodg1ItIUxYb1os+CNuKjNuCzJDEeBOg+muxfQaLURTUG9IbHAlQ4Mjusien9yxaRkkmsZMsImeyWWnwTYDzv8HZV503E5t1Ok/lk/xX4Q4B7pac/gKr1zFIeVuXyWv5Vy+Jk/QR2Th75dFBnMeOzUoSVQuBQ5tDrn8pA2jiPDrVOdVpy0yvjjPdNkTGJoQITbseh3nVlbeG2TXk/C69f4jcQOWhaTI9rdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Traefik-SSL-proxy\"\n        title=\"Traefik-SSL-proxy\"\n        src=\"/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png\"\n        srcset=\"/static/75e4f14247faf096e98b3044469792ad/a1986/traefik-ssl-proxy.png 210w,\n/static/75e4f14247faf096e98b3044469792ad/ad7fb/traefik-ssl-proxy.png 420w,\n/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png 751w\"\n        sizes=\"(max-width: 751px) 100vw, 751px\"\n      />\n  </a>\n    </span></p>\n<p>Things to check before starting:</p>\n<ul>\n<li><strong>Your device</strong> - should have access to <strong>Development server</strong> using a custom domain name e.g. <strong>my.test</strong>, you can set it using the <strong>/etc/hosts</strong> file (on Unix systems), <strong>dnsmasq</strong> or directly in the network router, if you have access to its configuration (if you can't do that please read <a href=\"#tips\">#Tips</a> section to adjust your <strong>traefik.toml</strong> TLS configuration)</li>\n<li><strong>Development server</strong> - if necessary, adjust system firewall configuration and open the required ports (ports <strong>4000</strong> and <strong>8080</strong> should be available for Intranet/LAN connections)</li>\n<li><strong>Application server</strong> - make sure it works and is available from <strong>Development server</strong> on port <strong>5000</strong></li>\n</ul>\n<p>Request to <strong>my.test:4000</strong> made from <strong>Your device</strong> is supposed to go through the following path:</p>\n<ul>\n<li>access <strong>Development server</strong> (via some domain resolution mechanism e.g. <strong>/etc/hosts</strong> on <strong>Your device</strong>)</li>\n<li>go through opened <strong>4000</strong> port</li>\n<li><strong>Traefik</strong> Docker container should handle that request thanks to the exposed <strong>4000</strong> port</li>\n<li>Traefik <strong>httpSSL</strong> entryPoint should be set to <strong>4000</strong> port and handle the request</li>\n<li>Traefik <strong>frontend1</strong> should \"redirect\" request to <strong>backend1</strong></li>\n<li>Traefik <strong>backend1</strong> should respond with a content from <strong>Application server</strong></li>\n</ul>\n<h3>File structure</h3>\n<p>Here is the final files structure you should generate by following the next steps.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">./\n./certs/cert.crt\n./crets/cert.key\n./traefik.toml\n./docker-compose.yml</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>Self-signed certificate files</h3>\n<p>You will need a <strong>.key</strong> and <strong>.crt</strong> files. They can be generated for self-signed certificates using the <code class=\"language-text\">openssl</code>. If you don't have it already, please check on Google (<code class=\"language-text\">brew install openssl</code> for Mac OS X with Homebrew packages manager). With the <code class=\"language-text\">openssl</code> ready to use execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">openssl req -x509 -nodes -days <span class=\"token number\">365</span> -newkey rsa:2048 -keyout cert.key -out cert.crt</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>The only important question while running the <code class=\"language-text\">openssl</code> command is <strong>Common Name (e.g. server FQDN or YOUR name):</strong>. It should match the domain name of your server e.g. <code class=\"language-text\">*.test</code> or <code class=\"language-text\">my.test</code> (or any other that you can point to your server), wildcards (<code class=\"language-text\">*</code>) are allowed.</p>\n<p>After preparing the certificate files, you must change their access rights.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">chmod</span> <span class=\"token number\">644</span> cert.crt\n<span class=\"token function\">chmod</span> <span class=\"token number\">600</span> cert.key</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>It's done, now you may proceed to the next step.</p>\n<h3>Traefik configuration traefik.toml</h3>\n<p>Most Traefik configurations will be placed inside the <strong>traefik.toml</strong> file. Here is the final result.</p>\n<div class=\"gatsby-highlight\" data-language=\"toml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-toml line-numbers\"><code class=\"language-toml\"><span class=\"token key property\">debug</span> <span class=\"token punctuation\">=</span> <span class=\"token boolean\">true</span>\n<span class=\"token key property\">logLevel</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"DEBUG\"</span>\n<span class=\"token key property\">defaultEntryPoints</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"httpSSL\"</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">web</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">address</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\":8080\"</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.httpSSL</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">address</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\":4000\"</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.httpSSL.tls</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">file</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">backends</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">backends.backend1</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">backends.backend1.servers</span><span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">[</span><span class=\"token table class-name\">backends.backend1.servers.server0</span><span class=\"token punctuation\">]</span>\n        <span class=\"token key property\">url</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"http://192.168.0.16:5000\"</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">frontends</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">frontends.frontend1</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">entryPoints</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"httpSSL\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">backend</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"backend1\"</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token table class-name\">tls</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">entryPoints</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"httpSSL\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">tls.certificate</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key property\">certFile</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"/certs/cert.crt\"</span>\n    <span class=\"token key property\">keyFile</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"/certs/cert.key\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Useful information:</p>\n<ul>\n<li><strong>debug</strong> and <strong>logLevel</strong> - It should be self-explanatory</li>\n<li><strong>defaultEntryPoints</strong> - Specifies that by default Traefik server will expose extrypoint named <strong>httpSSL</strong> (it can be <strong>any</strong> string, just be consistent if you want to change it)</li>\n<li><strong>[web]</strong> - This section might be omitted, it will provide administrative/diagnostic panel on the selected <strong>8080</strong> port</li>\n<li><strong>[entryPoints]</strong> - Defines default entrypoint <strong>httpSSL</strong> and assings port <strong>4000</strong> to it. It also ensures <strong>tls</strong> encryption (<a href=\"https://tools.ietf.org/html/rfc7568\">TLS is \"safer\" SSL</a>)</li>\n<li><strong>[file]</strong> - This one is tricky, because it does not look as important as it is, thanks to that section Traefik uses <strong>traefik.toml</strong> <a href=\"https://docs.traefik.io/v1.5/configuration/backends/file/\">file as a backend definitions provider</a></li>\n<li><strong>[backends]</strong> - All available backends names (which is only one <strong>backend1</strong> in this example) with <strong><a href=\"http://192.168.0.16:5000\">http://192.168.0.16:5000</a></strong> as a proxy target (<strong><a href=\"http://192.168.0.16:5000\">http://192.168.0.16:5000</a></strong> is an IP address of a running Application server)</li>\n<li><strong>[frontends]</strong> - Frontends configuration, where <strong>frontend1</strong> is the name (which can be changed at any time), <strong>entryPoints</strong> and <strong>backend</strong> keys link entry point with a backend for given frontend, <strong>rule</strong> tells Traefik which domains it should handle with that frontend</li>\n<li><strong>[[tls]]</strong> - Assign generated cert and key files to the selected <strong>entryPoint</strong> (which is <strong>httpSSL</strong> in this case)</li>\n</ul>\n<h3>It's Docker time</h3>\n<p>With <strong>traefik.toml</strong> in place it's time to go to the Docker configuration. The simplest (at least for me) solution is to write the <strong>docker-compose.yml</strong> file. Here's how it can look.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3'</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">traefik</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> traefik<span class=\"token punctuation\">:</span>1.7.0\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> public\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> 4000<span class=\"token punctuation\">:</span><span class=\"token number\">4000</span>\n      <span class=\"token punctuation\">-</span> 8080<span class=\"token punctuation\">:</span><span class=\"token number\">8080</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./traefik.toml<span class=\"token punctuation\">:</span>/traefik.toml\n      <span class=\"token punctuation\">-</span> ./certs/<span class=\"token punctuation\">:</span>/certs/\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock\n\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">public</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> bridge</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Let's start from the beginning:</p>\n<ul>\n<li><strong>version</strong> - Specifies the syntax of the Docker configuration used</li>\n<li><strong>services</strong> - A list of Docker containers to create</li>\n<li><strong>traefik</strong> - The only service to create</li>\n<li><strong>image</strong> - Image for <strong>traefik</strong> service creation (<strong>1.7.0</strong> is the current stable version at the time of writing)</li>\n<li><strong>network</strong> - The name of the network which will be used does not matter, as long as it uses the <strong>bridge</strong> driver defined at the end of configuration in <strong>networks</strong> section</li>\n<li><strong>ports</strong> - Exposes <strong>4000</strong> port which will be proxied with SSL and <strong>8080</strong> for debugging and diagnostic</li>\n<li><strong>volumes</strong> - Files and folders mounted to the created container, you should be familiar with all of them except <strong>/var/run/docker.sock</strong> which allows <strong>traefik</strong> container to <a href=\"https://stackoverflow.com/questions/35110146/can-anyone-explain-docker-sock/35110344\">use Docker API</a></li>\n</ul>\n<h3>Show time</h3>\n<p>When everything is in place, it's easy to shine :)\nExecute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">docker-compose up</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Visit <a href=\"http://192.168.0.16:8080\">http://192.168.0.16:8080</a> to check the configuration. Here is how it may look like.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 751px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.05326231691078%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACKUlEQVQoz4WSaU8aURSG/fFNmvSzTZqYJq02cYnthyogRoNWizALi6AWFxRmZVERGZRtnp5hEGnSph/enDt37n3Oe+45c5ABtKl8/yXqDEcZRn6GeiNBo5mgP1BlT2cw1Mcx+PcqXe7kmAtB6li+HypYX93eUnR7nNWfOL8bcHE/RLtusK0USOQvyZptirVnCu7TWHmnR8OrzAJDdyFQkwNdYhcQPR+ycfrM5ll/HDd+Ddi+8FFMplJFR1Ww2u7fgOG3YnksKLD4s8f7aI35qMuH7SZLKfiSkxOWjzajtAF22/63w2SlxUYajk9GHOr37KcbJHNtsgVxnPVJmSFINWeBDnMvkBd3/gT+9SDLcvyO7MMdm4ZG9CZLxNBRbxsC5H/AGQWOJcHWcYW1hEfWfWDPuiZxUx5HzWrxfQLUJ+Xqs8Cw3NRE6WnJiiONkGXy2iZ2VWTr/JTYZZHDsjN1GDQjJaAAlqxOgN1+EbdjUvNMafvNeJ6CJEdGh015w0y9zlYlR7ycJ17Nodg1ItIUxYb1os+CNuKjNuCzJDEeBOg+muxfQaLURTUG9IbHAlQ4Mjusien9yxaRkkmsZMsImeyWWnwTYDzv8HZV503E5t1Ok/lk/xX4Q4B7pac/gKr1zFIeVuXyWv5Vy+Jk/QR2Th75dFBnMeOzUoSVQuBQ5tDrn8pA2jiPDrVOdVpy0yvjjPdNkTGJoQITbseh3nVlbeG2TXk/C69f4jcQOWhaTI9rdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"traefik-ssl-proxy\"\n        title=\"traefik-ssl-proxy\"\n        src=\"/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png\"\n        srcset=\"/static/75e4f14247faf096e98b3044469792ad/a1986/traefik-ssl-proxy.png 210w,\n/static/75e4f14247faf096e98b3044469792ad/ad7fb/traefik-ssl-proxy.png 420w,\n/static/75e4f14247faf096e98b3044469792ad/0898f/traefik-ssl-proxy.png 751w\"\n        sizes=\"(max-width: 751px) 100vw, 751px\"\n      />\n  </a>\n    </span></p>\n<p>Then open <a href=\"https://my.test:4000\">https://my.test:4000</a> to admire the results of your hard work.</p>\n<p>You can verify if certificate works by clicking on \"Not Secure\" info in Google Chrome address bar. Details should match those provided during cert generation.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 468px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/17ae3e393b262eea69a3cee49459ab0d/3f263/self-signed-my-test-certificate.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.2905982905983%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAACs0lEQVQ4y61US4vTUBTuLxZduNONbgZ0IwjiLARx5QNkdNRZDDMrFQTn0Xb6SpsmaZomuXk2bd7t57m3dqad1oEBL3yccJJ85zuvW3l9UMXzAxXPvql4sq/cGk+/KNj5rODloQZlYKDyau8MO18ZHu07uPvexr3b4oONO+9sPNwz0ZBUVPCfTprlqLV6qGjWGJoVQjEJo4CsT9aHPHQhG66wXZ1dPq/Zv1BGHtqqjfNGG5XYPYFnniHx6wgcA/2+Atu2bq1wGseockIm/YSuqmCDYxhKE622hF5PhtzvE7kKWVbAmIMoihCEIcbjMXzfRxCECMMxkiRZJ3S6v2BKP6DX34ANB+h1ZWgUoCt1ocp9qKTYYQwRkQVENA45obcgJKwRNjuozOZAHCcoZuSlDwtdQ2noKJmFUutjNhoCngs49gL/TDlZEOZ5huFwCNMcIU0zFGUpsDw8zmw+v8JstoErhdL62KRpCs/z4DiUItUqTZMNJXMivY4NQu7jZK7rUodtMILjOFCplryePEhJqvOiuCRYDXCV8orCosgxMgwYBMs0icRHp9MRYzTQNFiWKYJleb6hdCshVxhSmpNoIkaEN8qyLGRZduP8bSVcOnOKHlMtOJbFFo0RxS+3NuSfTSmoPnym+MyZlDKvp+M6SMm3Sr6tMVubkmWpIDIpTd4U1/VoS/qQJAm6rosNCWm4eeCtNZxeU1jSh4zU8cK7NDacQO71xNqFQUCbEQjfdbXLEyfZgjDgq0Qr5JAim7nCModbnxRb8IgooujRZCoQhBF88c8YcRQgm/jIphTMZwvCk2oDCzRxWmvipLZi6y2yDfzm74WvtfDV26g1mnj7nW76QxMvjkzsHg9x2iDC84s2bgTdINVGR+wpV8BxTj+2aEZ3jwzc/+jjwScfj/cZTi8k/AGyadN+97XliAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"self-signed-my-test-certificate\"\n        title=\"self-signed-my-test-certificate\"\n        src=\"/static/17ae3e393b262eea69a3cee49459ab0d/3f263/self-signed-my-test-certificate.png\"\n        srcset=\"/static/17ae3e393b262eea69a3cee49459ab0d/a1986/self-signed-my-test-certificate.png 210w,\n/static/17ae3e393b262eea69a3cee49459ab0d/ad7fb/self-signed-my-test-certificate.png 420w,\n/static/17ae3e393b262eea69a3cee49459ab0d/3f263/self-signed-my-test-certificate.png 468w\"\n        sizes=\"(max-width: 468px) 100vw, 468px\"\n      />\n  </a>\n    </span></p>\n<h2>Tips</h2>\n<h3>You can't set a custom domain name for your development server and you need to use it's IP address</h3>\n<p>Use following <strong>entryPoints</strong> configuration:</p>\n<div class=\"gatsby-highlight\" data-language=\"toml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-toml line-numbers\"><code class=\"language-toml\"><span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.httpSSL</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">address</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\":4000\"</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.httpSSL.tls</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.httpSSL.tls.defaultCertificate</span><span class=\"token punctuation\">]</span>\n      <span class=\"token key property\">certFile</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"/certs/cert.crt\"</span>\n      <span class=\"token key property\">keyFile</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"/certs/cert.key\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Thanks to that step you will use your own certificate (generated in <a href=\"#self-signed-certificate-files\">#Self-signed certificate files</a> step) as a default one.</p>\n<h3>Application server address 192.168.0.16</h3>\n<p>It doesn't have to be your Development server IP visible on LAN. It can be also an internal IP visible from Docker which is usally something like <strong>172.17.0.1</strong>. You should be able to check that using <strong>ifconfig</strong> (look for <strong>docker0</strong> interface), in case you are using <strong>Docker for Mac</strong> you may also use <strong>host.docker.internal</strong> <a href=\"https://docs.docker.com/docker-for-mac/networking/#use-cases-and-workarounds\">see the docs</a>.</p>\n<h2>Troubleshooting</h2>\n<p>Check the output after executing the <code class=\"language-text\">docker-compose up</code> command.</p>\n<p>If you want to restart the created container with the new/changed configuration inside <strong>traefik.toml</strong> file, press <code class=\"language-text\">Ctrl-c</code>, and then execute <code class=\"language-text\">docker-compose down &amp;&amp; docker-compose up</code> to make sure that old container has been properly destroyed.</p>\n<p><code class=\"language-text\">502 Bad gateway</code> instead of your requested/proxied content probably means that you have made a simple error in the <strong>traefik.toml</strong> configuration. Watch out for typos and renaming (if you choose to change some names).</p>\n<p>Start with minimal modifications. Just copy and paste the example content to files and adjust only the URLs. Start it. You will be renaming everything (frontends, backends, entryPoints, containers, networks etc.) later, after the first successful start.</p>\n<p>Some explanations regarding the Traefik log messages:</p>\n<ul>\n<li><code class=\"language-text\">Serving default cert for request: ...</code> - you probably give an incorrect FQDN when generating a self-signed certificate using <code class=\"language-text\">openssl</code></li>\n<li><code class=\"language-text\">Error loading new configuration, aborted unable to generate TLS certificate : tls: failed to find any PEM data in certificate input</code> - check the path to your certificate files specified in the <strong>traefik.toml</strong> file, it is probably icorrect</li>\n</ul>\n<p>Be patient and read this guide again... (if necessary)</p>\n<h2>Why</h2>\n<p>Because I did not find such an example when I needed it.</p>\n<p>After some adjustment, you can use this configuration in production with Let's Encrypt SSL certificate instead of self-signed. I'm going to write something about it later and link it here.</p>\n<h2>Sources</h2>\n<p><a href=\"https://tools.ietf.org/html/rfc7568\">https://tools.ietf.org/html/rfc7568</a> - SSLv3 deprecation in favour of TLS 1.2\n<a href=\"https://stackoverflow.com/questions/35110146/can-anyone-explain-docker-sock/35110344\">https://stackoverflow.com/questions/35110146/can-anyone-explain-docker-sock/35110344</a> - info about docker.sock\n<a href=\"https://hub.docker.com/_/traefik/\">https://hub.docker.com/_/traefik/</a> - Traefik Docker image\n<a href=\"https://docs.traefik.io/\">https://docs.traefik.io/</a> - Traefik Documenation, which should be the most up-to-date source of knowledge\n<a href=\"https://docs.docker.com/docker-for-mac/networking/#use-cases-and-workarounds\">https://docs.docker.com/docker-for-mac/networking/#use-cases-and-workarounds</a> - Docker docs</p>","timeToRead":8,"excerpt":"You want to check how (or if) your application works with SSL encryption without exposing it to the Internet? Use a self-signed SSL…","frontmatter":{"title":"Traefik - proxy development server with self-signed SSL certificate","slug":"traefik-proxy-development-server-self-signed-ssl","date":"2018-11-07T05:25:00.000Z","tags":["backend","tools"],"date_created":"2018-11-29T04:08:02.000Z","date_updated":"2018-11-08T00:16:57.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1512168203104-3910bc2bcd54.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAeABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAECAwQF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAe0nkjUMDNfAtIB//8QAGRAAAwEBAQAAAAAAAAAAAAAAAAECEBEx/9oACAEBAAEFAtfkNuhkzyh7/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFxAAAwEAAAAAAAAAAAAAAAAAAREgMP/aAAgBAQAGPwKA8P/EABoQAAIDAQEAAAAAAAAAAAAAAAARARBBITH/2gAIAQEAAT8hm/YxonXgndldR0S0cn//2gAMAwEAAgADAAAAEL//AMP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAbEAADAQADAQAAAAAAAAAAAAAAARExECFRQf/aAAgBAQABPxCh3wQuWkmR4R7843S0Q/CbnCqXZDZumQoaf//Z","aspectRatio":2,"src":"/static/d82df298cb57c0123e8c64bd116c3d65/0defe/photo-1512168203104-3910bc2bcd54.jpg","srcSet":"/static/d82df298cb57c0123e8c64bd116c3d65/38b6a/photo-1512168203104-3910bc2bcd54.jpg 150w,\n/static/d82df298cb57c0123e8c64bd116c3d65/e201c/photo-1512168203104-3910bc2bcd54.jpg 300w,\n/static/d82df298cb57c0123e8c64bd116c3d65/0defe/photo-1512168203104-3910bc2bcd54.jpg 600w,\n/static/d82df298cb57c0123e8c64bd116c3d65/a71f1/photo-1512168203104-3910bc2bcd54.jpg 900w,\n/static/d82df298cb57c0123e8c64bd116c3d65/8d595/photo-1512168203104-3910bc2bcd54.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"8c556f1a-071e-532b-947d-ce837a0546ea","html":"<p>Although there is much useful information on the official BrowserStack website, you will certainly have a lot of questions when you run tests for the first time. I will try to explain how to deal with it based on a simple example which uses Jest and Selenium.</p>\n<p><strong>There is no problem in running <a href=\"https://jestjs.io\">Jest</a> with BrowserStack, despite the lack of documentation or examples.</strong></p>\n<p>TLDR; Check the <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example\">example repository</a> it should be self-explanatory.</p>\n<h2>Starting point</h2>\n<p>I have Selenium-based tests that I can run locally. How do I load BrowserStack and run tests against their browsers?</p>\n<p>It seems that it is quite simple and typical task.</p>\n<p>Here is an example of a basic Selenium test powered by Jest. It will be used to show how to integrate existing code with <a href=\"https://www.browserstack.com/docs?product=automate\">BrowserStack Automate</a> testing service.</p>\n<p><strong>test/local.test.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Builder<span class=\"token punctuation\">,</span> By<span class=\"token punctuation\">,</span> until <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"selenium-webdriver\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> firefox <span class=\"token keyword\">from</span> <span class=\"token string\">\"selenium-webdriver/firefox\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> path <span class=\"token keyword\">from</span> <span class=\"token string\">\"path\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getElementById</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">driver<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> timeout <span class=\"token operator\">=</span> <span class=\"token number\">2000</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> el <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span>until<span class=\"token punctuation\">.</span><span class=\"token function\">elementLocated</span><span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> timeout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span>until<span class=\"token punctuation\">.</span><span class=\"token function\">elementIsVisible</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> timeout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"webdriver\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> driver<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> options <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">firefox<span class=\"token punctuation\">.</span>Options</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    options<span class=\"token punctuation\">.</span><span class=\"token function\">headless</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    driver <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">forBrowser</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"firefox\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">setFirefoxOptions</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// eslint-disable-next-line no-undef</span>\n    <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"file://\"</span> <span class=\"token operator\">+</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"test.html\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">quit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> btn <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> <span class=\"token string\">\"test-button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> btn<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> <span class=\"token string\">\"output\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> outputVal <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> output<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>outputVal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Something\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>As you can see, this is a simple example in which after clicking on <strong>#myBtn</strong> we expect to have <strong>Something</strong> as value of the <strong>#output</strong> input HTML element. Here's tested code.</p>\n<p><strong>test/jest-selenium-browserstack-example.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> JestSeleniumBrowserStackExample <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">exports</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">write</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">elementId</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> el <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>elementId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    el<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"Something\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  exports<span class=\"token punctuation\">.</span>write <span class=\"token operator\">=</span> write<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> exports<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Here is a local HTML file used for testing in browser.</p>\n<p><strong>test/test.html</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span>\n      <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>./jest-selenium-browserstack-example.js<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">'</span>JestSeleniumBrowserStackExample.write(\"output\")<span class=\"token punctuation\">'</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>copy<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      write\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>output<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>not working<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>All files listed above are available inside <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example/tree/master/test\">test folder of Github example repository</a>. You may run <code class=\"language-text\">yarn test:local</code> in cloned repository to check if everything is working as expected.</p>\n<blockquote>\n<p>NOTE! In order to run Selenium tests locally you will have to download and install approperiate driver, which is geckodriver in this case. It may be downloaded directly from <a href=\"https://github.com/mozilla/geckodriver/releases\">official Mozilla repository</a> .</p>\n</blockquote>\n<h2>Solution</h2>\n<p>The following solution will use <a href=\"https://www.browserstack.com/automate/node#setting-local-tunnel\">Automate with Local Testing</a> for running fully automated tests on selected version of OS and browser.\nIn order to simplify things a bit, I assume that you're working on a Unix system (e.g. Ubuntu, Mac OS X). Windows commands will be different only when it comes to <strong>BrowserStackLocal</strong> executable.</p>\n<h3>1. What is BrowserStackLocal?</h3>\n<p>After reading <a href=\"https://www.browserstack.com/automate/node\">https://www.browserstack.com/automate/node</a> you may already know that <strong>BrowserStackLocal</strong> is \"something\" that can be useful in tests.\nUnfortunately, I didn't find any clear information about how to use it for integration with test (maybe I didn't look carefully enough).</p>\n<p>For starters, just run <a href=\"https://www.browserstack.com/automate/node#local-testing-getting-started\">downloaded</a> <strong>BrowserStackLocal</strong> to check if it works. You will have to provide the <code class=\"language-text\">--key</code> argument with your BrowserStack key (as in <a href=\"https://www.browserstack.com/automate/node#doc-platform-tab\">official docs</a>) e.g. <code class=\"language-text\">Asdafklwe12312kldfasfmaMD</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">./BrowserStackLocal --key <span class=\"token punctuation\">[</span>YOUR_BROWSERSTACK_KEY<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>As a result, you will get some output. Exact messages doesn't matter, just make sure that there are no errors at this point.\nNow run it with additional <code class=\"language-text\">--folder $(pwd)</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">./BrowserStackLocal --key <span class=\"token punctuation\">[</span>YOUR_BROWSERSTACK_KEY<span class=\"token punctuation\">]</span> --folder <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">pwd</span><span class=\"token variable\">)</span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>As you can see on the output, the contents of the current folder will be available for your tests under unique URL <code class=\"language-text\">http://[YOUR_BROWSERSTACK_USERNAME].browserstack.com</code> where <code class=\"language-text\">[YOUR_BROWSERSTACK_USERNAME]</code> is your BrowserStack username.</p>\n<h3>2. Adjust/rewrite tests</h3>\n<p>By default, our test is run using the local Selenium webdriver e.g. <code class=\"language-text\">geckodriver</code> (for Firefox). We would like to run it with remote BrowserStack OS and browser. Exact BrowserStack webdriver settings are defined inside <code class=\"language-text\">capabilities</code> object.\nHere is an example:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">// for more options check https://www.browserstack.com/automate/capabilities</span>\n<span class=\"token keyword\">const</span> capabilities <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  build<span class=\"token punctuation\">:</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../package.json\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>version<span class=\"token punctuation\">,</span>\n  project<span class=\"token punctuation\">:</span> <span class=\"token string\">\"jest-selenium-browserstack-example\"</span><span class=\"token punctuation\">,</span>\n  browserName<span class=\"token punctuation\">:</span> <span class=\"token string\">\"chrome\"</span><span class=\"token punctuation\">,</span>\n  os<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Windows\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"browserstack.local\"</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"browserstack.user\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"[YOUR_BROWSERSTACK_USERNAME]\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"browserstack.key\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"[YOUR_BROWSERSTACK_KEY]\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>With the above configuration, you will run tests using the Google Chrome browser on Windows. Here is the code that initiates the driver.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">driver <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">webdriver<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">usingServer</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://hub-cloud.browserstack.com/wd/hub\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">withCapabilities</span><span class=\"token punctuation\">(</span>capabilities<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Remember to import the Selenium webdriver before using the above code.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> webdriver <span class=\"token keyword\">from</span> <span class=\"token string\">\"selenium-webdriver\"</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>All this is described on the <a href=\"https://www.browserstack.com/automate/node\">official documentation pages</a>.</p>\n<p>The last important thing is to replace:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"file://\"</span> <span class=\"token operator\">+</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"test.html\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>\n  <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>capabilities<span class=\"token punctuation\">[</span><span class=\"token string\">\"browserstack.user\"</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.browserstack.com/test.html</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Because local files are not directly available in the Browser Stack, you can access them only through a webserver (which serves files from <strong>BrowserStackLocal</strong> <code class=\"language-text\">--folder</code>). This makes sense if you think about running tests on multiple OSes because thanks to this webserver you don't have to copy files from one machine to the other, all you have to do is access the internal URL.</p>\n<p>At this stage, if you manually connect to BrowserStack using <code class=\"language-text\">./BroserStackLocal --key [bs_key] --folder $(pwd)</code> executed in the same folder as the test files, you should be able to completet all tests.</p>\n<blockquote>\n<p>NOTE! BrowserStack Selenium tests may require setting a Jest timeouts (default is 5s). This is especially true for connecting and disconnecting which tends to be time consuming process. I would advise something around 10-15s.</p>\n</blockquote>\n<p>If you clone <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example\">example repository</a> initiate <strong>BrowserStackLocal</strong> with <code class=\"language-text\">test/</code> directory inside <code class=\"language-text\">--folder</code> argument and then run <code class=\"language-text\">yarn test:manual</code> to view the results.</p>\n<p>Here is the test code described above <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/manual.test.js\">https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/manual.test.js</a>.</p>\n<h3>3. Automate BrowserStackLocal connection</h3>\n<p>Going further, it's time to go for more automated/autonomous approach.\nIf you don't want (and probably you should not) to implement NodeJS wrapper for <code class=\"language-text\">./BrowserStackLocal</code>, use the official one <a href=\"https://github.com/browserstack/browserstack-local-nodejs\">browserstack-local-nodejs</a>.\nThis package will handle the download of approperiate binary files for you and can serve as an interface between your tests and the <code class=\"language-text\">BrowserStackLocal</code> executable.</p>\n<blockquote>\n<p>To be honest I don't like the <strong>browserstack-local-nodejs</strong> package at all (callbacks, hard to debug, unused variables and more), but since this the official BrowserStack repository, we can hope that it will be maintained.</p>\n</blockquote>\n<p>Let's continue with examples.</p>\n<p>Here is how you may wrap <code class=\"language-text\">start</code> and <code class=\"language-text\">stop</code> methods from <strong>browserstack-local-nodejs</strong> to make them work with my beloved async/await syntax.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">connect</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    local<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span>BrowserStackLocalArgs<span class=\"token punctuation\">,</span> <span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">disconnect</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    local<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now you can use <code class=\"language-text\">await start()</code> and <code class=\"language-text\">await stop()</code> which is much more convenient.\nDon't forget to initialize <strong>browserstack-local-nodejs</strong> first, with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> local <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">browserstack<span class=\"token punctuation\">.</span>Local</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>and set approperiate args for executable with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> BrowserStackLocalArgs <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  key<span class=\"token punctuation\">:</span> <span class=\"token string\">\"[YOUR_BROWSERSTACK_KEY]\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// verbose: true,</span>\n  onlyAutomate<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// eslint-disable-next-line</span>\n  folder<span class=\"token punctuation\">:</span> __dirname<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Then connect with BrowserStack by awaiting for <code class=\"language-text\">start()</code> function.\nYou should do this <strong>before</strong> running the webdriver.\nHere's how <code class=\"language-text\">beforeAll()</code> looks like for your tests:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// BrowserStackLocal has to be ready before webdriver initialization</span>\n    <span class=\"token keyword\">await</span> <span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    driver <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">webdriver<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">usingServer</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://hub-cloud.browserstack.com/wd/hub\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">withCapabilities</span><span class=\"token punctuation\">(</span>capabilities<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>capabilities<span class=\"token punctuation\">[</span><span class=\"token string\">\"browserstack.user\"</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.browserstack.com/test.html</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"connetion error\"</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// IMPORTANT! Selenium and Browserstack needs more time than regular Jest</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The tests should not require any changes. Remember about disconnecting from BrowserStack after finishing tests.\nYou can do it with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">quit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ~ 11 s !</span>\n    <span class=\"token keyword\">await</span> <span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ~ 3 s</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"disconnection error\"</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// IMPORTANT! Selenium and Browserstack needs a lot of time!</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>NOTE! At least in my case the disconnection after testing takes really long, which is why I set 20 seconds as a <code class=\"language-text\">afterAll</code> timeout.</p>\n</blockquote>\n<blockquote>\n<p>NOTE! If the waiting time is too short, you'll probably run into this message: <strong>Jest did not exit one second after the test run has completed</strong>. When it appears, check your system process/task manager and kill BrowserStackLocal process(es) which may not close/stop correctly.</p>\n</blockquote>\n<p>This is it. If you have any questions do not hestitate to ask and check out a sample repository that should help you a lot (I hope).</p>\n<p>If you clone <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example\">example repository</a> just run <code class=\"language-text\">yarn test:automate</code> to view the results.</p>\n<p>Here is the test code described above <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js\">https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js</a>.</p>\n<p>In the part 2 of this \"series\" I will present a way to run tests for many browsers and OSes at once, see <a href=\"https://www.grzegorowski.com/integration-tests-with-jest-selenium-and-browserstack-part-2/\">https://www.grzegorowski.com/integration-tests-with-jest-selenium-and-browserstack-part-2/</a>.</p>\n<h2>Sources</h2>\n<ul>\n<li><a href=\"https://seleniumhq.github.io/selenium/docs/api/javascript/module/selenium-webdriver/index.html\">https://seleniumhq.github.io/selenium/docs/api/javascript/module/selenium-webdriver/index.html</a> - Selenium documentation</li>\n<li><a href=\"https://github.com/Hyddan/se-runner-browserstack-example#readme\">https://github.com/Hyddan/se-runner-browserstack-example#readme</a> - first inspiration for automated tests with BrowserStack</li>\n<li><a href=\"https://github.com/browserstack/browserstack-local-nodejs\">https://github.com/browserstack/browserstack-local-nodejs</a> - finally a working example of BrowserStack integration</li>\n<li><a href=\"https://www.browserstack.com/automate/node\">https://www.browserstack.com/automate/node</a> - useful official NodeJS documentation</li>\n<li><a href=\"https://blog.evantahler.com/testing-javascript-applications-with-selenium-async-await-and-jest-7580ed074f2b\">https://blog.evantahler.com/testing-javascript-applications-with-selenium-async-await-and-jest-7580ed074f2b</a> - nice setup of Jest and Selenium without BrowserStack</li>\n<li><a href=\"https://www.browserstack.com/local-testing#modifiers\">https://www.browserstack.com/local-testing#modifiers</a> - BrowserStackLocal argument list</li>\n<li><a href=\"https://github.com/Hyddan/se-runner\">https://github.com/Hyddan/se-runner</a> - one of the inspirations (uses Grunt and Jasmine)</li>\n</ul>","timeToRead":9,"excerpt":"Although there is much useful information on the official BrowserStack website, you will certainly have a lot of questions when you run…","frontmatter":{"title":"Integration tests with Jest, Selenium and BrowserStack - part 1 - simple example","slug":"integration-tests-with-jest-selenium-and-browserstack","date":"2018-10-30T09:29:00.000Z","tags":["javascript","tools"],"date_created":"2018-11-20T10:58:51.000Z","date_updated":"2018-11-04T18:01:19.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1513611771808-7e8ab7f1dec6.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMFBP/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABXvl2MkjSP//EABoQAAIDAQEAAAAAAAAAAAAAAAABAxETAjL/2gAIAQEAAQUCid9ZmYola8n/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAADAAMAAAAAAAAAAAAAAAACEBExgZH/2gAIAQEABj8CkPbyXX//xAAZEAADAAMAAAAAAAAAAAAAAAAAAREQMUH/2gAIAQEAAT8hcje7GDCglxXRn//aAAwDAQACAAMAAAAQVP8A/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/EKx//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERMSFx/9oACAEBAAE/EIP1xGF60VNQi9Yn93tDtUaa9Zo//9k=","aspectRatio":2,"src":"/static/77532cba5dddbaa1e8170b8f97b35b49/0defe/photo-1513611771808-7e8ab7f1dec6.jpg","srcSet":"/static/77532cba5dddbaa1e8170b8f97b35b49/38b6a/photo-1513611771808-7e8ab7f1dec6.jpg 150w,\n/static/77532cba5dddbaa1e8170b8f97b35b49/e201c/photo-1513611771808-7e8ab7f1dec6.jpg 300w,\n/static/77532cba5dddbaa1e8170b8f97b35b49/0defe/photo-1513611771808-7e8ab7f1dec6.jpg 600w,\n/static/77532cba5dddbaa1e8170b8f97b35b49/a71f1/photo-1513611771808-7e8ab7f1dec6.jpg 900w,\n/static/77532cba5dddbaa1e8170b8f97b35b49/8d595/photo-1513611771808-7e8ab7f1dec6.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"ef4d6b89-823d-5f1b-aaec-9271a806d4d5","html":"<p>As described in <a href=\"https://www.grzegorowski.com/integration-tests-with-jest-selenium-and-browserstack/\">part 1</a> you can run Jest based tests with BrowserStack service. Now I will show how they can be automatically run against many browsers and OSes.</p>\n<h2>Parametrized tests</h2>\n<p>Probably the most simple way to convert <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js\">single-browser automatic Browserstack test</a> to multi browser/OS is parametrization using enironment variables. Here is how it might be done regarding example test file <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example/blob/master/test/automate.test.js\">test/automate.test.js</a>.</p>\n<p>Replace the following lines from <code class=\"language-text\">capabilities</code> object:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  browserName<span class=\"token punctuation\">:</span> <span class=\"token string\">'chrome'</span><span class=\"token punctuation\">,</span>\n  os<span class=\"token punctuation\">:</span> <span class=\"token string\">'Windows'</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  browserName<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">BROWSER</span><span class=\"token punctuation\">,</span>\n  os<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">OS</span><span class=\"token punctuation\">,</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>This is it! Now you may run tests against any browser and OS available in BrowserStack service.\nExample:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token assign-left variable\">OS</span><span class=\"token operator\">=</span>Windows <span class=\"token assign-left variable\">BROWSER</span><span class=\"token operator\">=</span>chrome <span class=\"token function\">yarn</span> jest ./test/parametrized.test.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Provided that your parametrized tests file path is: <code class=\"language-text\">./test/parametrized.test.js</code></p>\n<p>Running against multiple browsers and OSes might be achieved by chaining execution of commands like:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token assign-left variable\">OS</span><span class=\"token operator\">=</span>Windows <span class=\"token assign-left variable\">BROWSER</span><span class=\"token operator\">=</span>chrome <span class=\"token function\">yarn</span> jest ./test/parametrized.test.js <span class=\"token operator\">&amp;&amp;</span> <span class=\"token assign-left variable\">OS</span><span class=\"token operator\">=</span>Windows <span class=\"token assign-left variable\">BROWSER</span><span class=\"token operator\">=</span>firefox <span class=\"token function\">yarn</span> jest ./test/parametrized.test.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>or (if you don't care about possible previous command errors):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token assign-left variable\">OS</span><span class=\"token operator\">=</span>Windows <span class=\"token assign-left variable\">BROWSER</span><span class=\"token operator\">=</span>chrome <span class=\"token function\">yarn</span> jest ./test/parametrized.test.js<span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">OS</span><span class=\"token operator\">=</span>Windows <span class=\"token assign-left variable\">BROWSER</span><span class=\"token operator\">=</span>firefox <span class=\"token function\">yarn</span> jest ./test/parametrized.test.js</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>As you may expect, this is not the most effective method, because the connection to BrowserStack service is opened and closed for each command executed.</p>\n<h2>Sequential tests</h2>\n<p>Another option is to write a sequential test wrapper that will run selected tests against browsers defined in the <code class=\"language-text\">config.json</code> file one after another. It is a bit more complicated as it requires tests code refactoring.</p>\n<p>Here is an example content of a <code class=\"language-text\">config.json</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"browsers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"browserName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"internet explorer\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10.0\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"browserName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"chrome\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"22.0\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The file structure is based on the official <code class=\"language-text\">example/config.json</code> from <a href=\"https://www.browserstack.com/automate/node#wd\">https://www.browserstack.com/automate/node#wd</a>. Check the <a href=\"https://www.browserstack.com/automate/capabilities\">https://www.browserstack.com/automate/capabilities</a> for list of all available keys.</p>\n<p>The general idea is to connect to BrowserStackLocal, run tests for all browsers defined inside the <code class=\"language-text\">config.json</code> file and finally disconnect. To achieve this, we will use the <code class=\"language-text\">beforeAll</code> and <code class=\"language-text\">afterAll</code> hooks to handle BrowserStack connection. After establishing a connection with BrowserStackLocal we will loop through all browser versions from config file and run tests for each of them. Here's how it can look.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> webdriver <span class=\"token keyword\">from</span> <span class=\"token string\">'selenium-webdriver'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> browserstack <span class=\"token keyword\">from</span> <span class=\"token string\">'browserstack-local'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> local <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">browserstack<span class=\"token punctuation\">.</span>Local</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> until <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>until<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> By <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>By<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> config <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./config.json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> BrowserStackLocalArgs <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  key<span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  onlyAutomate<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  folder<span class=\"token punctuation\">:</span> __dirname<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">start</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    local<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span>BrowserStackLocalArgs<span class=\"token punctuation\">,</span> <span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">stop</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    local<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getElementById</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">driver<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> timeout <span class=\"token operator\">=</span> <span class=\"token number\">5000</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> el <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span>until<span class=\"token punctuation\">.</span><span class=\"token function\">elementLocated</span><span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span><span class=\"token function\">id</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> timeout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span>until<span class=\"token punctuation\">.</span><span class=\"token function\">elementIsVisible</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> timeout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> browser <span class=\"token keyword\">of</span> config<span class=\"token punctuation\">.</span>browsers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> driver<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> capabilities <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    os<span class=\"token punctuation\">:</span> <span class=\"token string\">'Windows'</span><span class=\"token punctuation\">,</span>\n    build<span class=\"token punctuation\">:</span> <span class=\"token string\">'0.1.0'</span><span class=\"token punctuation\">,</span>\n    project<span class=\"token punctuation\">:</span> <span class=\"token string\">'jest-selenium-browserstack-example'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'browserstack.local'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'browserstack.user'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'browserstack.key'</span><span class=\"token punctuation\">:</span> BrowserStackLocalArgs<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">...</span>browser<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">describe</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'selenium webdriver'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        driver <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">webdriver<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">usingServer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://hub-cloud.browserstack.com/wd/hub'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">withCapabilities</span><span class=\"token punctuation\">(</span>capabilities<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'driver start'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">quit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'driver quit'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">desc </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>capabilities<span class=\"token punctuation\">.</span>browserName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">test </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>capabilities<span class=\"token punctuation\">.</span>browserName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tests start'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">await</span> driver<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>\n            <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>\n              capabilities<span class=\"token punctuation\">[</span><span class=\"token string\">'browserstack.user'</span><span class=\"token punctuation\">]</span>\n            <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.browserstack.com/test.html</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> btn <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> <span class=\"token string\">'test-button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">await</span> btn<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">const</span> output <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> <span class=\"token string\">'output'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> outputVal <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> output<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>outputVal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toEqual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Something'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tests end'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">30000</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Although it seems quite easy, you need to take care of several things:</p>\n<ol>\n<li><code class=\"language-text\">describe</code> can not use <code class=\"language-text\">async</code> function, so there is no way to prepare <code class=\"language-text\">driver</code> instance to use directly inside <code class=\"language-text\">describe</code> block, it can be used only inside <code class=\"language-text\">test</code> body, which may be asynchronous</li>\n<li>Jest scoping is a topic which is worth refreshing to fully understand what is going on in the presented code <a href=\"https://jestjs.io/docs/en/setup-teardown#scoping\">https://jestjs.io/docs/en/setup-teardown#scoping</a></li>\n<li><code class=\"language-text\">beforeAll</code> and <code class=\"language-text\">afterAll</code> are scoped by <code class=\"language-text\">describe</code> blocks and what is more important both of them supports asynchronous function as an argument</li>\n<li>Remember about timeouts, default 5s is often not enough</li>\n</ol>\n<p>More details and sample files can be found in this repository <a href=\"https://github.com/jmarceli/jest-selenium-browserstack-example\">https://github.com/jmarceli/jest-selenium-browserstack-example</a>, especially in <code class=\"language-text\">test/sequential.test.js</code> file.</p>\n<h2>Sources</h2>\n<p><a href=\"https://www.browserstack.com/automate/node\">https://www.browserstack.com/automate/node</a>\n<a href=\"https://www.browserstack.com/list-of-browsers-and-platforms?product=automate\">https://www.browserstack.com/list-of-browsers-and-platforms?product=automate</a></p>","timeToRead":4,"excerpt":"As described in part 1 you can run Jest based tests with BrowserStack service. Now I will show how they can be automatically run against…","frontmatter":{"title":"Integration tests with Jest, Selenium and BrowserStack - part 2 - multiple browsers","slug":"integration-tests-with-jest-selenium-and-browserstack-part-2","date":"2018-11-03T02:58:00.000Z","tags":["frontend","javascript"],"date_created":"2018-11-06T02:33:54.000Z","date_updated":"2018-11-04T18:17:34.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1517607537732-619ace47ec9e.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAE/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAL/2gAMAwEAAhADEAAAAYspJWCP/8QAHBAAAQQDAQAAAAAAAAAAAAAAAAIDERIBBBAy/9oACAEBAAEFAk7FzC7D8Ou+SY5//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHBAAAgICAwAAAAAAAAAAAAAAAREAIQIxEEFh/9oACAEBAAY/AiEHtwl6uHIIeSp3x//EABoQAQACAwEAAAAAAAAAAAAAAAEAESExQWH/2gAIAQEAAT8hED0kcIpPDwgQz1AAchSrGD0cit8hP//aAAwDAQACAAMAAAAQXM//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxCq/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAx/9oACAECAQE/EBF//8QAGxABAAMBAQEBAAAAAAAAAAAAAQARIUExYZH/2gAIAQEAAT8QHVN4GjTxZVYBpQoywy62Ko4AOFHwiXqmhiaedlniVnS55FnPyf/Z","aspectRatio":2,"src":"/static/4035689e780baa3abd3793f7b51bc335/0defe/photo-1517607537732-619ace47ec9e.jpg","srcSet":"/static/4035689e780baa3abd3793f7b51bc335/38b6a/photo-1517607537732-619ace47ec9e.jpg 150w,\n/static/4035689e780baa3abd3793f7b51bc335/e201c/photo-1517607537732-619ace47ec9e.jpg 300w,\n/static/4035689e780baa3abd3793f7b51bc335/0defe/photo-1517607537732-619ace47ec9e.jpg 600w,\n/static/4035689e780baa3abd3793f7b51bc335/a71f1/photo-1517607537732-619ace47ec9e.jpg 900w,\n/static/4035689e780baa3abd3793f7b51bc335/8d595/photo-1517607537732-619ace47ec9e.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"4d2a833f-00a5-538e-9b16-4a2dea23f23a","html":"<p>Here is a description of common tools and files used to create a modern NPM package. Don't hesitate to clone my <a href=\"https://github.com/jmarceli/npm-lib-package-boilerplate\">npm-lib-package-boilerplate</a> repository to check the results before spending any time on reading this.</p>\n<p>Let's start with a list of development dependencies which I'm going to use throughout this article:</p>\n<ul>\n<li><a href=\"https://babeljs.io/\">Babel</a> - ES6-8 features transpiled to ES5</li>\n<li><a href=\"https://jestjs.io/\">Jest</a> - running tests and generate coverage reports</li>\n<li><a href=\"https://flow.org/\">Flow</a> - Javascript type checking</li>\n<li><a href=\"https://eslint.org/\">ESLint</a> - Javascript linting</li>\n<li><a href=\"https://travis-ci.org/\">Travis CI</a> - continuous integration</li>\n<li><a href=\"https://rollupjs.org\">Rollup</a> - package files building</li>\n</ul>\n<p>At the end of this text you should be more or less familiar with a purpose and usage of all packages listed above.</p>\n<p>NOTE: This build is aimed at generating NodeJS/Browser libraries but is not suitable for building/publishing web applications.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 197px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3319baddbbcf1935f186d44f2a73014d/c142b/babel.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.68020304568529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBP/EABcBAAMBAAAAAAAAAAAAAAAAAAECAwX/2gAMAwEAAhADEAAAAe2LZF9Ah//EABgQAQEBAQEAAAAAAAAAAAAAAAECEBIT/9oACAEBAAEFAqsl9ZxgXic//8QAFREBAQAAAAAAAAAAAAAAAAAAECH/2gAIAQMBAT8Bp//EABURAQEAAAAAAAAAAAAAAAAAABAi/9oACAECAQE/AZP/xAAZEAACAwEAAAAAAAAAAAAAAAAAARARITH/2gAIAQEABj8CpmRbOR//xAAaEAADAQADAAAAAAAAAAAAAAAAATEREFGB/9oACAEBAAE/IUWjNXmn5xTAlReiH//aAAwDAQACAAMAAAAQVB//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/EB//xAAXEQADAQAAAAAAAAAAAAAAAAABESEQ/9oACAECAQE/EBNbz//EAB0QAQADAAIDAQAAAAAAAAAAAAEAESExUUFhkfD/2gAIAQEAAT8QVdNTMqFwPznh3+7IaRyK8oXCuKnox8QAAFBP/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"babel\"\n        title=\"babel\"\n        src=\"/static/3319baddbbcf1935f186d44f2a73014d/c142b/babel.jpg\"\n        srcset=\"/static/3319baddbbcf1935f186d44f2a73014d/c142b/babel.jpg 197w\"\n        sizes=\"(max-width: 197px) 100vw, 197px\"\n      />\n  </a>\n    </span></p>\n<h2>Babel</h2>\n<p>Transpile (converts) ES6-8 Javascript syntax into ES5 compliant code.</p>\n<p>NOTE: These instructions are for Babel@6 despite the fact that Babel@7 is already available. It is so due to the fact that the latter is still not supported by all other dependencies. Especially Jest support for Babel@7 is not complete.</p>\n<p>Here is a command to execute in order to install Babel:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev babel-core babel-cli babel-preset-env babel-plugin-transform-object-rest-spread</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Short explanation:</p>\n<ul>\n<li><code class=\"language-text\">babel-preset-env</code> - a starting point for all Babel custom presets (instructions what should be transpiled and how)</li>\n<li><code class=\"language-text\">babel-plugin-transform-object-rest-spread</code> - if you use spread operator anywhere you will need this one</li>\n</ul>\n<p>Finally an example of <strong>.babelrc</strong> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ensures most commonly used transpilations e.g. import</span>\n  <span class=\"token string\">\"presets\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"env\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// some additional plugins: Flow and Rewire (described in the Jest section)</span>\n  <span class=\"token string\">\"plugins\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"transform-flow-strip-types\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"babel-plugin-rewire\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>It will only be used for tests. You won't need it during build process because it will be handled by a <a href=\"#rollup\">Rollup</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 160px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e91ab0590c5d35ff89504657950c88ce/bd8b1/jest.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQCBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHuwaF2smJqwrYZ/8QAGxAAAgIDAQAAAAAAAAAAAAAAAQIDIQAREhD/2gAIAQEAAQUCN50ulGlYEycBcjqOWpAoXz//xAAWEQEBAQAAAAAAAAAAAAAAAAABEDH/2gAIAQMBAT8BI5P/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAgEAABAwMFAQAAAAAAAAAAAAABABEhAjFBEBIiQlFS/9oACAEBAAY/AmeV2t9ZQBRLQ+FyqG7xUv4g0PdQNP/EAB0QAQACAwADAQAAAAAAAAAAAAEAESExURBBYYH/2gAIAQEAAT8hqHEj9gWbYybV8RlCoZYCm4OrrvoiMpjjGuQINgTaHidwqiPH/9oADAMBAAIAAwAAABDo2ID/xAAXEQEBAQEAAAAAAAAAAAAAAAABADEQ/9oACAEDAQE/EAE7Yc//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAfEAEAAQQCAwEAAAAAAAAAAAABEQAhMUFhcRBRobH/2gAIAQEAAT8QieVRDA5KEs84kO+WGiUsEZV3REtcBbJHY+c0gjBbNRDeVvmjiQhHJaphO3B6flRgO0Lvbvx//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jest\"\n        title=\"jest\"\n        src=\"/static/e91ab0590c5d35ff89504657950c88ce/bd8b1/jest.jpg\"\n        srcset=\"/static/e91ab0590c5d35ff89504657950c88ce/bd8b1/jest.jpg 160w\"\n        sizes=\"(max-width: 160px) 100vw, 160px\"\n      />\n  </a>\n    </span></p>\n<h2>Jest</h2>\n<p>Next important package after Babel transpiler is Jest. Facebook alternative to the well known Mocha test runner. Here is an installation command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev jest babel-jest babel-plugin-rewire</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>First two packages are more or less self-explanatory but the last one <code class=\"language-text\">babel-plugin-rewire</code> is in my opinion particularly useful. It let's you <a href=\"https://github.com/speedskater/babel-plugin-rewire\">test even non-exported functions</a> by getting their definitions through <code class=\"language-text\">__get__</code> method.</p>\n<p>As usual you will require some configuration file, which is named <strong>jest.config.js</strong>. It might be auto-generated with:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> jest --init</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>For start I would suggest you to leave <strong>jest.config.js</strong> without any changes as it should work in most cases.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 130px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5d84637d4e2302105b0bc7ad749ff59b/21825/flow.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 119.23076923076923%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAYABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMBAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAADAv/aAAwDAQACEAMQAAAB9nvZhdmGjiQKXCR//8QAGRABAAMBAQAAAAAAAAAAAAAAAQACITER/9oACAEBAAEFArKQcjF8TliWdOf/xAAZEQACAwEAAAAAAAAAAAAAAAAAMQECECH/2gAIAQMBAT8BeU6Sz//EABoRAQADAAMAAAAAAAAAAAAAAAEAAhEDITH/2gAIAQIBAT8BVq7DychnZKuk/8QAGhAAAQUBAAAAAAAAAAAAAAAAEAABESExYf/aAAgBAQAGPwJWeGHwf//EABsQAAMAAgMAAAAAAAAAAAAAAAABESFhMUFR/9oACAEBAAE/IX2iOFidVQtWjmB5HaiIDqYz/9oADAMBAAIAAwAAABAIF73/xAAYEQEBAQEBAAAAAAAAAAAAAAABABEhMf/aAAgBAwEBPxAwBk+3TGGK/8QAGBEBAQEBAQAAAAAAAAAAAAAAAQARMUH/2gAIAQIBAT8QYako3sBfScVv/8QAHBABAAMAAgMAAAAAAAAAAAAAAQARITFBYYGx/9oACAEBAAE/EGBgjIoUPNcw+ol0NPxMkKghA2adLl4nvZL3mB6yM0AKn//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"flow\"\n        title=\"flow\"\n        src=\"/static/5d84637d4e2302105b0bc7ad749ff59b/21825/flow.jpg\"\n        srcset=\"/static/5d84637d4e2302105b0bc7ad749ff59b/21825/flow.jpg 130w\"\n        sizes=\"(max-width: 130px) 100vw, 130px\"\n      />\n  </a>\n    </span></p>\n<h2>Flow</h2>\n<p>Type checking the Facebook way. As for React based development Flow seems to me as more natural choice than Typescript, I've decided to use it also for my non-React projects.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev flow-bin flow-typed babel-plugin-transform-flow-strip-types</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li><code class=\"language-text\">flow-typed</code> is a library with typings (something similar to Typescript DefinitelyTyped)</li>\n<li><code class=\"language-text\">babel-plugin-transform-flow-strip-types</code> allows for using flow with Babel transpiler by stripping flow annotations when necessary</li>\n</ul>\n<p>Flow default configuration available in <strong>.flowconfig</strong> should match your base requirements.</p>\n<p>After all packages are in installed with Yarn execute <code class=\"language-text\">yarn flow-typed install</code> to get most recent types definitions.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 150px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6b0e393a42fbe0dd551e514cae0cce8e/91b8e/eslint.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 103.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAGQABAQADAQAAAAAAAAAAAAAAAAQBAgUD/8QAGAEAAgMAAAAAAAAAAAAAAAAAAAECAwT/2gAMAwEAAhADEAAAAa/HPQ0LVEiWRCOsKn//xAAZEAEBAQEBAQAAAAAAAAAAAAADAgEEERP/2gAIAQEAAQUCRk1dhi2Ok6ka8drnDAcSOg8qAD6TE5E//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAGREBAAIDAAAAAAAAAAAAAAAAAQACEBEi/9oACAECAQE/AXl0ESgwslMf/8QAHxAAAgIBBAMAAAAAAAAAAAAAAAECEhEDITFRE0GR/9oACAEBAAY/Anpw2PJl/Td1fTHdYeR+xyfY5cSRaUiseD//xAAcEAADAAMAAwAAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hczCcqWWygU90IDX0BeeDb4UNqsSnywGvJ35MuY+JCeiIf//aAAwDAQACAAMAAAAQGNfC/8QAGBEAAgMAAAAAAAAAAAAAAAAAACEQETH/2gAIAQMBAT8Q0ZTj/8QAGREBAQEAAwAAAAAAAAAAAAAAAQARIUGB/9oACAECAQE/EEhxHPZ4azzHuVXW/8QAHBABAAICAwEAAAAAAAAAAAAAAQARIUExUcGR/9oACAEBAAE/EAcBGxQ7cEsLFparek6nE1iKR9I5UNeK1w+TERaZLWDByxdgHtwwZFCXQ09wAB1cfs1iCXc//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"eslint\"\n        title=\"eslint\"\n        src=\"/static/6b0e393a42fbe0dd551e514cae0cce8e/91b8e/eslint.jpg\"\n        srcset=\"/static/6b0e393a42fbe0dd551e514cae0cce8e/91b8e/eslint.jpg 150w\"\n        sizes=\"(max-width: 150px) 100vw, 150px\"\n      />\n  </a>\n    </span></p>\n<h2>ESLint</h2>\n<p>Having some linter is always a good idea so I've decided to go with probably most popular one which is ESLint. Just execute:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev eslint eslint-config-airbnb-base eslint-plugin-flowtype eslint-plugin-jest babel-eslint eslint-plugin-import</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>As you can see we have to install a plugin for every package used in development: Flow, Jest and Babel to prevent false positives. As it is a description of creating non-React package you should probably use <code class=\"language-text\">eslint-config-airbnb-base</code> instead of <code class=\"language-text\">eslint-config-airbnb</code> for base of your linting rules.\nWhat is more <code class=\"language-text\">eslint-plugin-import</code> package is required to support ES6 import statements.</p>\n<p>ESLint configuration is stored in <strong>.eslintrc</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"extends\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"airbnb-base\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:jest/recommended\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:flowtype/recommended\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"plugins\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"jest\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"flowtype\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"rules\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// special case for rewire __get__</span>\n    <span class=\"token string\">\"no-underscore-dangle\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"allow\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"__get__\"</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 156px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9dd0e07a3d0ff4c9f0e22afd8e6c3bae/35ffc/travisci.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.35897435897438%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAUEAgP/xAAXAQADAQAAAAAAAAAAAAAAAAABAgMA/9oADAMBAAIQAxAAAAGvj88yG2yGHU01LwM//8QAHhAAAgEDBQAAAAAAAAAAAAAAAQIDAAQREhMhIiP/2gAIAQEAAQUCdqU9xIMTq25jmGPUl2PONA1IoRf/xAAXEQEBAQEAAAAAAAAAAAAAAAABEAIh/9oACAEDAQE/AYKZ5P/EABURAQEAAAAAAAAAAAAAAAAAAAEg/9oACAECAQE/AUj/xAAgEAABAwIHAAAAAAAAAAAAAAAAAREhEjECIkFRYZGh/9oACAEBAAY/AhZ8MwrvNmNeyXvuVGHkpQ//xAAaEAEBAQEBAQEAAAAAAAAAAAABEQAhQTGx/9oACAEBAAE/IfMsPs9zFLLCAwBUf3dAMcVMGY9eHRgRL6l8aQCiM45G1LTmE/E3/9oADAMBAAIAAwAAABDcyDz/xAAYEQACAwAAAAAAAAAAAAAAAAAQEQEhQf/aAAgBAwEBPxCEheGj/8QAGREBAAIDAAAAAAAAAAAAAAAAAQARECEx/9oACAECAQE/EEXsLqJvH//EABsQAQACAwEBAAAAAAAAAAAAAAEAESExQVFh/9oACAEBAAE/EKhsE8LBq4NIQFFsux+ahVbl5NPYpzLN88a7M8510BzfbmIMjYTglCNsgEdjMgQmGK1WIGqHRe36z//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"travisci\"\n        title=\"travisci\"\n        src=\"/static/9dd0e07a3d0ff4c9f0e22afd8e6c3bae/35ffc/travisci.jpg\"\n        srcset=\"/static/9dd0e07a3d0ff4c9f0e22afd8e6c3bae/35ffc/travisci.jpg 156w\"\n        sizes=\"(max-width: 156px) 100vw, 156px\"\n      />\n  </a>\n    </span></p>\n<h2>Travis CI</h2>\n<p>Continuous integration is a nice and useful addition to every publicly available project. In order to use Travis CI you only have to register with your Github account on <a href=\"https://travis-ci.org/\">Travis CI</a>, which is FREE for every open-source project. After registration you should select your repository and activate it (which is fairly simple and intuitive).</p>\n<p>In order to make continuous integration work just add a file <strong>.travis.yml</strong> to the root folder of your project. It should have a content similar to the one presented below:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yml line-numbers\"><code class=\"language-yml\"><span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> node_js\n<span class=\"token key atrule\">node_js</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token string\">'8'</span>\n<span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> yarn test\n  <span class=\"token punctuation\">-</span> yarn build\n<span class=\"token key atrule\">install</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> yarn install\n<span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">only</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> master</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>This file tell Travis to:</p>\n<ul>\n<li>use language <code class=\"language-text\">node_js</code></li>\n<li>in version <code class=\"language-text\">8</code> (it will be selected with <code class=\"language-text\">nvm</code> by Travis)</li>\n<li><code class=\"language-text\">yarn install</code> packages (with Yarn - instead of default NPM installation)</li>\n<li>run scripts <code class=\"language-text\">yarn test</code> and <code class=\"language-text\">yarn build</code> - they will determine the process output, if any of them fails entire building result will be negative</li>\n<li>and use only <code class=\"language-text\">master</code> branch of your repo</li>\n</ul>\n<p>One thing worth noting during package configuration is a behaviour of <code class=\"language-text\">prepublish</code> hook which you may be tempted to implement in <strong>package.json</strong> file. It might be not so obvious that <code class=\"language-text\">prepublish</code> scripts will be run <strong>also</strong> after initial installation, not only before package publishing. You would probably like to use <code class=\"language-text\">prepublishOnly</code> instead of <code class=\"language-text\">prepublish</code>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 118px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/77d523d4050aecce642f246d40d90469/2ac20/rollup.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 131.35593220338984%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMCBAUB/8QAFgEBAQEAAAAAAAAAAAAAAAAAAwQF/9oADAMBAAIQAxAAAAGM2Rl0rQoaftB6CffMIQ//xAAcEAABBAMBAAAAAAAAAAAAAAACAAEDIgQSMhD/2gAIAQEAAQUCLp6IMmojeQlHjuQm+jKI9wn78//EABwRAAIABwAAAAAAAAAAAAAAAAABAgMEESExQf/aAAgBAwEBPwFvg1JuQIdNnZ//xAAaEQEAAQUAAAAAAAAAAAAAAAAAAhESISIx/9oACAECAQE/Aa5bI8Xv/8QAHRAAAgEEAwAAAAAAAAAAAAAAAAERECAhIjFRcf/aAAgBAQAGPwJ+i7N+Rsgl4qnZ/8QAHBABAAIDAQEBAAAAAAAAAAAAAQARITFBcVGh/9oACAEBAAE/If0IU0M+/IZQKOkuZoWZ6ZYLbPRDWtridvsNRzp9mjyEtOz/2gAMAwEAAgADAAAAEH//AEL/xAAZEQEBAQEBAQAAAAAAAAAAAAABEQAhcYH/2gAIAQMBAT8Qqh+65Xu5XGpIPN//xAAZEQEAAwEBAAAAAAAAAAAAAAABABEhMVH/2gAIAQIBAT8QVkg0gq3sM8n/xAAgEAEAAgEEAgMAAAAAAAAAAAABABEhMUFRcRBhgeHw/9oACAEBAAE/EPzOYt2ZWydCodQVchKfZY9tsERG4ua+4uNLIZTmM9LnZXWCuRyu/cFoHDeyJp2NHy+GkEdM/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"rollup\"\n        title=\"rollup\"\n        src=\"/static/77d523d4050aecce642f246d40d90469/2ac20/rollup.jpg\"\n        srcset=\"/static/77d523d4050aecce642f246d40d90469/2ac20/rollup.jpg 118w\"\n        sizes=\"(max-width: 118px) 100vw, 118px\"\n      />\n  </a>\n    </span></p>\n<h2>Rollup</h2>\n<p>Finally, one of the least known packages. Rollup, a package building tool without complicated configuration. Here is a command to install Rollup and all recommended plugins:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev rollup rollup-plugin-babel@3 rollup-plugin-flow rollup-plugin-cpy babel-plugin-external-helpers</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>After finishing installation create one fairly simple <strong>rollup.config.js</strong> file. Here is a commented example:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">// plugins that we are going to use</span>\n<span class=\"token keyword\">import</span> babel <span class=\"token keyword\">from</span> <span class=\"token string\">'rollup-plugin-babel'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> copy <span class=\"token keyword\">from</span> <span class=\"token string\">'rollup-plugin-cpy'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> flow <span class=\"token keyword\">from</span> <span class=\"token string\">'rollup-plugin-flow'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// list of plugins used during building process</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">plugins</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">targets</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token comment\">// remove flow annotations from output</span>\n  <span class=\"token function\">flow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// use Babel to transpile to ES5</span>\n  <span class=\"token function\">babel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ignore node_modules/ in transpilation process</span>\n    exclude<span class=\"token punctuation\">:</span> <span class=\"token string\">'node_modules/**'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// ignore .babelrc (if defined) and use options defined here</span>\n    babelrc<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> use recommended babel<span class=\"token operator\">-</span>preset<span class=\"token operator\">-</span>env without es modules enabled\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> and <span class=\"token keyword\">with</span> possibility to <span class=\"token keyword\">set</span> custom targets e<span class=\"token punctuation\">.</span>g<span class=\"token punctuation\">.</span> <span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">:</span> <span class=\"token string\">'8'</span> <span class=\"token punctuation\">}</span>\n    presets<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'env'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> modules<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> targets <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> solve a problem <span class=\"token keyword\">with</span> spread operator transpilation https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>github<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>rollup<span class=\"token operator\">/</span>rollup<span class=\"token operator\">/</span>issues<span class=\"token operator\">/</span><span class=\"token number\">281</span>\n    plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'babel-plugin-transform-object-rest-spread'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> removes comments <span class=\"token keyword\">from</span> output\n    comments<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> copy Flow definitions <span class=\"token keyword\">from</span> source to destination directory\n  <span class=\"token function\">copy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    files<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'src/*.flow'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    dest<span class=\"token punctuation\">:</span> <span class=\"token string\">'lib'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// packages that should be treated as external dependencies, not bundled</span>\n<span class=\"token keyword\">const</span> external <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">/</span><span class=\"token operator\">/</span> e<span class=\"token punctuation\">.</span>g<span class=\"token punctuation\">.</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'axios'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> source file <span class=\"token operator\">/</span> entrypoint\n  input<span class=\"token punctuation\">:</span> <span class=\"token string\">'src/index.js'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> output configuration\n  output<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> name visible <span class=\"token keyword\">for</span> other scripts\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'npmLibPackageExample'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> output file location\n    file<span class=\"token punctuation\">:</span> <span class=\"token string\">'lib/index.esm.js'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> format <span class=\"token keyword\">of</span> generated <span class=\"token constant\">JS</span> file<span class=\"token punctuation\">,</span> also<span class=\"token punctuation\">:</span> esm<span class=\"token punctuation\">,</span> and others are available\n    format<span class=\"token punctuation\">:</span> <span class=\"token string\">'esm'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">/</span> add sourcemaps\n    sourcemap<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  external<span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> build es modules <span class=\"token keyword\">for</span> node <span class=\"token number\">8</span>\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token function\">plugins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">:</span> <span class=\"token string\">'8'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  input<span class=\"token punctuation\">:</span> <span class=\"token string\">'src/index.js'</span><span class=\"token punctuation\">,</span>\n  output<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'npmLibPackageExample'</span><span class=\"token punctuation\">,</span>\n    file<span class=\"token punctuation\">:</span> <span class=\"token string\">'lib/index.js'</span><span class=\"token punctuation\">,</span>\n    format<span class=\"token punctuation\">:</span> <span class=\"token string\">'cjs'</span><span class=\"token punctuation\">,</span>\n    sourcemap<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  external<span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">/</span> build common <span class=\"token constant\">JS</span> <span class=\"token keyword\">for</span> node <span class=\"token number\">6</span>\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token function\">plugins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">:</span> <span class=\"token string\">'6'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Some more or less important findings are:</p>\n<ul>\n<li>use <code class=\"language-text\">rollup-plugin-cpy</code> instead of <code class=\"language-text\">rollup-plugin-copy</code> in order to avoid <a href=\"https://github.com/meuter/rollup-plugin-copy/issues/7\">non-existing output directory problem</a></li>\n<li><code class=\"language-text\">rollup-plugin-babel@3</code> you may use version 4 if you upgrade Babel to version 7</li>\n<li>as you may noticed as a result of this Rollup configuration you will get two files: <a href=\"https://github.com/rollup/rollup/wiki/pkg.module\">ES module standard and CommonJS one</a></li>\n</ul>\n<h2>Scripts</h2>\n<p>Custom scripts defined inside <strong>package.json</strong> which are used during development and publishing. Here is a list:</p>\n<ul>\n<li><code class=\"language-text\">&quot;clean&quot;: &quot;rimraf lib&quot;</code> - remove <code class=\"language-text\">lib/</code> directory with build results</li>\n<li><code class=\"language-text\">&quot;test&quot;: &quot;yarn jest src&quot;</code> - run tests defined inside <code class=\"language-text\">src/</code> directory with Jest</li>\n<li><code class=\"language-text\">&quot;test:watch&quot;: &quot;yarn jest src --watch --notify&quot;</code> - run tests and watch for changes as well as display notifications with results</li>\n<li><code class=\"language-text\">&quot;cover&quot;: &quot;jest src --coverage&quot;</code> - generate test coverage report</li>\n<li><code class=\"language-text\">&quot;lint&quot;: &quot;eslint src&quot;</code> - run linting with ESLint</li>\n<li><code class=\"language-text\">&quot;build&quot;: &quot;yarn rollup -c&quot;</code> - build output using Rollup</li>\n<li><code class=\"language-text\">&quot;precommit&quot;: &quot;yarn flow src &amp;&amp; yarn lint &amp;&amp; yarn test&quot;</code> - run before each commit to ensure commited code quality</li>\n<li><code class=\"language-text\">&quot;prepublishOnly&quot;: &quot;yarn clean &amp;&amp; yarn lint &amp;&amp; yarn test &amp;&amp; yarn build&quot;</code> - run <a href=\"https://docs.npmjs.com/misc/scripts\">ONLY before</a> <code class=\"language-text\">yarn publish</code> to ensure quality and most recent output</li>\n</ul>\n<h2>Other tools and files</h2>\n<p>List of useful tools/files:</p>\n<ul>\n<li><code class=\"language-text\">rimraf</code> - cross-platform directory cleaning</li>\n<li><code class=\"language-text\">husky</code> - additional Git hooks e.g. testing code just before making a commit</li>\n<li><code class=\"language-text\">.editorconfig</code> - recommended editor configuration</li>\n<li><code class=\"language-text\">.npmignore</code> - list of ignored files/dirs when publishing to NPM registry</li>\n<li><code class=\"language-text\">LICENSE</code> - info about license e.g. <a href=\"https://en.wikipedia.org/wiki/MIT_License\">MIT</a></li>\n</ul>\n<p>Another important thing is last part of <strong>package.json</strong> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\">  <span class=\"token property\">\"husky\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"hooks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"pre-commit\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"yarn precommit\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>These are lines which actually trigger <code class=\"language-text\">yarn precommit</code> before each Git commit thanks to <a href=\"https://github.com/typicode/husky\">husky</a> provided hooks.</p>\n<p>You will find all files/tools listed above in my <a href=\"https://github.com/jmarceli/npm-lib-package-boilerplate\">boilerplate project on Github</a> or <a href=\"https://www.npmjs.com/package/npm-lib-package-boilerplate\">on NPM</a></p>\n<h2>Sources</h2>\n<ul>\n<li><a href=\"https://codeburst.io/publish-your-own-npm-package-ff918698d450\">https://codeburst.io/publish-your-own-npm-package-ff918698d450</a> - great article with slightly different setup</li>\n<li><a href=\"https://github.com/rollup/rollup/wiki/pkg.module\">https://github.com/rollup/rollup/wiki/pkg.module</a> - ES module, CommonJS and others explained</li>\n<li><a href=\"https://github.com/rollup/rollup/issues/281\">https://github.com/rollup/rollup/issues/281</a> - Rollup spread operator transpilation</li>\n<li><a href=\"https://github.com/rollup/rollup-plugin-babel#configuring-babel\">https://github.com/rollup/rollup-plugin-babel#configuring-babel</a></li>\n<li><a href=\"https://github.com/meuter/rollup-plugin-copy/issues/7\">https://github.com/meuter/rollup-plugin-copy/issues/7</a> - rollup-plugin-copy problem</li>\n</ul>","timeToRead":9,"excerpt":"Here is a description of common tools and files used to create a modern NPM package. Don't hesitate to clone my npm-lib-package-boilerplate…","frontmatter":{"title":"Publishing NPM package with Rollup, Babel, Flow, Jest and ESLint","slug":"publishing-npm-package-with-rollup-babel-and","date":"2018-10-01T02:57:00.000Z","tags":["javascript"],"date_created":"2018-11-05T01:31:45.000Z","date_updated":"2018-10-02T21:48:08.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1520038410233-7141be7e6f97.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABtpsLZdyeF//EABoQAAIDAQEAAAAAAAAAAAAAAAABAgMREjH/2gAIAQEAAQUCJTmr+kJlvu4f/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/AYx//8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAECAQE/Aa1//8QAGBAAAgMAAAAAAAAAAAAAAAAAABESIEH/2gAIAQEABj8CNgq//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERQRAhUWH/2gAIAQEAAT8hRAVLkrPXDB7ooSP/2gAMAwEAAgADAAAAEAc//8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAwEBPxAa9kbf/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAgEBPxBYchX/xAAcEAEAAwACAwAAAAAAAAAAAAABABExIUGBofD/2gAIAQEAAT8QrUABqg1579UWBQKXT1ETPcVIXiByjdn/2Q==","aspectRatio":2,"src":"/static/53c3d1dd50f0e922033c3793e452e77e/0defe/photo-1520038410233-7141be7e6f97.jpg","srcSet":"/static/53c3d1dd50f0e922033c3793e452e77e/38b6a/photo-1520038410233-7141be7e6f97.jpg 150w,\n/static/53c3d1dd50f0e922033c3793e452e77e/e201c/photo-1520038410233-7141be7e6f97.jpg 300w,\n/static/53c3d1dd50f0e922033c3793e452e77e/0defe/photo-1520038410233-7141be7e6f97.jpg 600w,\n/static/53c3d1dd50f0e922033c3793e452e77e/a71f1/photo-1520038410233-7141be7e6f97.jpg 900w,\n/static/53c3d1dd50f0e922033c3793e452e77e/8d595/photo-1520038410233-7141be7e6f97.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"6e5b33a1-0893-5af0-99b7-17841b60e075","html":"<p>InfluxDB turns out to be a good solution for a time series data which happens to be the cornerstone of my current job. As (probably) every database it has it's pros and cons, but the most annoying thing for me as a developer was lack of a proper administration tool to work with.\nUntil now...\n<br/></p>\n<div style=\"text-align: center\">\n    <a href=\"https://timeseriesadmin.github.io/\" style=\"box-shadow: none; display: inline-block; border: none;\">\n      <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 128px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADNUlEQVQ4y31US08UQRAeTDxwIAZ57AvY7hqUh4hRgfBUEAQVBHmDi254CKIGr/4A7yTcvXLgZuJv8aIYvfAfZHa6rK+ne10S4yZfpqd26ut6fFUBEQX44am1vuTOl+W8LDgW/BCcCyLBT8GJoCDfVONbpdQlzyH2oEyWyWS8cVbwVWwMyPkCKuzfBauB+8m56l9kH8sORJGmUECxwDjE1pZE64kPPamN1KcJsjAMWYmTyudLKpM2qrHBqGzGqFw2QVpsKbHlckYrVZILSvAR3yOXflU5TdwmhlgIYn29jenBpKHZRUNzK0wL64I1ptklppkFo/uHjHzLIFZal8Ik0kJQ0QBbM0QGp3D3wNDMvKHxKdYjo6wHhlgPDrO+P8408ZhpeYPDvfdGDwyzam5CpCD8JahBdMvU2soqnYpoctpQcdeoKzVIly1yWVZNTQkyaVYN9azqr7JqaeHw4IPRHZ04R5Skvg3CY7yoluZId3Ub2txHdKzv9rLu7GKbGsiam1nDqfsW6/5hpuebTIvrRrIyaJJr0OfA6QxdjVWTFFuc6NFTpo1tpnVxKshzrejOWwmRvOuhe6ghO8LYyepb4ESb/NHWjhslpTqbnkiEddfNJCqg84ZNVaUbbdpongSABhlH+DuwmkJDEF3fgKGtN9bZEqN+vma4JNWYpA7n0Qmml69waSXheeDGCS+xdMzowRGm4h7T5mumeZHKk7m/mJ5nWpEOb7+V5wsfcWXKpyA8cQWNRFOJmKUJur3D1snKBDWdmoE2Wff0sW69lkSbydgJkgh9U74EdtDR5VwusimLcEXciQNkg1TragWSdkNd2S71htiNJc/nIzcx+yCsdoOOTpdoqcBWOs9WGOnr2z2s73j0Mo1N2nTDnXeGxh6ipl7YZ4JaP3qrNkqZT8yw6BFTYRCBlU9xNwGkMz2PCbHysnMupXLR7QR+nznSQ/uHRIlbVTZrayQpJmgUpFN+WdjLsZEc2Sdw5PP5qsAvR0d65EjlI6wvQRjG0JpDbG1ufVWSub1QdXE5JucCBv1/C9YRnZXTrOTwaxuR+n2GrYFBx2xinDABbqJOIQ100zcAafrIwPUH1TPgnCdbUBEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Time Series Admin logo - administrator UI for InfluxDB\" title=\"Time Series Admin logo - administrator UI for InfluxDB\" src=\"/static/b62767277a93d049123dd9e282c27923/81a47/timeseries-admin-icon.png\" srcset=\"/static/b62767277a93d049123dd9e282c27923/81a47/timeseries-admin-icon.png 128w\" sizes=\"(max-width: 128px) 100vw, 128px\">\n    </span>\n      <h3 style=\"margin-top:20px\">Time Series Admin</h3>\n    </a>\n</div>\n<h2>Quick start</h2>\n<p>Here it is <a href=\"https://timeseriesadmin.github.io/\">Time Series Admin</a>, which you may <a href=\"https://timeseriesadmin.github.io/#download\">download</a> as an Electron application. It is built as an alternative to <a href=\"https://docs.influxdata.com/influxdb/v1.3/administration/differences/#web-admin-ui-removal\">deprecated Admin UI</a> or current <a href=\"https://docs.influxdata.com/chronograf/v1.6/\">Chronograf</a> based approach.</p>\n<p>It is tested to be compatible with:</p>\n<ul>\n<li>Windows 10 x64</li>\n<li>Ubuntu 18.04</li>\n<li>Mac OS X 10.13</li>\n</ul>\n<p>It should also work with other versions of popular OSes, but this is not yet verified (a feedback will be appreciated).</p>\n<p>In order to ensure a fallback for non-supported OSes and for demo purposes there is also an <a href=\"https://hub.docker.com/r/timeseriesadmin/timeseriesadmin/\">Time Series Admin Docker image</a>.\nYou may run it on (probably) any OS and use through some recent version of Google Chrome browser.\nEverything you need to get it working is a <a href=\"https://www.docker.com/get-started\">Docker installed</a> on your system and a command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">docker run -p <span class=\"token number\">8085</span>:80 -it timeseriesadmin/timeseriesadmin:latest</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>After executing command above visit <a href=\"http://localhost:8085\">http://localhost:8085</a>.</p>\n<h2>Why</h2>\n<p>I know that there is <a href=\"https://grafana.com/\">Grafana</a> and Chronograf, but while these tools are great for plotting and presenting data they are not so convenient to explore and work with raw queries during development phase.\nHere are some reasons which justifies existence of Time Series Admin as an administrator UI for InfluxDB:</p>\n<ul>\n<li>no need for server to run you administrator UI</li>\n<li>you are always one click away from any of your InfluxDB servers (easy access to any of saved connections)</li>\n<li>query history (this is something I was missing most in any other InfluxDB UI)</li>\n<li>ability to browse through Influx structure without worrying about queries</li>\n<li>viewing raw query results</li>\n<li>formatting returned data timestamps</li>\n</ul>\n<h2>Overview</h2>\n<p>General idea was to create a tool (admin UI) which will work through InfluxDB HTTP API allowing for easy query execution and database management/exploration.</p>\n<p>Time Series Admin is aimed primarily at developers/users who have at least base knowledge about <a href=\"https://docs.influxdata.com/influxdb/v1.6/query_language/\">InfluxQL</a>.\nThanks to the \"Explorer\" panel even without any knowledge you may reason about database internals in a human friendly way.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.60176991150442%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACbUlEQVQ4y22SPVMaURSGt82YGR1QaDRF9ifkD6SLmUmVmTS0ETWCBQOMTGZIj9kqdZr8gdili41FChCFkgh+ACts5GMXlt297L0n59ywKtE783K4X895z9mrbL17qyaSG9peLqfl9nJaKpXSkomktpvcvdX21ra282FH24xvagffDzTLtLR2q6W1mi3tWr8mfW632l/Ofp+9UGKx2JuPn/Kwv78PhUIB8vk8pNNpyGaykMlkIJvNAiaRisfjcHR0BDSEEPD/aDQaCaVSrb7yXJf7vs+m0ynD9QdiuGeORmxkTxgeYka3y4amyTyPBWdcAtbr9fdKsVhcN00TLMsSJM/zpFzXFZhIOChgngDuC/AZRi4mjiMMwxAIJ59oVvgzYFw5OTlZZ5gIFYAgEMIAqfBr7MHXzhC+GRY0mU8IMIw/MJUGgWq/A56ens4BsWzA8qUY/Udo1bLhx3ACP0ceGATEvf5gANgKos0DyaHjOGDbtsBI9mXDOedS1CbhOgDUXn8KMFvv9XqyigcOj4+PpUPaQFdiPB4DJQigMuIVH3/IkT9bu7npwdieUEvxHr8DlsvldSxVAqnsfr8PBA2eBonacN81qWv0wLI9rIBjq/x5hzNHHIF8MBhwLJ8jhJ7SrWgEkfbxK3N7MuFsyrhPGf8BN5RKpfL6/uOkvjz2aO8Puu88cu7i4mJLOTw8fHl1ddXBjHq73dZrtZp+fn6u07zb7c6p0+nIeHl5qeNlvdlsyjmebaGGpVIppiwtLT0Jh8PPI5GIilFdWFhQFxcX1ZWVlVvRXiCaR6NR9dnamrq6uirny8vLMoZCoad/AU9JYtF5uGvWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Time Series Admin - browse through InfluxDB database\"\n        title=\"Time Series Admin - browse through InfluxDB database\"\n        src=\"/static/c1a0cd3a957efea5d6b04d866f53ef61/a3419/timeseriesadmin--panel-explorer.png\"\n        srcset=\"/static/c1a0cd3a957efea5d6b04d866f53ef61/a1986/timeseriesadmin--panel-explorer.png 210w,\n/static/c1a0cd3a957efea5d6b04d866f53ef61/ad7fb/timeseriesadmin--panel-explorer.png 420w,\n/static/c1a0cd3a957efea5d6b04d866f53ef61/a3419/timeseriesadmin--panel-explorer.png 840w,\n/static/c1a0cd3a957efea5d6b04d866f53ef61/822a4/timeseriesadmin--panel-explorer.png 1130w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n    </span></p>\n<h2>Features</h2>\n<p>Most of the features are illustrated on the official Time Series Admin project page in <a href=\"https://timeseriesadmin.github.io/#showcase\">showcase</a> section.\nSome of them are extremely helpful (like query history) and others are more or less irrelevant (references panel - at least in current version). Anyway here they are:</p>\n<ul>\n<li>query history</li>\n<li>results browsing, pagination, sorting</li>\n<li>time formatting</li>\n<li>connection credentials list (saving, loading and deleting them)</li>\n<li>server exploration (through the Explorer panel)</li>\n<li>detailed error reporting</li>\n<li>flexible window size</li>\n<li>query reference</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 840px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.526361279170274%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACEUlEQVQ4y62Tu24TURCGt+QFeICQN6HBQlRINK6QsOIIBxEXNo4ETlpbB1PAK/ACiAjRure06wegcLB3vd6LL3u/Df+cXTtKGgoY6ffMufg7M3POKicvnh+33jQ+vutdiF63J87fnovW65Y4a50d1Dxpisarhjhtnoqryyth6IYwDEPMf8/F0ljyeKgv9M83s5uXSr1ef3bx4T0Nh0MaDAbU7/ep0+lQt9s9+L3a7TaNRiO6b0VRSO84zlhRNe2Jbdv5brdL4jhOMC+VZVnium7Cluf5HfHezWaTRFEkFYRhxEDMf1Mmk0kNAQFWYLEIw1Bqu90W6/Vaxr7vH8ae5xWAyTHgnBorYyDmryUwCAKCJBBghhMSK4UY82S7azItm7aex5mQ7TjSp2lKAGdVhiUQpzG9YChD9tC9siQmylPkkqMZMVm2TaZp0mq1kkLvsqqH14qqqjU+BSqqsmmvEMqgeRDRF9OjT3OXfmwicgHRdZ04kWqvBAJeAjmrqlzuC5dAuBTp8UNempEapDTxE/oVJuSjbIZlvF7abcmaptW4LG48XwA/Ac6YPc9zTPwsZJvg00Su7Z9KFUsgDrkFIiM+LmcDJMemnF8M+lr6KMpT7IniWK7dU1Ld8ndlOp0+pf9kqPKnMh6PHy8WCwuf0hKNXsKbfxM+hDuyLEvHDfuz2eyrAnsAHUGP/kH8/2Po4R9uiGKT1RH5AgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Time Series Admin - query history\"\n        title=\"Time Series Admin - query history\"\n        src=\"/static/9708b9a911c7742848c582e1909e9ae1/a3419/timeseriesadmin--panel-history.png\"\n        srcset=\"/static/9708b9a911c7742848c582e1909e9ae1/a1986/timeseriesadmin--panel-history.png 210w,\n/static/9708b9a911c7742848c582e1909e9ae1/ad7fb/timeseriesadmin--panel-history.png 420w,\n/static/9708b9a911c7742848c582e1909e9ae1/a3419/timeseriesadmin--panel-history.png 840w,\n/static/9708b9a911c7742848c582e1909e9ae1/e1c78/timeseriesadmin--panel-history.png 1157w\"\n        sizes=\"(max-width: 840px) 100vw, 840px\"\n      />\n    </span></p>\n<h2>Further development - wish list of features</h2>\n<p>While Time Series Admin is a usable and fully functional tool there are some improvemenets that are currently in backlog and hopefully will be available in future versions:</p>\n<ul>\n<li>writing data directly from UI</li>\n<li>import/export data (e.g. in CSV format)</li>\n<li>query editor (with some kind of suggestions and autocorrection, maybe a query wizzard)</li>\n<li>users administration UI</li>\n<li>retention policy UI</li>\n<li>automatic/easy application updates</li>\n<li>more UI buttons in Explorer (e.g. drop measurement, preview data, count series etc.</li>\n<li>copy measurement data feature (through <code class=\"language-text\">SELECT ... INTO ...</code> query)</li>\n<li>connection params validation autocorrection (e.g. missing port number or invalid URL)</li>\n</ul>\n<p>If you have any other ideas or feature request please let me know by creating an issue in the <a href=\"https://github.com/timeseriesadmin/timeseriesadmin/issues/new\">project Github repository</a>.</p>\n<h2>Summary</h2>\n<p>You are welcome to go and <a href=\"https://timeseriesadmin.github.io/#download\">try Time Series Admin</a>.\nAs usually it is an open source project <a href=\"https://github.com/timeseriesadmin/timeseriesadmin\">hosted on Github</a> with MIT license.\nIf you find any issues during usage please report them directly on Github.</p>\n<p>Of course you are more than welcome to contribute, more details about that should be available in repository files.</p>","timeToRead":3,"excerpt":"InfluxDB turns out to be a good solution for a time series data which happens to be the cornerstone of my current job. As (probably) every…","frontmatter":{"title":"Time Series Admin - Electron-based alternative to Admin UI for InfluxDB","slug":"time-series-admin-electron-application-influxdb","date":"2018-10-14T06:44:00.000Z","tags":["javascript","tools"],"date_created":"2018-11-04T18:31:42.000Z","date_updated":"2018-10-20T17:40:52.000Z","author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/photo-1504639725590-34d0984388bd.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgMF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAeU0vdnIgH//xAAaEAACAgMAAAAAAAAAAAAAAAAAAQISESEx/9oACAEBAAEFAl1syJxL6sj/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAACAwEAAAAAAAAAAAAAAAAAEQEQIjH/2gAIAQEABj8CMwoR2k6//8QAHRAAAwABBQEAAAAAAAAAAAAAAAERMVFhcZGh8P/aAAgBAQABPyGsBTTbt56XqKszsawyRcnzWf/aAAwDAQACAAMAAAAQ2+//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QhX//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCn/8QAHRABAAICAgMAAAAAAAAAAAAAAREhADFBUXHR8P/aAAgBAQABPxDS3uLMDhTuSvNMFmUvvLyKmoF6yPNQAaeaxHlfjrP/2Q==","aspectRatio":2,"src":"/static/64e6b6511ddfd7fea6aac62db0ec7ece/0defe/photo-1504639725590-34d0984388bd.jpg","srcSet":"/static/64e6b6511ddfd7fea6aac62db0ec7ece/38b6a/photo-1504639725590-34d0984388bd.jpg 150w,\n/static/64e6b6511ddfd7fea6aac62db0ec7ece/e201c/photo-1504639725590-34d0984388bd.jpg 300w,\n/static/64e6b6511ddfd7fea6aac62db0ec7ece/0defe/photo-1504639725590-34d0984388bd.jpg 600w,\n/static/64e6b6511ddfd7fea6aac62db0ec7ece/a71f1/photo-1504639725590-34d0984388bd.jpg 900w,\n/static/64e6b6511ddfd7fea6aac62db0ec7ece/8d595/photo-1504639725590-34d0984388bd.jpg 1080w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},{"node":{"id":"b1fbb88b-acde-56d7-986f-daf1adac67db","html":"<p>Type checking with Flow is a nice addition to your code. Unfortunately, it is not so intuitive to use Flow with libraries like Axios. The main problem is lack of easily available usage examples.</p>\n<h2>Problem</h2>\n<p>Using Axios type annotations <code class=\"language-text\">$AxiosXHR</code> and <code class=\"language-text\">$AxiosXHRConfig</code> may result in error messages similar to this:</p>\n<blockquote>\n<p>Cannot call resolve with result bound to result because string [1] is incompatible with object type [2] in type argument T [3]</p>\n</blockquote>\n<p>or this:</p>\n<blockquote>\n<p>Cannot call resolve with result bound to result because object type [1] is incompatible with string [2] in type argument R [3].</p>\n</blockquote>\n<p>What are <code class=\"language-text\">T</code> and <code class=\"language-text\">R</code> and how to fix that?</p>\n<h2>Solution</h2>\n<p>If you would like to find out the answer yourself you will have to read the source code of Axios Flow implementation. The code is not so complicated if you have some experience with Flow types, but for newcomers it looks cryptic (at best).</p>\n<p>Moving forward...</p>\n<p><code class=\"language-text\">$AxiosXHR</code> is defined as <code class=\"language-text\">$AxiosXHR&lt;T, R=T&gt;</code> which means that we have to provide at least one argument <code class=\"language-text\">T</code> and optionally another <code class=\"language-text\">R</code>.</p>\n<ul>\n<li><code class=\"language-text\">T</code> - input data <strong>T</strong>ype, should be a type of <code class=\"language-text\">data</code> parameter in your Axios request</li>\n<li><code class=\"language-text\">R</code> - <strong>R</strong>esponse type, should define expected type for a response</li>\n</ul>\n<p>As you may noticed <code class=\"language-text\">R</code> is optional and equals <code class=\"language-text\">T</code> by default which is useful especially when dealing with no request data (e.g. all <code class=\"language-text\">GET</code> queries) or no response data (e.g. <code class=\"language-text\">POST</code> query with just <code class=\"language-text\">200 OK</code> as a response).</p>\n<h2>Example</h2>\n<p>As usual we have to begin with <code class=\"language-text\">// @flow</code> declaration, import of Axios library and appropriate type definitions:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">// @flow</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> type <span class=\"token punctuation\">{</span> $AxiosXHR <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Let's define expected Axios response structure type:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> type RateLimit <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  limit<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">,</span>\n  remaining<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">,</span>\n  reset<span class=\"token punctuation\">:</span> number\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\ntype RateLimitResponse <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  resources<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    core<span class=\"token punctuation\">:</span> RateLimit<span class=\"token punctuation\">,</span>\n    search<span class=\"token punctuation\">:</span> RateLimit<span class=\"token punctuation\">,</span>\n    graphql<span class=\"token punctuation\">:</span> RateLimit<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  rate<span class=\"token punctuation\">:</span> RateLimit<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now it's time for a \"magical\" <code class=\"language-text\">$AxiosXHR</code> type annotation:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> getRateLimit <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Promise<span class=\"token operator\">&lt;</span>$AxiosXHR<span class=\"token operator\">&lt;</span>RateLimitResponse<span class=\"token operator\">>></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token function\">axios</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://api.github.com/rate_limit</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>We know that Github API endpoint <code class=\"language-text\">/rate_limit</code> is going to return something which should match <code class=\"language-text\">RateLimitResponse</code>. As we don't have any input data type there is no need to define more than one <code class=\"language-text\">$AxiosXHR</code> parameter (<code class=\"language-text\">R</code> equals <code class=\"language-text\">T</code>  by default).</p>\n<p>What is more, we know that <code class=\"language-text\">async</code> function should return a promise, thus we wrap returned type with <code class=\"language-text\">Promise&lt;....&gt;</code>.</p>\n<p>Now we can use Axios with Flow typings.</p>\n<p><strong>NOTE</strong>\nAs mentioned by @Joey M. you may replace:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">Promise<span class=\"token operator\">&lt;</span>$AxiosXHR<span class=\"token operator\">&lt;</span>RateLimitResponse<span class=\"token operator\">>></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>with</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">AxiosPromise<span class=\"token operator\">&lt;</span>RateLimitResponse<span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>It's a hand wrapper which simplifies typings a bit. Of course it has to be imported before usage: <code class=\"language-text\">import type { AxiosPromise } from &#39;axios&#39;;</code></p>\n<h2>Another example</h2>\n<p>Let say we have an API endpoint <code class=\"language-text\">http://your-api-enpoint.test</code> which will respond with string <code class=\"language-text\">OK</code> to every POST request with JSON <code class=\"language-text\">data</code> body: <code class=\"language-text\">{ getStatus: true }</code>.</p>\n<p>In this case Axios Flow typing for request is going to look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">type StatusRequest <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  getStatus<span class=\"token punctuation\">:</span> boolean\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> getStatus <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> AxiosPromise<span class=\"token operator\">&lt;</span>StatusRequest<span class=\"token punctuation\">,</span> string<span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token function\">axios</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    method<span class=\"token punctuation\">:</span> <span class=\"token string\">'post'</span><span class=\"token punctuation\">,</span>\n    data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> getStatus<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    url<span class=\"token punctuation\">:</span> <span class=\"token string\">'http://your-api-enpoint.test'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>That's all?</p>\n<p>Unfortunately, I don't know yet if it is possible to add Flow typings without wrapping Axios call in a wrapper function.</p>\n<p>Ideally something like this might be possible:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> response<span class=\"token punctuation\">:</span> $AxiosXHR<span class=\"token operator\">&lt;</span>RateLimitResponse<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">axios</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://api.github.com/rate_limit</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>","timeToRead":3,"excerpt":"Type checking with Flow is a nice addition to your code. Unfortunately, it is not so intuitive to use Flow with libraries like Axios. The…","frontmatter":{"title":"Flow type checking for Axios","slug":"flow-type-checking-for-axios","date":"2018-10-07T18:41:00.000Z","tags":["javascript"],"date_created":"2018-10-17T05:48:40.000Z","date_updated":"2018-11-08T00:24:46.000Z","author":"jan","feature_image":null}}}]},"authors":{"edges":[{"node":{"bio":"Full-stack developer currently working with React / Java stack at Equinix","id":"1","website":"","location":"","cover_image":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDAf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAGbzVEMI//EABsQAAIBBQAAAAAAAAAAAAAAAAECAAMREiIy/9oACAEBAAEFAgTCxl6hi7OwxVef/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8BJ//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/Aar/xAAaEAACAgMAAAAAAAAAAAAAAAAAAREhAjFx/9oACAEBAAY/ArhFFZojXBwI/8QAGxABAAICAwAAAAAAAAAAAAAAAQAxEVFBcaH/2gAIAQEAAT8hHdtXAcF1M5cDqECiCZaeef/aAAwDAQACAAMAAAAQPz//xAAWEQEBAQAAAAAAAAAAAAAAAAAAASH/2gAIAQMBAT8QiMf/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8QttP/xAAcEAEBAAMAAwEAAAAAAAAAAAABEQAhMXGBkaH/2gAIAQEAAT8Qcnvx8HC0EGkRf3mJgqQOO5MoUNAt83KGwO1rzH2Lrn//2Q==","width":30,"height":30,"src":"/static/580c6b1019cb9f810a68f59a6bab6c8f/a6b89/background.jpg","srcSet":"/static/580c6b1019cb9f810a68f59a6bab6c8f/a6b89/background.jpg 1x,\n/static/580c6b1019cb9f810a68f59a6bab6c8f/74c3b/background.jpg 1.5x,\n/static/580c6b1019cb9f810a68f59a6bab6c8f/9c097/background.jpg 2x"}}}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":true}}}