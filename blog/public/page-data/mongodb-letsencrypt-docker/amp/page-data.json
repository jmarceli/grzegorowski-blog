{"componentChunkName":"component---gatsby-ghost-theme-src-templates-post-js","path":"/mongodb-letsencrypt-docker/amp/","webpackCompilationHash":"860f80644a368a36172f","result":{"data":{"post":{"html":"<p>How to setup MongoDB Docker container to use Let's Encrypt SSL certificate with autorenewal support?\nThat's something which should be much easier to do than it is now.</p>\n<p><a href=\"https://docs.docker.com/engine/api/v1.36/#operation/SystemEvents\">https://docs.docker.com/engine/api/v1.36/#operation/SystemEvents</a>\nExample:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">curl -G -v --unix-socket /var/run/docker.sock http:/events --data-urlencode &#39;filters={&quot;container&quot;:[&quot;nginx-mongo&quot;]}&#39;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Filter <strong>nginx-mongo</strong> container restarts:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">curl -G -v --unix-socket /var/run/docker.sock http:/events --data-urlencode &#39;filters={&quot;container&quot;:[&quot;nginx-mongo&quot;],&quot;event&quot;:[&quot;restart&quot;]}&#39;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>This should work (but doesn't):</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">while read l; do echo &quot;OK&quot;; done &lt; &lt;(curl -GET -s --unix-socket /var/run/docker.sock http:/events --data-urlencode &#39;filters={&quot;container&quot;:[&quot;nginx-mongo&quot;],&quot;event&quot;:[&quot;restart&quot;]}&#39;)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Such command may trigger <strong>mongodb.pem</strong> key+cert file generation by:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sh line-numbers\"><code class=\"language-sh\">awk 1 /etc/nginx/certs/srp.predictail.com.key /etc/nginx/certs/srp.predictail.com.crt &gt; /mongo-ssl/mongodb.pem</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>Sources:</h3>\n<p><a href=\"https://stackoverflow.com/questions/878600/how-to-create-a-cron-job-using-bash-automatically-without-the-interactive-editor\">https://stackoverflow.com/questions/878600/how-to-create-a-cron-job-using-bash-automatically-without-the-interactive-editor</a>\n<a href=\"https://askubuntu.com/questions/640055/concatenate-two-files-and-separate-them-with-a-newline\">https://askubuntu.com/questions/640055/concatenate-two-files-and-separate-them-with-a-newline</a>\n<a href=\"https://docs.mongodb.com/manual/tutorial/configure-ssl/\">https://docs.mongodb.com/manual/tutorial/configure-ssl/</a>\n<a href=\"https://medium.com/lucjuggery/about-var-run-docker-sock-3bfd276e12fd\">https://medium.com/lucjuggery/about-var-run-docker-sock-3bfd276e12fd</a></p>","excerpt":"How to setup MongoDB Docker container to use Let's Encrypt SSL certificate with autorenewal support?\nThat's something which should be muchâ€¦","timeToRead":1,"frontmatter":{"author":"jan","feature_image":{"absolutePath":"/Users/janek/work/github_contrib/grzegorowski.com/theme/blog/content/posts/img/docker-containers.jpg","relativePath":"posts/img/docker-containers.jpg","publicURL":"/static/docker-containers-519a97714c74ce11183212fe7806cb18.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABy6TZyghP/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERECH/2gAIAQEAAQUCqRTgsZ//xAAWEQEBAQAAAAAAAAAAAAAAAAAAEQH/2gAIAQMBAT8BmI//xAAXEQADAQAAAAAAAAAAAAAAAAAAARES/9oACAECAQE/AdMrP//EABYQAAMAAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwIi/wD/xAAbEAACAgMBAAAAAAAAAAAAAAAAAREhMVFhgf/aAAgBAQABPyHEaIq4x0blrwSitEE8H//aAAwDAQACAAMAAAAQBO//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8Qiy//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/EAv/xAAbEAEAAgIDAAAAAAAAAAAAAAABABEhUTFBcf/aAAgBAQABPxAcoa1MYI+4Vki0qAhQfSNjjiKjSf/Z","aspectRatio":1.5005861664712778,"src":"/static/519a97714c74ce11183212fe7806cb18/c108b/docker-containers.jpg","srcSet":"/static/519a97714c74ce11183212fe7806cb18/6ece9/docker-containers.jpg 480w,\n/static/519a97714c74ce11183212fe7806cb18/0a89a/docker-containers.jpg 960w,\n/static/519a97714c74ce11183212fe7806cb18/c108b/docker-containers.jpg 1280w","sizes":"(max-width: 1280px) 100vw, 1280px"},"sizes":{"presentationHeight":533,"presentationWidth":800}}},"title":"MongoDB + Letsencrypt + Docker","slug":"mongodb-letsencrypt-docker","date":"2017-12-03T18:19:00.000Z","tags":[],"date_created":"2018-02-18T02:01:20.000Z","date_updated":"2019-03-03T16:20:05.000Z","featured":false}},"similarPosts":{"edges":[]},"authors":{"edges":[{"node":{"id":"1","slug":"jan","name":"Jan Grzegorowski","bio":"Full-stack developer currently working with React / Java stack at Equinix","website":"","location":"","profile_image":{"relativePath":"avatar/photo-mini.jpg","childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAUEAv/EABQBAQAAAAAAAAAAAAAAAAAAAAL/2gAMAwEAAhADEAAAAa8+nhDphjnIF7Ah/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxEiMf/aAAgBAQABBQK5mUB762lg1VGvG8Udif/EABcRAQEBAQAAAAAAAAAAAAAAAAEQETH/2gAIAQMBAT8BAyHJ/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAx/9oACAECAQE/ATUav//EABsQAQACAgMAAAAAAAAAAAAAAAECEgAQESAx/9oACAEBAAY/Agh64Wbx56u//8QAHBABAAIDAAMAAAAAAAAAAAAAAQARECExgaGx/9oACAEBAAE/IRAL6t4R+NaJW948RDMDnzHpQyxFZP/aAAwDAQACAAMAAAAQD8A8/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAx/9oACAEDAQE/EGNZvP/EABYRAQEBAAAAAAAAAAAAAAAAAAEQMf/aAAgBAgEBPxBJGE//xAAcEAEBAAICAwAAAAAAAAAAAAABEQAhEDFRgcH/2gAIAQEAAT8Qfyh9bKr5wsWRAIpRh0prgVXZTPUxvgwCqwb+cGlgG6ILpxBXtz//2Q==","width":30,"height":30,"src":"/static/2b64da00e4a3f2952c8d9e3a6b631208/a6b89/photo-mini.jpg","srcSet":"/static/2b64da00e4a3f2952c8d9e3a6b631208/a6b89/photo-mini.jpg 1x,\n/static/2b64da00e4a3f2952c8d9e3a6b631208/74c3b/photo-mini.jpg 1.5x,\n/static/2b64da00e4a3f2952c8d9e3a6b631208/9c097/photo-mini.jpg 2x"}}},"profile_image_large":{"relativePath":"avatar/photo-mini.jpg","childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAUEAv/EABQBAQAAAAAAAAAAAAAAAAAAAAL/2gAMAwEAAhADEAAAAa8+nhDphjnIF7Ah/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxEiMf/aAAgBAQABBQK5mUB762lg1VGvG8Udif/EABcRAQEBAQAAAAAAAAAAAAAAAAEQETH/2gAIAQMBAT8BAyHJ/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAx/9oACAECAQE/ATUav//EABsQAQACAgMAAAAAAAAAAAAAAAECEgAQESAx/9oACAEBAAY/Agh64Wbx56u//8QAHBABAAIDAAMAAAAAAAAAAAAAAQARECExgaGx/9oACAEBAAE/IRAL6t4R+NaJW948RDMDnzHpQyxFZP/aAAwDAQACAAMAAAAQD8A8/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAx/9oACAEDAQE/EGNZvP/EABYRAQEBAAAAAAAAAAAAAAAAAAEQMf/aAAgBAgEBPxBJGE//xAAcEAEBAAICAwAAAAAAAAAAAAABEQAhEDFRgcH/2gAIAQEAAT8Qfyh9bKr5wsWRAIpRh0prgVXZTPUxvgwCqwb+cGlgG6ILpxBXtz//2Q==","width":60,"height":60,"src":"/static/2b64da00e4a3f2952c8d9e3a6b631208/9c097/photo-mini.jpg","srcSet":"/static/2b64da00e4a3f2952c8d9e3a6b631208/9c097/photo-mini.jpg 1x,\n/static/2b64da00e4a3f2952c8d9e3a6b631208/c5aad/photo-mini.jpg 1.5x"}}}}}]},"tags":{"edges":[]},"tagPosts":{"edges":[],"totalCount":0}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"mongodb-letsencrypt-docker","tags":[],"author":"jan","mainTag":"","prev":{"frontmatter":{"slug":"docker-grafana-google-analytics","tags":["docker","backend"],"author":"jan"}},"next":{"frontmatter":{"slug":"how-to-backup-and-restore-influxdb-which-runs-inside-docker-container","tags":["docker","backend"],"author":"jan"}},"isAmp":true}}}